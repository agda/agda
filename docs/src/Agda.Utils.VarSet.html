<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Needed to get haddock to pick up on identifiers with a #.</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">{-|
Manage sets of natural numbers (de Bruijn indices).

This file contains an implementation of finite sets of integers
that is optimized for storing sets of free variables. Notably,
de Bruijn indices/levels are not uniformly distributed across the
range of 'Int', and are always very small (EG: less than 64).

This makes 'Data.IntSet.IntSet' somewhat ill-suited for the task.
'Data.IntSet.IntSet' is designed to be able to handle values distributed
across the entire range of 'Int', at the cost of pointer indirections
and poor memory locality.

Instead, 'VarSet' stores free variables as a bitvector. When the
elements in the set are all smaller than 64, we can fit the entire set
into a single unboxed 'GHC.Base.Word#', which makes most of our set operations
a single instruction.

When we exceed this bound, we fall back to an unboxed 'GHC.Base.ByteArray#'.
Experimentally, this happens less than 0.0001% of the time.

= Experimental Results

Agda builds instrumented with 'traceVarSetSize' give the following
statistics for 'VarSet' sizes across the following libraries:

+-------------+------------------------------------------+-------------------+---------------------+
| library     | commit hash                              | varsets allocated | non-word sized sets |
+=============+==========================================+===================+=====================+
| 1lab        | 11f4672ca7dcfdccb1b4ce94ca4ca42c9b732e62 | 118198551         | 0                   |
+-------------+------------------------------------------+-------------------+---------------------+
| agda-stdlib | 0e97e2ed1f999ea0d2cce2a3b2395d5a9a7bd36a | 38960049          | 2178                |
+-------------+------------------------------------------+-------------------+---------------------+
| cubical     | 1f2af52701945bef003a525f78fa41aeadb7c6ae | 82751805          | 0                   |
+-------------+------------------------------------------+-------------------+---------------------+
-}</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html"><span class="hs-identifier">Agda.Utils.VarSet</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- * VarSet type</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-comment">-- $varSetType</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier">VarSet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Construction</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier">empty</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#singleton"><span class="hs-identifier">singleton</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#fromList"><span class="hs-identifier">fromList</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#fromDescList"><span class="hs-identifier">fromDescList</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier">full</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#range"><span class="hs-identifier">range</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Insertion</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier">insert</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-identifier">inserts</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier">insertsDesc</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Deletion</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier">delete</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Queries</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier">null</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#member"><span class="hs-identifier">member</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMin"><span class="hs-identifier">lookupMin</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMax"><span class="hs-identifier">lookupMax</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#size"><span class="hs-identifier">Agda.Utils.VarSet.size</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#disjoint"><span class="hs-identifier">disjoint</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-identifier">isSubsetOf</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#inRange"><span class="hs-identifier">inRange</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Combining variable sets</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier">union</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#unions"><span class="hs-identifier">unions</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier">intersection</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier">difference</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#complement"><span class="hs-identifier">complement</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Filters</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#split"><span class="hs-identifier">split</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLT"><span class="hs-identifier">filterLT</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLE"><span class="hs-identifier">filterLE</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGT"><span class="hs-identifier">filterGT</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGE"><span class="hs-identifier">filterGE</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Folds</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="hs-comment">-- $varSetFolds</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#foldr"><span class="hs-identifier">foldr</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#foldl"><span class="hs-identifier">foldl</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#foldr%27"><span class="hs-identifier">foldr'</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Views</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#minView"><span class="hs-identifier">minView</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#maxView"><span class="hs-identifier">maxView</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Contextual operations</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#strengthen"><span class="hs-identifier">strengthen</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#weaken"><span class="hs-identifier">weaken</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Conversions</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#toDescList"><span class="hs-identifier">toDescList</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#toAscList"><span class="hs-identifier">toAscList</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- We need the machines word size for some bitwise operations.</span><span class="hs-cpp">
#include &quot;MachDeps.h&quot;
</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Base</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Num.BigNat</span></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Num.WordArray</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Num</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Show</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.ByteArray.html"><span class="hs-identifier">Agda.Utils.ByteArray</span></a></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Word.html"><span class="hs-identifier">Agda.Utils.Word</span></a></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Serialize.html"><span class="hs-identifier">Agda.Utils.Serialize</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- $varSetType</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- = Invariants</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- A variable set whose maximum entry is less than than 64 is always encoded</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- via the 'VS#' constructor.</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- The final word of a 'VB#' is always non-zero.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- = Performance</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- GHC will use pointer-tagging for datatypes with less than 4 constructors</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- on 32 bit machines (8 on 64 bit), which means that 'VarSet' will be laid</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- out as a tagged pointer to a word-sized piece of data.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- We also pay attention to the constructor ordering here.</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- GHC will lay out the machine code for case statements in</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- reverse order of the datatypes constructors. Both ARM and x86 statically</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- predict that forward branches are not taken, so putting 'VB#' before</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- 'VS#' means that we can eek out a few extra drops of performance.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Finally, many functions in this module follow the following pattern:</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- union :: VarSet -&gt; VarSet -&gt; VarSet</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- union (VS# w1) (VS# w2) = VS# (w1 `or#` w2)</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- union vs1 vs2 = unionSlow vs1 vs2</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- {-# INLINE union #-}</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- unionSlow :: VarSet -&gt; VarSet -&gt; VarSet</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- unionSlow (VS# w1) (VS# w2) = VS# (w1 `or#` w2)</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- unionSlow (VS# w1) (VB# bs2) = VB# (bigNatOrWord# bs2 w1)</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- unionSlow (VB# bs1) (VS# w2) = VB# (bigNatOrWord# bs1 w2)</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- unionSlow (VB# bs1) (VB# bs2) = VB# (bigNatOr bs1 bs2)</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- {-# NOINLINE unionSlow #-}</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- This makes the 0.0001% of slow cases notably worse, but makes the</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- happy path approximately 3x faster for things like 'inRange', as</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- GHC is able to coalesce all of the happy paths.</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | A set of de Bruijn indices/levels.</span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="VarSet"><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-var">VarSet</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VB%23"><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ A variable set whose maximum entry is greater than or equal to 64.</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VS%23"><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ A small variable set whose maximum entry is less than than 64.</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Convert a 'ByteArray#' to a variable set, upholding</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- the invariant that all word-sized variable sets should use</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- 'VS#'.</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Agda.Utils.VarSet.html#byteArrayToVarSet%23"><span class="hs-identifier hs-type">byteArrayToVarSet#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-173"></span><span id="byteArrayToVarSet%23"><span class="annot"><span class="annottext">byteArrayToVarSet# :: ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#byteArrayToVarSet%23"><span class="hs-identifier hs-var hs-var">byteArrayToVarSet#</span></a></span></span><span> </span><span id="local-6989586621681667287"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667287"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">bigNatSize#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667287"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-comment">-- Dont allocate if we don't have to.</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667287"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667287"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681667291"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667295"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667295"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681667296"><span class="annot"><span class="annottext">== :: VarSet -&gt; VarSet -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667297"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667297"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667295"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667297"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667299"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667299"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667300"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667300"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; Bool
</span><span class="hs-identifier hs-var">bigNatEq</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667299"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667300"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681667306"><span id="local-6989586621681667310"><span id="local-6989586621681667313"><span id="local-6989586621681667316"><span id="local-6989586621681667319"><span id="local-6989586621681667322"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621681667325"><span class="annot"><span class="annottext">compare :: VarSet -&gt; VarSet -&gt; Ordering
</span><a href="#local-6989586621681667325"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667327"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667327"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667328"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667328"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Ordering
</span><span class="hs-identifier hs-var">compareWord#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667327"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667328"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667330"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667330"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667331"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667331"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; Ordering
</span><span class="hs-identifier hs-var">bigNatCompare</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667330"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667331"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681667335"><span id="local-6989586621681667339"><span class="annot"><span class="hs-identifier hs-type">P.Show</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- Use the same direction as the 'Show' instance for 'IntSet'.</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621681667349"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; VarSet -&gt; ShowS
</span><a href="#local-6989586621681667349"><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621681667351"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667351"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681667352"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667352"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667351"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromList &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; [Int]
</span><a href="Agda.Utils.VarSet.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667352"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621681667361"><span class="annot"><span class="annottext">rnf :: VarSet -&gt; ()
</span><a href="#local-6989586621681667361"><span class="hs-identifier hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><span class="hs-comment">-- | @(&lt;&gt;)@ is @'union'@</span></span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681667365"><span id="local-6989586621681667369"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621681667374"><span class="annot"><span class="annottext">&lt;&gt; :: VarSet -&gt; VarSet -&gt; VarSet
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier hs-var">union</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><span class="hs-comment">-- | @mempty@ is @'empty'@.</span></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681667379"><span id="local-6989586621681667383"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621681667386"><span class="annot"><span class="annottext">mempty :: VarSet
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- This instance is a bit suboptimal.</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Ideally, 'hashWithSalt' should directly just call an unboxed 'mixHash' when we have a 'VS#',</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- but 'Hashable' doesn't expose enough of its internals for this.</span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621681667393"><span class="annot"><span class="annottext">hash :: VarSet -&gt; Int
</span><a href="#local-6989586621681667393"><span class="hs-identifier hs-var hs-var hs-var">hash</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667395"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667395"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667395"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">hash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667396"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667396"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int -&gt; Int -&gt; Int
</span><span class="hs-identifier hs-var">hashByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667396"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">sizeofByteArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667396"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621681667400"><span class="annot"><span class="annottext">hashWithSalt :: Int -&gt; VarSet -&gt; Int
</span><a href="#local-6989586621681667400"><span class="hs-identifier hs-var hs-var hs-var">hashWithSalt</span></a></span></span><span> </span><span id="local-6989586621681667402"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667402"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667403"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667403"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Hashable a =&gt; Int -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">hashWithSalt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667403"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667402"><span class="hs-identifier hs-var">salt</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">hashWithSalt</span></span><span> </span><span id="local-6989586621681667404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667404"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667405"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667405"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><span class="hs-identifier hs-var">hashByteArrayWithSalt</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667405"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">sizeofByteArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667405"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667404"><span class="hs-identifier hs-var">salt</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.Serialize.html#Serialize"><span class="hs-identifier hs-type">Serialize</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.Serialize.html#size"><span class="hs-pragma hs-type">size</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621681667418"><span class="annot"><span class="annottext">size :: VarSet -&gt; Int
</span><a href="Agda.Utils.Serialize.html#size"><span class="hs-identifier hs-var hs-var hs-var">size</span></a></span></span><span> </span><span id="local-6989586621681667419"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667419"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SIZEOF_WORD8</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-identifier">VB#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SIZEOF_HSINT</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">I#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeofByteArray#</span><span> </span><span class="hs-identifier">arr</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-identifier">VS#</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SIZEOF_HSWORD</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621681667436"><span class="annot"><span class="annottext">put :: VarSet -&gt; Put
</span><a href="#local-6989586621681667436"><span class="hs-identifier hs-var hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621681667438"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667438"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Addr# -&gt; RW -&gt; (# Addr#, RW #)) -&gt; Put
</span><a href="Agda.Utils.Serialize.html#Put"><span class="hs-identifier hs-var">Put</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681667440"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621681667440"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681667441"><span class="annot"><span class="annottext">RW
</span><a href="#local-6989586621681667441"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667438"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667442"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667442"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681667443"><span class="annot"><span class="annottext">sz :: Int#
</span><a href="#local-6989586621681667443"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">sizeofByteArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667442"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Addr# -&gt; RW -&gt; (# Addr#, RW #)
</span><a href="Agda.Utils.Serialize.html#unPut"><span class="hs-identifier hs-var">unPut</span></a></span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><span class="annottext">Word8 -&gt; Put
forall a. Serialize a =&gt; a -&gt; Put
</span><a href="Agda.Utils.Serialize.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Put
forall a. Serialize a =&gt; a -&gt; Put
</span><a href="Agda.Utils.Serialize.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667443"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Int# -&gt; Put
</span><a href="Agda.Utils.Serialize.html#putByteArray%23"><span class="hs-identifier hs-var">putByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667442"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667443"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621681667440"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">RW
</span><a href="#local-6989586621681667441"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667446"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667446"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">Put -&gt; Addr# -&gt; RW -&gt; (# Addr#, RW #)
</span><a href="Agda.Utils.Serialize.html#unPut"><span class="hs-identifier hs-var">unPut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Put
forall a. Serialize a =&gt; a -&gt; Put
</span><a href="Agda.Utils.Serialize.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Put
forall a. Serialize a =&gt; a -&gt; Put
</span><a href="Agda.Utils.Serialize.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word
</span><span class="hs-identifier hs-var">W#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667446"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621681667440"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">RW
</span><a href="#local-6989586621681667441"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621681667464"><span class="annot"><span class="annottext">get :: Get VarSet
</span><a href="#local-6989586621681667464"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Serialize a =&gt; Get a
</span><a href="Agda.Utils.Serialize.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="annottext">Get Word8 -&gt; (Word8 -&gt; Get VarSet) -&gt; Get VarSet
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667466"><span class="annot"><a href="#local-6989586621681667466"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
forall a. Serialize a =&gt; Get a
</span><a href="Agda.Utils.Serialize.html#get"><span class="hs-identifier hs-var">get</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Agda.Utils.Serialize.html#getByteArray%23"><span class="hs-identifier hs-type">getByteArray#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681667466"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681667468"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667468"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Get VarSet
forall a. a -&gt; Get a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; Get VarSet) -&gt; VarSet -&gt; Get VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667468"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621681667469"><span class="annot"><a href="#local-6989586621681667469"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word
forall a. Serialize a =&gt; Get a
</span><a href="Agda.Utils.Serialize.html#get"><span class="hs-identifier hs-var">get</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681667469"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get VarSet
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deserialize: malformed input&quot;</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Construction</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | The empty variable set.</span></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-245"></span><span id="empty"><span class="annot"><span class="annottext">empty :: VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span>
</span><span id="line-246"></span><span class="hs-pragma">{-# INLINE CONLIKE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#empty"><span class="hs-pragma hs-type">empty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">-- | A variable set with only a single entry.</span></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Agda.Utils.VarSet.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-250"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667471"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667471"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667471"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Agda.Utils.Word.html#uncheckedBitWord%23"><span class="hs-identifier hs-var">uncheckedBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667471"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatBit#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667471"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#singleton"><span class="hs-pragma hs-type">singleton</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><span class="hs-comment">-- | Construct a set of variables from a list of indices.</span></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Agda.Utils.VarSet.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-259"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: [Int] -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span id="local-6989586621681667474"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667474"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-identifier hs-var">inserts</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667474"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-260"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#fromList"><span class="hs-pragma hs-type">fromList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Construct a set of variables from a list of indices sorted in descending order.</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- This can be more efficient than 'fromList', as we only need to perform a single</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- to determine that elements of the list are smaller than 64.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- The precondition that the variables are sorted in descending order is</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- not checked by 'fromDescList'.</span><span>
</span><span id="line-268"></span><span class="annot"><a href="Agda.Utils.VarSet.html#fromDescList"><span class="hs-identifier hs-type">fromDescList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-269"></span><span id="fromDescList"><span class="annot"><span class="annottext">fromDescList :: [Int] -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#fromDescList"><span class="hs-identifier hs-var hs-var">fromDescList</span></a></span></span><span> </span><span id="local-6989586621681667475"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667475"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier hs-var">insertsDesc</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667475"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">-- | Construct a variable set that contains the indices @[0..n-1]@.</span></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-type">full</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-273"></span><span id="full"><span class="annot"><span class="annottext">full :: Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var hs-var">full</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667476"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667476"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667476"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667476"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="Agda.Utils.Word.html#uncheckedWordOnes%23"><span class="hs-identifier hs-var">uncheckedWordOnes#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667476"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; ByteArray#
</span><a href="Agda.Utils.ByteArray.html#byteArrayOnes%23"><span class="hs-identifier hs-var">byteArrayOnes#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667476"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#full"><span class="hs-pragma hs-type">full</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | Construct a variable set that contains the indices @[lo+1..hi-1]@.</span></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Agda.Utils.VarSet.html#range"><span class="hs-identifier hs-type">range</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-284"></span><span id="range"><span class="annot"><span class="annottext">range :: Int -&gt; Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#range"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621681667479"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667479"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621681667480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667480"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- Most of the time, @hi@ is the length of the context</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">-- and @lo@ is some variable, so it would be a waste of time</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">-- to try and avoid work by checking if hi &lt;= lo.</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667480"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667479"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#range"><span class="hs-pragma hs-type">range</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Insertion</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | Insert an index into a variable set.</span></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-296"></span><span id="insert"><span class="annot"><span class="annottext">insert :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667481"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667481"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667482"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667482"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667481"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><a href="Agda.Utils.Word.html#uncheckedSetBitWord%23"><span class="hs-identifier hs-var">uncheckedSetBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667482"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667481"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatSetBit#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatFromWord#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667482"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667481"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667486"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667486"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667487"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667487"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatSetBit#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667487"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667486"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">-- | Insert a list of variables into a @VarSet@.</span></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-identifier hs-type">inserts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-305"></span><span id="inserts"><span class="annot"><span class="annottext">inserts :: [Int] -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-identifier hs-var hs-var">inserts</span></a></span></span><span> </span><span id="local-6989586621681667488"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667488"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681667489"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667489"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; Int -&gt; VarSet) -&gt; VarSet -&gt; [Int] -&gt; VarSet
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Fold.foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; VarSet -&gt; VarSet) -&gt; VarSet -&gt; Int -&gt; VarSet
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667489"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667488"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-306"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-pragma hs-type">inserts</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Insert a list of variables sorted in descending order into a 'VarSet'.</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- This can be more efficient than 'inserts', as we only need to perform a single</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- to determine that elements of the list are smaller than 64.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- The precondition that the variables are sorted in descending order is</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- not checked by 'insertsDesc'.</span><span>
</span><span id="line-314"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier hs-type">insertsDesc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-315"></span><span id="insertsDesc"><span class="annot"><span class="annottext">insertsDesc :: [Int] -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier hs-var hs-var">insertsDesc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681667492"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667492"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667492"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier hs-var">insertsDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667493"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667493"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681667494"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667494"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667495"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667495"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667493"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">VS#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">insertsDescFast#</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uncheckedSetBitWord#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDesc"><span class="hs-identifier hs-var">insertsDesc</span></a></span><span> </span><span id="local-6989586621681667497"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667497"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681667498"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667498"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#inserts"><span class="hs-identifier hs-var">inserts</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667497"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667498"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-comment">-- Could be more optimal but this is basically never taken.</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><span class="hs-comment">-- | Fast path for 'insertsDesc' that omits bounds checking.</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDescFast%23"><span class="hs-identifier hs-type">insertsDescFast#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span>
</span><span id="line-321"></span><span id="insertsDescFast%23"><span class="annot"><span class="annottext">insertsDescFast# :: [Int] -&gt; Word# -&gt; Word#
</span><a href="Agda.Utils.VarSet.html#insertsDescFast%23"><span class="hs-identifier hs-var hs-var">insertsDescFast#</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681667499"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667499"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667499"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Agda.Utils.VarSet.html#insertsDescFast%23"><span class="hs-identifier hs-var">insertsDescFast#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667500"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667500"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681667501"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667501"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681667502"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667502"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Word# -&gt; Word#
</span><a href="Agda.Utils.VarSet.html#insertsDescFast%23"><span class="hs-identifier hs-var">insertsDescFast#</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681667501"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><a href="Agda.Utils.Word.html#uncheckedSetBitWord%23"><span class="hs-identifier hs-var">uncheckedSetBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667502"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667500"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Deletion</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="annot"><span class="hs-comment">-- | Delete an index from a variable set.</span></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-329"></span><span id="delete"><span class="annot"><span class="annottext">delete :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667503"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667503"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681667504"><span class="annot"><span class="annottext">vs :: VarSet
</span><a href="#local-6989586621681667504"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667505"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667505"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667503"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><a href="Agda.Utils.Word.html#uncheckedClearBitWord%23"><span class="hs-identifier hs-var">uncheckedClearBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667505"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667503"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667504"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667507"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667507"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667508"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667508"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#byteArrayToVarSet%23"><span class="hs-identifier hs-var">byteArrayToVarSet#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatClearBit#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667508"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667507"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- Queries</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | Is this the empty set?</span></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-341"></span><span id="null"><span class="annot"><span class="annottext">null :: VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#null"><span class="hs-pragma hs-type">null</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><span class="hs-comment">-- | Is a variable a member of a var set?</span></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Agda.Utils.VarSet.html#member"><span class="hs-identifier hs-type">member</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-347"></span><span id="member"><span class="annot"><span class="annottext">member :: Int -&gt; VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#member"><span class="hs-identifier hs-var hs-var">member</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667510"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667510"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667511"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667511"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667510"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`andI#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667510"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">andI#</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uncheckedTestBitWord#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span class="annot"><a href="Agda.Utils.VarSet.html#member"><span class="hs-identifier hs-var">member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667513"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667513"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667514"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667514"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; Int#
</span><span class="hs-identifier hs-var">bigNatTestBit#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667514"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667513"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#member"><span class="hs-pragma hs-type">member</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><span class="hs-comment">-- | Find the smallest index in the variable set.</span></span><span>
</span><span id="line-352"></span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMin"><span class="hs-identifier hs-type">lookupMin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-353"></span><span id="lookupMin"><span class="annot"><span class="annottext">lookupMin :: VarSet -&gt; Maybe Int
</span><a href="Agda.Utils.VarSet.html#lookupMin"><span class="hs-identifier hs-var hs-var">lookupMin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667516"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667516"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667516"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#lowestBitWord%23"><span class="hs-identifier hs-var">lowestBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667516"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMin"><span class="hs-identifier hs-var">lookupMin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667518"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667518"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; ByteArray# -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#lookupMinSlow%23"><span class="hs-identifier hs-var">lookupMinSlow#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667518"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'lookupMin'.</span></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMinSlow%23"><span class="hs-identifier hs-type">lookupMinSlow#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-362"></span><span id="lookupMinSlow%23"><span class="annot"><span class="annottext">lookupMinSlow# :: Int# -&gt; ByteArray# -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#lookupMinSlow%23"><span class="hs-identifier hs-var hs-var">lookupMinSlow#</span></a></span></span><span> </span><span id="local-6989586621681667520"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681667521"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667521"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-comment">-- We don't need to check if the index goes out of bounds, as we know that</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-comment">-- 0 always gets stored as an @VS#@, so there must be *some* set bit.</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681667522"><span class="annot"><span class="annottext">w :: Word#
</span><a href="#local-6989586621681667522"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667521"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667520"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-identifier hs-var">eqWord#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667522"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">Int# -&gt; ByteArray# -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#lookupMinSlow%23"><span class="hs-identifier hs-var">lookupMinSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667520"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">+#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667521"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-identifier">WORD_SIZE_IN_BITS#</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word2Int#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lowestBitWord#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMinSlow%23"><span class="hs-pragma hs-type">lookupMinSlow#</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><span class="hs-comment">-- | Find the largest index in the variable set.</span></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMax"><span class="hs-identifier hs-type">lookupMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-374"></span><span id="lookupMax"><span class="annot"><span class="annottext">lookupMax :: VarSet -&gt; Maybe Int
</span><a href="Agda.Utils.VarSet.html#lookupMax"><span class="hs-identifier hs-var hs-var">lookupMax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667523"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667523"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667523"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#highestBitWord%23"><span class="hs-identifier hs-var">highestBitWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667523"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Agda.Utils.VarSet.html#lookupMax"><span class="hs-identifier hs-var">lookupMax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667525"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667525"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-comment">-- We know that the highest bit must be in the final word of 'bs',</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-comment">-- as there are no leading 0 words in our varsets.</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681667526"><span class="annot"><span class="annottext">len :: Int#
</span><a href="#local-6989586621681667526"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><span class="hs-identifier hs-var">wordArraySize#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667525"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#highestBitWord%23"><span class="hs-identifier hs-var">highestBitWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667525"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667526"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">-#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><span class="hs-comment">-- | The number of entries in the variable set.</span></span><span>
</span><span id="line-386"></span><span class="annot"><a href="Agda.Utils.VarSet.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-387"></span><span id="size"><span class="annot"><span class="annottext">size :: VarSet -&gt; Int
</span><a href="Agda.Utils.VarSet.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667528"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667528"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><span class="hs-identifier hs-var">popCnt#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667528"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Agda.Utils.VarSet.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667529"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667529"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">word2Int#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word#
</span><span class="hs-identifier hs-var">bigNatPopCount#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667529"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#size"><span class="hs-pragma hs-type">size</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><span class="hs-comment">-- | Check if two variable sets are disjoint.</span></span><span>
</span><span id="line-392"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjoint"><span class="hs-identifier hs-type">disjoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-393"></span><span id="disjoint"><span class="annot"><span class="annottext">disjoint :: VarSet -&gt; VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#disjoint"><span class="hs-identifier hs-var hs-var">disjoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667531"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667531"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667532"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667532"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="Agda.Utils.Word.html#disjointWord%23"><span class="hs-identifier hs-var">disjointWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667531"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667532"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjoint"><span class="hs-identifier hs-var">disjoint</span></a></span><span> </span><span id="local-6989586621681667534"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667534"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621681667535"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667535"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-var">disjointSlow#</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667534"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667535"><span class="hs-identifier hs-var">vs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#disjoint"><span class="hs-pragma hs-type">disjoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'disjoint'.</span></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-type">disjointSlow#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-399"></span><span id="disjointSlow%23"><span class="annot"><span class="annottext">disjointSlow# :: VarSet -&gt; VarSet -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-var hs-var">disjointSlow#</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667537"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667537"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667538"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667538"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="Agda.Utils.Word.html#disjointWord%23"><span class="hs-identifier hs-var">disjointWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667537"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667538"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-var">disjointSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667539"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667539"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667540"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667540"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="Agda.Utils.Word.html#disjointWord%23"><span class="hs-identifier hs-var">disjointWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667539"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667540"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-401"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-var">disjointSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667541"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667541"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667542"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667542"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="Agda.Utils.Word.html#disjointWord%23"><span class="hs-identifier hs-var">disjointWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667542"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667541"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-identifier hs-var">disjointSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667543"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667543"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667544"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667544"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; Int#
</span><a href="Agda.Utils.ByteArray.html#byteArrayDisjoint%23"><span class="hs-identifier hs-var">byteArrayDisjoint#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667543"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667544"><span class="hs-identifier hs-var">bs2</span></a></span><span>
</span><span id="line-403"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#disjointSlow%23"><span class="hs-pragma hs-type">disjointSlow#</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- Combining variable sets</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><span class="hs-comment">-- | Union two variable sets.</span></span><span>
</span><span id="line-409"></span><span class="annot"><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier hs-type">union</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-410"></span><span id="union"><span class="annot"><span class="annottext">union :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier hs-var hs-var">union</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667546"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667546"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667547"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667547"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667546"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`or#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667547"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span class="annot"><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span id="local-6989586621681667548"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667548"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621681667549"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667549"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-var">unionSlow</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667548"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667549"><span class="hs-identifier hs-var">vs2</span></a></span><span>
</span><span id="line-412"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#union"><span class="hs-pragma hs-type">union</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'union'.</span></span><span>
</span><span id="line-415"></span><span class="annot"><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-type">unionSlow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-416"></span><span id="unionSlow"><span class="annot"><span class="annottext">unionSlow :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-var hs-var">unionSlow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667551"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667551"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667552"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667552"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667551"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`or#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667552"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-var">unionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667553"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667553"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667554"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667554"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatOrWord#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667554"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667553"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-var">unionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667556"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667556"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667557"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667557"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatOrWord#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667556"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667557"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-identifier hs-var">unionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667558"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667558"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667559"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667559"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatOr</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667558"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667559"><span class="hs-identifier hs-var">bs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#unionSlow"><span class="hs-pragma hs-type">unionSlow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- | Union a collection of variable sets together.</span></span><span>
</span><span id="line-423"></span><span id="local-6989586621681667210"><span class="annot"><a href="Agda.Utils.VarSet.html#unions"><span class="hs-identifier hs-type">unions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621681667210"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667210"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span><span>
</span><span id="line-424"></span><span id="unions"><span class="annot"><span class="annottext">unions :: forall (f :: * -&gt; *). Foldable f =&gt; f VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#unions"><span class="hs-identifier hs-var hs-var">unions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet -&gt; VarSet) -&gt; VarSet -&gt; f VarSet -&gt; VarSet
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; f a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Fold.foldl'</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="Agda.Utils.VarSet.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-425"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#unions"><span class="hs-pragma hs-type">unions</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Take the intersection of two variable sets.</span></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-type">intersection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-429"></span><span id="intersection"><span class="annot"><span class="annottext">intersection :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-var hs-var">intersection</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667563"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667563"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667564"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667564"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667563"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667564"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span id="local-6989586621681667565"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667565"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621681667566"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667566"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-var">intersectionSlow</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667565"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667566"><span class="hs-identifier hs-var">vs2</span></a></span><span>
</span><span id="line-431"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-pragma hs-type">intersection</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'intersection'.</span></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-type">intersectionSlow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-435"></span><span id="intersectionSlow"><span class="annot"><span class="annottext">intersectionSlow :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-var hs-var">intersectionSlow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667568"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667568"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667569"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667569"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667568"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667569"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-var">intersectionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667570"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667570"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667571"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667571"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667570"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667571"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-var">intersectionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667572"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667572"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667573"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667573"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667572"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667573"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span class="annot"><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-identifier hs-var">intersectionSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667574"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667574"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667575"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667575"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatAnd</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667574"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667575"><span class="hs-identifier hs-var">bs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#intersectionSlow"><span class="hs-pragma hs-type">intersectionSlow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><span class="hs-comment">-- | Set difference of two variable sets.</span></span><span>
</span><span id="line-442"></span><span class="annot"><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-type">difference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-443"></span><span id="difference"><span class="annot"><span class="annottext">difference :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var hs-var">difference</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667577"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667577"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667578"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667578"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667577"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#andNot%23"><span class="hs-operator hs-var">`andNot#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667578"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span class="annot"><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span> </span><span id="local-6989586621681667580"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667580"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621681667581"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667581"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-var">differenceSlow</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667580"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667581"><span class="hs-identifier hs-var">vs2</span></a></span><span>
</span><span id="line-445"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#difference"><span class="hs-pragma hs-type">difference</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'difference'.</span></span><span>
</span><span id="line-448"></span><span class="annot"><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-type">differenceSlow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-449"></span><span id="differenceSlow"><span class="annot"><span class="annottext">differenceSlow :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-var hs-var">differenceSlow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667583"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667583"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667584"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667584"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667583"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#andNot%23"><span class="hs-operator hs-var">`andNot#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667584"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span class="annot"><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-var">differenceSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667585"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667585"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667586"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667586"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667585"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="Agda.Utils.Word.html#andNot%23"><span class="hs-operator hs-var">`andNot#`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667586"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span class="annot"><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-var">differenceSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667587"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667587"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667588"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667588"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatAndNotWord#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667587"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667588"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span class="annot"><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-identifier hs-var">differenceSlow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667590"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667590"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667591"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667591"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#byteArrayToVarSet%23"><span class="hs-identifier hs-var">byteArrayToVarSet#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatAndNot</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667590"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667591"><span class="hs-identifier hs-var">bs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#differenceSlow"><span class="hs-pragma hs-type">differenceSlow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><span class="hs-comment">-- | Infix operator for 'difference'.</span></span><span>
</span><span id="line-456"></span><span class="annot"><a href="Agda.Utils.VarSet.html#%5C%5C"><span class="hs-operator hs-type">(\\)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-457"></span><span id="%5C%5C"><span class="annot"><span class="annottext">\\ :: VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#%5C%5C"><span class="hs-operator hs-var hs-var">(\\)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span>
</span><span id="line-458"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\\</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><span class="hs-comment">-- | Take a relative complement of a variable set.</span></span><span>
</span><span id="line-461"></span><span class="annot"><a href="Agda.Utils.VarSet.html#complement"><span class="hs-identifier hs-type">complement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-462"></span><span id="complement"><span class="annot"><span class="annottext">complement :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#complement"><span class="hs-identifier hs-var hs-var">complement</span></a></span></span><span> </span><span id="local-6989586621681667593"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667594"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667594"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667593"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667594"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-463"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#complement"><span class="hs-pragma hs-type">complement</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="annot"><span class="hs-comment">-- | @isSubsetOf vs1 vs2@ determines if @vs1@ is a subset of @vs2@.</span></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-identifier hs-type">isSubsetOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-467"></span><span id="isSubsetOf"><span class="annot"><span class="annottext">isSubsetOf :: VarSet -&gt; VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-identifier hs-var hs-var">isSubsetOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667595"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667595"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667596"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667596"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667595"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667596"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667595"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a></span><span> </span><span id="local-6989586621681667597"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667597"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621681667598"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667598"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-var">isSubsetOfSlow#</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667597"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667598"><span class="hs-identifier hs-var">vs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-pragma hs-type">isSubsetOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><span class="hs-comment">-- | Slow path for 'isSubsetOf'.</span></span><span>
</span><span id="line-472"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-type">isSubsetOfSlow#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-473"></span><span id="isSubsetOfSlow%23"><span class="annot"><span class="annottext">isSubsetOfSlow# :: VarSet -&gt; VarSet -&gt; Int#
</span><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-var hs-var">isSubsetOfSlow#</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667600"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667600"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667601"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667601"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667600"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667601"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667600"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-474"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-var">isSubsetOfSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667602"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667602"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667603"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667603"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667602"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word#
</span><span class="hs-identifier hs-var">indexWordArray#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667603"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667602"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-475"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-var">isSubsetOfSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667604"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667604"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667605"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667605"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-identifier hs-var">isSubsetOfSlow#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667606"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667606"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667607"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667607"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray# -&gt; Int#
</span><a href="Agda.Utils.ByteArray.html#byteArrayIsSubsetOf%23"><span class="hs-identifier hs-var">byteArrayIsSubsetOf#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667606"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667607"><span class="hs-identifier hs-var">bs2</span></a></span><span>
</span><span id="line-477"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#isSubsetOfSlow%23"><span class="hs-pragma hs-type">isSubsetOfSlow#</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | @inRange lo hi vs@ determines if all the variables in @vs@</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- are within the range @[lo+1 .. hi-1]@.</span><span>
</span><span id="line-481"></span><span class="annot"><a href="Agda.Utils.VarSet.html#inRange"><span class="hs-identifier hs-type">inRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-482"></span><span id="inRange"><span class="annot"><span class="annottext">inRange :: Int -&gt; Int -&gt; VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#inRange"><span class="hs-identifier hs-var hs-var">inRange</span></a></span></span><span> </span><span id="local-6989586621681667609"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667609"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621681667610"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667610"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span id="local-6989586621681667611"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667611"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-comment">-- This might seem inefficient, but is optimal</span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-comment">-- when @range lo hi@ and @vs@ both fit within a single word.</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667611"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#isSubsetOf"><span class="hs-operator hs-var">`isSubsetOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667609"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667610"><span class="hs-identifier hs-var">hi</span></a></span><span>
</span><span id="line-486"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#inRange"><span class="hs-pragma hs-type">inRange</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- Filters</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- | Split a variable set into elements that are strictly smaller than</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- @n@ and elements that are strictly larger.</span><span>
</span><span id="line-493"></span><span class="hs-comment">--</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- Note that this is strict in both components of the pair. If you only</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- need one half, use 'filterLT' or 'filterGT'.</span><span>
</span><span id="line-496"></span><span class="annot"><a href="Agda.Utils.VarSet.html#split"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span id="split"><span class="annot"><span class="annottext">split :: Int -&gt; VarSet -&gt; (VarSet, VarSet)
</span><a href="Agda.Utils.VarSet.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621681667612"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667612"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667613"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667613"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681667614"><span class="annot"><span class="annottext">lo :: VarSet
</span><a href="#local-6989586621681667614"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667613"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667612"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621681667615"><span class="annot"><span class="annottext">hi :: VarSet
</span><a href="#local-6989586621681667615"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667613"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667612"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667614"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667615"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#split"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="annot"><span class="hs-comment">-- | Filter a variable set to elements that are less than to an index.</span></span><span>
</span><span id="line-504"></span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLT"><span class="hs-identifier hs-type">filterLT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-505"></span><span id="filterLT"><span class="annot"><span class="annottext">filterLT :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#filterLT"><span class="hs-identifier hs-var hs-var">filterLT</span></a></span></span><span> </span><span id="local-6989586621681667616"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667616"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667617"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667617"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667617"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667616"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLT"><span class="hs-pragma hs-type">filterLT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><span class="hs-comment">-- | Filter a variable set to elements that are less than or equal to an index.</span></span><span>
</span><span id="line-509"></span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLE"><span class="hs-identifier hs-type">filterLE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-510"></span><span id="filterLE"><span class="annot"><span class="annottext">filterLE :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#filterLE"><span class="hs-identifier hs-var hs-var">filterLE</span></a></span></span><span> </span><span id="local-6989586621681667618"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667618"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667619"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667619"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667619"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667618"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterLE"><span class="hs-pragma hs-type">filterLE</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><span class="hs-comment">-- | Filter a variable set to elements that are greater than to an index.</span></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGT"><span class="hs-identifier hs-type">filterGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-515"></span><span id="filterGT"><span class="annot"><span class="annottext">filterGT :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#filterGT"><span class="hs-identifier hs-var hs-var">filterGT</span></a></span></span><span> </span><span id="local-6989586621681667620"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667620"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667621"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667621"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667621"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGT"><span class="hs-pragma hs-type">filterGT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><span class="hs-comment">-- | Filter a variable set to elements that are greater than or equal to an index.</span></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGE"><span class="hs-identifier hs-type">filterGE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-520"></span><span id="filterGE"><span class="annot"><span class="annottext">filterGE :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#filterGE"><span class="hs-identifier hs-var hs-var">filterGE</span></a></span></span><span> </span><span id="local-6989586621681667622"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667622"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681667623"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667623"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667623"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#full"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667622"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#filterGE"><span class="hs-pragma hs-type">filterGE</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- Folds</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">-- $varSetFolds</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- Like most unordered containers, @foldr@ and @foldl@ are somewhat ambigious</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- names for folds over a 'VarSet'. For the sake of consistency, we adopt the</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- same convention as 'Data.IntSet.IntSet', where</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- VarSet.foldr f x = foldr f x . VarSet.toAscList</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- VarSet.foldl f x = foldl f x . VarSet.toAscList</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-534"></span><span class="hs-comment">--</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- Unfortunately, this convention the opposite of how our sets are laid out</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- in memory.</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><span class="hs-comment">-- | Lazily fold over the elements of a variable set in ascending order.</span></span><span>
</span><span id="line-539"></span><span id="local-6989586621681667212"><span class="annot"><a href="Agda.Utils.VarSet.html#foldr"><span class="hs-identifier hs-type">foldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667212"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667212"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667212"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-540"></span><span id="foldr"><span class="annot"><span class="annottext">foldr :: forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldr"><span class="hs-identifier hs-var hs-var">foldr</span></a></span></span><span> </span><span id="local-6989586621681667624"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667624"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667625"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667625"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667626"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667626"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
</span><a href="Agda.Utils.Word.html#wordFoldrBits%23"><span class="hs-identifier hs-var">wordFoldrBits#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667624"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667625"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667626"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-541"></span><span class="annot"><a href="Agda.Utils.VarSet.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span id="local-6989586621681667628"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667628"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667629"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667629"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667630"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667630"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
</span><a href="Agda.Utils.ByteArray.html#byteArrayFoldrBits%23"><span class="hs-identifier hs-var">byteArrayFoldrBits#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667628"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667629"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667630"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">-- | Lazily fold over the elements of a variable set in descending order.</span><span>
</span><span id="line-544"></span><span class="hs-comment">--</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- This does not have the same deficiencies 'Data.List.foldl', as we can</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- start the fold at the back of the 'VarSet'.</span><span>
</span><span id="line-547"></span><span id="local-6989586621681667216"><span class="annot"><a href="Agda.Utils.VarSet.html#foldl"><span class="hs-identifier hs-type">foldl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681667216"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667216"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667216"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667216"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-548"></span><span id="foldl"><span class="annot"><span class="annottext">foldl :: forall a. (a -&gt; Int -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldl"><span class="hs-identifier hs-var hs-var">foldl</span></a></span></span><span> </span><span id="local-6989586621681667632"><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621681667632"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667633"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667633"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667634"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667634"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Int -&gt; a) -&gt; a -&gt; Word# -&gt; a
forall a. (a -&gt; Int -&gt; a) -&gt; a -&gt; Word# -&gt; a
</span><a href="Agda.Utils.Word.html#wordFoldlBits%23"><span class="hs-identifier hs-var">wordFoldlBits#</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621681667632"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667633"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667634"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Agda.Utils.VarSet.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span id="local-6989586621681667636"><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621681667636"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667637"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667637"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667638"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667638"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Int -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
forall a. (a -&gt; Int -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
</span><a href="Agda.Utils.ByteArray.html#byteArrayFoldlBits%23"><span class="hs-identifier hs-var">byteArrayFoldlBits#</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621681667636"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667637"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667638"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- | Strictly fold over the elements of a variable set in ascending order.</span><span>
</span><span id="line-552"></span><span class="hs-comment">--</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- This does not have the same deficiencies 'Data.List.foldr'', as we can</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- start the fold at the back of the 'VarSet'.</span><span>
</span><span id="line-555"></span><span id="local-6989586621681667640"><span class="annot"><a href="Agda.Utils.VarSet.html#foldr%27"><span class="hs-identifier hs-type">foldr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667640"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667640"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667640"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667640"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-556"></span><span id="foldr%27"><span class="annot"><span class="annottext">foldr' :: forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldr%27"><span class="hs-identifier hs-var hs-var">foldr'</span></a></span></span><span> </span><span id="local-6989586621681667641"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667641"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667642"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667642"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667643"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667643"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
</span><a href="Agda.Utils.Word.html#wordFoldrBitsStrict%23"><span class="hs-identifier hs-var">wordFoldrBitsStrict#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667641"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667642"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667643"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-557"></span><span class="annot"><a href="Agda.Utils.VarSet.html#foldr%27"><span class="hs-identifier hs-var">foldr'</span></a></span><span> </span><span id="local-6989586621681667645"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667645"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667646"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667646"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667647"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667647"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
</span><a href="Agda.Utils.ByteArray.html#byteArrayFoldrBitsStrict%23"><span class="hs-identifier hs-var">byteArrayFoldrBitsStrict#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667645"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667646"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667647"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="annot"><span class="hs-comment">-- | Strictly fold over the elements of a variable set in descending order.</span></span><span>
</span><span id="line-560"></span><span id="local-6989586621681667649"><span class="annot"><a href="Agda.Utils.VarSet.html#foldl%27"><span class="hs-identifier hs-type">foldl'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667649"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667649"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667649"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681667649"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-561"></span><span id="foldl%27"><span class="annot"><span class="annottext">foldl' :: forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldl%27"><span class="hs-identifier hs-var hs-var">foldl'</span></a></span></span><span> </span><span id="local-6989586621681667650"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667650"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667651"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667651"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667652"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667652"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; Word# -&gt; a
</span><a href="Agda.Utils.Word.html#wordFoldrBitsStrict%23"><span class="hs-identifier hs-var">wordFoldrBitsStrict#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667650"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667651"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667652"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-562"></span><span class="annot"><a href="Agda.Utils.VarSet.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span id="local-6989586621681667653"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667653"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681667654"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667654"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667655"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667655"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; ByteArray# -&gt; a
</span><a href="Agda.Utils.ByteArray.html#byteArrayFoldrBitsStrict%23"><span class="hs-identifier hs-var">byteArrayFoldrBitsStrict#</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621681667653"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681667654"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667655"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- Views</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-comment">-- | Retrieve the smallest index in the variable set along with the set sans that</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- element, or 'Nothing' if the set was empty.</span><span>
</span><span id="line-570"></span><span class="annot"><a href="Agda.Utils.VarSet.html#minView"><span class="hs-identifier hs-type">minView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span id="minView"><span class="annot"><span class="annottext">minView :: VarSet -&gt; Maybe (Int, VarSet)
</span><a href="Agda.Utils.VarSet.html#minView"><span class="hs-identifier hs-var hs-var">minView</span></a></span></span><span> </span><span id="local-6989586621681667656"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667656"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Maybe Int
</span><a href="Agda.Utils.VarSet.html#lookupMin"><span class="hs-identifier hs-var">lookupMin</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667656"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681667657"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667657"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681667658"><span class="annot"><span class="annottext">vs' :: VarSet
</span><a href="#local-6989586621681667658"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667657"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667656"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int, VarSet) -&gt; Maybe (Int, VarSet)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667657"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667658"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, VarSet)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-577"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#minView"><span class="hs-pragma hs-type">minView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-comment">-- | Retrieve the smallest index in the variable set along with the set sans that</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- element, or 'Nothing' if the set was empty.</span><span>
</span><span id="line-581"></span><span class="annot"><a href="Agda.Utils.VarSet.html#maxView"><span class="hs-identifier hs-type">maxView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span id="maxView"><span class="annot"><span class="annottext">maxView :: VarSet -&gt; Maybe (Int, VarSet)
</span><a href="Agda.Utils.VarSet.html#maxView"><span class="hs-identifier hs-var hs-var">maxView</span></a></span></span><span> </span><span id="local-6989586621681667659"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667659"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Maybe Int
</span><a href="Agda.Utils.VarSet.html#lookupMax"><span class="hs-identifier hs-var">lookupMax</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667659"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-584"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681667660"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667660"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681667661"><span class="annot"><span class="annottext">vs' :: VarSet
</span><a href="#local-6989586621681667661"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667660"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667659"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int, VarSet) -&gt; Maybe (Int, VarSet)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681667660"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667661"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, VarSet)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-588"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#maxView"><span class="hs-pragma hs-type">maxView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- Contextual operations</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-comment">-- | Remove the first @n@ entries from the variable set,</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- and shift the indices of all other entries down by @n@.</span><span>
</span><span id="line-595"></span><span class="annot"><a href="Agda.Utils.VarSet.html#strengthen"><span class="hs-identifier hs-type">strengthen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-596"></span><span id="strengthen"><span class="annot"><span class="annottext">strengthen :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#strengthen"><span class="hs-identifier hs-var hs-var">strengthen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667662"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667662"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667663"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667663"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-comment">-- A strengthening by 64+ will literally never happen, so we are better</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-comment">-- off avoiding the branch then we are saving an allocation by</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-comment">-- re-using 'empty' when the shift result would be 0.</span><span>
</span><span id="line-600"></span><span>  </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667663"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><span class="hs-operator hs-var">`shiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667662"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span class="annot"><a href="Agda.Utils.VarSet.html#strengthen"><span class="hs-identifier hs-var">strengthen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667665"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667665"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667666"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667666"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#byteArrayToVarSet%23"><span class="hs-identifier hs-var">byteArrayToVarSet#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatShiftR#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667666"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667665"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="annot"><span class="hs-comment">-- | Shift all indices in the variable set up by @n@.</span></span><span>
</span><span id="line-605"></span><span class="annot"><a href="Agda.Utils.VarSet.html#weaken"><span class="hs-identifier hs-type">weaken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-606"></span><span id="weaken"><span class="annot"><span class="annottext">weaken :: Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#weaken"><span class="hs-identifier hs-var hs-var">weaken</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667668"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667668"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span id="local-6989586621681667669"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667669"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><span class="hs-identifier hs-var">clz#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667669"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`geWord#`</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-608"></span><span>    </span><span class="annot"><span class="annottext">Word# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-var">VS#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667669"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><span class="hs-operator hs-var">`uncheckedShiftL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatShiftL#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatFromWord#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621681667669"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span class="annot"><a href="Agda.Utils.VarSet.html#weaken"><span class="hs-identifier hs-var">weaken</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681667671"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667671"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667672"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667672"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><span class="annottext">ByteArray# -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-var">VB#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word# -&gt; ByteArray#
</span><span class="hs-identifier hs-var">bigNatShiftL#</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667672"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681667671"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- Conversions</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><span class="hs-comment">-- | Convert a variable set to a descending list of indices.</span></span><span>
</span><span id="line-618"></span><span class="annot"><a href="Agda.Utils.VarSet.html#toDescList"><span class="hs-identifier hs-type">toDescList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span id="toDescList"><span class="annot"><span class="annottext">toDescList :: VarSet -&gt; [Int]
</span><a href="Agda.Utils.VarSet.html#toDescList"><span class="hs-identifier hs-var hs-var">toDescList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int -&gt; [Int]) -&gt; [Int] -&gt; VarSet -&gt; [Int]
forall a. (a -&gt; Int -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; [Int] -&gt; [Int]) -&gt; [Int] -&gt; Int -&gt; [Int]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#toDescList"><span class="hs-pragma hs-type">toDescList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="annot"><span class="hs-comment">-- | Convert a variable set to an ascending list of indices.</span></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Agda.Utils.VarSet.html#toAscList"><span class="hs-identifier hs-type">toAscList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span id="toAscList"><span class="annot"><span class="annottext">toAscList :: VarSet -&gt; [Int]
</span><a href="Agda.Utils.VarSet.html#toAscList"><span class="hs-identifier hs-var hs-var">toAscList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [Int] -&gt; [Int]) -&gt; [Int] -&gt; VarSet -&gt; [Int]
forall a. (Int -&gt; a -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="Agda.Utils.VarSet.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-625"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#toAscList"><span class="hs-pragma hs-type">toAscList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- Debugging</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="annot"><span class="hs-comment">-- | Trace the size of a variable set to the eventlog.</span></span><span>
</span><span id="line-631"></span><span class="annot"><a href="Agda.Utils.VarSet.html#traceVarSetSize"><span class="hs-identifier hs-type">traceVarSetSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-632"></span><span id="traceVarSetSize"><span class="annot"><span class="annottext">traceVarSetSize :: VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#traceVarSetSize"><span class="hs-identifier hs-var hs-var">traceVarSetSize</span></a></span></span><span> </span><span id="local-6989586621681667673"><span class="annot"><span class="annottext">vs :: VarSet
</span><a href="#local-6989586621681667673"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VS%23"><span class="hs-identifier hs-type">VS#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; VarSet -&gt; VarSet
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">traceEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VarSet.size=1&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667673"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-633"></span><span class="annot"><a href="Agda.Utils.VarSet.html#traceVarSetSize"><span class="hs-identifier hs-var">traceVarSetSize</span></a></span><span> </span><span id="local-6989586621681667675"><span class="annot"><span class="annottext">vs :: VarSet
</span><a href="#local-6989586621681667675"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VB%23"><span class="hs-identifier hs-type">VB#</span></a></span><span> </span><span id="local-6989586621681667676"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667676"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; VarSet -&gt; VarSet
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">traceEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VarSet.size=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word
</span><span class="hs-identifier hs-var">bigNatSize</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621681667676"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681667675"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-634"></span></pre></body></html>