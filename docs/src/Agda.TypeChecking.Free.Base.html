<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html"><span class="hs-identifier">Agda.TypeChecking.Free.Base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Reader</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReader</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HashSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashSet</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier">List1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Semigroup.html"><span class="hs-identifier">Agda.Utils.Semigroup</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html"><span class="hs-identifier">Agda.Utils.Size</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-28"></span><span class="annot"><span class="hs-comment">-- * Set of meta variables.</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><span class="hs-comment">-- | A set of meta variables.  Forms a monoid under union.</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">newtype</span><span> </span><span id="MetaSet"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-var">MetaSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MetaSet"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-var">MetaSet</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="theMetaSet"><span class="annot"><span class="annottext">MetaSet -&gt; HashSet MetaId
</span><a href="Agda.TypeChecking.Free.Base.html#theMetaSet"><span class="hs-identifier hs-var hs-var">theMetaSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787115"><span id="local-6989586621681787121"><span class="annot"><span class="annottext">MetaSet -&gt; MetaSet -&gt; Bool
(MetaSet -&gt; MetaSet -&gt; Bool)
-&gt; (MetaSet -&gt; MetaSet -&gt; Bool) -&gt; Eq MetaSet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MetaSet -&gt; MetaSet -&gt; Bool
== :: MetaSet -&gt; MetaSet -&gt; Bool
$c/= :: MetaSet -&gt; MetaSet -&gt; Bool
/= :: MetaSet -&gt; MetaSet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787130"><span id="local-6989586621681787137"><span id="local-6989586621681787141"><span class="annot"><span class="annottext">Int -&gt; MetaSet -&gt; ShowS
[MetaSet] -&gt; ShowS
MetaSet -&gt; String
(Int -&gt; MetaSet -&gt; ShowS)
-&gt; (MetaSet -&gt; String) -&gt; ([MetaSet] -&gt; ShowS) -&gt; Show MetaSet
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MetaSet -&gt; ShowS
showsPrec :: Int -&gt; MetaSet -&gt; ShowS
$cshow :: MetaSet -&gt; String
show :: MetaSet -&gt; String
$cshowList :: [MetaSet] -&gt; ShowS
showList :: [MetaSet] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787147"><span id="local-6989586621681787152"><span class="annot"><span class="annottext">MetaSet
MetaSet -&gt; Bool
MetaSet -&gt; (MetaSet -&gt; Bool) -&gt; Null MetaSet
forall a. a -&gt; (a -&gt; Bool) -&gt; Null a
$cempty :: MetaSet
empty :: MetaSet
$cnull :: MetaSet -&gt; Bool
null :: MetaSet -&gt; Bool
</span><a href="Agda.Utils.Null.html#Null"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Null</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787160"><span id="local-6989586621681787165"><span id="local-6989586621681787169"><span class="annot"><span class="annottext">NonEmpty MetaSet -&gt; MetaSet
MetaSet -&gt; MetaSet -&gt; MetaSet
(MetaSet -&gt; MetaSet -&gt; MetaSet)
-&gt; (NonEmpty MetaSet -&gt; MetaSet)
-&gt; (forall b. Integral b =&gt; b -&gt; MetaSet -&gt; MetaSet)
-&gt; Semigroup MetaSet
forall b. Integral b =&gt; b -&gt; MetaSet -&gt; MetaSet
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: MetaSet -&gt; MetaSet -&gt; MetaSet
&lt;&gt; :: MetaSet -&gt; MetaSet -&gt; MetaSet
$csconcat :: NonEmpty MetaSet -&gt; MetaSet
sconcat :: NonEmpty MetaSet -&gt; MetaSet
$cstimes :: forall b. Integral b =&gt; b -&gt; MetaSet -&gt; MetaSet
stimes :: forall b. Integral b =&gt; b -&gt; MetaSet -&gt; MetaSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787180"><span id="local-6989586621681787185"><span id="local-6989586621681787189"><span class="annot"><span class="annottext">Semigroup MetaSet
MetaSet
Semigroup MetaSet =&gt;
MetaSet
-&gt; (MetaSet -&gt; MetaSet -&gt; MetaSet)
-&gt; ([MetaSet] -&gt; MetaSet)
-&gt; Monoid MetaSet
[MetaSet] -&gt; MetaSet
MetaSet -&gt; MetaSet -&gt; MetaSet
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
$cmempty :: MetaSet
mempty :: MetaSet
$cmappend :: MetaSet -&gt; MetaSet -&gt; MetaSet
mappend :: MetaSet -&gt; MetaSet -&gt; MetaSet
$cmconcat :: [MetaSet] -&gt; MetaSet
mconcat :: [MetaSet] -&gt; MetaSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>  </span><span id="local-6989586621681787199"><span class="annot"><span class="annottext">singleton :: MetaId -&gt; MetaSet
</span><a href="#local-6989586621681787199"><span class="hs-identifier hs-var hs-var hs-var">singleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet MetaId -&gt; MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-var">MetaSet</span></a></span><span> </span><span class="annot"><span class="annottext">(HashSet MetaId -&gt; MetaSet)
-&gt; (MetaId -&gt; HashSet MetaId) -&gt; MetaId -&gt; MetaSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; HashSet MetaId
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#insertMetaSet"><span class="hs-identifier hs-type">insertMetaSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-39"></span><span id="insertMetaSet"><span class="annot"><span class="annottext">insertMetaSet :: MetaId -&gt; MetaSet -&gt; MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#insertMetaSet"><span class="hs-identifier hs-var hs-var">insertMetaSet</span></a></span></span><span> </span><span id="local-6989586621681787203"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681787203"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span id="local-6989586621681787204"><span class="annot"><span class="annottext">HashSet MetaId
</span><a href="#local-6989586621681787204"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet MetaId -&gt; MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-var">MetaSet</span></a></span><span> </span><span class="annot"><span class="annottext">(HashSet MetaId -&gt; MetaSet) -&gt; HashSet MetaId -&gt; MetaSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; HashSet MetaId -&gt; HashSet MetaId
forall a. Hashable a =&gt; a -&gt; HashSet a -&gt; HashSet a
</span><span class="hs-identifier hs-var">HashSet.insert</span></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681787203"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet MetaId
</span><a href="#local-6989586621681787204"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621681786851"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#foldrMetaSet"><span class="hs-identifier hs-type">foldrMetaSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786851"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786851"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786851"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786851"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-42"></span><span id="foldrMetaSet"><span class="annot"><span class="annottext">foldrMetaSet :: forall a. (MetaId -&gt; a -&gt; a) -&gt; a -&gt; MetaSet -&gt; a
</span><a href="Agda.TypeChecking.Free.Base.html#foldrMetaSet"><span class="hs-identifier hs-var hs-var">foldrMetaSet</span></a></span></span><span> </span><span id="local-6989586621681787207"><span class="annot"><span class="annottext">MetaId -&gt; a -&gt; a
</span><a href="#local-6989586621681787207"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681787208"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787208"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681787209"><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787209"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; a -&gt; a) -&gt; a -&gt; HashSet MetaId -&gt; a
forall b a. (b -&gt; a -&gt; a) -&gt; a -&gt; HashSet b -&gt; a
</span><span class="hs-identifier hs-var">HashSet.foldr</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; a -&gt; a
</span><a href="#local-6989586621681787207"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(HashSet MetaId -&gt; a) -&gt; HashSet MetaId -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaSet -&gt; HashSet MetaId
</span><a href="Agda.TypeChecking.Free.Base.html#theMetaSet"><span class="hs-identifier hs-var">theMetaSet</span></a></span><span> </span><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787209"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#metaSetToBlocker"><span class="hs-identifier hs-type">metaSetToBlocker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span>
</span><span id="line-45"></span><span id="metaSetToBlocker"><span class="annot"><span class="annottext">metaSetToBlocker :: MetaSet -&gt; Blocker
</span><a href="Agda.TypeChecking.Free.Base.html#metaSetToBlocker"><span class="hs-identifier hs-var hs-var">metaSetToBlocker</span></a></span></span><span> </span><span id="local-6989586621681787212"><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787212"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Blocker -&gt; Blocker
</span><a href="Agda.Syntax.Internal.Blockers.html#unblockOnAny"><span class="hs-identifier hs-var">unblockOnAny</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Blocker -&gt; Blocker) -&gt; Set Blocker -&gt; Blocker
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; Set Blocker -&gt; Set Blocker)
-&gt; Set Blocker -&gt; MetaSet -&gt; Set Blocker
forall a. (MetaId -&gt; a -&gt; a) -&gt; a -&gt; MetaSet -&gt; a
</span><a href="Agda.TypeChecking.Free.Base.html#foldrMetaSet"><span class="hs-identifier hs-var">foldrMetaSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Blocker -&gt; Set Blocker -&gt; Set Blocker
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">(Blocker -&gt; Set Blocker -&gt; Set Blocker)
-&gt; (MetaId -&gt; Blocker) -&gt; MetaId -&gt; Set Blocker -&gt; Set Blocker
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Blocker
</span><a href="Agda.Syntax.Internal.Blockers.html#unblockOnMeta"><span class="hs-identifier hs-var">unblockOnMeta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Blocker
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787212"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787219"><span id="local-6989586621681787223"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621681787232"><span class="annot"><span class="annottext">pretty :: MetaSet -&gt; Doc
</span><a href="#local-6989586621681787232"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Set MetaId -&gt; Doc) -&gt; (MetaSet -&gt; Set MetaId) -&gt; MetaSet -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; Set MetaId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([MetaId] -&gt; Set MetaId)
-&gt; (MetaSet -&gt; [MetaId]) -&gt; MetaSet -&gt; Set MetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashSet MetaId -&gt; [MetaId]
forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">HashSet.toList</span></span><span> </span><span class="annot"><span class="annottext">(HashSet MetaId -&gt; [MetaId])
-&gt; (MetaSet -&gt; HashSet MetaId) -&gt; MetaSet -&gt; [MetaId]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MetaSet -&gt; HashSet MetaId
</span><a href="Agda.TypeChecking.Free.Base.html#theMetaSet"><span class="hs-identifier hs-var">theMetaSet</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-51"></span><span class="annot"><span class="hs-comment">-- * Flexible and rigid occurrences (semigroup)</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Depending on the surrounding context of a variable,</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   it's occurrence can be classified as flexible or rigid,</span><span>
</span><span id="line-55"></span><span class="hs-comment">--   with finer distinctions.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">--   The constructors are listed in increasing order (wrt. information content).</span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="FlexRig%27"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-var">FlexRig'</span></a></span></span><span> </span><span id="local-6989586621681786928"><span class="annot"><a href="#local-6989586621681786928"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Flexible"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621681786928"><span class="hs-identifier hs-type">a</span></a></span><span>       </span><span class="hs-comment">-- ^ In arguments of metas.</span><span>
</span><span id="line-60"></span><span>                      </span><span class="hs-comment">--   The set of metas is used by ''Agda.TypeChecking.Rewriting.NonLinMatch''</span><span>
</span><span id="line-61"></span><span>                      </span><span class="hs-comment">--   to generate the right blocking information.</span><span>
</span><span id="line-62"></span><span>                      </span><span class="hs-comment">--   The semantics is that the status of a variable occurrence may change</span><span>
</span><span id="line-63"></span><span>                      </span><span class="hs-comment">--   if one of the metas in the set gets solved.  We may say the occurrence</span><span>
</span><span id="line-64"></span><span>                      </span><span class="hs-comment">--   is tainted by the meta variables in the set.</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WeaklyRigid"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ In arguments to variables and definitions.</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Unguarded"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ In top position, or only under inductive record constructors (unit).</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StronglyRigid"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Under at least one and only inductive constructors.</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787242"><span id="local-6989586621681787248"><span class="annot"><span class="annottext">FlexRig' a -&gt; FlexRig' a -&gt; Bool
(FlexRig' a -&gt; FlexRig' a -&gt; Bool)
-&gt; (FlexRig' a -&gt; FlexRig' a -&gt; Bool) -&gt; Eq (FlexRig' a)
forall a. Eq a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; Bool
== :: FlexRig' a -&gt; FlexRig' a -&gt; Bool
$c/= :: forall a. Eq a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; Bool
/= :: FlexRig' a -&gt; FlexRig' a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787253"><span id="local-6989586621681787257"><span id="local-6989586621681787261"><span class="annot"><span class="annottext">Int -&gt; FlexRig' a -&gt; ShowS
[FlexRig' a] -&gt; ShowS
FlexRig' a -&gt; String
(Int -&gt; FlexRig' a -&gt; ShowS)
-&gt; (FlexRig' a -&gt; String)
-&gt; ([FlexRig' a] -&gt; ShowS)
-&gt; Show (FlexRig' a)
forall a. Show a =&gt; Int -&gt; FlexRig' a -&gt; ShowS
forall a. Show a =&gt; [FlexRig' a] -&gt; ShowS
forall a. Show a =&gt; FlexRig' a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FlexRig' a -&gt; ShowS
showsPrec :: Int -&gt; FlexRig' a -&gt; ShowS
$cshow :: forall a. Show a =&gt; FlexRig' a -&gt; String
show :: FlexRig' a -&gt; String
$cshowList :: forall a. Show a =&gt; [FlexRig' a] -&gt; ShowS
showList :: [FlexRig' a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787264"><span id="local-6989586621681787266"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; FlexRig' a -&gt; FlexRig' b)
-&gt; (forall a b. a -&gt; FlexRig' b -&gt; FlexRig' a) -&gt; Functor FlexRig'
forall a b. a -&gt; FlexRig' b -&gt; FlexRig' a
forall a b. (a -&gt; b) -&gt; FlexRig' a -&gt; FlexRig' b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; FlexRig' a -&gt; FlexRig' b
fmap :: forall a b. (a -&gt; b) -&gt; FlexRig' a -&gt; FlexRig' b
$c&lt;$ :: forall a b. a -&gt; FlexRig' b -&gt; FlexRig' a
&lt;$ :: forall a b. a -&gt; FlexRig' b -&gt; FlexRig' a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787271"><span id="local-6989586621681787277"><span id="local-6989586621681787283"><span id="local-6989586621681787288"><span id="local-6989586621681787290"><span id="local-6989586621681787293"><span id="local-6989586621681787296"><span id="local-6989586621681787299"><span id="local-6989586621681787302"><span id="local-6989586621681787305"><span id="local-6989586621681787308"><span id="local-6989586621681787310"><span id="local-6989586621681787313"><span id="local-6989586621681787318"><span id="local-6989586621681787323"><span id="local-6989586621681787328"><span id="local-6989586621681787333"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; FlexRig' m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a)
-&gt; (forall a. FlexRig' a -&gt; [a])
-&gt; (forall a. FlexRig' a -&gt; Bool)
-&gt; (forall a. FlexRig' a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; FlexRig' a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; FlexRig' a -&gt; a)
-&gt; (forall a. Ord a =&gt; FlexRig' a -&gt; a)
-&gt; (forall a. Num a =&gt; FlexRig' a -&gt; a)
-&gt; (forall a. Num a =&gt; FlexRig' a -&gt; a)
-&gt; Foldable FlexRig'
forall a. Eq a =&gt; a -&gt; FlexRig' a -&gt; Bool
forall a. Num a =&gt; FlexRig' a -&gt; a
forall a. Ord a =&gt; FlexRig' a -&gt; a
forall m. Monoid m =&gt; FlexRig' m -&gt; m
forall a. FlexRig' a -&gt; Bool
forall a. FlexRig' a -&gt; Int
forall a. FlexRig' a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; FlexRig' m -&gt; m
fold :: forall m. Monoid m =&gt; FlexRig' m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FlexRig' a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; FlexRig' a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; FlexRig' a -&gt; a
$ctoList :: forall a. FlexRig' a -&gt; [a]
toList :: forall a. FlexRig' a -&gt; [a]
$cnull :: forall a. FlexRig' a -&gt; Bool
null :: forall a. FlexRig' a -&gt; Bool
$clength :: forall a. FlexRig' a -&gt; Int
length :: forall a. FlexRig' a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; FlexRig' a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; FlexRig' a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; FlexRig' a -&gt; a
maximum :: forall a. Ord a =&gt; FlexRig' a -&gt; a
$cminimum :: forall a. Ord a =&gt; FlexRig' a -&gt; a
minimum :: forall a. Ord a =&gt; FlexRig' a -&gt; a
$csum :: forall a. Num a =&gt; FlexRig' a -&gt; a
sum :: forall a. Num a =&gt; FlexRig' a -&gt; a
$cproduct :: forall a. Num a =&gt; FlexRig' a -&gt; a
product :: forall a. Num a =&gt; FlexRig' a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="FlexRig"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier hs-var">FlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">class</span><span> </span><span id="LensFlexRig"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-var">LensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681786902"><span class="annot"><a href="#local-6989586621681786902"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span id="local-6989586621681786903"><span class="annot"><a href="#local-6989586621681786903"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621681786902"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786903"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="lensFlexRig"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-type">lensFlexRig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786902"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786903"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786904"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786904"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681786904"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621681787346"><span class="annot"><span class="annottext">lensFlexRig :: Lens' (FlexRig' a) (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FlexRig' a -&gt; f (FlexRig' a)) -&gt; FlexRig' a -&gt; f (FlexRig' a)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span id="local-6989586621681786907"><span id="local-6989586621681786908"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isFlexible"><span class="hs-identifier hs-type">isFlexible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786907"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786908"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786907"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-79"></span><span id="isFlexible"><span class="annot"><span class="annottext">isFlexible :: forall o a. LensFlexRig o a =&gt; o -&gt; Bool
</span><a href="Agda.TypeChecking.Free.Base.html#isFlexible"><span class="hs-identifier hs-var hs-var">isFlexible</span></a></span></span><span> </span><span id="local-6989586621681787350"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787350"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Lens' o (FlexRig' a) -&gt; FlexRig' a
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' a -&gt; f (FlexRig' a)) -&gt; o -&gt; f o
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' o (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621681787355"><span id="local-6989586621681787356"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isUnguarded"><span class="hs-identifier hs-type">isUnguarded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787355"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787355"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-84"></span><span id="isUnguarded"><span class="annot"><span class="annottext">isUnguarded :: forall o a. LensFlexRig o a =&gt; o -&gt; Bool
</span><a href="Agda.TypeChecking.Free.Base.html#isUnguarded"><span class="hs-identifier hs-var hs-var">isUnguarded</span></a></span></span><span> </span><span id="local-6989586621681787359"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787359"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787359"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Lens' o (FlexRig' a) -&gt; FlexRig' a
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' a -&gt; f (FlexRig' a)) -&gt; o -&gt; f o
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' o (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621681787363"><span id="local-6989586621681787364"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isWeaklyRigid"><span class="hs-identifier hs-type">isWeaklyRigid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787363"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787364"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787363"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-89"></span><span id="isWeaklyRigid"><span class="annot"><span class="annottext">isWeaklyRigid :: forall o a. LensFlexRig o a =&gt; o -&gt; Bool
</span><a href="Agda.TypeChecking.Free.Base.html#isWeaklyRigid"><span class="hs-identifier hs-var hs-var">isWeaklyRigid</span></a></span></span><span> </span><span id="local-6989586621681787367"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787367"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787367"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Lens' o (FlexRig' a) -&gt; FlexRig' a
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' a -&gt; f (FlexRig' a)) -&gt; o -&gt; f o
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' o (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>   </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-91"></span><span>   </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621681787371"><span id="local-6989586621681787372"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isStronglyRigid"><span class="hs-identifier hs-type">isStronglyRigid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787371"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787371"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-94"></span><span id="isStronglyRigid"><span class="annot"><span class="annottext">isStronglyRigid :: forall o a. LensFlexRig o a =&gt; o -&gt; Bool
</span><a href="Agda.TypeChecking.Free.Base.html#isStronglyRigid"><span class="hs-identifier hs-var hs-var">isStronglyRigid</span></a></span></span><span> </span><span id="local-6989586621681787375"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787375"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621681787375"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Lens' o (FlexRig' a) -&gt; FlexRig' a
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' a -&gt; f (FlexRig' a)) -&gt; o -&gt; f o
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' o (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | 'FlexRig' aggregation (additive operation of the semiring).</span><span>
</span><span id="line-99"></span><span class="hs-comment">--   For combining occurrences of the same variable in subterms.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--   This is a refinement of the 'max' operation for 'FlexRig'</span><span>
</span><span id="line-101"></span><span class="hs-comment">--   which would work if 'Flexible' did not have the 'MetaSet' as an argument.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--   Now, to aggregate two 'Flexible' occurrences, we union the involved 'MetaSet's.</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621681786923"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-type">addFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681786923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786923"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-105"></span><span id="addFlexRig"><span class="annot"><span class="annottext">addFlexRig :: forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-var hs-var">addFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
-&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
forall a b c. ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c
</span><span class="hs-identifier hs-var">curry</span></span><span> </span><span class="annot"><span class="annottext">(((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
 -&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a)
-&gt; ((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
-&gt; FlexRig' a
-&gt; FlexRig' a
-&gt; FlexRig' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- StronglyRigid is dominant</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- Next is Unguarded</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">-- Then WeaklyRigid</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- Least is Flexible.  We union the meta sets, as the variable</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- is tainted by all of the involved meta variable.</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787384"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787384"><span class="hs-identifier hs-var">ms1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787385"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787385"><span class="hs-identifier hs-var">ms2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; FlexRig' a) -&gt; a -&gt; FlexRig' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787384"><span class="hs-identifier hs-var">ms1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787385"><span class="hs-identifier hs-var">ms2</span></a></span><span>
</span><span id="line-118"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-pragma hs-type">addFlexRig</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-119"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-pragma hs-type">addFlexRig</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Unit for 'addFlexRig'.</span></span><span>
</span><span id="line-122"></span><span id="local-6989586621681786929"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#zeroFlexRig"><span class="hs-identifier hs-type">zeroFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681786929"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786929"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-123"></span><span id="zeroFlexRig"><span class="annot"><span class="annottext">zeroFlexRig :: forall a. Monoid a =&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#zeroFlexRig"><span class="hs-identifier hs-var hs-var">zeroFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | Absorptive for 'addFlexRig'.</span></span><span>
</span><span id="line-126"></span><span id="local-6989586621681787389"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#omegaFlexRig"><span class="hs-identifier hs-type">omegaFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787389"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-127"></span><span id="omegaFlexRig"><span class="annot"><span class="annottext">omegaFlexRig :: forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#omegaFlexRig"><span class="hs-identifier hs-var hs-var">omegaFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | 'FlexRig' composition (multiplicative operation of the semiring).</span><span>
</span><span id="line-130"></span><span class="hs-comment">--   For accumulating the context of a variable.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">--   'Flexible' is dominant.  Once we are under a meta, we are flexible</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   regardless what else comes.  We taint all variable occurrences</span><span>
</span><span id="line-134"></span><span class="hs-comment">--   under a meta by this meta.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">--   'WeaklyRigid' is next in strength.  Destroys strong rigidity.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">--   'StronglyRigid' is still dominant over 'Unguarded'.</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">--   'Unguarded' is the unit.  It is the top (identity) context.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span id="local-6989586621681787391"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-identifier hs-type">composeFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681787391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787391"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-143"></span><span id="composeFlexRig"><span class="annot"><span class="annottext">composeFlexRig :: forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-identifier hs-var hs-var">composeFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
-&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
forall a b c. ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c
</span><span class="hs-identifier hs-var">curry</span></span><span> </span><span class="annot"><span class="annottext">(((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
 -&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a)
-&gt; ((FlexRig' a, FlexRig' a) -&gt; FlexRig' a)
-&gt; FlexRig' a
-&gt; FlexRig' a
-&gt; FlexRig' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787395"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787395"><span class="hs-identifier hs-var">ms1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787396"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787396"><span class="hs-identifier hs-var">ms2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; FlexRig' a) -&gt; a -&gt; FlexRig' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787395"><span class="hs-identifier hs-var">ms1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787396"><span class="hs-identifier hs-var">ms2</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787397"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787397"><span class="hs-identifier hs-var">ms1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787397"><span class="hs-identifier hs-var">ms1</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787398"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787398"><span class="hs-identifier hs-var">ms2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787398"><span class="hs-identifier hs-var">ms2</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>
</span><span id="line-152"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-pragma hs-type">composeFlexRig</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-pragma hs-type">MetaSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-153"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-pragma hs-type">composeFlexRig</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-pragma hs-type">FlexRig'</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Unit for 'composeFlexRig'.</span></span><span>
</span><span id="line-156"></span><span id="local-6989586621681787399"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#oneFlexRig"><span class="hs-identifier hs-type">oneFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787399"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-157"></span><span id="oneFlexRig"><span class="annot"><span class="annottext">oneFlexRig :: forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#oneFlexRig"><span class="hs-identifier hs-var hs-var">oneFlexRig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><span class="hs-comment">-- | Extract a blocker from an occurrence</span></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#flexRigToBlocker"><span class="hs-identifier hs-type">flexRigToBlocker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier hs-type">FlexRig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span>
</span><span id="line-161"></span><span id="flexRigToBlocker"><span class="annot"><span class="annottext">flexRigToBlocker :: FlexRig -&gt; Blocker
</span><a href="Agda.TypeChecking.Free.Base.html#flexRigToBlocker"><span class="hs-identifier hs-var hs-var">flexRigToBlocker</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787402"><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787402"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaSet -&gt; Blocker
</span><a href="Agda.TypeChecking.Free.Base.html#metaSetToBlocker"><span class="hs-identifier hs-var">metaSetToBlocker</span></a></span><span> </span><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681787402"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#flexRigToBlocker"><span class="hs-identifier hs-var">flexRigToBlocker</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blocker
</span><a href="Agda.Syntax.Internal.Blockers.html#neverUnblock"><span class="hs-identifier hs-var">neverUnblock</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786936"><span id="local-6989586621681787407"><span id="local-6989586621681787411"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621681787422"><span class="annot"><span class="annottext">pretty :: FlexRig' a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681787423"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787423"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;FL&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681787423"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;WR&quot;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;SR&quot;</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- * Multi-dimensional feature vector for variable occurrence (semigroup)</span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Occurrence of free variables is classified by several dimensions.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--   Currently, we have 'FlexRig' and 'Modality'.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="VarOcc%27"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-var">VarOcc'</span></a></span></span><span> </span><span id="local-6989586621681786942"><span class="annot"><a href="#local-6989586621681786942"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VarOcc"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="varFlexRig"><span class="annot"><span class="annottext">forall a. VarOcc' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#varFlexRig"><span class="hs-identifier hs-var hs-var">varFlexRig</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786942"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="varModality"><span class="annot"><span class="annottext">forall a. VarOcc' a -&gt; Modality
</span><a href="Agda.TypeChecking.Free.Base.html#varModality"><span class="hs-identifier hs-var hs-var">varModality</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787431"><span id="local-6989586621681787437"><span id="local-6989586621681787441"><span class="annot"><span class="annottext">Int -&gt; VarOcc' a -&gt; ShowS
[VarOcc' a] -&gt; ShowS
VarOcc' a -&gt; String
(Int -&gt; VarOcc' a -&gt; ShowS)
-&gt; (VarOcc' a -&gt; String)
-&gt; ([VarOcc' a] -&gt; ShowS)
-&gt; Show (VarOcc' a)
forall a. Show a =&gt; Int -&gt; VarOcc' a -&gt; ShowS
forall a. Show a =&gt; [VarOcc' a] -&gt; ShowS
forall a. Show a =&gt; VarOcc' a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; VarOcc' a -&gt; ShowS
showsPrec :: Int -&gt; VarOcc' a -&gt; ShowS
$cshow :: forall a. Show a =&gt; VarOcc' a -&gt; String
show :: VarOcc' a -&gt; String
$cshowList :: forall a. Show a =&gt; [VarOcc' a] -&gt; ShowS
showList :: [VarOcc' a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span class="hs-keyword">type</span><span> </span><span id="VarOcc"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | Equality up to origin.</span></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786950"><span id="local-6989586621681787447"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621681786950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787454"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787454"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span id="local-6989586621681787455"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787455"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681787456"><span class="annot"><span class="annottext">== :: VarOcc' a -&gt; VarOcc' a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787457"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787457"><span class="hs-identifier hs-var">fr'</span></a></span></span><span> </span><span id="local-6989586621681787458"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787458"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787454"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; FlexRig' a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787457"><span class="hs-identifier hs-var">fr'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
forall a b. (LensModality a, LensModality b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Agda.Syntax.Common.html#sameModality"><span class="hs-identifier hs-var">sameModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787455"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787458"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786956"><span id="local-6989586621681787463"><span class="annot"><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-type">LensModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621681787468"><span class="annot"><span class="annottext">getModality :: VarOcc' a -&gt; Modality
</span><a href="#local-6989586621681787468"><span class="hs-identifier hs-var hs-var hs-var">getModality</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarOcc' a -&gt; Modality
forall a. VarOcc' a -&gt; Modality
</span><a href="Agda.TypeChecking.Free.Base.html#varModality"><span class="hs-identifier hs-var">varModality</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621681787470"><span class="annot"><span class="annottext">mapModality :: (Modality -&gt; Modality) -&gt; VarOcc' a -&gt; VarOcc' a
</span><a href="#local-6989586621681787470"><span class="hs-identifier hs-var hs-var hs-var">mapModality</span></a></span></span><span> </span><span id="local-6989586621681787472"><span class="annot"><span class="annottext">Modality -&gt; Modality
</span><a href="#local-6989586621681787472"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787473"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787473"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681787474"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787474"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787473"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; VarOcc' a) -&gt; Modality -&gt; VarOcc' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality
</span><a href="#local-6989586621681787472"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787474"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786961"><span id="local-6989586621681787476"><span id="local-6989586621681787481"><span id="local-6989586621681787484"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786961"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786966"><span id="local-6989586621681787489"><span id="local-6989586621681787494"><span id="local-6989586621681787497"><span class="annot"><a href="Agda.Syntax.Common.html#LensQuantity"><span class="hs-identifier hs-type">LensQuantity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><span class="hs-comment">-- | Access to 'varFlexRig' in 'VarOcc'.</span></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786968"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681786968"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621681787505"><span class="annot"><span class="annottext">lensFlexRig :: Lens' (VarOcc' a) (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681787506"><span class="annot"><span class="annottext">FlexRig' a -&gt; f (FlexRig' a)
</span><a href="#local-6989586621681787506"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787507"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787507"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span id="local-6989586621681787508"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787508"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; f (FlexRig' a)
</span><a href="#local-6989586621681787506"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787507"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">f (FlexRig' a) -&gt; (FlexRig' a -&gt; VarOcc' a) -&gt; f (VarOcc' a)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681787510"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787510"><span class="hs-identifier hs-var">fr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787510"><span class="hs-identifier hs-var">fr'</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787508"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- lensFlexRig :: Lens' (VarOcc' a) (FlexRig' a)</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- lensFlexRig f (VarOcc fr m) = f fr &lt;&amp;&gt; \ fr' -&gt; VarOcc fr' m</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | The default way of aggregating free variable info from subterms is by adding</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   the variable occurrences.  For instance, if we have a pair @(t&#8321;,t&#8322;)@ then</span><span>
</span><span id="line-203"></span><span class="hs-comment">--   and @t&#8321;@ has @o&#8321;@ the occurrences of a variable @x@</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   and @t&#8322;@ has @o&#8322;@ the occurrences of the same variable, then</span><span>
</span><span id="line-205"></span><span class="hs-comment">--   @(t&#8321;,t&#8322;)@ has @mappend o&#8321; o&#8322;@ occurrences of that variable.</span><span>
</span><span id="line-206"></span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span class="hs-comment">--   From counting 'Quantity', we extrapolate this to 'FlexRig' and 'Relevance':</span><span>
</span><span id="line-208"></span><span class="hs-comment">--   we care most about about 'StronglyRigid' 'Relevant' occurrences.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--   E.g., if @t&#8321;@ has a 'StronglyRigid' occurrence and @t&#8322;@ a 'Flexible' occurrence,</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   then @(t&#8321;,t&#8322;)@ still has a 'StronglyRigid' occurrence.</span><span>
</span><span id="line-211"></span><span class="hs-comment">--   Analogously, @Relevant@ occurrences count most, as we wish e.g. to forbid</span><span>
</span><span id="line-212"></span><span class="hs-comment">--   relevant occurrences of variables that are declared to be irrelevant.</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">--   'VarOcc' forms a semiring, and this monoid is the addition of the semiring.</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786975"><span id="local-6989586621681787515"><span id="local-6989586621681787519"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681786975"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786975"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787524"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787524"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621681787525"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787525"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681787526"><span class="annot"><span class="annottext">&lt;&gt; :: VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787527"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787527"><span class="hs-identifier hs-var">o'</span></a></span></span><span> </span><span id="local-6989586621681787528"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787528"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-var">addFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787524"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787527"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.Syntax.Common.html#addModality"><span class="hs-identifier hs-var">addModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787525"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787528"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | The neutral element for variable occurrence aggregation is least serious</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   occurrence: flexible, irrelevant.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   This is also the absorptive element for 'composeVarOcc', if we ignore</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   the 'MetaSet' in 'Flexible'.</span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786977"><span id="local-6989586621681787538"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681786977"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786977"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621681787543"><span class="annot"><span class="annottext">mempty :: VarOcc' a
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; FlexRig' a
forall a. a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Agda.Syntax.Common.html#zeroModality"><span class="hs-identifier hs-var">zeroModality</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621681787546"><span class="annot"><span class="annottext">mappend :: VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | The absorptive element of variable occurrence under aggregation:</span><span>
</span><span id="line-228"></span><span class="hs-comment">--   strongly rigid, relevant.</span><span>
</span><span id="line-229"></span><span id="local-6989586621681786978"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#topVarOcc"><span class="hs-identifier hs-type">topVarOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786978"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span id="topVarOcc"><span class="annot"><span class="annottext">topVarOcc :: forall a. VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#topVarOcc"><span class="hs-identifier hs-var hs-var">topVarOcc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Agda.Syntax.Common.html#topModality"><span class="hs-identifier hs-var">topModality</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | First argument is the outer occurrence (context) and second is the inner.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--   This multiplicative operation is to modify an occurrence under a context.</span><span>
</span><span id="line-234"></span><span id="local-6989586621681787549"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#composeVarOcc"><span class="hs-identifier hs-type">composeVarOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681787549"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787549"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787549"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787549"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-235"></span><span id="composeVarOcc"><span class="annot"><span class="annottext">composeVarOcc :: forall a. Semigroup a =&gt; VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#composeVarOcc"><span class="hs-identifier hs-var hs-var">composeVarOcc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787552"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787552"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621681787553"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787553"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787554"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787554"><span class="hs-identifier hs-var">o'</span></a></span></span><span> </span><span id="local-6989586621681787555"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787555"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-identifier hs-var">composeFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787552"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787554"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.Syntax.Common.html#composeModality"><span class="hs-identifier hs-var">composeModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787553"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787555"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- We use the multipicative modality monoid (composition).</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621681787557"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#oneVarOcc"><span class="hs-identifier hs-type">oneVarOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787557"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-239"></span><span id="oneVarOcc"><span class="annot"><span class="annottext">oneVarOcc :: forall a. VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#oneVarOcc"><span class="hs-identifier hs-var hs-var">oneVarOcc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Modality -&gt; VarOcc' a
forall a. FlexRig' a -&gt; Modality -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-var">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Agda.Syntax.Common.html#unitModality"><span class="hs-identifier hs-var">unitModality</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-comment">-- | What's the rigidity of a constructor?</span></span><span>
</span><span id="line-242"></span><span id="local-6989586621681786984"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#constructorFlexRig"><span class="hs-identifier hs-type">constructorFlexRig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786984"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-243"></span><span id="constructorFlexRig"><span class="annot"><span class="annottext">constructorFlexRig :: forall a. ConHead -&gt; Elims -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#constructorFlexRig"><span class="hs-identifier hs-var hs-var">constructorFlexRig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DataOrRecord
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681787567"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681787567"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681787568"><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681787568"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681787569"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681787569"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681787567"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- Coinductive (record) constructors admit infinite cycles:</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- Inductive constructors do not admit infinite cycles:</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Elims -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681787569"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Arg QName] -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681787568"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-comment">-- Jesper, 2020-10-22: Issue #4995: treat occurrences in non-fully</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- applied constructors as weakly rigid.</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">-- Ulf, 2019-10-18: Now the termination checker treats inductive recursive records</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-comment">-- the same as datatypes, so absense of infinite cycles can be proven in Agda, and thus</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- the unifier is allowed to do it too. Test case: test/Succeed/Issue1271a.agda</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-comment">-- WAS:</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- -- Inductive record constructors do not admit infinite cycles,</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- -- but this cannot be proven inside Agda.</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- -- Thus, unification should not prove it either.</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681786994"><span id="local-6989586621681787576"><span id="local-6989586621681787580"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786994"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621681787585"><span class="annot"><span class="annottext">pretty :: VarOcc' a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681787586"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787586"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681787587"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787587"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787586"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681787587"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-264"></span><span class="annot"><span class="hs-comment">-- * Storing variable occurrences (semimodule).</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Any representation @c@ of a set of variables need to be able to be modified by</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   a variable occurrence. This is to ensure that free variable analysis is</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   compositional. For instance, it should be possible to compute `fv (v [u/x])`</span><span>
</span><span id="line-269"></span><span class="hs-comment">--   from `fv v` and `fv u`.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   In algebraic terminology, a variable set @a@ needs to be (almost) a left semimodule</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   to the semiring 'VarOcc'.</span><span>
</span><span id="line-273"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786996"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681786996"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681786997"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IsVarSet"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IsVarSet"><span class="hs-identifier hs-var">IsVarSet</span></a></span></span><span> </span><span id="local-6989586621681786996"><span class="annot"><a href="#local-6989586621681786996"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681786997"><span class="annot"><a href="#local-6989586621681786997"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621681786997"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786996"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-comment">-- | Laws</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">--    * Respects monoid operations:</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-comment">--        withVarOcc o mempty   == mempty</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">--        withVarOcc o (x &lt;&gt; y) == withVarOcc o x &lt;&gt; withVarOcc o y</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">--    * Respects VarOcc composition:</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">--        withVarOcc oneVarOcc             = id</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-comment">--        withVarOcc (composeVarOcc o1 o2) = withVarOcc o1 . withVarOcc o2</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">--    * Respects VarOcc aggregation:</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">--        withVarOcc (o1 &lt;&gt; o2) x = withVarOcc o1 x &lt;&gt; withVarOcc o2 x</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">--      Since the corresponding unit law may fail,</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">--        withVarOcc mempty x = mempty</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-comment">--      ```</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-comment">--      it is not quite a semimodule.</span><span>
</span><span id="line-294"></span><span>  </span><span id="withVarOcc"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#withVarOcc"><span class="hs-identifier hs-type">withVarOcc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786996"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786997"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681786997"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Representation of a variable set as map from de Bruijn indices</span><span>
</span><span id="line-297"></span><span class="hs-comment">--   to 'VarOcc'.</span><span>
</span><span id="line-298"></span><span class="hs-keyword">type</span><span> </span><span id="TheVarMap%27"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap%27"><span class="hs-identifier hs-var">TheVarMap'</span></a></span></span><span> </span><span id="local-6989586621681787593"><span class="annot"><a href="#local-6989586621681787593"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787593"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span class="hs-keyword">newtype</span><span> </span><span id="VarMap%27"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-var">VarMap'</span></a></span></span><span> </span><span id="local-6989586621681786999"><span class="annot"><a href="#local-6989586621681786999"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VarMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="theVarMap"><span class="annot"><span class="annottext">forall a. VarMap' a -&gt; TheVarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#theVarMap"><span class="hs-identifier hs-var hs-var">theVarMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap%27"><span class="hs-identifier hs-type">TheVarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681786999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787598"><span id="local-6989586621681787604"><span class="annot"><span class="annottext">VarMap' a -&gt; VarMap' a -&gt; Bool
(VarMap' a -&gt; VarMap' a -&gt; Bool)
-&gt; (VarMap' a -&gt; VarMap' a -&gt; Bool) -&gt; Eq (VarMap' a)
forall a. Eq a =&gt; VarMap' a -&gt; VarMap' a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; VarMap' a -&gt; VarMap' a -&gt; Bool
== :: VarMap' a -&gt; VarMap' a -&gt; Bool
$c/= :: forall a. Eq a =&gt; VarMap' a -&gt; VarMap' a -&gt; Bool
/= :: VarMap' a -&gt; VarMap' a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787611"><span id="local-6989586621681787617"><span id="local-6989586621681787621"><span class="annot"><span class="annottext">Int -&gt; VarMap' a -&gt; ShowS
[VarMap' a] -&gt; ShowS
VarMap' a -&gt; String
(Int -&gt; VarMap' a -&gt; ShowS)
-&gt; (VarMap' a -&gt; String)
-&gt; ([VarMap' a] -&gt; ShowS)
-&gt; Show (VarMap' a)
forall a. Show a =&gt; Int -&gt; VarMap' a -&gt; ShowS
forall a. Show a =&gt; [VarMap' a] -&gt; ShowS
forall a. Show a =&gt; VarMap' a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; VarMap' a -&gt; ShowS
showsPrec :: Int -&gt; VarMap' a -&gt; ShowS
$cshow :: forall a. Show a =&gt; VarMap' a -&gt; String
show :: VarMap' a -&gt; String
$cshowList :: forall a. Show a =&gt; [VarMap' a] -&gt; ShowS
showList :: [VarMap' a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-keyword">type</span><span> </span><span id="TheVarMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap"><span class="hs-identifier hs-var">TheVarMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap%27"><span class="hs-identifier hs-type">TheVarMap'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-303"></span><span class="hs-keyword">type</span><span>    </span><span id="VarMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><span class="hs-comment">-- | A &quot;set&quot;-style 'Singleton' instance with default/initial variable occurrence.</span></span><span>
</span><span id="line-306"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787011"><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787011"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621681787628"><span class="annot"><span class="annottext">singleton :: Int -&gt; VarMap' a
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621681787629"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787629"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheVarMap' a -&gt; VarMap' a
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheVarMap' a -&gt; VarMap' a) -&gt; TheVarMap' a -&gt; VarMap' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarOcc' a -&gt; TheVarMap' a
forall a. Int -&gt; a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787629"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc' a
forall a. VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#oneVarOcc"><span class="hs-identifier hs-var">oneVarOcc</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621681787013"><span id="local-6989586621681787014"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#mapVarMap"><span class="hs-identifier hs-type">mapVarMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap%27"><span class="hs-identifier hs-type">TheVarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787013"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheVarMap%27"><span class="hs-identifier hs-type">TheVarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787014"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787013"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787014"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-310"></span><span id="mapVarMap"><span class="annot"><span class="annottext">mapVarMap :: forall a b.
(TheVarMap' a -&gt; TheVarMap' b) -&gt; VarMap' a -&gt; VarMap' b
</span><a href="Agda.TypeChecking.Free.Base.html#mapVarMap"><span class="hs-identifier hs-var hs-var">mapVarMap</span></a></span></span><span> </span><span id="local-6989586621681787632"><span class="annot"><span class="annottext">TheVarMap' a -&gt; TheVarMap' b
</span><a href="#local-6989586621681787632"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheVarMap' b -&gt; VarMap' b
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheVarMap' b -&gt; VarMap' b)
-&gt; (VarMap' a -&gt; TheVarMap' b) -&gt; VarMap' a -&gt; VarMap' b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TheVarMap' a -&gt; TheVarMap' b
</span><a href="#local-6989586621681787632"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TheVarMap' a -&gt; TheVarMap' b)
-&gt; (VarMap' a -&gt; TheVarMap' a) -&gt; VarMap' a -&gt; TheVarMap' b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VarMap' a -&gt; TheVarMap' a
forall a. VarMap' a -&gt; TheVarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#theVarMap"><span class="hs-identifier hs-var">theVarMap</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span id="local-6989586621681787017"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lookupVarMap"><span class="hs-identifier hs-type">lookupVarMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier hs-type">VarOcc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-313"></span><span id="lookupVarMap"><span class="annot"><span class="annottext">lookupVarMap :: forall a. Int -&gt; VarMap' a -&gt; Maybe (VarOcc' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lookupVarMap"><span class="hs-identifier hs-var hs-var">lookupVarMap</span></a></span></span><span> </span><span id="local-6989586621681787634"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787634"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap (VarOcc' a) -&gt; Maybe (VarOcc' a)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IntMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787634"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap (VarOcc' a) -&gt; Maybe (VarOcc' a))
-&gt; (VarMap' a -&gt; IntMap (VarOcc' a))
-&gt; VarMap' a
-&gt; Maybe (VarOcc' a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VarMap' a -&gt; IntMap (VarOcc' a)
forall a. VarMap' a -&gt; TheVarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#theVarMap"><span class="hs-identifier hs-var">theVarMap</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Andreas &amp; Jesper, 2018-05-11, issue #3052:</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Proper monoid instance for @VarMap@ rather than inheriting the broken one from IntMap.</span><span>
</span><span id="line-318"></span><span class="hs-comment">--   We combine two occurrences of a variable using 'mappend'.</span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787022"><span id="local-6989586621681787639"><span id="local-6989586621681787643"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681787022"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787022"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span id="local-6989586621681787648"><span class="annot"><span class="annottext">TheVarMap' a
</span><a href="#local-6989586621681787648"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681787649"><span class="annot"><span class="annottext">&lt;&gt; :: VarMap' a -&gt; VarMap' a -&gt; VarMap' a
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span id="local-6989586621681787650"><span class="annot"><span class="annottext">TheVarMap' a
</span><a href="#local-6989586621681787650"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheVarMap' a -&gt; VarMap' a
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheVarMap' a -&gt; VarMap' a) -&gt; TheVarMap' a -&gt; VarMap' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a)
-&gt; TheVarMap' a -&gt; TheVarMap' a -&gt; TheVarMap' a
forall a. (a -&gt; a -&gt; a) -&gt; IntMap a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.unionWith</span></span><span> </span><span class="annot"><span class="annottext">VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">TheVarMap' a
</span><a href="#local-6989586621681787648"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TheVarMap' a
</span><a href="#local-6989586621681787650"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787025"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681787025"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787025"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621681787659"><span class="annot"><span class="annottext">mempty :: VarMap' a
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheVarMap' a -&gt; VarMap' a
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="annot"><span class="annottext">TheVarMap' a
forall a. IntMap a
</span><span class="hs-identifier hs-var">IntMap.empty</span></span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621681787662"><span class="annot"><span class="annottext">mappend :: VarMap' a -&gt; VarMap' a -&gt; VarMap' a
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap' a -&gt; VarMap' a -&gt; VarMap' a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621681787666"><span class="annot"><span class="annottext">mconcat :: [VarMap' a] -&gt; VarMap' a
</span><span class="hs-identifier hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheVarMap' a -&gt; VarMap' a
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheVarMap' a -&gt; VarMap' a)
-&gt; ([VarMap' a] -&gt; TheVarMap' a) -&gt; [VarMap' a] -&gt; VarMap' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a)
-&gt; [TheVarMap' a] -&gt; TheVarMap' a
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; f (IntMap a) -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">([TheVarMap' a] -&gt; TheVarMap' a)
-&gt; ([VarMap' a] -&gt; [TheVarMap' a]) -&gt; [VarMap' a] -&gt; TheVarMap' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarMap' a -&gt; TheVarMap' a) -&gt; [VarMap' a] -&gt; [TheVarMap' a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VarMap' a -&gt; TheVarMap' a
forall a. VarMap' a -&gt; TheVarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#theVarMap"><span class="hs-identifier hs-var">theVarMap</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-comment">-- mconcat = VarMap . IntMap.unionsWith mappend . coerce   -- ghc 8.6.5 does not seem to like this coerce</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787032"><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681787032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IsVarSet"><span class="hs-identifier hs-type">IsVarSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier hs-type">VarMap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621681787683"><span class="annot"><span class="annottext">withVarOcc :: VarOcc' a -&gt; VarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#withVarOcc"><span class="hs-identifier hs-var hs-var hs-var">withVarOcc</span></a></span></span><span> </span><span id="local-6989586621681787684"><span class="annot"><span class="annottext">VarOcc' a
</span><a href="#local-6989586621681787684"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TheVarMap' a -&gt; TheVarMap' a) -&gt; VarMap' a -&gt; VarMap' a
forall a b.
(TheVarMap' a -&gt; TheVarMap' b) -&gt; VarMap' a -&gt; VarMap' b
</span><a href="Agda.TypeChecking.Free.Base.html#mapVarMap"><span class="hs-identifier hs-var">mapVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">((TheVarMap' a -&gt; TheVarMap' a) -&gt; VarMap' a -&gt; VarMap' a)
-&gt; (TheVarMap' a -&gt; TheVarMap' a) -&gt; VarMap' a -&gt; VarMap' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VarOcc' a -&gt; VarOcc' a) -&gt; TheVarMap' a -&gt; TheVarMap' a
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((VarOcc' a -&gt; VarOcc' a) -&gt; TheVarMap' a -&gt; TheVarMap' a)
-&gt; (VarOcc' a -&gt; VarOcc' a) -&gt; TheVarMap' a -&gt; TheVarMap' a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
forall a. Semigroup a =&gt; VarOcc' a -&gt; VarOcc' a -&gt; VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#composeVarOcc"><span class="hs-identifier hs-var">composeVarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc' a
</span><a href="#local-6989586621681787684"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- * Simple flexible/rigid variable collection.</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- | Keep track of 'FlexRig' for every variable, but forget the involved meta vars.</span></span><span>
</span><span id="line-335"></span><span class="hs-keyword">type</span><span> </span><span id="TheFlexRigMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheFlexRigMap"><span class="hs-identifier hs-var">TheFlexRigMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span class="hs-keyword">newtype</span><span> </span><span id="FlexRigMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FlexRigMap"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="theFlexRigMap"><span class="annot"><span class="annottext">FlexRigMap -&gt; TheFlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#theFlexRigMap"><span class="hs-identifier hs-var hs-var">theFlexRigMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheFlexRigMap"><span class="hs-identifier hs-type">TheFlexRigMap</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787688"><span id="local-6989586621681787693"><span id="local-6989586621681787697"><span class="annot"><span class="annottext">Int -&gt; FlexRigMap -&gt; ShowS
[FlexRigMap] -&gt; ShowS
FlexRigMap -&gt; String
(Int -&gt; FlexRigMap -&gt; ShowS)
-&gt; (FlexRigMap -&gt; String)
-&gt; ([FlexRigMap] -&gt; ShowS)
-&gt; Show FlexRigMap
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FlexRigMap -&gt; ShowS
showsPrec :: Int -&gt; FlexRigMap -&gt; ShowS
$cshow :: FlexRigMap -&gt; String
show :: FlexRigMap -&gt; String
$cshowList :: [FlexRigMap] -&gt; ShowS
showList :: [FlexRigMap] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787702"><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#mapFlexRigMap"><span class="hs-identifier hs-type">mapFlexRigMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheFlexRigMap"><span class="hs-identifier hs-type">TheFlexRigMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#TheFlexRigMap"><span class="hs-identifier hs-type">TheFlexRigMap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span>
</span><span id="line-340"></span><span id="mapFlexRigMap"><span class="annot"><span class="annottext">mapFlexRigMap :: (TheFlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#mapFlexRigMap"><span class="hs-identifier hs-var hs-var">mapFlexRigMap</span></a></span></span><span> </span><span id="local-6989586621681787708"><span class="annot"><span class="annottext">TheFlexRigMap -&gt; TheFlexRigMap
</span><a href="#local-6989586621681787708"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheFlexRigMap -&gt; FlexRigMap)
-&gt; (FlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; FlexRigMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap -&gt; TheFlexRigMap
</span><a href="#local-6989586621681787708"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TheFlexRigMap -&gt; TheFlexRigMap)
-&gt; (FlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; TheFlexRigMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FlexRigMap -&gt; TheFlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#theFlexRigMap"><span class="hs-identifier hs-var">theFlexRigMap</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787711"><span id="local-6989586621681787715"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span> </span><span id="local-6989586621681787720"><span class="annot"><span class="annottext">TheFlexRigMap
</span><a href="#local-6989586621681787720"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681787721"><span class="annot"><span class="annottext">&lt;&gt; :: FlexRigMap -&gt; FlexRigMap -&gt; FlexRigMap
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span> </span><span id="local-6989586621681787722"><span class="annot"><span class="annottext">TheFlexRigMap
</span><a href="#local-6989586621681787722"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheFlexRigMap -&gt; FlexRigMap) -&gt; TheFlexRigMap -&gt; FlexRigMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ())
-&gt; TheFlexRigMap -&gt; TheFlexRigMap -&gt; TheFlexRigMap
forall a. (a -&gt; a -&gt; a) -&gt; IntMap a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.unionWith</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ()
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-var">addFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap
</span><a href="#local-6989586621681787720"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap
</span><a href="#local-6989586621681787722"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621681787729"><span class="annot"><span class="annottext">mempty :: FlexRigMap
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap
forall a. IntMap a
</span><span class="hs-identifier hs-var">IntMap.empty</span></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621681787731"><span class="annot"><span class="annottext">mappend :: FlexRigMap -&gt; FlexRigMap -&gt; FlexRigMap
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRigMap -&gt; FlexRigMap -&gt; FlexRigMap
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621681787734"><span class="annot"><span class="annottext">mconcat :: [FlexRigMap] -&gt; FlexRigMap
</span><span class="hs-identifier hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheFlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-var">FlexRigMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TheFlexRigMap -&gt; FlexRigMap)
-&gt; ([FlexRigMap] -&gt; TheFlexRigMap) -&gt; [FlexRigMap] -&gt; FlexRigMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ())
-&gt; [TheFlexRigMap] -&gt; TheFlexRigMap
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; f (IntMap a) -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ()
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-var">addFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">([TheFlexRigMap] -&gt; TheFlexRigMap)
-&gt; ([FlexRigMap] -&gt; [TheFlexRigMap])
-&gt; [FlexRigMap]
-&gt; TheFlexRigMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FlexRigMap -&gt; TheFlexRigMap) -&gt; [FlexRigMap] -&gt; [TheFlexRigMap]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FlexRigMap -&gt; TheFlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#theFlexRigMap"><span class="hs-identifier hs-var">theFlexRigMap</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><span class="hs-comment">-- | Compose everything with the 'varFlexRig' part of the 'VarOcc'.</span></span><span>
</span><span id="line-351"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IsVarSet"><span class="hs-identifier hs-type">IsVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRigMap"><span class="hs-identifier hs-type">FlexRigMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621681787748"><span class="annot"><span class="annottext">withVarOcc :: VarOcc' () -&gt; FlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#withVarOcc"><span class="hs-identifier hs-var hs-var hs-var">withVarOcc</span></a></span></span><span> </span><span id="local-6989586621681787749"><span class="annot"><span class="annottext">VarOcc' ()
</span><a href="#local-6989586621681787749"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TheFlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; FlexRigMap
</span><a href="Agda.TypeChecking.Free.Base.html#mapFlexRigMap"><span class="hs-identifier hs-var">mapFlexRigMap</span></a></span><span> </span><span class="annot"><span class="annottext">((TheFlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; FlexRigMap)
-&gt; (TheFlexRigMap -&gt; TheFlexRigMap) -&gt; FlexRigMap -&gt; FlexRigMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FlexRig' () -&gt; FlexRig' ()) -&gt; TheFlexRigMap -&gt; TheFlexRigMap
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((FlexRig' () -&gt; FlexRig' ()) -&gt; TheFlexRigMap -&gt; TheFlexRigMap)
-&gt; (FlexRig' () -&gt; FlexRig' ()) -&gt; TheFlexRigMap -&gt; TheFlexRigMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ()
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-identifier hs-var">composeFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ())
-&gt; FlexRig' () -&gt; FlexRig' () -&gt; FlexRig' ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; FlexRig' () -&gt; FlexRig' ()
forall a b. a -&gt; FlexRig' b -&gt; FlexRig' a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">VarOcc' () -&gt; FlexRig' ()
forall a. VarOcc' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#varFlexRig"><span class="hs-identifier hs-var">varFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc' ()
</span><a href="#local-6989586621681787749"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621681787751"><span class="annot"><span class="annottext">singleton :: MetaId -&gt; ()
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var hs-var hs-var">singleton</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-358"></span><span class="annot"><span class="hs-comment">-- * Plain variable occurrence counting.</span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-keyword">newtype</span><span> </span><span id="VarCounts"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VarCounts"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="varCounts"><span class="annot"><span class="annottext">VarCounts -&gt; IntMap Int
</span><a href="Agda.TypeChecking.Free.Base.html#varCounts"><span class="hs-identifier hs-var hs-var">varCounts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787755"><span id="local-6989586621681787760"><span class="annot"><span class="annottext">VarCounts -&gt; VarCounts -&gt; Bool
(VarCounts -&gt; VarCounts -&gt; Bool)
-&gt; (VarCounts -&gt; VarCounts -&gt; Bool) -&gt; Eq VarCounts
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: VarCounts -&gt; VarCounts -&gt; Bool
== :: VarCounts -&gt; VarCounts -&gt; Bool
$c/= :: VarCounts -&gt; VarCounts -&gt; Bool
/= :: VarCounts -&gt; VarCounts -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787766"><span id="local-6989586621681787771"><span id="local-6989586621681787775"><span class="annot"><span class="annottext">Int -&gt; VarCounts -&gt; ShowS
[VarCounts] -&gt; ShowS
VarCounts -&gt; String
(Int -&gt; VarCounts -&gt; ShowS)
-&gt; (VarCounts -&gt; String)
-&gt; ([VarCounts] -&gt; ShowS)
-&gt; Show VarCounts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; VarCounts -&gt; ShowS
showsPrec :: Int -&gt; VarCounts -&gt; ShowS
$cshow :: VarCounts -&gt; String
show :: VarCounts -&gt; String
$cshowList :: [VarCounts] -&gt; ShowS
showList :: [VarCounts] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787780"><span id="local-6989586621681787784"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span><span> </span><span id="local-6989586621681787790"><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681787790"><span class="hs-identifier hs-var">fv1</span></a></span></span><span> </span><span id="local-6989586621681787791"><span class="annot"><span class="annottext">&lt;&gt; :: VarCounts -&gt; VarCounts -&gt; VarCounts
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span><span> </span><span id="local-6989586621681787792"><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681787792"><span class="hs-identifier hs-var">fv2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap Int -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; IntMap Int -&gt; IntMap Int -&gt; IntMap Int
forall a. (a -&gt; a -&gt; a) -&gt; IntMap a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.unionWith</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681787790"><span class="hs-identifier hs-var">fv1</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681787792"><span class="hs-identifier hs-var">fv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787799"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621681787802"><span class="annot"><span class="annottext">mempty :: VarCounts
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap Int -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap Int
forall a. IntMap a
</span><span class="hs-identifier hs-var">IntMap.empty</span></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621681787804"><span class="annot"><span class="annottext">mappend :: VarCounts -&gt; VarCounts -&gt; VarCounts
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarCounts -&gt; VarCounts -&gt; VarCounts
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IsVarSet"><span class="hs-identifier hs-type">IsVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621681787813"><span class="annot"><span class="annottext">withVarOcc :: VarOcc' () -&gt; VarCounts -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.Base.html#withVarOcc"><span class="hs-identifier hs-var hs-var hs-var">withVarOcc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VarOcc' ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarCounts -&gt; VarCounts
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621681787816"><span class="annot"><span class="annottext">singleton :: Int -&gt; VarCounts
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621681787817"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787817"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap Int -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap Int -&gt; VarCounts) -&gt; IntMap Int -&gt; VarCounts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; IntMap Int
forall a. Int -&gt; a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681787817"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-377"></span><span class="annot"><span class="hs-comment">-- * Environment for collecting free variables.</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">-- | Where should we skip sorts in free variable analysis?</span></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">data</span><span> </span><span id="IgnoreSorts"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreSorts"><span class="hs-identifier hs-var">IgnoreSorts</span></a></span></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IgnoreNot"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreNot"><span class="hs-identifier hs-var">IgnoreNot</span></a></span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ Do not skip.</span></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IgnoreInAnnotations"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreInAnnotations"><span class="hs-identifier hs-var">IgnoreInAnnotations</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Skip when annotation to a type.</span></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IgnoreAll"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreAll"><span class="hs-identifier hs-var">IgnoreAll</span></a></span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ Skip unconditionally.</span></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681787822"><span id="local-6989586621681787826"><span class="annot"><span class="annottext">IgnoreSorts -&gt; IgnoreSorts -&gt; Bool
(IgnoreSorts -&gt; IgnoreSorts -&gt; Bool)
-&gt; (IgnoreSorts -&gt; IgnoreSorts -&gt; Bool) -&gt; Eq IgnoreSorts
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: IgnoreSorts -&gt; IgnoreSorts -&gt; Bool
== :: IgnoreSorts -&gt; IgnoreSorts -&gt; Bool
$c/= :: IgnoreSorts -&gt; IgnoreSorts -&gt; Bool
/= :: IgnoreSorts -&gt; IgnoreSorts -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681787830"><span id="local-6989586621681787832"><span id="local-6989586621681787836"><span class="annot"><span class="annottext">Int -&gt; IgnoreSorts -&gt; ShowS
[IgnoreSorts] -&gt; ShowS
IgnoreSorts -&gt; String
(Int -&gt; IgnoreSorts -&gt; ShowS)
-&gt; (IgnoreSorts -&gt; String)
-&gt; ([IgnoreSorts] -&gt; ShowS)
-&gt; Show IgnoreSorts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; IgnoreSorts -&gt; ShowS
showsPrec :: Int -&gt; IgnoreSorts -&gt; ShowS
$cshow :: IgnoreSorts -&gt; String
show :: IgnoreSorts -&gt; String
$cshowList :: [IgnoreSorts] -&gt; ShowS
showList :: [IgnoreSorts] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><span class="hs-comment">-- | The current context.</span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-keyword">data</span><span> </span><span id="FreeEnv%27"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-var">FreeEnv'</span></a></span></span><span> </span><span id="local-6989586621681787041"><span class="annot"><a href="#local-6989586621681787041"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681787042"><span class="annot"><a href="#local-6989586621681787042"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621681787043"><span class="annot"><a href="#local-6989586621681787043"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeEnv"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv"><span class="hs-identifier hs-var">FreeEnv</span></a></span></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="feExtra"><span class="annot"><span class="annottext">forall a b c. FreeEnv' a b c -&gt; b
</span><a href="Agda.TypeChecking.Free.Base.html#feExtra"><span class="hs-identifier hs-var hs-var">feExtra</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621681787042"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Additional context, e.g., whether to ignore free variables in sorts.</span></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="feFlexRig"><span class="annot"><span class="annottext">forall a b c. FreeEnv' a b c -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#feFlexRig"><span class="hs-identifier hs-var hs-var">feFlexRig</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier hs-type">FlexRig'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787041"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Are we flexible or rigid?</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="feModality"><span class="annot"><span class="annottext">forall a b c. FreeEnv' a b c -&gt; Modality
</span><a href="Agda.TypeChecking.Free.Base.html#feModality"><span class="hs-identifier hs-var hs-var">feModality</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ What is the current relevance and quantity?</span></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="feSingleton"><span class="annot"><span class="annottext">forall a b c. FreeEnv' a b c -&gt; b -&gt; Maybe Int -&gt; c
</span><a href="Agda.TypeChecking.Free.Base.html#feSingleton"><span class="hs-identifier hs-var hs-var">feSingleton</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681787042"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787043"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Method to return a single variable.</span></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-keyword">type</span><span> </span><span id="Variable"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-401"></span><span class="hs-keyword">type</span><span> </span><span id="SingleVar"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#SingleVar"><span class="hs-identifier hs-var">SingleVar</span></a></span></span><span> </span><span id="local-6989586621681787843"><span class="annot"><a href="#local-6989586621681787843"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787843"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-keyword">type</span><span> </span><span id="FreeEnv"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv"><span class="hs-identifier hs-var">FreeEnv</span></a></span></span><span> </span><span id="local-6989586621681787845"><span class="annot"><a href="#local-6989586621681787845"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreSorts"><span class="hs-identifier hs-type">IgnoreSorts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787845"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><span class="hs-comment">-- | Ignore free variables in sorts.</span></span><span>
</span><span id="line-406"></span><span id="local-6989586621681787057"><span id="local-6989586621681787058"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#feIgnoreSorts"><span class="hs-identifier hs-type">feIgnoreSorts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreSorts"><span class="hs-identifier hs-type">IgnoreSorts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787058"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreSorts"><span class="hs-identifier hs-type">IgnoreSorts</span></a></span></span></span><span>
</span><span id="line-407"></span><span id="feIgnoreSorts"><span class="annot"><span class="annottext">feIgnoreSorts :: forall a c. FreeEnv' a IgnoreSorts c -&gt; IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#feIgnoreSorts"><span class="hs-identifier hs-var hs-var">feIgnoreSorts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeEnv' a IgnoreSorts c -&gt; IgnoreSorts
forall a b c. FreeEnv' a b c -&gt; b
</span><a href="Agda.TypeChecking.Free.Base.html#feExtra"><span class="hs-identifier hs-var">feExtra</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787064"><span id="local-6989586621681787065"><span id="local-6989586621681787066"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787065"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787066"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681787064"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621681787851"><span class="annot"><span class="annottext">lensFlexRig :: Lens' (FreeEnv' a b c) (FlexRig' a)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681787852"><span class="annot"><span class="annottext">FlexRig' a -&gt; f (FlexRig' a)
</span><a href="#local-6989586621681787852"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681787853"><span class="annot"><span class="annottext">FreeEnv' a b c
</span><a href="#local-6989586621681787853"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a -&gt; f (FlexRig' a)
</span><a href="#local-6989586621681787852"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeEnv' a b c -&gt; FlexRig' a
forall a b c. FreeEnv' a b c -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#feFlexRig"><span class="hs-identifier hs-var">feFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FreeEnv' a b c
</span><a href="#local-6989586621681787853"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (FlexRig' a)
-&gt; (FlexRig' a -&gt; FreeEnv' a b c) -&gt; f (FreeEnv' a b c)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681787854"><span class="annot"><span class="annottext">FlexRig' a
</span><a href="#local-6989586621681787854"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeEnv' a b c
</span><a href="#local-6989586621681787853"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#feFlexRig"><span class="hs-identifier hs-var">feFlexRig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681787854"><span class="hs-identifier hs-type">fr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787071"><span id="local-6989586621681787072"><span id="local-6989586621681787073"><span id="local-6989586621681787857"><span class="annot"><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-type">LensModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787072"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787073"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621681787861"><span class="annot"><span class="annottext">getModality :: FreeEnv' a b c -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var hs-var hs-var">getModality</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeEnv' a b c -&gt; Modality
forall a b c. FreeEnv' a b c -&gt; Modality
</span><a href="Agda.TypeChecking.Free.Base.html#feModality"><span class="hs-identifier hs-var">feModality</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621681787862"><span class="annot"><span class="annottext">mapModality :: (Modality -&gt; Modality) -&gt; FreeEnv' a b c -&gt; FreeEnv' a b c
</span><a href="Agda.Syntax.Common.html#mapModality"><span class="hs-identifier hs-var hs-var hs-var">mapModality</span></a></span></span><span> </span><span id="local-6989586621681787863"><span class="annot"><span class="annottext">Modality -&gt; Modality
</span><a href="#local-6989586621681787863"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681787864"><span class="annot"><span class="annottext">FreeEnv' a b c
</span><a href="#local-6989586621681787864"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeEnv' a b c
</span><a href="#local-6989586621681787864"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#feModality"><span class="hs-identifier hs-var">feModality</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681787863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#feModality"><span class="hs-identifier hs-var">feModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787864"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787077"><span id="local-6989586621681787078"><span id="local-6989586621681787079"><span id="local-6989586621681787866"><span id="local-6989586621681787871"><span id="local-6989586621681787874"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787077"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787078"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787079"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681787083"><span id="local-6989586621681787084"><span id="local-6989586621681787085"><span id="local-6989586621681787878"><span id="local-6989586621681787883"><span id="local-6989586621681787886"><span class="annot"><a href="Agda.Syntax.Common.html#LensQuantity"><span class="hs-identifier hs-type">LensQuantity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787083"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787084"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787085"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><span class="hs-comment">-- | The initial context.</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span id="local-6989586621681787086"><span id="local-6989586621681787087"><span id="local-6989586621681787089"><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#initFreeEnv"><span class="hs-identifier hs-type">initFreeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681787086"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681787087"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#SingleVar"><span class="hs-identifier hs-type">SingleVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787086"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier hs-type">FreeEnv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787089"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787087"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681787086"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-422"></span><span id="initFreeEnv"><span class="annot"><span class="annottext">initFreeEnv :: forall c b a. Monoid c =&gt; b -&gt; SingleVar c -&gt; FreeEnv' a b c
</span><a href="Agda.TypeChecking.Free.Base.html#initFreeEnv"><span class="hs-identifier hs-var hs-var">initFreeEnv</span></a></span></span><span> </span><span id="local-6989586621681787892"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681787892"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681787893"><span class="annot"><span class="annottext">SingleVar c
</span><a href="#local-6989586621681787893"><span class="hs-identifier hs-var">sing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv"><span class="hs-identifier hs-type">FreeEnv</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">feExtra :: b
</span><a href="Agda.TypeChecking.Free.Base.html#feExtra"><span class="hs-identifier hs-var">feExtra</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681787892"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feFlexRig :: FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#feFlexRig"><span class="hs-identifier hs-var">feFlexRig</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' a
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feModality :: Modality
</span><a href="Agda.TypeChecking.Free.Base.html#feModality"><span class="hs-identifier hs-var">feModality</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Agda.Syntax.Common.html#unitModality"><span class="hs-identifier hs-var">unitModality</span></a></span><span>      </span><span class="hs-comment">-- multiplicative monoid</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feSingleton :: b -&gt; Maybe Int -&gt; c
</span><a href="Agda.TypeChecking.Free.Base.html#feSingleton"><span class="hs-identifier hs-var">feSingleton</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c -&gt; SingleVar c -&gt; Maybe Int -&gt; c
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">c
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">SingleVar c
</span><a href="#local-6989586621681787893"><span class="hs-identifier hs-var">sing</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-428"></span></pre></body></html>