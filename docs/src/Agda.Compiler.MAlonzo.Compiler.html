<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Compiler</span></a></span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier">ghcBackend</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationStrings"><span class="hs-identifier">ghcInvocationStrings</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zipWith</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withReaderT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadWriter</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runWriterT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashSet</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mappend</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html"><span class="hs-identifier">Agda.Utils.Haskell.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">setEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">normalise</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">utf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.CallCompiler.html"><span class="hs-identifier">Agda.Compiler.CallCompiler</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html"><span class="hs-identifier">Agda.Compiler.Common</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Coerce.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Coerce</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Misc</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pretty</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Primitives</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.HaskellTypes.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.HaskellTypes</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pragmas</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Strict.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Strict</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.ToTreeless.html"><span class="hs-identifier">Agda.Compiler.ToTreeless</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Unused.html"><span class="hs-identifier">Agda.Compiler.Treeless.Unused</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Erase.html"><span class="hs-identifier">Agda.Compiler.Treeless.Erase</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html"><span class="hs-identifier">Agda.Compiler.Backend</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">render</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Names.html"><span class="hs-identifier">Agda.Syntax.Internal.Names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier">namesIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html"><span class="hs-identifier">Agda.Syntax.Treeless</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html"><span class="hs-identifier">Agda.Syntax.TopLevelModuleName</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html"><span class="hs-identifier">Agda.TypeChecking.Datatypes</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier">getBuiltinName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier">isNewerThan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Float.html"><span class="hs-identifier">Agda.Utils.Float</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.IO.Directory.html"><span class="hs-identifier">Agda.Utils.IO.Directory</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.ListInf.html"><span class="hs-identifier">Agda.Utils.ListInf</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ListInf</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.IO.UTF8.html"><span class="hs-identifier">Agda.Utils.IO.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTF8</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Zip.html"><span class="hs-identifier">Agda.Utils.Zip</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Setup.html"><span class="hs-identifier">Agda.Setup</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Setup.html#getDataDir"><span class="hs-identifier">getDataDir</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- The backend callbacks --------------------------------------------------</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-type">ghcBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span>
</span><span id="line-90"></span><span id="ghcBackend"><span class="annot"><span class="annottext">ghcBackend :: Backend
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-var hs-var">ghcBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend'_boot
  Definition TCM GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
-&gt; Backend
forall opts definition (tcm :: * -&gt; *) env menv mod def.
NFData opts =&gt;
Backend'_boot definition tcm opts env menv mod def
-&gt; Backend_boot definition tcm
</span><a href="Agda.Compiler.Backend.Base.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot
  Definition TCM GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var">ghcBackend'</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-type">ghcBackend'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-93"></span><span id="ghcBackend%27"><span class="annot"><span class="annottext">ghcBackend' :: Backend'_boot
  Definition TCM GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var hs-var">ghcBackend'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">backendName :: BackendName
</span><a href="Agda.Compiler.Backend.Base.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BackendName
</span><span class="hs-string">&quot;GHC&quot;</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendVersion :: Maybe BackendName
</span><a href="Agda.Compiler.Backend.Base.html#backendVersion"><span class="hs-identifier hs-var">backendVersion</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe BackendName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">options :: GHCFlags
</span><a href="Agda.Compiler.Backend.Base.html#options"><span class="hs-identifier hs-var">options</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var">defaultGHCFlags</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">commandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.Backend.Base.html#commandLineFlags"><span class="hs-identifier hs-var">commandLineFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var">ghcCommandLineFlags</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isEnabled :: GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.Backend.Base.html#isEnabled"><span class="hs-identifier hs-var">isEnabled</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preCompile :: GHCFlags -&gt; TCMT IO GHCEnv
</span><a href="Agda.Compiler.Backend.Base.html#preCompile"><span class="hs-identifier hs-var">preCompile</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; TCMT IO GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var">ghcPreCompile</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postCompile :: GHCEnv -&gt; IsMain -&gt; Map TopLevelModuleName GHCModule -&gt; TCMT IO ()
</span><a href="Agda.Compiler.Backend.Base.html#postCompile"><span class="hs-identifier hs-var">postCompile</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; IsMain -&gt; Map TopLevelModuleName GHCModule -&gt; TCMT IO ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var">ghcPostCompile</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preModule :: GHCEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; Maybe [Char]
-&gt; TCMT IO (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.Backend.Base.html#preModule"><span class="hs-identifier hs-var">preModule</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; Maybe [Char]
-&gt; TCMT IO (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var">ghcPreModule</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postModule :: GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; [GHCDefinition]
-&gt; TCMT IO GHCModule
</span><a href="Agda.Compiler.Backend.Base.html#postModule"><span class="hs-identifier hs-var">postModule</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; [GHCDefinition]
-&gt; TCMT IO GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var">ghcPostModule</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compileDef :: GHCEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCMT IO GHCDefinition
</span><a href="Agda.Compiler.Backend.Base.html#compileDef"><span class="hs-identifier hs-var">compileDef</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCMT IO GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var">ghcCompileDef</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scopeCheckingSuffices :: Bool
</span><a href="Agda.Compiler.Backend.Base.html#scopeCheckingSuffices"><span class="hs-identifier hs-var">scopeCheckingSuffices</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mayEraseType :: QName -&gt; TCMT IO Bool
</span><a href="Agda.Compiler.Backend.Base.html#mayEraseType"><span class="hs-identifier hs-var">mayEraseType</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var">ghcMayEraseType</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendInteractTop :: Maybe (BackendCommandTop TCM)
</span><a href="Agda.Compiler.Backend.Base.html#backendInteractTop"><span class="hs-identifier hs-var">backendInteractTop</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (BackendCommandTop TCM)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendInteractHole :: Maybe (BackendCommandHole TCM)
</span><a href="Agda.Compiler.Backend.Base.html#backendInteractHole"><span class="hs-identifier hs-var">backendInteractHole</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (BackendCommandHole TCM)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">--- Command-line flags ---</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="flagGhcCompile"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var hs-var">flagGhcCompile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcCallGhc"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var hs-var">flagGhcCallGhc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcBin"><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var hs-var">flagGhcBin</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Use the compiler at PATH instead of &quot;ghc&quot;</span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcFlags"><span class="annot"><span class="annottext">GHCFlags -&gt; [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var hs-var">flagGhcFlags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcStrictData"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var hs-var">flagGhcStrictData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Make inductive constructors strict?</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcStrict"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var hs-var">flagGhcStrict</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Make functions strict?</span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcTrace"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcTrace"><span class="hs-identifier hs-var hs-var">flagGhcTrace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Print function name upon entry using 'Debug.Trace.trace'?</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682205613"><span id="local-6989586621682205615"><span class="annot"><span class="annottext">(forall x. GHCFlags -&gt; Rep GHCFlags x)
-&gt; (forall x. Rep GHCFlags x -&gt; GHCFlags) -&gt; Generic GHCFlags
forall x. Rep GHCFlags x -&gt; GHCFlags
forall x. GHCFlags -&gt; Rep GHCFlags x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. GHCFlags -&gt; Rep GHCFlags x
from :: forall x. GHCFlags -&gt; Rep GHCFlags x
$cto :: forall x. Rep GHCFlags x -&gt; GHCFlags
to :: forall x. Rep GHCFlags x -&gt; GHCFlags
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682205621"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-type">defaultGHCFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-130"></span><span id="defaultGHCFlags"><span class="annot"><span class="annottext">defaultGHCFlags :: GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var hs-var">defaultGHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCompile :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcBin :: Maybe [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcFlags :: [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcStrict :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcTrace :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcTrace"><span class="hs-identifier hs-var">flagGhcTrace</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | The option to activate the GHC backend.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationFlag"><span class="hs-identifier hs-type">ghcInvocationFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.GetOpt.html#OptDescr"><span class="hs-identifier hs-type">OptDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="ghcInvocationFlag"><span class="annot"><span class="annottext">ghcInvocationFlag :: OptDescr (Flag GHCFlags)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationFlag"><span class="hs-identifier hs-var hs-var">ghcInvocationFlag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205659"><span class="hs-identifier hs-var">enable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile program using the GHC backend&quot;</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621682205659"><span class="annot"><span class="annottext">enable :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205659"><span class="hs-identifier hs-var hs-var">enable</span></a></span></span><span>      </span><span id="local-6989586621682205665"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205665"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205665"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-type">ghcCommandLineFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.GetOpt.html#OptDescr"><span class="hs-identifier hs-type">OptDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span id="ghcCommandLineFlags"><span class="annot"><span class="annottext">ghcCommandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var hs-var">ghcCommandLineFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">OptDescr (Flag GHCFlags)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationFlag"><span class="hs-identifier hs-var">ghcInvocationFlag</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc-dont-call-ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205666"><span class="hs-identifier hs-var">dontCallGHC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;don't call GHC, just write the GHC Haskell files.&quot;</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc-flag&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; Flag GHCFlags) -&gt; [Char] -&gt; ArgDescr (Flag GHCFlags)
forall a. ([Char] -&gt; a) -&gt; [Char] -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#ReqArg"><span class="hs-identifier hs-var">ReqArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Flag GHCFlags
forall {f :: * -&gt; *}.
Applicative f =&gt;
[Char] -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205668"><span class="hs-identifier hs-var">ghcFlag</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;GHC-FLAG&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;give the flag GHC-FLAG to GHC&quot;</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;with-compiler&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; Flag GHCFlags) -&gt; [Char] -&gt; ArgDescr (Flag GHCFlags)
forall a. ([Char] -&gt; a) -&gt; [Char] -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#ReqArg"><span class="hs-identifier hs-var">ReqArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var">withCompilerFlag</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;PATH&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;use the compiler available at PATH&quot;</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc-strict-data&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205670"><span class="hs-identifier hs-var">strictData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;make inductive constructors strict&quot;</span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc-strict&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205671"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;make functions strict&quot;</span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; [[Char]]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; [Char]
-&gt; OptDescr (Flag GHCFlags)
forall a. [Char] -&gt; [[Char]] -&gt; ArgDescr a -&gt; [Char] -&gt; OptDescr a
</span><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc-trace&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><a href="Agda.Utils.GetOpt.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205672"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;instrument code to debug print trace of function calls&quot;</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621682205666"><span class="annot"><span class="annottext">dontCallGHC :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205666"><span class="hs-identifier hs-var hs-var">dontCallGHC</span></a></span></span><span> </span><span id="local-6989586621682205677"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205677"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205677"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621682205668"><span class="annot"><span class="annottext">ghcFlag :: [Char] -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205668"><span class="hs-identifier hs-var hs-var">ghcFlag</span></a></span></span><span> </span><span id="local-6989586621682205682"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205682"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span id="local-6989586621682205683"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205683"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205683"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682205683"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682205682"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621682205670"><span class="annot"><span class="annottext">strictData :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205670"><span class="hs-identifier hs-var hs-var">strictData</span></a></span></span><span>  </span><span id="local-6989586621682205688"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205688"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205688"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621682205671"><span class="annot"><span class="annottext">strict :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205671"><span class="hs-identifier hs-var hs-var">strict</span></a></span></span><span>      </span><span id="local-6989586621682205693"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205693"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205693"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-170"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-171"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621682205672"><span class="annot"><span class="annottext">trace :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621682205672"><span class="hs-identifier hs-var hs-var">trace</span></a></span></span><span>       </span><span id="local-6989586621682205698"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205698"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205698"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcTrace"><span class="hs-identifier hs-var">flagGhcTrace</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-type">withCompilerFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-175"></span><span id="withCompilerFlag"><span class="annot"><span class="annottext">withCompilerFlag :: [Char] -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var hs-var">withCompilerFlag</span></a></span></span><span> </span><span id="local-6989586621682205699"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205699"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621682205700"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205700"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205700"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall a. a -&gt; OptM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205700"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682205699"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; OptM GHCFlags
forall a. [Char] -&gt; OptM a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;only one compiler path allowed&quot;</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Option strings to activate the GHC backend.</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationStrings"><span class="hs-identifier hs-type">ghcInvocationStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span id="ghcInvocationStrings"><span class="annot"><span class="annottext">ghcInvocationStrings :: [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationStrings"><span class="hs-identifier hs-var hs-var">ghcInvocationStrings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptDescr (Flag GHCFlags) -&gt; [[Char]]
forall a. OptDescr a -&gt; [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optionStrings"><span class="hs-identifier hs-var">optionStrings</span></a></span><span> </span><span class="annot"><span class="annottext">OptDescr (Flag GHCFlags)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcInvocationFlag"><span class="hs-identifier hs-var">ghcInvocationFlag</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Get all flags that activate the given option.</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span id="local-6989586621682204252"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#optionStrings"><span class="hs-identifier hs-type">optionStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.GetOpt.html#OptDescr"><span class="hs-identifier hs-type">OptDescr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-187"></span><span id="optionStrings"><span class="annot"><span class="annottext">optionStrings :: forall a. OptDescr a -&gt; [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optionStrings"><span class="hs-identifier hs-var hs-var">optionStrings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.GetOpt.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span id="local-6989586621682205702"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205702"><span class="hs-identifier hs-var">short</span></a></span></span><span> </span><span id="local-6989586621682205703"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682205703"><span class="hs-identifier hs-var">long</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgDescr a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; [Char]) -&gt; [Char] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682205704"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682205704"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682205704"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205702"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682205703"><span class="hs-identifier hs-var">long</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">--- Context types ---</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">-- | Monads that can read @GHCOptions@</span></span><span>
</span><span id="line-192"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ReadGHCOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-var">ReadGHCOpts</span></a></span></span><span> </span><span id="local-6989586621682204256"><span class="annot"><a href="#local-6989586621682204256"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="askGhcOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682204256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682204259"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204259"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204259"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621682205714"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCOptions m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682204263"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204263"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204263"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621682205722"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCEnv m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; GHCOptions)
-&gt; ReaderT GHCOptions m GHCOptions -&gt; ReaderT GHCEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var">ghcEnvOpts</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682204196"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204196"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204196"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621682205729"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModuleEnv m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; GHCEnv)
-&gt; ReaderT GHCEnv m GHCOptions -&gt; ReaderT GHCModuleEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModEnv"><span class="hs-identifier hs-var">ghcModEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">data</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcModModuleEnv"><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcModMainFuncs"><span class="annot"><span class="annottext">GHCModule -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var hs-var">ghcModMainFuncs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- ^ The `main` function definition(s), if both the module is</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">--   the @IsMain@ module (root/focused) and a suitable `main`</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">--   function was defined.</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682204198"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204198"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621682205739"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModule m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m GHCOptions
-&gt; ReaderT GHCModule m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var">ghcModModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682204197"><span id="local-6989586621682205745"><span id="local-6989586621682205748"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204197"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204197"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621682205752"><span class="annot"><span class="annottext">askGHCModuleEnv :: ReaderT GHCModule m GHCModuleEnv
</span><a href="#local-6989586621682205752"><span class="hs-identifier hs-var hs-var hs-var">askGHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m GHCModuleEnv
-&gt; ReaderT GHCModule m GHCModuleEnv
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var">ghcModModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var">askGHCModuleEnv</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">data</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcDefUsesFloat"><span class="annot"><span class="annottext">GHCDefinition -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefUsesFloat"><span class="hs-identifier hs-var hs-var">ghcDefUsesFloat</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDecls"><span class="annot"><span class="annottext">GHCDefinition -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDecls"><span class="hs-identifier hs-var hs-var">ghcDefDecls</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDefinition"><span class="annot"><span class="annottext">GHCDefinition -&gt; Definition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDefinition"><span class="hs-identifier hs-var hs-var">ghcDefDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefMainDef"><span class="annot"><span class="annottext">GHCDefinition -&gt; Maybe MainFunctionDef
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefMainDef"><span class="hs-identifier hs-var hs-var">ghcDefMainDef</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefImports"><span class="annot"><span class="annottext">GHCDefinition -&gt; Set TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefImports"><span class="hs-identifier hs-var hs-var">ghcDefImports</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">--- Top-level compilation ---</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-type">ghcPreCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-229"></span><span id="ghcPreCompile"><span class="annot"><span class="annottext">ghcPreCompile :: GHCFlags -&gt; TCMT IO GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var hs-var">ghcPreCompile</span></a></span></span><span> </span><span id="local-6989586621682205760"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">TCMT IO (Maybe Cubical) -&gt; (Cubical -&gt; TCMT IO ()) -&gt; TCMT IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (Maybe a) -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Maybe.html#whenJustM"><span class="hs-identifier hs-var">whenJustM</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe Cubical)
forall (m :: * -&gt; *). HasOptions m =&gt; m (Maybe Cubical)
</span><a href="Agda.TypeChecking.Monad.Base.html#cubicalOption"><span class="hs-identifier hs-var">cubicalOption</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CWithoutGlue"><span class="hs-identifier hs-var">CWithoutGlue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCMT IO ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CErased"><span class="hs-identifier hs-var">CErased</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCMT IO ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CFull"><span class="hs-identifier hs-var">CFull</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCMT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCMT IO ()) -&gt; TypeError -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cubical -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#CubicalCompilationNotSupported"><span class="hs-identifier hs-var">CubicalCompilationNotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CFull"><span class="hs-identifier hs-var">CFull</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621682205768"><span class="annot"><a href="#local-6989586621682205768"><span class="hs-identifier hs-var">outDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO [Char]
forall (m :: * -&gt; *). HasOptions m =&gt; m [Char]
</span><a href="Agda.Compiler.Common.html#compileDir"><span class="hs-identifier hs-var">compileDir</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682205770"><span class="annot"><a href="#local-6989586621682205770"><span class="hs-identifier hs-var hs-var">ghcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-237"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">optGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCallGhc"><span class="hs-identifier hs-var">optGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-238"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcBin :: [Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcBin"><span class="hs-identifier hs-var">optGhcBin</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char] -&gt; [Char]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ghc&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcFlags :: [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcFlags"><span class="hs-identifier hs-var">optGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-240"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcCompileDir :: [Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205768"><span class="hs-identifier hs-var">outDir</span></a></span><span>
</span><span id="line-241"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var">optGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-242"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcStrict :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-243"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcTrace :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcTrace"><span class="hs-identifier hs-var">optGhcTrace</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcTrace"><span class="hs-identifier hs-var">flagGhcTrace</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621682205760"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-244"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621682205780"><span class="annot"><a href="#local-6989586621682205780"><span class="hs-identifier hs-var">mbool</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinBool"><span class="hs-identifier hs-type">builtinBool</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621682205782"><span class="annot"><a href="#local-6989586621682205782"><span class="hs-identifier hs-var">mtrue</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-type">builtinTrue</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621682205784"><span class="annot"><a href="#local-6989586621682205784"><span class="hs-identifier hs-var">mfalse</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-type">builtinFalse</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621682205786"><span class="annot"><a href="#local-6989586621682205786"><span class="hs-identifier hs-var">mlist</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinList"><span class="hs-identifier hs-type">builtinList</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621682205788"><span class="annot"><a href="#local-6989586621682205788"><span class="hs-identifier hs-var">mnil</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-type">builtinNil</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621682205790"><span class="annot"><a href="#local-6989586621682205790"><span class="hs-identifier hs-var">mcons</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-type">builtinCons</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621682205792"><span class="annot"><a href="#local-6989586621682205792"><span class="hs-identifier hs-var">mmaybe</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinMaybe"><span class="hs-identifier hs-type">builtinMaybe</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621682205794"><span class="annot"><a href="#local-6989586621682205794"><span class="hs-identifier hs-var">mnothing</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinNothing"><span class="hs-identifier hs-type">builtinNothing</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621682205796"><span class="annot"><a href="#local-6989586621682205796"><span class="hs-identifier hs-var">mjust</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinJust"><span class="hs-identifier hs-type">builtinJust</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621682205798"><span class="annot"><a href="#local-6989586621682205798"><span class="hs-identifier hs-var">mnat</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinNat"><span class="hs-identifier hs-type">builtinNat</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621682205800"><span class="annot"><a href="#local-6989586621682205800"><span class="hs-identifier hs-var">minteger</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinInteger"><span class="hs-identifier hs-type">builtinInteger</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621682205802"><span class="annot"><a href="#local-6989586621682205802"><span class="hs-identifier hs-var">mword64</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinWord64"><span class="hs-identifier hs-type">builtinWord64</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621682205804"><span class="annot"><a href="#local-6989586621682205804"><span class="hs-identifier hs-var">minf</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinInf"><span class="hs-identifier hs-type">builtinInf</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621682205806"><span class="annot"><a href="#local-6989586621682205806"><span class="hs-identifier hs-var">msharp</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinSharp"><span class="hs-identifier hs-type">builtinSharp</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621682205808"><span class="annot"><a href="#local-6989586621682205808"><span class="hs-identifier hs-var">mflat</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFlat"><span class="hs-identifier hs-type">builtinFlat</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621682205810"><span class="annot"><a href="#local-6989586621682205810"><span class="hs-identifier hs-var">minterval</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-type">builtinInterval</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621682205812"><span class="annot"><a href="#local-6989586621682205812"><span class="hs-identifier hs-var">mizero</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIZero"><span class="hs-identifier hs-type">builtinIZero</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621682205814"><span class="annot"><a href="#local-6989586621682205814"><span class="hs-identifier hs-var">mione</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-type">builtinIOne</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621682205816"><span class="annot"><a href="#local-6989586621682205816"><span class="hs-identifier hs-var">misone</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIsOne"><span class="hs-identifier hs-type">builtinIsOne</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621682205818"><span class="annot"><a href="#local-6989586621682205818"><span class="hs-identifier hs-var">mitisone</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinItIsOne"><span class="hs-identifier hs-type">builtinItIsOne</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621682205820"><span class="annot"><a href="#local-6989586621682205820"><span class="hs-identifier hs-var">misone1</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIsOne1"><span class="hs-identifier hs-type">builtinIsOne1</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621682205822"><span class="annot"><a href="#local-6989586621682205822"><span class="hs-identifier hs-var">misone2</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIsOne2"><span class="hs-identifier hs-type">builtinIsOne2</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621682205824"><span class="annot"><a href="#local-6989586621682205824"><span class="hs-identifier hs-var">misoneempty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIsOneEmpty"><span class="hs-identifier hs-type">builtinIsOneEmpty</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621682205826"><span class="annot"><a href="#local-6989586621682205826"><span class="hs-identifier hs-var">mpathp</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinPathP"><span class="hs-identifier hs-type">builtinPathP</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621682205828"><span class="annot"><a href="#local-6989586621682205828"><span class="hs-identifier hs-var">msub</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinSub"><span class="hs-identifier hs-type">builtinSub</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621682205830"><span class="annot"><a href="#local-6989586621682205830"><span class="hs-identifier hs-var">msubin</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinSubIn"><span class="hs-identifier hs-type">builtinSubIn</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621682205832"><span class="annot"><a href="#local-6989586621682205832"><span class="hs-identifier hs-var">istcbuiltin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621682205833"><span class="annot"><a href="#local-6989586621682205833"><span class="hs-identifier hs-var">builtins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMReturn"><span class="hs-identifier hs-type">builtinAgdaTCMReturn</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMBind"><span class="hs-identifier hs-type">builtinAgdaTCMBind</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMUnify"><span class="hs-identifier hs-type">builtinAgdaTCMUnify</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMTypeError"><span class="hs-identifier hs-type">builtinAgdaTCMTypeError</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMInferType"><span class="hs-identifier hs-type">builtinAgdaTCMInferType</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCheckType"><span class="hs-identifier hs-type">builtinAgdaTCMCheckType</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMNormalise"><span class="hs-identifier hs-type">builtinAgdaTCMNormalise</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMReduce"><span class="hs-identifier hs-type">builtinAgdaTCMReduce</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCatchError"><span class="hs-identifier hs-type">builtinAgdaTCMCatchError</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMQuoteTerm"><span class="hs-identifier hs-type">builtinAgdaTCMQuoteTerm</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMUnquoteTerm"><span class="hs-identifier hs-type">builtinAgdaTCMUnquoteTerm</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMQuoteOmegaTerm"><span class="hs-identifier hs-type">builtinAgdaTCMQuoteOmegaTerm</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetContext"><span class="hs-identifier hs-type">builtinAgdaTCMGetContext</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMExtendContext"><span class="hs-identifier hs-type">builtinAgdaTCMExtendContext</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMInContext"><span class="hs-identifier hs-type">builtinAgdaTCMInContext</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMFreshName"><span class="hs-identifier hs-type">builtinAgdaTCMFreshName</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDeclareDef"><span class="hs-identifier hs-type">builtinAgdaTCMDeclareDef</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDeclarePostulate"><span class="hs-identifier hs-type">builtinAgdaTCMDeclarePostulate</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDeclareData"><span class="hs-identifier hs-type">builtinAgdaTCMDeclareData</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDefineData"><span class="hs-identifier hs-type">builtinAgdaTCMDefineData</span></a></span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDefineFun"><span class="hs-identifier hs-type">builtinAgdaTCMDefineFun</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetType"><span class="hs-identifier hs-type">builtinAgdaTCMGetType</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetDefinition"><span class="hs-identifier hs-type">builtinAgdaTCMGetDefinition</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMBlock"><span class="hs-identifier hs-type">builtinAgdaTCMBlock</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCommit"><span class="hs-identifier hs-type">builtinAgdaTCMCommit</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMIsMacro"><span class="hs-identifier hs-type">builtinAgdaTCMIsMacro</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithNormalisation"><span class="hs-identifier hs-type">builtinAgdaTCMWithNormalisation</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithReconstructed"><span class="hs-identifier hs-type">builtinAgdaTCMWithReconstructed</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithExpandLast"><span class="hs-identifier hs-type">builtinAgdaTCMWithExpandLast</span></a></span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithReduceDefs"><span class="hs-identifier hs-type">builtinAgdaTCMWithReduceDefs</span></a></span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMAskNormalisation"><span class="hs-identifier hs-type">builtinAgdaTCMAskNormalisation</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMAskReconstructed"><span class="hs-identifier hs-type">builtinAgdaTCMAskReconstructed</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMAskExpandLast"><span class="hs-identifier hs-type">builtinAgdaTCMAskExpandLast</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMAskReduceDefs"><span class="hs-identifier hs-type">builtinAgdaTCMAskReduceDefs</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMFormatErrorParts"><span class="hs-identifier hs-type">builtinAgdaTCMFormatErrorParts</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDebugPrint"><span class="hs-identifier hs-type">builtinAgdaTCMDebugPrint</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMNoConstraints"><span class="hs-identifier hs-type">builtinAgdaTCMNoConstraints</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWorkOnTypes"><span class="hs-identifier hs-type">builtinAgdaTCMWorkOnTypes</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMRunSpeculative"><span class="hs-identifier hs-type">builtinAgdaTCMRunSpeculative</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMExec"><span class="hs-identifier hs-type">builtinAgdaTCMExec</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCheckFromString"><span class="hs-identifier hs-type">builtinAgdaTCMCheckFromString</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetInstances"><span class="hs-identifier hs-type">builtinAgdaTCMGetInstances</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMSolveInstances"><span class="hs-identifier hs-type">builtinAgdaTCMSolveInstances</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMPragmaForeign"><span class="hs-identifier hs-type">builtinAgdaTCMPragmaForeign</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMPragmaCompile"><span class="hs-identifier hs-type">builtinAgdaTCMPragmaCompile</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaBlocker"><span class="hs-identifier hs-type">builtinAgdaBlocker</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaBlockerAll"><span class="hs-identifier hs-type">builtinAgdaBlockerAll</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaBlockerAny"><span class="hs-identifier hs-type">builtinAgdaBlockerAny</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinAgdaBlockerMeta"><span class="hs-identifier hs-type">builtinAgdaBlockerMeta</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashSet.member</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">HashSet.fromList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682205833"><span class="hs-identifier hs-type">builtins</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682205924"><span class="annot"><a href="#local-6989586621682205924"><span class="hs-identifier hs-var hs-var">defArity</span></a></span></span><span> </span><span id="local-6989586621682205925"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682205925"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Nat
</span><a href="Agda.Syntax.Internal.html#arity"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Nat) -&gt; (Definition -&gt; Type) -&gt; Definition -&gt; Nat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Nat) -&gt; f Definition -&gt; f Nat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; f Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682205925"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621682205931"><span class="annot"><a href="#local-6989586621682205931"><span class="hs-identifier hs-var">listArity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621682205924"><span class="hs-identifier hs-type">defArity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682205786"><span class="hs-identifier hs-type">mlist</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621682205933"><span class="annot"><a href="#local-6989586621682205933"><span class="hs-identifier hs-var">maybeArity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621682205924"><span class="hs-identifier hs-type">defArity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682205792"><span class="hs-identifier hs-type">mmaybe</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var">ghcEnvOpts</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205770"><span class="hs-identifier hs-type">ghcOpts</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvBool"><span class="hs-identifier hs-var">ghcEnvBool</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205780"><span class="hs-identifier hs-type">mbool</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvTrue"><span class="hs-identifier hs-var">ghcEnvTrue</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205782"><span class="hs-identifier hs-type">mtrue</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFalse"><span class="hs-identifier hs-var">ghcEnvFalse</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205784"><span class="hs-identifier hs-type">mfalse</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybe"><span class="hs-identifier hs-var">ghcEnvMaybe</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205792"><span class="hs-identifier hs-type">mmaybe</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNothing"><span class="hs-identifier hs-var">ghcEnvNothing</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205794"><span class="hs-identifier hs-type">mnothing</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvJust"><span class="hs-identifier hs-var">ghcEnvJust</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205796"><span class="hs-identifier hs-type">mjust</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvList"><span class="hs-identifier hs-var">ghcEnvList</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205786"><span class="hs-identifier hs-type">mlist</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNil"><span class="hs-identifier hs-var">ghcEnvNil</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205788"><span class="hs-identifier hs-type">mnil</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvCons"><span class="hs-identifier hs-var">ghcEnvCons</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205790"><span class="hs-identifier hs-type">mcons</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNat"><span class="hs-identifier hs-var">ghcEnvNat</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205798"><span class="hs-identifier hs-type">mnat</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInteger"><span class="hs-identifier hs-var">ghcEnvInteger</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205800"><span class="hs-identifier hs-type">minteger</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvWord64"><span class="hs-identifier hs-var">ghcEnvWord64</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205802"><span class="hs-identifier hs-type">mword64</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInf"><span class="hs-identifier hs-var">ghcEnvInf</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205804"><span class="hs-identifier hs-type">minf</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSharp"><span class="hs-identifier hs-var">ghcEnvSharp</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205806"><span class="hs-identifier hs-type">msharp</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFlat"><span class="hs-identifier hs-var">ghcEnvFlat</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205808"><span class="hs-identifier hs-type">mflat</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInterval"><span class="hs-identifier hs-var">ghcEnvInterval</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205810"><span class="hs-identifier hs-type">minterval</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIZero"><span class="hs-identifier hs-var">ghcEnvIZero</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205812"><span class="hs-identifier hs-type">mizero</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIOne"><span class="hs-identifier hs-var">ghcEnvIOne</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205814"><span class="hs-identifier hs-type">mione</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne"><span class="hs-identifier hs-var">ghcEnvIsOne</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205816"><span class="hs-identifier hs-type">misone</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvItIsOne"><span class="hs-identifier hs-var">ghcEnvItIsOne</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205818"><span class="hs-identifier hs-type">mitisone</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne1"><span class="hs-identifier hs-var">ghcEnvIsOne1</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205820"><span class="hs-identifier hs-type">misone1</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne2"><span class="hs-identifier hs-var">ghcEnvIsOne2</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205822"><span class="hs-identifier hs-type">misone2</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOneEmpty"><span class="hs-identifier hs-var">ghcEnvIsOneEmpty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205824"><span class="hs-identifier hs-type">misoneempty</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvPathP"><span class="hs-identifier hs-var">ghcEnvPathP</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205826"><span class="hs-identifier hs-type">mpathp</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSub"><span class="hs-identifier hs-var">ghcEnvSub</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205828"><span class="hs-identifier hs-type">msub</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSubIn"><span class="hs-identifier hs-var">ghcEnvSubIn</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205830"><span class="hs-identifier hs-type">msubin</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsTCBuiltin"><span class="hs-identifier hs-var">ghcEnvIsTCBuiltin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205832"><span class="hs-identifier hs-type">istcbuiltin</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvListArity"><span class="hs-identifier hs-var">ghcEnvListArity</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205931"><span class="hs-identifier hs-type">listArity</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybeArity"><span class="hs-identifier hs-var">ghcEnvMaybeArity</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682205933"><span class="hs-identifier hs-type">maybeArity</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-type">ghcPostCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span id="ghcPostCompile"><span class="annot"><span class="annottext">ghcPostCompile :: GHCEnv -&gt; IsMain -&gt; Map TopLevelModuleName GHCModule -&gt; TCMT IO ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var hs-var">ghcPostCompile</span></a></span></span><span> </span><span id="local-6989586621682205964"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682205964"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621682205965"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621682205965"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621682205966"><span class="annot"><span class="annottext">Map TopLevelModuleName GHCModule
</span><a href="#local-6989586621682205966"><span class="hs-identifier hs-var">mods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-comment">-- FIXME: @curMName@ and @curIF@ are evil TCM state, but there does not appear to be</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-comment">--------- another way to retrieve the compilation root (&quot;main&quot; module or interaction focused).</span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621682205967"><span class="annot"><a href="#local-6989586621682205967"><span class="hs-identifier hs-var">rootModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO TopLevelModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-comment">-- Mario, 2024-10-16: cannot trigger this error:</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-comment">-- genericError $ &quot;Module &quot; &lt;&gt; prettyShow rootModuleName &lt;&gt; &quot; was not compiled!&quot;</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682205969"><span class="annot"><a href="#local-6989586621682205969"><span class="hs-identifier hs-var hs-var">rootModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCModule
-&gt; TopLevelModuleName
-&gt; Map TopLevelModuleName GHCModule
-&gt; GHCModule
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">Map.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">GHCModule
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682205967"><span class="hs-identifier hs-var">rootModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">Map TopLevelModuleName GHCModule
</span><a href="#local-6989586621682205966"><span class="hs-identifier hs-var">mods</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621682205969"><span class="hs-identifier hs-type">rootModule</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-type">copyRTEModules</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-type">callGHC</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">--- Module compilation ---</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-type">ghcPreModule</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Are we looking at the main module?</span></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Path to the @.agdai@ file.</span></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Recompile"><span class="hs-identifier hs-type">Recompile</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ Could we confirm the existence of a main function?</span></span><span>
</span><span id="line-389"></span><span id="ghcPreModule"><span class="annot"><span class="annottext">ghcPreModule :: GHCEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; Maybe [Char]
-&gt; TCMT IO (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var hs-var">ghcPreModule</span></a></span></span><span> </span><span id="local-6989586621682205974"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682205974"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span id="local-6989586621682205975"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621682205975"><span class="hs-identifier hs-var">isMain</span></a></span></span><span> </span><span id="local-6989586621682205976"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682205976"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682205977"><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621682205977"><span class="hs-identifier hs-var">mifile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682205978"><span class="annot"><span class="annottext">check :: ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205978"><span class="hs-identifier hs-var hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621682205980"><span class="hs-identifier hs-var">uptodate</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall {menv}. ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621682205981"><span class="hs-identifier hs-var">noComp</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205982"><span class="hs-identifier hs-var">yesComp</span></a></span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621682205983"><span class="annot"><a href="#local-6989586621682205983"><span class="hs-identifier hs-var">cubical</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Maybe Cubical)
forall (m :: * -&gt; *). HasOptions m =&gt; m (Maybe Cubical)
</span><a href="Agda.TypeChecking.Monad.Base.html#cubicalOption"><span class="hs-identifier hs-var">cubicalOption</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682205983"><span class="hs-identifier hs-type">cubical</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-comment">-- Code that uses --cubical is not compiled.</span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CFull"><span class="hs-identifier hs-var">CFull</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall {menv}. ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621682205981"><span class="hs-identifier hs-var">noComp</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CErased"><span class="hs-identifier hs-var">CErased</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205978"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CWithoutGlue"><span class="hs-identifier hs-var">CWithoutGlue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205978"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><span class="annottext">Maybe Cubical
</span><span class="hs-identifier hs-var">Nothing</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205978"><span class="hs-identifier hs-var">check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; GHCModuleEnv -&gt; TCMT IO (Recompile GHCModuleEnv GHCModule)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; HsModuleEnv -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682205974"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; Bool -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-var">HsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682205976"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621682205975"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="annot"><span class="annottext">IsMain -&gt; IsMain -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsMain
</span><a href="Agda.Syntax.Common.html#IsMain"><span class="hs-identifier hs-var">IsMain</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621682205980"><span class="annot"><span class="annottext">uptodate :: ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621682205980"><span class="hs-identifier hs-var hs-var">uptodate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621682205977"><span class="hs-identifier hs-var">mifile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall a. a -&gt; ReaderT GHCModuleEnv TCM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-402"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682205987"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205987"><span class="hs-identifier hs-var">ifile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall a. IO a -&gt; ReaderT GHCModuleEnv TCM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool)
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
-&gt; ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO Bool
</span><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier hs-var">isNewerThan</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char] -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM [Char]
-&gt; ReaderT GHCModuleEnv TCM ([Char] -&gt; IO Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM [Char]
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var">curOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ([Char] -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM [Char]
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
forall a b.
ReaderT GHCModuleEnv TCM (a -&gt; b)
-&gt; ReaderT GHCModuleEnv TCM a -&gt; ReaderT GHCModuleEnv TCM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReaderT GHCModuleEnv TCM [Char]
forall a. a -&gt; ReaderT GHCModuleEnv TCM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682205987"><span class="hs-identifier hs-var">ifile</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621682205991"><span class="annot"><span class="annottext">ifileDesc :: [Char]
</span><a href="#local-6989586621682205991"><span class="hs-identifier hs-var hs-var">ifileDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char] -&gt; [Char]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(memory)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621682205977"><span class="hs-identifier hs-var">mifile</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621682205981"><span class="annot"><span class="annottext">noComp :: ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621682205981"><span class="hs-identifier hs-var hs-var">noComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; [Char] -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; [Char] -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; (TopLevelModuleName -&gt; [Char])
-&gt; TopLevelModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; : no compilation is needed.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char])
-&gt; (TopLevelModuleName -&gt; [Char]) -&gt; TopLevelModuleName -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(TopLevelModuleName -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; ReaderT GHCModuleEnv TCM TopLevelModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM TopLevelModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span id="local-6989586621682206027"><span class="annot"><a href="#local-6989586621682206027"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM GHCModuleEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-409"></span><span>      </span><span id="local-6989586621682206028"><span class="annot"><a href="#local-6989586621682206028"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-type">ifM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-type">curIsMainModule</span></a></span><span>
</span><span id="line-410"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#mainFunctionDefs"><span class="hs-identifier hs-type">mainFunctionDefs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-type">curIF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206027"><span class="hs-identifier hs-type">menv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206028"><span class="hs-identifier hs-type">mainDefs</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621682205982"><span class="annot"><span class="annottext">yesComp :: ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621682205982"><span class="hs-identifier hs-var hs-var">yesComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>      </span><span id="local-6989586621682206033"><span class="annot"><a href="#local-6989586621682206033"><span class="hs-identifier hs-var">m</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(TopLevelModuleName -&gt; [Char])
-&gt; ReaderT GHCModuleEnv TCM TopLevelModuleName
-&gt; ReaderT GHCModuleEnv TCM [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM TopLevelModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span id="local-6989586621682206034"><span class="annot"><a href="#local-6989586621682206034"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-type">curOutFile</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#alwaysReportSLn"><span class="hs-identifier hs-type">alwaysReportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#repl"><span class="hs-identifier hs-type">repl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682205991"><span class="hs-identifier hs-type">ifileDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206034"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-string">&quot;Compiling &lt;&lt;0&gt;&gt; in &lt;&lt;1&gt;&gt; to &lt;&lt;2&gt;&gt;&quot;</span></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Recompile"><span class="hs-identifier hs-type">Recompile</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-type">ghcPostModule</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Are we looking at the main module?</span></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Compiled module content.</span></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span>
</span><span id="line-427"></span><span id="ghcPostModule"><span class="annot"><span class="annottext">ghcPostModule :: GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; TopLevelModuleName
-&gt; [GHCDefinition]
-&gt; TCMT IO GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var hs-var">ghcPostModule</span></a></span></span><span> </span><span id="local-6989586621682206038"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206038"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span id="local-6989586621682206039"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682206039"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621682206040"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621682206040"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621682206041"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682206041"><span class="hs-identifier hs-var">_moduleName</span></a></span></span><span> </span><span id="local-6989586621682206042"><span class="annot"><span class="annottext">[GHCDefinition]
</span><a href="#local-6989586621682206042"><span class="hs-identifier hs-var">ghcDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621682206043"><span class="annot"><a href="#local-6989586621682206043"><span class="hs-identifier hs-var">builtinThings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; BuiltinThings) -&gt; TCMT IO BuiltinThings
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; BuiltinThings
</span><a href="Agda.TypeChecking.Monad.Base.html#stBuiltinThings"><span class="hs-identifier hs-var">stBuiltinThings</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621682206046"><span class="annot"><a href="#local-6989586621682206046"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-type">curIF</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-comment">-- Accumulate all of the modules, definitions, declarations, etc.</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682206047"><span class="annot"><a href="#local-6989586621682206047"><span class="hs-identifier hs-var">usedFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206048"><span class="annot"><a href="#local-6989586621682206048"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206049"><span class="annot"><a href="#local-6989586621682206049"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206050"><span class="annot"><a href="#local-6989586621682206050"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206051"><span class="annot"><a href="#local-6989586621682206051"><span class="hs-identifier hs-var">usedModules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mconcat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682206042"><span class="hs-identifier hs-type">ghcDefs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&amp;&gt;</span></span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span> </span><span id="local-6989586621682206053"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621682206053"><span class="hs-identifier hs-var">useFloat'</span></a></span></span><span> </span><span id="local-6989586621682206054"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682206054"><span class="hs-identifier hs-var">decls'</span></a></span></span><span> </span><span id="local-6989586621682206055"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206055"><span class="hs-identifier hs-var">def'</span></a></span></span><span> </span><span id="local-6989586621682206056"><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621682206056"><span class="hs-identifier hs-var">md'</span></a></span></span><span> </span><span id="local-6989586621682206057"><span class="annot"><span class="annottext">Set TopLevelModuleName
</span><a href="#local-6989586621682206057"><span class="hs-identifier hs-var">imps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621682206053"><span class="hs-identifier hs-var">useFloat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682206054"><span class="hs-identifier hs-var">decls'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206055"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef -&gt; [MainFunctionDef]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621682206056"><span class="hs-identifier hs-var">md'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TopLevelModuleName
</span><a href="#local-6989586621682206057"><span class="hs-identifier hs-var">imps'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-comment">-- Builtins used in the definitions.</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621682206059"><span class="annot"><a href="#local-6989586621682206059"><span class="hs-identifier hs-var hs-var">actuallyUsedBuiltins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinThings -&gt; [Definition] -&gt; Set SomeBuiltin
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#usedBuiltins"><span class="hs-identifier hs-var">usedBuiltins</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinThings
</span><a href="#local-6989586621682206043"><span class="hs-identifier hs-var">builtinThings</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621682206049"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621682206061"><span class="annot"><a href="#local-6989586621682206061"><span class="hs-identifier hs-var hs-var">useBuiltinFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeBuiltin -&gt; Bool) -&gt; [SomeBuiltin] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeBuiltin -&gt; Set SomeBuiltin -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set SomeBuiltin
</span><a href="#local-6989586621682206059"><span class="hs-identifier hs-var">actuallyUsedBuiltins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SomeBuiltin]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#floatBuiltins"><span class="hs-identifier hs-var">floatBuiltins</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621682206065"><span class="annot"><a href="#local-6989586621682206065"><span class="hs-identifier hs-var hs-var">useBuiltinChar</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeBuiltin -&gt; Bool) -&gt; [SomeBuiltin] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeBuiltin -&gt; Set SomeBuiltin -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set SomeBuiltin
</span><a href="#local-6989586621682206059"><span class="hs-identifier hs-var">actuallyUsedBuiltins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SomeBuiltin]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#charBuiltins"><span class="hs-identifier hs-var">charBuiltins</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-comment">-- Get content of FOREIGN pragmas.</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682206067"><span class="annot"><a href="#local-6989586621682206067"><span class="hs-identifier hs-var">headerPragmas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206068"><span class="annot"><a href="#local-6989586621682206068"><span class="hs-identifier hs-var">hsImps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206069"><span class="annot"><a href="#local-6989586621682206069"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#foreignHaskell"><span class="hs-identifier hs-type">foreignHaskell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206046"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-comment">-- MAlonzo.* imports</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><a href="#local-6989586621682206071"><span class="hs-identifier hs-type">mazImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>    </span><span id="local-6989586621682206071"><span class="annot"><a href="#local-6989586621682206071"><span class="hs-identifier hs-var hs-var">mazImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[ImportDecl]] -&gt; [ImportDecl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#rteImports"><span class="hs-identifier hs-var">rteImports</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var">mazRTEFloatImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621682206047"><span class="hs-identifier hs-var">usedFloat</span></a></span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; UsesFloat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206061"><span class="hs-identifier hs-var">useBuiltinFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TopLevelModuleName -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#moduleImports"><span class="hs-identifier hs-var">moduleImports</span></a></span><span> </span><span class="annot"><span class="annottext">Set TopLevelModuleName
</span><a href="#local-6989586621682206051"><span class="hs-identifier hs-var">usedModules</span></a></span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-comment">-- Other imports, from FOREIGN pragmas and builtins.</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-comment">-- The needed Haskell modules might be duplicated by FOREIGN imports</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-comment">-- so we render them as strings and merge them with the latter,</span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-comment">-- to remove duplicates.</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="#local-6989586621682206077"><span class="hs-identifier hs-type">haskellImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#GHCImport"><span class="hs-identifier hs-type">GHCImport</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621682206077"><span class="annot"><a href="#local-6989586621682206077"><span class="hs-identifier hs-var hs-var">haskellImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set [Char] -&gt; [[Char]]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span> </span><span class="annot"><span class="annottext">(Set [Char] -&gt; [[Char]]) -&gt; Set [Char] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set [Char] -&gt; Set [Char] -&gt; Set [Char]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set [Char]
</span><a href="#local-6989586621682206068"><span class="hs-identifier hs-var">hsImps</span></a></span><span> </span><span class="annot"><span class="annottext">(Set [Char] -&gt; Set [Char]) -&gt; Set [Char] -&gt; Set [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; Set [Char]
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; Set [Char]) -&gt; [[Char]] -&gt; Set [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ImportDecl -&gt; [Char]) -&gt; [ImportDecl] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ImportDecl -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">([ImportDecl] -&gt; [[Char]]) -&gt; [ImportDecl] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[ImportDecl]] -&gt; [ImportDecl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsImportDebugTrace"><span class="hs-identifier hs-var">hsImportDebugTrace</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcTrace"><span class="hs-identifier hs-var">optGhcTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GHCEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var">ghcEnvOpts</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206038"><span class="hs-identifier hs-var">cenv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#qualifiedImport"><span class="hs-identifier hs-var">HS.qualifiedImport</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ImportDecl) -&gt; ModuleName -&gt; ImportDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Data.Char&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206065"><span class="hs-identifier hs-var">useBuiltinChar</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#qualifiedImport"><span class="hs-identifier hs-var">HS.qualifiedImport</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ImportDecl) -&gt; ModuleName -&gt; ImportDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Data.Text&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621682206039"><span class="hs-identifier hs-type">menv</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621682206086"><span class="annot"><a href="#local-6989586621682206086"><span class="hs-identifier hs-var">hsModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-type">curHsMod</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-type">writeModule</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><a href="#local-6989586621682206086"><span class="hs-identifier hs-type">hsModuleName</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#OtherPragma"><span class="hs-identifier hs-type">HS.OtherPragma</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.toAscList</span></span><span> </span><span class="annot"><a href="#local-6989586621682206067"><span class="hs-identifier hs-type">headerPragmas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-comment">-- The MAlonzo.Code modules make proper import declarations in the AST.</span><span>
</span><span id="line-470"></span><span>      </span><span class="annot"><a href="#local-6989586621682206071"><span class="hs-identifier hs-type">mazImports</span></a></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-comment">-- The other imports are already rendered to strings.</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDecl"><span class="hs-identifier hs-type">fakeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206077"><span class="hs-identifier hs-type">haskellImports</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206069"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206048"><span class="hs-identifier hs-type">decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206039"><span class="hs-identifier hs-type">menv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206050"><span class="hs-identifier hs-type">mainDefs</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- Imports ---------------------------------------------------------------</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="annot"><span class="hs-comment">-- | Imports for the runtime environment (RTE).</span></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#rteImports"><span class="hs-identifier hs-type">rteImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span id="rteImports"><span class="annot"><span class="annottext">rteImports :: [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#rteImports"><span class="hs-identifier hs-var hs-var">rteImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621682206092"><span class="hs-identifier hs-var">unqualRTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#qualifiedImport"><span class="hs-identifier hs-var">HS.qualifiedImport</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="#local-6989586621682206092"><span class="hs-identifier hs-type">unqualRTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621682206092"><span class="annot"><span class="annottext">unqualRTE :: ImportDecl
</span><a href="#local-6989586621682206092"><span class="hs-identifier hs-var hs-var">unqualRTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Bool, [ImportSpec]) -&gt; ImportDecl)
-&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec]))
-&gt; (Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ImportSpec] -&gt; (Bool, [ImportSpec]))
-&gt; [ImportSpec] -&gt; (Bool, [ImportSpec])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ImportSpec) -&gt; [[Char]] -&gt; [ImportSpec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ImportSpec
</span><a href="Agda.Utils.Haskell.Syntax.html#IVar"><span class="hs-identifier hs-var">HS.IVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ImportSpec) -&gt; ([Char] -&gt; Name) -&gt; [Char] -&gt; ImportSpec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [ImportSpec]) -&gt; [[Char]] -&gt; [ImportSpec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-var">mazCoerceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-var">mazAnyTypeName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="annottext">(TPrim -&gt; [Char]) -&gt; [TPrim] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; [Char]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd"><span class="hs-identifier hs-var">T.PAdd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub"><span class="hs-identifier hs-var">T.PSub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul"><span class="hs-identifier hs-var">T.PMul</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot"><span class="hs-identifier hs-var">T.PQuot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem"><span class="hs-identifier hs-var">T.PRem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PGeq"><span class="hs-identifier hs-var">T.PGeq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt"><span class="hs-identifier hs-var">T.PLt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEqI"><span class="hs-identifier hs-var">T.PEqI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-488"></span><span>       </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd64"><span class="hs-identifier hs-var">T.PAdd64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub64"><span class="hs-identifier hs-var">T.PSub64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul64"><span class="hs-identifier hs-var">T.PMul64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot64"><span class="hs-identifier hs-var">T.PQuot64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem64"><span class="hs-identifier hs-var">T.PRem64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt64"><span class="hs-identifier hs-var">T.PLt64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEq64"><span class="hs-identifier hs-var">T.PEq64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-489"></span><span>       </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PITo64"><span class="hs-identifier hs-var">T.PITo64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#P64ToI"><span class="hs-identifier hs-var">T.P64ToI</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Excludes T.PEqF, which is defined in MAlonzo.RTE.Float</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">-- | Imports of the compiled Agda modules, ordered alphabetically.</span></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#moduleImports"><span class="hs-identifier hs-type">moduleImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span id="moduleImports"><span class="annot"><span class="annottext">moduleImports :: Set TopLevelModuleName -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#moduleImports"><span class="hs-identifier hs-var hs-var">moduleImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ImportDecl) -&gt; [[Char]] -&gt; [ImportDecl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#qualifiedImport"><span class="hs-identifier hs-var">HS.qualifiedImport</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ImportDecl)
-&gt; ([Char] -&gt; ModuleName) -&gt; [Char] -&gt; ImportDecl
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod%27"><span class="hs-identifier hs-var">mazMod'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [ImportDecl])
-&gt; (Set TopLevelModuleName -&gt; [[Char]])
-&gt; Set TopLevelModuleName
-&gt; [ImportDecl]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]])
-&gt; (Set TopLevelModuleName -&gt; [[Char]])
-&gt; Set TopLevelModuleName
-&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TopLevelModuleName -&gt; [Char]) -&gt; [TopLevelModuleName] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">([TopLevelModuleName] -&gt; [[Char]])
-&gt; (Set TopLevelModuleName -&gt; [TopLevelModuleName])
-&gt; Set TopLevelModuleName
-&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set TopLevelModuleName -&gt; [TopLevelModuleName]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.elems</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="annot"><span class="hs-comment">-- | Should we import @MAlonzo.RTE.Float@?</span></span><span>
</span><span id="line-497"></span><span class="hs-keyword">newtype</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682206122"><span id="local-6989586621682206126"><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; Bool
(UsesFloat -&gt; UsesFloat -&gt; Bool)
-&gt; (UsesFloat -&gt; UsesFloat -&gt; Bool) -&gt; Eq UsesFloat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: UsesFloat -&gt; UsesFloat -&gt; Bool
== :: UsesFloat -&gt; UsesFloat -&gt; Bool
$c/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206133"><span id="local-6989586621682206138"><span id="local-6989586621682206142"><span class="annot"><span class="annottext">Nat -&gt; UsesFloat -&gt; [Char] -&gt; [Char]
[UsesFloat] -&gt; [Char] -&gt; [Char]
UsesFloat -&gt; [Char]
(Nat -&gt; UsesFloat -&gt; [Char] -&gt; [Char])
-&gt; (UsesFloat -&gt; [Char])
-&gt; ([UsesFloat] -&gt; [Char] -&gt; [Char])
-&gt; Show UsesFloat
forall a.
(Nat -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Nat -&gt; UsesFloat -&gt; [Char] -&gt; [Char]
showsPrec :: Nat -&gt; UsesFloat -&gt; [Char] -&gt; [Char]
$cshow :: UsesFloat -&gt; [Char]
show :: UsesFloat -&gt; [Char]
$cshowList :: [UsesFloat] -&gt; [Char] -&gt; [Char]
showList :: [UsesFloat] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-type">YesFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-500"></span><span class="hs-keyword">pattern</span><span> </span><span id="YesFloat"><span id="%24mYesFloat"><span id="%24bYesFloat"><span class="annot"><span class="annottext">$mYesFloat :: forall {r}. UsesFloat -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bYesFloat :: UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var hs-var hs-var">YesFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-type">NoFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-503"></span><span class="hs-keyword">pattern</span><span> </span><span id="NoFloat"><span id="%24mNoFloat"><span id="%24bNoFloat"><span class="annot"><span class="annottext">$mNoFloat :: forall {r}. UsesFloat -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bNoFloat :: UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-var hs-var hs-var">NoFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682206154"><span id="local-6989586621682206157"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621682206162"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206162"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682206163"><span class="annot"><span class="annottext">&lt;&gt; :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621682206164"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206164"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206162"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206164"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682206171"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621682206174"><span class="annot"><span class="annottext">mempty :: UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-var">NoFloat</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span id="local-6989586621682206176"><span class="annot"><span class="annottext">mappend :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; UsesFloat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-type">mazRTEFloatImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-513"></span><span id="mazRTEFloatImport"><span class="annot"><span class="annottext">mazRTEFloatImport :: UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var hs-var">mazRTEFloatImport</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621682206177"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206177"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#qualifiedImport"><span class="hs-identifier hs-var">HS.qualifiedImport</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206177"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsImportDebugTrace"><span class="hs-identifier hs-type">hsImportDebugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-516"></span><span id="hsImportDebugTrace"><span class="annot"><span class="annottext">hsImportDebugTrace :: ImportDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsImportDebugTrace"><span class="hs-identifier hs-var hs-var">hsImportDebugTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">importModule :: ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#importModule"><span class="hs-identifier hs-var">importModule</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Debug.Trace&quot;</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">importQualified :: Bool
</span><a href="Agda.Utils.Haskell.Syntax.html#importQualified"><span class="hs-identifier hs-var">importQualified</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">importSpecs :: Maybe (Bool, [ImportSpec])
</span><a href="Agda.Utils.Haskell.Syntax.html#importSpecs"><span class="hs-identifier hs-var">importSpecs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ImportSpec
</span><a href="Agda.Utils.Haskell.Syntax.html#IVar"><span class="hs-identifier hs-var">HS.IVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ImportSpec) -&gt; Name -&gt; ImportSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trace&quot;</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- Compilation ------------------------------------------------------------</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-type">ghcCompileDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-525"></span><span id="ghcCompileDef"><span class="annot"><span class="annottext">ghcCompileDef :: GHCEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCMT IO GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var hs-var">ghcCompileDef</span></a></span></span><span> </span><span id="local-6989586621682206182"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206182"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621682206183"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682206183"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621682206184"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621682206184"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621682206185"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206185"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682206186"><span class="annot"><a href="#local-6989586621682206186"><span class="hs-identifier hs-var">usesFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206187"><span class="annot"><a href="#local-6989586621682206187"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206188"><span class="annot"><a href="#local-6989586621682206188"><span class="hs-identifier hs-var">mainFuncDef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span id="local-6989586621682206190"><span class="annot"><a href="#local-6989586621682206190"><span class="hs-identifier hs-var">imps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="annottext">Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206185"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; GHCModuleEnv
-&gt; TCMT
     IO
     ((UsesFloat, [Decl], Maybe CheckedMainFunctionDef), HsCompileState)
forall (m :: * -&gt; *) a.
HsCompileT m a -&gt; GHCModuleEnv -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT"><span class="hs-operator hs-var">`runHsCompileT`</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682206183"><span class="hs-identifier hs-var">menv</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206186"><span class="hs-identifier hs-type">usesFloat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206187"><span class="hs-identifier hs-type">decls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206185"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDef"><span class="hs-identifier hs-var">checkedMainDef</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682206188"><span class="hs-identifier hs-type">mainFuncDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206190"><span class="hs-identifier hs-type">imps</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-comment">-- | We do not erase types that have a 'HsData' pragma.</span><span>
</span><span id="line-531"></span><span class="hs-comment">--   This is to ensure a stable interface to third-party code.</span><span>
</span><span id="line-532"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-type">ghcMayEraseType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-533"></span><span id="ghcMayEraseType"><span class="annot"><span class="annottext">ghcMayEraseType :: QName -&gt; TCMT IO Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var hs-var">ghcMayEraseType</span></a></span></span><span> </span><span id="local-6989586621682206195"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206195"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206195"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; (Maybe HaskellPragma -&gt; Bool) -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-comment">-- Andreas, 2019-05-09, issue #3732.</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-comment">-- We restrict this to 'HsData' since types like @Size@, @Level@</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-comment">-- should be erased although they have a 'HsType' binding to the</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-comment">-- Haskell unit type.</span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-539"></span><span>  </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- Main compiling clauses</span><span>
</span><span id="line-543"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-type">definition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#CheckedMainFunctionDef"><span class="hs-identifier hs-type">CheckedMainFunctionDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- ignore irrelevant definitions</span><span>
</span><span id="line-547"></span><span id="definition"><span class="annot"><span class="annottext">definition :: Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var hs-var">definition</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defArgInfo :: Definition -&gt; ArgInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#defArgInfo"><span class="hs-identifier hs-var">defArgInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206199"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682206199"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206201"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206201"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensModality a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#usableModality"><span class="hs-identifier hs-var">usableModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682206199"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><span class="annottext">[Char]
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Not compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206201"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><span class="annottext">(UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall a. a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span id="local-6989586621682206207"><span class="annot"><span class="annottext">def :: Definition
</span><a href="#local-6989586621682206207"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206208"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defType :: Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206209"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206209"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">theDef :: Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206211"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621682206211"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><span class="annottext">[Char]
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Defn -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621682206211"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621682206215"><span class="annot"><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM (Maybe HaskellPragma)
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma))
-&gt; TCM (Maybe HaskellPragma)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621682206217"><span class="annot"><a href="#local-6989586621682206217"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-type">askGHCEnv</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206219"><span class="annot"><a href="#local-6989586621682206219"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682206220"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="#local-6989586621682206220"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="#local-6989586621682206220"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206217"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span id="local-6989586621682206221"><span class="annot"><a href="#local-6989586621682206221"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#checkTypeOfMain"><span class="hs-identifier hs-type">checkTypeOfMain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206207"><span class="hs-identifier hs-type">def</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206223"><span class="annot"><a href="#local-6989586621682206223"><span class="hs-identifier hs-var hs-var">mainDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Decl -&gt; [Decl]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Decl -&gt; [Decl]) -&gt; Maybe Decl -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CheckedMainFunctionDef -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDecl"><span class="hs-identifier hs-var">checkedMainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckedMainFunctionDef -&gt; Decl)
-&gt; Maybe CheckedMainFunctionDef -&gt; Maybe Decl
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621682206221"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206237"><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-var hs-var">retDecls</span></a></span></span><span> </span><span id="local-6989586621682206238"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682206238"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; m (a, b)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682206238"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682206221"><span class="hs-identifier hs-type">typeCheckedMainDef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mainDecl</span></span><span> </span><span class="annot"><span class="hs-operator">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-type">infodecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682206211"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsDefn"><span class="hs-identifier hs-type">HsDefn</span></a></span><span> </span><span id="local-6989586621682206242"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206242"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682206243"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206243"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206242"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-566"></span><span>            </span><span class="hs-comment">-- Make sure we have imports for all names mentioned in the type.</span><span>
</span><span id="line-567"></span><span>            </span><span id="local-6989586621682206245"><span class="annot"><a href="#local-6989586621682206245"><span class="hs-identifier hs-var">hsty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-568"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">`xqual`</span></span><span> </span><span class="annot"><span class="hs-identifier">HS.Ident</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier hs-type">namesIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206209"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>          </span><span class="hs-comment">-- Check that the function isn't INLINE (since that will make this</span><span>
</span><span id="line-571"></span><span>          </span><span class="hs-comment">-- definition pointless).</span><span>
</span><span id="line-572"></span><span>            </span><span id="local-6989586621682206249"><span class="annot"><a href="#local-6989586621682206249"><span class="hs-identifier hs-var">inline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">^.</span></span><span> </span><span class="annot"><span class="hs-identifier">funInline</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-type">getConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-573"></span><span>            </span><span class="annot"><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-type">when</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206249"><span class="hs-identifier hs-type">inline</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-type">warning</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#UselessInline"><span class="hs-identifier hs-type">UselessInline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>            </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682206259"><span class="hs-identifier hs-type">fbWithType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206245"><span class="hs-identifier hs-type">hsty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-type">fakeExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206243"><span class="hs-identifier hs-type">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-comment">-- Compiling Bool</span><span>
</span><span id="line-578"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvBool"><span class="hs-identifier hs-var">ghcEnvBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-579"></span><span>        </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primTrue"><span class="hs-identifier hs-var">primTrue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primFalse"><span class="hs-identifier hs-var">primFalse</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing TRUE/FALSE</span><span>
</span><span id="line-580"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206265"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621682206265"><span class="hs-identifier hs-var hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-581"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206267"><span class="annot"><a href="#local-6989586621682206267"><span class="hs-identifier hs-var">true</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-var">builtinTrue</span></a></span><span>
</span><span id="line-582"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206268"><span class="annot"><a href="#local-6989586621682206268"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-type">builtinFalse</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span id="local-6989586621682206269"><span class="annot"><a href="#local-6989586621682206269"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206268"><span class="hs-identifier hs-type">false</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206267"><span class="hs-identifier hs-type">true</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Bool&quot;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-585"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206265"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-type">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-586"></span><span>                   </span><span class="annot"><a href="#local-6989586621682206269"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>      </span><span class="hs-comment">-- Compiling List</span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206278"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206278"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvList"><span class="hs-identifier hs-var">ghcEnvList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>        </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNil"><span class="hs-identifier hs-var">primNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primCons"><span class="hs-identifier hs-var">primCons</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NIL/CONS</span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Maybe.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206282"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621682206282"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621682206282"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#PragmaCompileList"><span class="hs-identifier hs-var">PragmaCompileList</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206284"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621682206284"><span class="hs-identifier hs-var hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-593"></span><span>            </span><span id="local-6989586621682206285"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621682206285"><span class="hs-identifier hs-var hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206288"><span class="annot"><a href="#local-6989586621682206288"><span class="hs-identifier hs-var">nil</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-var">builtinNil</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206289"><span class="annot"><a href="#local-6989586621682206289"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-type">builtinCons</span></a></span><span>
</span><span id="line-596"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206294"><span class="annot"><a href="#local-6989586621682206294"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621682206295"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621682206295"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206296"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206296"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; b) -&gt; [Nat] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621682206295"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206296"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-597"></span><span>        </span><span id="local-6989586621682206299"><span class="annot"><a href="#local-6989586621682206299"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206288"><span class="hs-identifier hs-type">nil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206289"><span class="hs-identifier hs-type">cons</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-type">HS.TypeDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206285"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206294"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-type">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206278"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-type">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206284"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206294"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206278"><span class="hs-identifier hs-type">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-type">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-600"></span><span>                   </span><span class="annot"><a href="#local-6989586621682206299"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-comment">-- Compiling Maybe</span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206304"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206304"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybe"><span class="hs-identifier hs-var">ghcEnvMaybe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>        </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNothing"><span class="hs-identifier hs-var">primNothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primJust"><span class="hs-identifier hs-var">primJust</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NOTHING/JUST</span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Maybe.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206307"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621682206307"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621682206307"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#PragmaCompileMaybe"><span class="hs-identifier hs-var">PragmaCompileMaybe</span></a></span><span>
</span><span id="line-606"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206309"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621682206309"><span class="hs-identifier hs-var hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-607"></span><span>            </span><span id="local-6989586621682206310"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621682206310"><span class="hs-identifier hs-var hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206311"><span class="annot"><a href="#local-6989586621682206311"><span class="hs-identifier hs-var">nothing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinNothing"><span class="hs-identifier hs-var">builtinNothing</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206312"><span class="annot"><a href="#local-6989586621682206312"><span class="hs-identifier hs-var">just</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinJust"><span class="hs-identifier hs-type">builtinJust</span></a></span><span>
</span><span id="line-610"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206317"><span class="annot"><a href="#local-6989586621682206317"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621682206318"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621682206318"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206319"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206319"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; b) -&gt; [Nat] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621682206318"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206319"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-611"></span><span>        </span><span id="local-6989586621682206320"><span class="annot"><a href="#local-6989586621682206320"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206311"><span class="hs-identifier hs-type">nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206312"><span class="hs-identifier hs-type">just</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-612"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-type">HS.TypeDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206310"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206317"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-type">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206304"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-type">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Maybe&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206309"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206317"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206304"><span class="hs-identifier hs-type">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-type">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-614"></span><span>                   </span><span class="annot"><a href="#local-6989586621682206320"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>      </span><span class="hs-comment">-- Compiling Inf</span><span>
</span><span id="line-617"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInf"><span class="hs-identifier hs-var">ghcEnvInf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-618"></span><span>        </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primSharp"><span class="hs-identifier hs-var">primSharp</span></a></span><span> </span><span class="hs-comment">-- To get a proper error for missing SHARP.</span><span>
</span><span id="line-619"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206322"><span class="annot"><a href="#local-6989586621682206322"><span class="hs-identifier hs-var">sharp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinSharp"><span class="hs-identifier hs-type">builtinSharp</span></a></span><span>
</span><span id="line-620"></span><span>        </span><span id="local-6989586621682206323"><span class="annot"><a href="#local-6989586621682206323"><span class="hs-identifier hs-var">sharpC</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206322"><span class="hs-identifier hs-type">sharp</span></a></span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206324"><span class="annot"><a href="#local-6989586621682206324"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-622"></span><span>            </span><span id="local-6989586621682206326"><span class="annot"><a href="#local-6989586621682206326"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No term-level implementation of the INFINITY builtin.&quot;</span></span><span>
</span><span id="line-623"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;MAlonzo.RTE.Infinity&quot;</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-624"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206324"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-type">ihname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-type">A</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-625"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-type">HS.FakeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;error &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682206326"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>                       </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206323"><span class="hs-identifier hs-type">sharpC</span></a></span><span>
</span><span id="line-628"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>      </span><span class="hs-comment">-- The interval is compiled as the type of booleans: 0 is</span><span>
</span><span id="line-631"></span><span>      </span><span class="hs-comment">-- compiled as False and 1 as True.</span><span>
</span><span id="line-632"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInterval"><span class="hs-identifier hs-var">ghcEnvInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-633"></span><span>        </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIZero"><span class="hs-identifier hs-var">primIZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIOne"><span class="hs-identifier hs-var">primIOne</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-634"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206332"><span class="annot"><a href="#local-6989586621682206332"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinIZero"><span class="hs-identifier hs-var">builtinIZero</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206333"><span class="annot"><a href="#local-6989586621682206333"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-type">builtinIOne</span></a></span><span>
</span><span id="line-636"></span><span>        </span><span id="local-6989586621682206334"><span class="annot"><a href="#local-6989586621682206334"><span class="hs-identifier hs-var">cs</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206332"><span class="hs-identifier hs-type">i0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206333"><span class="hs-identifier hs-type">i1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Bool&quot;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-639"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span>
</span><span id="line-640"></span><span>              </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-type">dname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-641"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-type">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-643"></span><span>          </span><span class="annot"><a href="#local-6989586621682206334"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>      </span><span class="hs-comment">-- IsOne is compiled as the constant function to the unit type.</span><span>
</span><span id="line-646"></span><span>      </span><span class="hs-comment">-- Partial/PartialP are compiled as functions from the unit type</span><span>
</span><span id="line-647"></span><span>      </span><span class="hs-comment">-- to the underlying type.</span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne"><span class="hs-identifier hs-var">ghcEnvIsOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-650"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-651"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;()&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-654"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-655"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span>      </span><span class="hs-comment">-- itIsOne.</span><span>
</span><span id="line-658"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvItIsOne"><span class="hs-identifier hs-var">ghcEnvItIsOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-660"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-661"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-662"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-663"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>      </span><span class="hs-comment">-- IsOne1/IsOne2.</span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne1"><span class="hs-identifier hs-var">ghcEnvIsOne1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne2"><span class="hs-identifier hs-var">ghcEnvIsOne2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-669"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\_ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-672"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-comment">-- isOneEmpty.</span><span>
</span><span id="line-675"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOneEmpty"><span class="hs-identifier hs-var">ghcEnvIsOneEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-678"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-679"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\_ x _ -&gt; x ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-comment">-- PathP is compiled as a function from the interval (booleans)</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-comment">-- to the underlying type.</span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvPathP"><span class="hs-identifier hs-var">ghcEnvPathP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primInterval"><span class="hs-identifier hs-var">primInterval</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-687"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206336"><span class="annot"><a href="#local-6989586621682206336"><span class="hs-identifier hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-var">builtinInterval</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621682206337"><span class="annot"><a href="#local-6989586621682206337"><span class="hs-identifier hs-var">int</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-type">xhqn</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-type">TypeK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206336"><span class="hs-identifier hs-type">int</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-690"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-type">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-type">TypeK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>              </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-type">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-type">ihname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-type">A</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206339"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682206339"><span class="annot"><a href="#local-6989586621682206339"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-type">HS.TyFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-type">HS.TyCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206337"><span class="hs-identifier hs-type">int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-type">mazAnyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span>
</span><span id="line-694"></span><span>              </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-type">dname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-695"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-type">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\\_ _ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>                 </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-697"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>      </span><span class="hs-comment">-- Sub is compiled as the underlying type.</span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSub"><span class="hs-identifier hs-var">ghcEnvSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-701"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-702"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206343"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682206343"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206343"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-704"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyVar"><span class="hs-identifier hs-var">HS.TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-706"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-707"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\_ _ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-709"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span>      </span><span class="hs-comment">-- subIn.</span><span>
</span><span id="line-712"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621682206219"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSubIn"><span class="hs-identifier hs-var">ghcEnvSubIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-713"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-714"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-715"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-716"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\_ _ _ x -&gt; x&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-718"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span>      </span><span class="hs-comment">-- TC builtins are compiled to erased, which is an &#8734;-ary</span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-comment">-- function.</span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; QName -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsTCBuiltin"><span class="hs-identifier hs-var">ghcEnvIsTCBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206217"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-723"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-724"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-725"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-726"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-728"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-733"></span><span>        </span><span id="local-6989586621682206346"><span class="annot"><a href="#local-6989586621682206346"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Nat
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat)
-&gt; TCMT IO Nat
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Nat
</span><a href="Agda.TypeChecking.Telescope.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206209"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-734"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206348"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206346"><span class="hs-identifier hs-type">ar</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsType"><span class="hs-identifier hs-type">HsType</span></a></span><span> </span><span id="local-6989586621682206350"><span class="annot"><a href="#local-6989586621682206350"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682206348"><span class="annot"><a href="#local-6989586621682206348"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206215"><span class="hs-identifier hs-type">pragma</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-735"></span><span>                   </span><span class="annot"><a href="#local-6989586621682206351"><span class="hs-identifier hs-type">fb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206352"><span class="hs-identifier hs-type">axiomErr</span></a></span><span>
</span><span id="line-736"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">primName :: Defn -&gt; PrimitiveId
</span><a href="Agda.TypeChecking.Monad.Base.html#primName"><span class="hs-identifier hs-var">primName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206355"><span class="annot"><span class="annottext">PrimitiveId
</span><a href="#local-6989586621682206355"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; (UsesFloat, [Decl]))
-&gt; (Exp -&gt; [Decl]) -&gt; Exp -&gt; (UsesFloat, [Decl])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621682206351"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; (UsesFloat, [Decl]))
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Exp -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Exp -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp)
-&gt; (PrimitiveId -&gt; TCM Exp)
-&gt; PrimitiveId
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimitiveId -&gt; TCM Exp
forall (m :: * -&gt; *). MonadTCError m =&gt; PrimitiveId -&gt; m Exp
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#primBody"><span class="hs-identifier hs-var">primBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="#local-6989586621682206355"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206359"><span class="hs-identifier hs-var">function</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definition
-&gt; QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206360"><span class="hs-identifier hs-var">functionViaTreeless</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206207"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206361"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206361"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206363"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206363"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206365"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621682206365"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-743"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataPathCons :: Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPathCons"><span class="hs-identifier hs-var">dataPathCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206367"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206367"><span class="hs-identifier hs-var">pcs</span></a></span></span><span>
</span><span id="line-744"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682206368"><span class="annot"><span class="annottext">hsdata :: HaskellPragma
</span><a href="#local-6989586621682206368"><span class="hs-identifier hs-var">hsdata</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621682206369"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206369"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682206370"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206370"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682206371"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206371"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-745"></span><span>        </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206369"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><span class="annottext">[Char]
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCM Doc] -&gt; TCM Doc) -&gt; [TCM Doc] -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-747"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling data type with COMPILE pragma ...&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HaskellPragma -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621682206368"><span class="hs-identifier hs-var">hsdata</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-748"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCMT IO ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-749"></span><span>        </span><span id="local-6989586621682206374"><span class="annot"><a href="#local-6989586621682206374"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-750"></span><span>        </span><span id="local-6989586621682206376"><span class="annot"><a href="#local-6989586621682206376"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-type">constructorCoverageCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206361"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682206363"><span class="hs-identifier hs-type">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206374"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206370"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206371"><span class="hs-identifier hs-type">hsCons</span></a></span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621682206379"><span class="annot"><a href="#local-6989586621682206379"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206374"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-752"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206380"><span class="annot"><a href="#local-6989586621682206380"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl]) -&gt; [[Decl]] -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-753"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206361"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206363"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe Clause
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Clause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char] -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206370"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206361"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-755"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682206379"><span class="hs-identifier hs-var">cds</span></a></span><span>
</span><span id="line-756"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682206376"><span class="hs-identifier hs-var">ccscov</span></a></span><span>
</span><span id="line-757"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-758"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206380"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206383"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206383"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206384"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206384"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206385"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621682206385"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-760"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataPathCons :: Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPathCons"><span class="hs-identifier hs-var">dataPathCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206386"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206386"><span class="hs-identifier hs-var">pcs</span></a></span></span><span>
</span><span id="line-761"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-762"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCMT IO ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-763"></span><span>        </span><span id="local-6989586621682206387"><span class="annot"><a href="#local-6989586621682206387"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-764"></span><span>        </span><span id="local-6989586621682206388"><span class="annot"><a href="#local-6989586621682206388"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-type">condecl</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-type">Inductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206387"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-765"></span><span>        </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-type">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206383"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682206384"><span class="hs-identifier hs-type">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206388"><span class="hs-identifier hs-type">cds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206385"><span class="hs-identifier hs-type">cl</span></a></span><span>
</span><span id="line-766"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-767"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621682206237"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-768"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#recPars"><span class="hs-identifier hs-var">recPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206394"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206394"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#recClause"><span class="hs-identifier hs-var">recClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206396"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621682206396"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recConHead :: Defn -&gt; ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206398"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682206398"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-769"></span><span>              </span><span class="annot"><span class="annottext">recInduction :: Defn -&gt; Maybe Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206400"><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621682206400"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-770"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Non-recursive record types are treated as being</span><span>
</span><span id="line-771"></span><span>            </span><span class="hs-comment">-- inductive.</span><span>
</span><span id="line-772"></span><span>            </span><span id="local-6989586621682206401"><span class="annot"><span class="annottext">inductionKind :: Induction
</span><a href="#local-6989586621682206401"><span class="hs-identifier hs-var hs-var">inductionKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction -&gt; Induction
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621682206400"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-773"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206215"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-774"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621682206402"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206402"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682206403"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206403"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682206404"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206404"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206402"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-775"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206405"><span class="annot"><span class="annottext">cs :: [QName]
</span><a href="#local-6989586621682206405"><span class="hs-identifier hs-var hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682206398"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-776"></span><span>            </span><span class="annot"><span class="annottext">TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCMT IO ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-777"></span><span>            </span><span id="local-6989586621682206407"><span class="annot"><a href="#local-6989586621682206407"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Nat
-&gt; [QName]
-&gt; [Char]
-&gt; [[Char]]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var">constructorCoverageCode</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206394"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206405"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206403"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206404"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-778"></span><span>            </span><span id="local-6989586621682206408"><span class="annot"><a href="#local-6989586621682206408"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206405"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-779"></span><span>            </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-780"></span><span>              </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206401"><span class="hs-identifier hs-type">inductionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206394"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-781"></span><span>              </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206403"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206394"><span class="hs-identifier hs-type">np</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206408"><span class="hs-identifier hs-type">cds</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206407"><span class="hs-identifier hs-type">ccscov</span></a></span><span>
</span><span id="line-782"></span><span>          </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>            </span><span class="annot"><span class="annottext">TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCMT IO ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-784"></span><span>            </span><span id="local-6989586621682206409"><span class="annot"><a href="#local-6989586621682206409"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var">condecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682206398"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682206401"><span class="hs-identifier hs-var">inductionKind</span></a></span><span>
</span><span id="line-785"></span><span>            </span><span class="annot"><a href="#local-6989586621682206237"><span class="hs-identifier hs-type">retDecls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206208"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206401"><span class="hs-identifier hs-type">inductionKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#arity"><span class="hs-identifier hs-type">I.arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206209"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206409"><span class="hs-identifier hs-type">cd</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682206396"><span class="hs-identifier hs-type">cl</span></a></span><span>
</span><span id="line-786"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-788"></span><span>  </span><span class="annot"><a href="#local-6989586621682206359"><span class="hs-identifier hs-type">function</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellPragma"><span class="hs-identifier hs-type">HaskellPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>  </span><span id="local-6989586621682206359"><span class="annot"><span class="annottext">function :: Maybe HaskellPragma
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206359"><span class="hs-identifier hs-var hs-var">function</span></a></span></span><span> </span><span id="local-6989586621682206411"><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621682206411"><span class="hs-identifier hs-var">mhe</span></a></span></span><span> </span><span id="local-6989586621682206412"><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206412"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682206413"><span class="annot"><a href="#local-6989586621682206413"><span class="hs-identifier hs-var">imp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206414"><span class="annot"><a href="#local-6989586621682206414"><span class="hs-identifier hs-var">ccls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206412"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682206411"><span class="hs-identifier hs-type">mhe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-792"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsExport"><span class="hs-identifier hs-type">HsExport</span></a></span><span> </span><span id="local-6989586621682206416"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206416"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682206417"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206417"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-793"></span><span>          </span><span id="local-6989586621682206418"><span class="annot"><a href="#local-6989586621682206418"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range -&gt; HsCompileM Type -&gt; HsCompileM Type
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682206416"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileM Type -&gt; HsCompileM Type)
-&gt; HsCompileM Type -&gt; HsCompileM Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-794"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682206419"><span class="hs-identifier hs-type">tsig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-795"></span><span>              </span><span id="local-6989586621682206419"><span class="annot"><a href="#local-6989586621682206419"><span class="hs-identifier hs-var hs-var">tsig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206417"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206418"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span>              </span><span class="annot"><a href="#local-6989586621682206421"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-798"></span><span>              </span><span id="local-6989586621682206421"><span class="annot"><a href="#local-6989586621682206421"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206417"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-799"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206413"><span class="hs-identifier hs-type">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206419"><span class="hs-identifier hs-type">tsig</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682206421"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206414"><span class="hs-identifier hs-type">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>      </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621682206413"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682206414"><span class="hs-identifier hs-var">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span>  </span><span class="annot"><a href="#local-6989586621682206360"><span class="hs-identifier hs-type">functionViaTreeless</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>  </span><span id="local-6989586621682206360"><span class="annot"><span class="annottext">functionViaTreeless :: Definition
-&gt; QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621682206360"><span class="hs-identifier hs-var hs-var">functionViaTreeless</span></a></span></span><span> </span><span id="local-6989586621682206424"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206424"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621682206425"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206425"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-804"></span><span>    </span><span id="local-6989586621682206426"><span class="annot"><a href="#local-6989586621682206426"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; Bool)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-805"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206427"><span class="annot"><a href="#local-6989586621682206427"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206426"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="Agda.Syntax.Treeless.html#EagerEvaluation"><span class="hs-identifier hs-var">EagerEvaluation</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="Agda.Syntax.Treeless.html#LazyEvaluation"><span class="hs-identifier hs-var">LazyEvaluation</span></a></span><span>
</span><span id="line-806"></span><span>    </span><span class="annot"><a href="Agda.Utils.Maybe.html#caseMaybeM"><span class="hs-identifier hs-type">caseMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-type">liftTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.ToTreeless.html#toTreeless"><span class="hs-identifier hs-type">toTreeless</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206427"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206425"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206432"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206432"><span class="hs-identifier hs-var">treeless</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span>      </span><span id="local-6989586621682206433"><span class="annot"><a href="#local-6989586621682206433"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206425"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-809"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206435"><span class="annot"><a href="#local-6989586621682206435"><span class="hs-identifier hs-var hs-var">dostrip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206433"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>      </span><span class="hs-comment">-- Compute the type approximation</span><span>
</span><span id="line-812"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682206438"><span class="annot"><a href="#local-6989586621682206438"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206439"><span class="annot"><a href="#local-6989586621682206439"><span class="hs-identifier hs-var">resType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-type">hsTelApproximation</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206424"><span class="hs-identifier hs-type">def</span></a></span><span>
</span><span id="line-813"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206441"><span class="annot"><a href="#local-6989586621682206441"><span class="hs-identifier hs-var hs-var">pars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682206424"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-814"></span><span>                   </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funProjection :: Defn -&gt; Either ProjectionLikenessMissing Projection
</span><a href="Agda.TypeChecking.Monad.Base.html#funProjection"><span class="hs-identifier hs-var">funProjection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projIndex :: Projection -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206445"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206445"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206445"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206445"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span>
</span><span id="line-815"></span><span>                   </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span>
</span><span id="line-816"></span><span>          </span><span id="local-6989586621682206447"><span class="annot"><a href="#local-6989586621682206447"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Type] -&gt; [Type]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206441"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206438"><span class="hs-identifier hs-var">argTypes0</span></a></span><span>
</span><span id="line-817"></span><span>          </span><span id="local-6989586621682206449"><span class="annot"><a href="#local-6989586621682206449"><span class="hs-identifier hs-var hs-var">argTypesS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; [Type] -&gt; [Type]
forall a. [ArgUsage] -&gt; [a] -&gt; [a]
</span><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-var">filterUsed</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206433"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206447"><span class="hs-identifier hs-var">argTypes</span></a></span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682206451"><span class="annot"><a href="#local-6989586621682206451"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206452"><span class="annot"><a href="#local-6989586621682206452"><span class="hs-identifier hs-var">useFloat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682206435"><span class="hs-identifier hs-type">dostrip</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-type">closedTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Treeless.Unused.html#stripUnusedArguments"><span class="hs-identifier hs-type">stripUnusedArguments</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206433"><span class="hs-identifier hs-type">used</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206432"><span class="hs-identifier hs-type">treeless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-type">closedTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206432"><span class="hs-identifier hs-type">treeless</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682206455"><span class="annot"><a href="#local-6989586621682206455"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206456"><span class="annot"><a href="#local-6989586621682206456"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682206457"><span class="hs-identifier hs-type">lamView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206451"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-822"></span><span>          </span><span id="local-6989586621682206457"><span class="annot"><a href="#local-6989586621682206457"><span class="hs-identifier hs-var hs-var">lamView</span></a></span></span><span> </span><span id="local-6989586621682206458"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206458"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-823"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206458"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-824"></span><span>              </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-type">HS.Lambda</span></a></span><span> </span><span id="local-6989586621682206460"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206460"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682206461"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206461"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206460"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206461"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>              </span><span id="local-6989586621682206462"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206462"><span class="hs-identifier hs-var">b</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206462"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span>          </span><span id="local-6989586621682206465"><span class="annot"><a href="#local-6989586621682206465"><span class="hs-identifier hs-var hs-var">tydecl</span></a></span></span><span>  </span><span id="local-6989586621682206466"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206466"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206467"><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621682206467"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621682206468"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206468"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206466"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; t Type -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-var">HS.TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206468"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621682206467"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>          </span><span id="local-6989586621682206470"><span class="annot"><a href="#local-6989586621682206470"><span class="hs-identifier hs-var hs-var">funbind</span></a></span></span><span> </span><span id="local-6989586621682206471"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206471"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206472"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206472"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682206473"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206473"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206471"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206472"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206473"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-829"></span><span>          </span><span id="local-6989586621682206478"><span class="annot"><a href="#local-6989586621682206478"><span class="hs-identifier hs-var hs-var">tyfunbind</span></a></span></span><span> </span><span id="local-6989586621682206479"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206479"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206480"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206480"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621682206481"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206481"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682206482"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206482"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682206483"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206483"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-830"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206484"><span class="annot"><span class="annottext">ts' :: [Type]
</span><a href="#local-6989586621682206484"><span class="hs-identifier hs-var hs-var">ts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206480"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; [Type]
forall a. Nat -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206482"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206480"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var">mazAnyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; Decl
forall {t :: * -&gt; *}. Foldable t =&gt; Name -&gt; t Type -&gt; Type -&gt; Decl
</span><a href="#local-6989586621682206465"><span class="hs-identifier hs-var">tydecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206479"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682206484"><span class="hs-identifier hs-var">ts'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206481"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Exp -&gt; Decl
</span><a href="#local-6989586621682206470"><span class="hs-identifier hs-var">funbind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206479"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206482"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206483"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span>      </span><span class="hs-comment">-- The definition of the non-stripped function</span><span>
</span><span id="line-834"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682206487"><span class="annot"><a href="#local-6989586621682206487"><span class="hs-identifier hs-var">ps0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682206457"><span class="hs-identifier hs-type">lamView</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-type">closedTerm_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">($)</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-type">T.TErased</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621682206433"><span class="hs-identifier hs-type">used</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-type">T.TLam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206491"><span class="annot"><a href="#local-6989586621682206491"><span class="hs-identifier hs-var hs-var">b0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var">duname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206425"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span id="local-6989586621682206495"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206495"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUsed"><span class="hs-identifier hs-var">ArgUsed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; [ArgUsage] -&gt; [(Pat, ArgUsage)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) a b.
Zip f g h =&gt;
f a -&gt; g b -&gt; h (a, b)
</span><a href="Agda.Utils.Zip.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206487"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206433"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-836"></span><span>          </span><span id="local-6989586621682206498"><span class="annot"><a href="#local-6989586621682206498"><span class="hs-identifier hs-var hs-var">ps0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; ArgUsage -&gt; Pat) -&gt; [Pat] -&gt; [ArgUsage] -&gt; [Pat]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) a b c.
Zip f g h =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; g b -&gt; h c
</span><a href="Agda.Utils.Zip.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682206500"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682206500"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682206501"><span class="annot"><span class="annottext">ArgUsage
</span><a href="#local-6989586621682206501"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="#local-6989586621682206501"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-837"></span><span>                                    </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUsed"><span class="hs-identifier hs-var">ArgUsed</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682206500"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-838"></span><span>                                    </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PIrrPat"><span class="hs-identifier hs-var">HS.PIrrPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682206500"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>                   </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682206487"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206433"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>      </span><span class="hs-comment">-- Trace entering functions when --ghc-trace is on.</span><span>
</span><span id="line-842"></span><span>      </span><span id="local-6989586621682206503"><span class="annot"><a href="#local-6989586621682206503"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-type">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#isProperProjection"><span class="hs-identifier hs-type">isProperProjection</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206424"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-type">`or2M`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcTrace"><span class="hs-identifier hs-var">optGhcTrace</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>        </span><span class="hs-comment">{-then-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682206456"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>        </span><span class="hs-comment">{-else-}</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-845"></span><span>          </span><span id="local-6989586621682206506"><span class="annot"><a href="#local-6989586621682206506"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206425"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-846"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-type">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-type">HS.App</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsDebugTrace"><span class="hs-identifier hs-type">hsDebugTrace</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-type">HS.Lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-type">HS.String</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.pack</span></span><span> </span><span class="annot"><a href="#local-6989586621682206506"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206456"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206452"><span class="hs-identifier hs-type">useFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-849"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682206435"><span class="hs-identifier hs-type">dostrip</span></a></span><span>
</span><span id="line-850"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682206478"><span class="hs-identifier hs-type">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-type">dname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206425"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206447"><span class="hs-identifier hs-type">argTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206439"><span class="hs-identifier hs-type">resType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206498"><span class="hs-identifier hs-type">ps0'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206491"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-851"></span><span>                     </span><span class="annot"><a href="#local-6989586621682206478"><span class="hs-identifier hs-type">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-type">duname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206425"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206449"><span class="hs-identifier hs-type">argTypesS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206439"><span class="hs-identifier hs-type">resType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206455"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206503"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-852"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682206478"><span class="hs-identifier hs-type">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-type">dname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206425"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206447"><span class="hs-identifier hs-type">argTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206439"><span class="hs-identifier hs-type">resType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206455"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206503"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span>  </span><span class="annot"><a href="#local-6989586621682206259"><span class="hs-identifier hs-type">fbWithType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Type"><span class="hs-identifier hs-type">HS.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-855"></span><span>  </span><span id="local-6989586621682206259"><span class="annot"><span class="annottext">fbWithType :: Type -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621682206259"><span class="hs-identifier hs-var hs-var">fbWithType</span></a></span></span><span> </span><span id="local-6989586621682206511"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206511"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682206512"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206512"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-856"></span><span>    </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682206511"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621682206351"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206512"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>  </span><span class="annot"><a href="#local-6989586621682206351"><span class="hs-identifier hs-type">fb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-859"></span><span>  </span><span id="local-6989586621682206351"><span class="annot"><span class="annottext">fb :: Exp -&gt; [Decl]
</span><a href="#local-6989586621682206351"><span class="hs-identifier hs-var hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621682206513"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206513"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-860"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206513"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><a href="#local-6989586621682206352"><span class="hs-identifier hs-type">axiomErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-863"></span><span>  </span><span id="local-6989586621682206352"><span class="annot"><span class="annottext">axiomErr :: Exp
</span><a href="#local-6989586621682206352"><span class="hs-identifier hs-var hs-var">axiomErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BackendName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmError"><span class="hs-identifier hs-var">rtmError</span></a></span><span> </span><span class="annot"><span class="annottext">(BackendName -&gt; Exp) -&gt; BackendName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BackendName
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; BackendName) -&gt; [Char] -&gt; BackendName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;postulate evaluated: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206208"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="annot"><span class="hs-comment">-- | The Haskell function 'Debug.Trace.trace'.</span></span><span>
</span><span id="line-866"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsDebugTrace"><span class="hs-identifier hs-type">hsDebugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-867"></span><span id="hsDebugTrace"><span class="annot"><span class="annottext">hsDebugTrace :: Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsDebugTrace"><span class="hs-identifier hs-var hs-var">hsDebugTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Debug.Trace&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trace&quot;</span></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-type">constructorCoverageCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-870"></span><span id="constructorCoverageCode"><span class="annot"><span class="annottext">constructorCoverageCode :: QName
-&gt; Nat
-&gt; [QName]
-&gt; [Char]
-&gt; [[Char]]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var hs-var">constructorCoverageCode</span></a></span></span><span> </span><span id="local-6989586621682206519"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206519"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682206520"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206520"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span id="local-6989586621682206521"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206521"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682206522"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206522"><span class="hs-identifier hs-var">hsTy</span></a></span></span><span> </span><span id="local-6989586621682206523"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206523"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-comment">-- Check that number of constructors matches up.</span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[QName] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206521"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206523"><span class="hs-identifier hs-var">hsCons</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-873"></span><span>    </span><span class="annot"><span class="annottext">GHCBackendError
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
GHCBackendError -&gt; m a
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcBackendError"><span class="hs-identifier hs-var">ghcBackendError</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCBackendError
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; GHCBackendError
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; [[Char]] -&gt; GHCBackendError
</span><a href="Agda.TypeChecking.Monad.Base.html#ConstructorCountMismatch"><span class="hs-identifier hs-var">ConstructorCountMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206519"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206521"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206523"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-874"></span><span>  </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Bool
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool)
-&gt; TCMT IO Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Bool
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
QName -&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#noCheckCover"><span class="hs-identifier hs-var">noCheckCover</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206519"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall a. a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-875"></span><span>    </span><span id="local-6989586621682206528"><span class="annot"><a href="#local-6989586621682206528"><span class="hs-identifier hs-var">ccs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [[Decl]]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(QName
 -&gt; [Char]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; [QName]
-&gt; [[Char]]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [[Decl]]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; [Char]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var">checkConstructorType</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206521"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206523"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span id="local-6989586621682206531"><span class="annot"><a href="#local-6989586621682206531"><span class="hs-identifier hs-var">cov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-type">liftTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-type">checkCover</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206519"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206522"><span class="hs-identifier hs-type">hsTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206520"><span class="hs-identifier hs-type">np</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206521"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206523"><span class="hs-identifier hs-type">hsCons</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682206528"><span class="hs-identifier hs-type">ccs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682206531"><span class="hs-identifier hs-type">cov</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- | Environment for naming of local variables.</span><span>
</span><span id="line-880"></span><span class="hs-comment">--   Invariant: @reverse ccCxt ++ ccNameSupply@</span><span>
</span><span id="line-881"></span><span class="hs-keyword">data</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span>
</span><span id="line-882"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_ccNameSupply"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var hs-var">_ccNameSupply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Supply of fresh names</span></span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_ccContext"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var hs-var">_ccContext</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Names currently in scope</span></span><span>
</span><span id="line-884"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-keyword">type</span><span> </span><span id="NameSupply"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-var">NameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-887"></span><span class="hs-keyword">type</span><span> </span><span id="CCContext"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-var">CCContext</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-type">ccNameSupply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span>
</span><span id="line-890"></span><span id="ccNameSupply"><span class="annot"><span class="annottext">ccNameSupply :: Lens' CCEnv [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var hs-var">ccNameSupply</span></a></span></span><span> </span><span id="local-6989586621682206541"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621682206541"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206542"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206542"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206543"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206543"><span class="hs-identifier hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206542"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682206543"><span class="hs-identifier hs-type">ns'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621682206541"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206542"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-type">ccContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span>
</span><span id="line-893"></span><span id="ccContext"><span class="annot"><span class="annottext">ccContext :: Lens' CCEnv [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var hs-var">ccContext</span></a></span></span><span> </span><span id="local-6989586621682206547"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621682206547"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682206548"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206548"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206549"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206549"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206548"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682206549"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621682206547"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621682206548"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="annot"><span class="hs-comment">-- | Initial environment for expression generation.</span></span><span>
</span><span id="line-896"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-type">initCCEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-897"></span><span id="initCCEnv"><span class="annot"><span class="annottext">initCCEnv :: CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-var hs-var">initCCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccNameSupply :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Name) -&gt; [Nat] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#V"><span class="hs-identifier hs-var">V</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- DON'T CHANGE THESE NAMES!</span><span>
</span><span id="line-899"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_ccContext :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-900"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span class="annot"><span class="hs-comment">-- | Term variables are de Bruijn indices.</span></span><span>
</span><span id="line-903"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-type">lookupIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-904"></span><span id="lookupIndex"><span class="annot"><span class="annottext">lookupIndex :: Nat -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var hs-var">lookupIndex</span></a></span></span><span> </span><span id="local-6989586621682206553"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206553"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682206554"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206554"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name -&gt; Name
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Name) -&gt; Maybe Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206554"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Nat -&gt; Maybe Name
forall a. [a] -&gt; Nat -&gt; Maybe a
</span><a href="Agda.Utils.List.html#%21%21%21"><span class="hs-operator hs-var">!!!</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206553"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="annot"><span class="hs-comment">-- | Constructor coverage monad transformer</span></span><span>
</span><span id="line-907"></span><span class="hs-keyword">type</span><span> </span><span id="CCT"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-var">CCT</span></a></span></span><span> </span><span id="local-6989586621682206556"><span class="annot"><a href="#local-6989586621682206556"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206556"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="annot"><span class="hs-comment">-- | Constructor coverage monad</span></span><span>
</span><span id="line-910"></span><span class="hs-keyword">type</span><span> </span><span id="CC"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-var">CC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span id="local-6989586621682204488"><span id="local-6989586621682204489"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204488"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204488"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204488"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204489"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-913"></span><span id="liftCC"><span class="annot"><span class="annottext">liftCC :: forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var hs-var">liftCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT UsesFloat (HsCompileT m) a
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ReaderT CCEnv m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(WriterT UsesFloat (HsCompileT m) a
 -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a)
-&gt; (HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a)
-&gt; HsCompileT m a
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; WriterT UsesFloat m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span id="local-6989586621682204497"><span id="local-6989586621682204498"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-type">freshNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204498"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-916"></span><span id="freshNames"><span class="annot"><span class="annottext">freshNames :: forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var hs-var">freshNames</span></a></span></span><span> </span><span id="local-6989586621682206584"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206584"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206584"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCT m a
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-917"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span id="local-6989586621682206586"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206586"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682206587"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621682206587"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682206588"><span class="annot"><a href="#local-6989586621682206588"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206589"><span class="annot"><a href="#local-6989586621682206589"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Name] -&gt; ([Name], [Name])
forall a. Nat -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ([Name], [Name]))
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
-&gt; ReaderT
     CCEnv (WriterT UsesFloat (HsCompileT m)) ([Name], [Name])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' CCEnv [Name]
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' o i -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; f [Name]) -&gt; CCEnv -&gt; f CCEnv
Lens' CCEnv [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var">ccNameSupply</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-type">over</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-type">ccNameSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">const</span></span><span> </span><span class="annot"><a href="#local-6989586621682206589"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682206587"><span class="hs-identifier hs-type">cont</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206588"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="annot"><span class="hs-comment">-- | Introduce n variables into the context.</span></span><span>
</span><span id="line-922"></span><span id="local-6989586621682206599"><span id="local-6989586621682206600"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-type">intros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682206599"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206599"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206600"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206599"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206600"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-923"></span><span id="intros"><span class="annot"><span class="annottext">intros :: forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var hs-var">intros</span></a></span></span><span> </span><span id="local-6989586621682206608"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206608"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682206609"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621682206609"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206608"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CCT m a) -&gt; CCT m a) -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682206610"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206610"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">(CCEnv -&gt; CCEnv) -&gt; CCT m a -&gt; CCT m a
forall a.
(CCEnv -&gt; CCEnv)
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' CCEnv [Name] -&gt; LensMap CCEnv [Name]
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; f [Name]) -&gt; CCEnv -&gt; f CCEnv
Lens' CCEnv [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206610"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CCT m a -&gt; CCT m a) -&gt; CCT m a -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621682206609"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206610"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-type">checkConstructorType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-927"></span><span id="checkConstructorType"><span class="annot"><span class="annottext">checkConstructorType :: QName
-&gt; [Char]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var hs-var">checkConstructorType</span></a></span></span><span> </span><span id="local-6989586621682206614"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206614"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682206615"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206615"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-928"></span><span>  </span><span id="local-6989586621682206616"><span class="annot"><a href="#local-6989586621682206616"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206614"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-type">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-type">CheckK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206614"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682206616"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-930"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-type">CheckK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206614"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-931"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-type">fakeExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206615"><span class="hs-identifier hs-type">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-932"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span id="local-6989586621682204484"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-type">checkCover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204484"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204484"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-935"></span><span id="checkCover"><span class="annot"><span class="annottext">checkCover :: forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; [Char] -&gt; Nat -&gt; [QName] -&gt; [[Char]] -&gt; m [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-var hs-var">checkCover</span></a></span></span><span> </span><span id="local-6989586621682206631"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206631"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682206632"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206632"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682206633"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206633"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682206634"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206634"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682206635"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206635"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206636"><span class="annot"><span class="annottext">tvs :: [[Char]]
</span><a href="#local-6989586621682206636"><span class="hs-identifier hs-var hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206637"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682206637"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206637"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206633"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-937"></span><span>      </span><span id="local-6989586621682206671"><span class="annot"><span class="annottext">makeClause :: QName -&gt; [Char] -&gt; m Alt
</span><a href="#local-6989586621682206671"><span class="hs-identifier hs-var hs-var hs-var">makeClause</span></a></span></span><span> </span><span id="local-6989586621682206672"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206672"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682206673"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206673"><span class="hs-identifier hs-var">hsc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-938"></span><span>        </span><span id="local-6989586621682206674"><span class="annot"><a href="#local-6989586621682206674"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Nat
forall {f :: * -&gt; *}. HasConstInfo f =&gt; QName -&gt; f Nat
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206672"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-939"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206676"><span class="annot"><a href="#local-6989586621682206676"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206673"><span class="hs-identifier hs-var">hsc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Pat] -&gt; Pat) -&gt; [Pat] -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Pat -&gt; [Pat]
forall a. Nat -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206674"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span>
</span><span id="line-940"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206676"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-type">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span>
</span><span id="line-941"></span><span>
</span><span id="line-942"></span><span>  </span><span id="local-6989586621682206681"><span class="annot"><a href="#local-6989586621682206681"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; [Char] -&gt; m Alt) -&gt; [QName] -&gt; [[Char]] -&gt; m [Alt]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char] -&gt; m Alt
forall {m :: * -&gt; *}. HasConstInfo m =&gt; QName -&gt; [Char] -&gt; m Alt
</span><a href="#local-6989586621682206671"><span class="hs-identifier hs-var">makeClause</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682206634"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682206635"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-943"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206682"><span class="annot"><a href="#local-6989586621682206682"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Alt] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-var">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621682206681"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-type">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-type">CoverK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206631"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeType"><span class="hs-identifier hs-type">fakeType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206632"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682206636"><span class="hs-identifier hs-type">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; -&gt; ()&quot;</span></span><span>
</span><span id="line-946"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-type">CoverK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206631"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-type">HS.Ident</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-947"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206682"><span class="hs-identifier hs-type">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-948"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-type">closedTerm_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-951"></span><span id="closedTerm_"><span class="annot"><span class="annottext">closedTerm_ :: TTerm -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-var hs-var">closedTerm_</span></a></span></span><span> </span><span id="local-6989586621682206687"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206687"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp, UsesFloat) -&gt; Exp
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Exp, UsesFloat) -&gt; Exp)
-&gt; HsCompileM (Exp, UsesFloat)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206687"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-type">closedTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span id="closedTerm"><span class="annot"><span class="annottext">closedTerm :: TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var hs-var">closedTerm</span></a></span></span><span> </span><span id="local-6989586621682206689"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206689"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621682206690"><span class="annot"><a href="#local-6989586621682206690"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM TTerm -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM TTerm
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm)
-&gt; TCM TTerm
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TCM TTerm
forall (m :: * -&gt; *). HasConstInfo m =&gt; TTerm -&gt; m TTerm
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#addCoercions"><span class="hs-identifier hs-var">addCoercions</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206689"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206690"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-var">`runReaderT`</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-type">initCCEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>
</span><span id="line-958"></span><span class="hs-comment">-- Translate case on bool to if</span><span>
</span><span id="line-959"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-type">mkIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span>
</span><span id="line-960"></span><span id="mkIf"><span class="annot"><span class="annottext">mkIf :: TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var hs-var">mkIf</span></a></span></span><span> </span><span id="local-6989586621682206694"><span class="annot"><span class="annottext">t :: TTerm
</span><a href="#local-6989586621682206694"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">TCase</span></a></span><span> </span><span id="local-6989586621682206696"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206696"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">CaseInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682206697"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206697"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621682206699"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206699"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682206700"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206700"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621682206701"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206701"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682206702"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206702"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; Bool
forall a. Unreachable a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Treeless.html#isUnreachable"><span class="hs-identifier hs-var">T.isUnreachable</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206697"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621682206704"><span class="annot"><a href="#local-6989586621682206704"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
-&gt; CCT TCM GHCEnv
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var">askGHCEnv</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206705"><span class="annot"><a href="#local-6989586621682206705"><span class="hs-identifier hs-var hs-var">isTrue</span></a></span></span><span>  </span><span id="local-6989586621682206706"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206706"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206706"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvTrue"><span class="hs-identifier hs-var">ghcEnvTrue</span></a></span><span>  </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206704"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-963"></span><span>      </span><span id="local-6989586621682206707"><span class="annot"><a href="#local-6989586621682206707"><span class="hs-identifier hs-var hs-var">isFalse</span></a></span></span><span> </span><span id="local-6989586621682206708"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206708"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206708"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFalse"><span class="hs-identifier hs-var">ghcEnvFalse</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621682206704"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682206705"><span class="hs-identifier hs-type">isTrue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206699"><span class="hs-identifier hs-type">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206707"><span class="hs-identifier hs-type">isFalse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206701"><span class="hs-identifier hs-type">c2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-type">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-type">TCoerce</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206696"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206700"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206702"><span class="hs-identifier hs-type">b2</span></a></span><span>
</span><span id="line-965"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682206705"><span class="hs-identifier hs-type">isTrue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206701"><span class="hs-identifier hs-type">c2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682206707"><span class="hs-identifier hs-type">isFalse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206699"><span class="hs-identifier hs-type">c1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-type">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-type">TCoerce</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206696"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206702"><span class="hs-identifier hs-type">b2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206700"><span class="hs-identifier hs-type">b1</span></a></span><span>
</span><span id="line-966"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682206694"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-967"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span id="local-6989586621682206712"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206712"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206712"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span class="hs-comment">-- | Extract Agda term to Haskell expression.</span><span>
</span><span id="line-970"></span><span class="hs-comment">--   Erased arguments are extracted as @()@.</span><span>
</span><span id="line-971"></span><span class="hs-comment">--   Types are extracted as @()@.</span><span>
</span><span id="line-972"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-973"></span><span id="term"><span class="annot"><span class="annottext">term :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span id="local-6989586621682206713"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206713"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206713"><span class="hs-identifier hs-var">tm0</span></a></span><span> </span><span class="annot"><span class="annottext">CC TTerm -&gt; (TTerm -&gt; CC Exp) -&gt; CC Exp
forall a b.
ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  a
-&gt; (a
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         b)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206714"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206714"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682206715"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206715"><span class="hs-identifier hs-var hs-var">hasCoerce</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206716"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206716"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206717"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206717"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; ((Bool, TTerm), [TTerm])
</span><a href="Agda.Syntax.Treeless.html#coerceAppView"><span class="hs-identifier hs-var">coerceAppView</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206714"><span class="hs-identifier hs-var">tm0</span></a></span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-comment">-- let (t0, ts)       = tAppView tm0</span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-comment">-- let (hasCoerce, t) = coerceView t0</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206719"><span class="annot"><span class="annottext">coe :: Exp -&gt; Exp
</span><a href="#local-6989586621682206719"><span class="hs-identifier hs-var hs-var">coe</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682206715"><span class="hs-identifier hs-var">hasCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206716"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206717"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-979"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PIf"><span class="hs-identifier hs-var">T.PIf</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682206723"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206723"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206724"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206724"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206725"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206725"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682206719"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#If"><span class="hs-identifier hs-var">HS.If</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     (Exp -&gt; Exp -&gt; Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206723"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     (Exp -&gt; Exp)
forall a b.
ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (a -&gt; b)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206724"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (Exp -&gt; Exp)
-&gt; CC Exp -&gt; CC Exp
forall a b.
ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (a -&gt; b)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206725"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span> </span><span id="local-6989586621682206728"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206728"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206729"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206729"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-982"></span><span>      </span><span id="local-6989586621682206730"><span class="annot"><a href="#local-6989586621682206730"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
 -&gt; CCT TCM [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206728"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-983"></span><span>      </span><span class="hs-comment">-- #2248: no unused argument pruning for COMPILE'd functions</span><span>
</span><span id="line-984"></span><span>      </span><span id="local-6989586621682206731"><span class="annot"><a href="#local-6989586621682206731"><span class="hs-identifier hs-var">isCompiled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-type">liftTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-type">getHaskellPragma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206728"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-985"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206733"><span class="annot"><a href="#local-6989586621682206733"><span class="hs-identifier hs-var hs-var">given</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TTerm] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206729"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-986"></span><span>          </span><span id="local-6989586621682206734"><span class="annot"><a href="#local-6989586621682206734"><span class="hs-identifier hs-var hs-var">needed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206730"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-987"></span><span>          </span><span id="local-6989586621682206735"><span class="annot"><a href="#local-6989586621682206735"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [ArgUsage] -&gt; [ArgUsage]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206733"><span class="hs-identifier hs-var">given</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621682206730"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-988"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682206731"><span class="hs-identifier hs-type">isCompiled</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-type">ArgUnused</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`elem`</span></span><span> </span><span class="annot"><a href="#local-6989586621682206730"><span class="hs-identifier hs-type">used</span></a></span><span>
</span><span id="line-989"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-type">ArgUnused</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`elem`</span></span><span> </span><span class="annot"><a href="#local-6989586621682206735"><span class="hs-identifier hs-type">missing</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206737"><span class="hs-identifier hs-type">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206734"><span class="hs-identifier hs-type">needed</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682206733"><span class="hs-identifier hs-type">given</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206714"><span class="hs-identifier hs-type">tm0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-990"></span><span>          </span><span id="local-6989586621682206738"><span class="annot"><a href="#local-6989586621682206738"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-type">HS.Var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-type">xhqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-type">FunK</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NoUnused"><span class="hs-identifier hs-type">NoUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206728"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-991"></span><span>                                   </span><span class="hs-comment">-- use stripped function</span><span>
</span><span id="line-992"></span><span>          </span><span class="hs-comment">-- Andreas, 2019-11-07, issue #4169.</span><span>
</span><span id="line-993"></span><span>          </span><span class="hs-comment">-- Insert coercion unconditionally as erasure of arguments</span><span>
</span><span id="line-994"></span><span>          </span><span class="hs-comment">-- that are matched upon might remove the unfolding of codomain types.</span><span>
</span><span id="line-995"></span><span>          </span><span class="hs-comment">-- (Hard to explain, see test/Compiler/simple/Issue4169.)</span><span>
</span><span id="line-996"></span><span>          </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206738"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206741"><span class="hs-operator hs-type">`apps`</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-type">filterUsed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206730"><span class="hs-identifier hs-type">used</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206729"><span class="hs-identifier hs-type">ts</span></a></span><span>
</span><span id="line-997"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-998"></span><span>          </span><span id="local-6989586621682206742"><span class="annot"><a href="#local-6989586621682206742"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-type">HS.Var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-type">xhqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-type">FunK</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#PossiblyUnused"><span class="hs-identifier hs-type">PossiblyUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206728"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-999"></span><span>                                   </span><span class="hs-comment">-- use original (non-stripped) function</span><span>
</span><span id="line-1000"></span><span>          </span><span class="annot"><a href="#local-6989586621682206719"><span class="hs-identifier hs-type">coe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206742"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206741"><span class="hs-operator hs-type">`apps`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206729"><span class="hs-identifier hs-type">ts</span></a></span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span> </span><span id="local-6989586621682206745"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206745"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206746"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206746"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1003"></span><span>      </span><span id="local-6989586621682206747"><span class="annot"><a href="#local-6989586621682206747"><span class="hs-identifier hs-var">erased</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206745"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1004"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206749"><span class="annot"><a href="#local-6989586621682206749"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Bool] -&gt; [Bool]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TTerm] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206746"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621682206747"><span class="hs-identifier hs-var">erased</span></a></span><span>
</span><span id="line-1005"></span><span>          </span><span id="local-6989586621682206750"><span class="annot"><a href="#local-6989586621682206750"><span class="hs-identifier hs-var hs-var">notErased</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-1006"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">all</span></span><span> </span><span class="annot"><a href="#local-6989586621682206750"><span class="hs-identifier hs-type">notErased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206749"><span class="hs-identifier hs-type">missing</span></a></span><span>
</span><span id="line-1007"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1008"></span><span>                </span><span id="local-6989586621682206752"><span class="annot"><a href="#local-6989586621682206752"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-type">HS.Con</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-type">conhqn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206745"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-1009"></span><span>                </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206752"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206741"><span class="hs-operator hs-type">`apps`</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621682206755"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682206755"><span class="annot"><a href="#local-6989586621682206755"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Zip.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206746"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206747"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1010"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1011"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206756"><span class="annot"><a href="#local-6989586621682206756"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621682206749"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-1012"></span><span>                </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-type">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206756"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span>  </span><span class="hs-comment">-- We will add at least on TLam, not getting a busy loop here.</span><span>
</span><span id="line-1013"></span><span>                </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682206737"><span class="hs-identifier hs-type">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621682206749"><span class="hs-identifier hs-type">missing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206714"><span class="hs-identifier hs-type">tm0</span></a></span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span>    </span><span class="hs-comment">-- Other kind of application: fall back to apps.</span><span>
</span><span id="line-1016"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682206757"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206757"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206758"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206758"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var">noApplication</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206757"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CC Exp -&gt; (Exp -&gt; CC Exp) -&gt; CC Exp
forall a b.
ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  a
-&gt; (a
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         b)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206760"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206760"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682206719"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206760"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621682206741"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621682206758"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1018"></span><span>  </span><span id="local-6989586621682206741"><span class="annot"><span class="annottext">apps :: Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621682206741"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; TTerm -&gt; CC Exp) -&gt; Exp -&gt; [TTerm] -&gt; CC Exp
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206776"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206776"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682206777"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206777"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206776"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206777"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>  </span><span id="local-6989586621682206737"><span class="annot"><span class="annottext">etaExpand :: Nat -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621682206737"><span class="hs-identifier hs-var hs-var">etaExpand</span></a></span></span><span> </span><span id="local-6989586621682206782"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206782"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682206783"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206783"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTLam"><span class="hs-identifier hs-var">mkTLam</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206782"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206782"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206783"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; [TTerm] -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTApp"><span class="hs-operator hs-var">`T.mkTApp`</span></a></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; TTerm) -&gt; [Nat] -&gt; [TTerm]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; [Nat]
forall a. Integral a =&gt; a -&gt; [a]
</span><a href="Agda.Utils.List.html#downFrom"><span class="hs-identifier hs-var">downFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>
</span><span id="line-1021"></span><span class="annot"><span class="hs-comment">-- | Translate a non-application, non-coercion, non-constructor, non-definition term.</span></span><span>
</span><span id="line-1022"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-type">noApplication</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1023"></span><span id="noApplication"><span class="annot"><span class="annottext">noApplication :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var hs-var">noApplication</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1024"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TApp"><span class="hs-identifier hs-type">T.TApp</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1025"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-type">T.TCoerce</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1026"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1027"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-type">T.TVar</span></a></span><span> </span><span id="local-6989586621682206789"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206789"><span class="hs-identifier hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; ([Name] -&gt; Name) -&gt; [Name] -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var">lookupIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Exp)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     [Name]
-&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' CCEnv [Name]
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' o i -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; f [Name]) -&gt; CCEnv -&gt; f CCEnv
Lens' CCEnv [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span>
</span><span id="line-1030"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-type">T.TLam</span></a></span><span> </span><span id="local-6989586621682206792"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206792"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CC Exp) -&gt; CC Exp) -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682206793"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206793"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-var">hsLambda</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206793"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206792"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLet"><span class="hs-identifier hs-type">T.TLet</span></a></span><span> </span><span id="local-6989586621682206796"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206796"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682206797"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206797"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1033"></span><span>    </span><span id="local-6989586621682206798"><span class="annot"><a href="#local-6989586621682206798"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206796"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1034"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-type">intros</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">[</span><span id="local-6989586621682206799"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206799"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLet"><span class="hs-identifier hs-var">hsLet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206799"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206798"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; (Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206797"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">T.TCase</span></a></span><span> </span><span id="local-6989586621682206801"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206801"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621682206802"><span class="annot"><span class="annottext">CaseInfo
</span><a href="#local-6989586621682206802"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span id="local-6989586621682206803"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206803"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621682206804"><span class="annot"><span class="annottext">[TAlt]
</span><a href="#local-6989586621682206804"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1038"></span><span>    </span><span id="local-6989586621682206805"><span class="annot"><a href="#local-6989586621682206805"><span class="hs-identifier hs-var">sc'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206801"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-1039"></span><span>    </span><span id="local-6989586621682206806"><span class="annot"><a href="#local-6989586621682206806"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-type">alt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206801"><span class="hs-identifier hs-type">sc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206804"><span class="hs-identifier hs-type">alts</span></a></span><span>
</span><span id="line-1040"></span><span>    </span><span id="local-6989586621682206808"><span class="annot"><a href="#local-6989586621682206808"><span class="hs-identifier hs-var">def'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206803"><span class="hs-identifier hs-type">def</span></a></span><span>
</span><span id="line-1041"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206809"><span class="annot"><a href="#local-6989586621682206809"><span class="hs-identifier hs-var hs-var">defAlt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206808"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-1042"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-type">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206805"><span class="hs-identifier hs-type">sc'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682206806"><span class="hs-identifier hs-type">alts'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682206809"><span class="hs-identifier hs-type">defAlt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>
</span><span id="line-1044"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLit"><span class="hs-identifier hs-type">T.TLit</span></a></span><span> </span><span id="local-6989586621682206811"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206811"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206811"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1045"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span id="local-6989586621682206813"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621682206813"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var">compilePrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621682206813"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1046"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TUnit"><span class="hs-identifier hs-var">T.TUnit</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-1047"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TSort"><span class="hs-identifier hs-var">T.TSort</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-1048"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-var">T.TErased</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span>
</span><span id="line-1049"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TError"><span class="hs-identifier hs-type">T.TError</span></a></span><span> </span><span id="local-6989586621682206818"><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621682206818"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall a.
a
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621682206818"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1050"></span><span>    </span><span class="annot"><span class="annottext">TError
</span><a href="Agda.Syntax.Treeless.html#TUnreachable"><span class="hs-identifier hs-var">T.TUnreachable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmUnreachableError"><span class="hs-identifier hs-var">rtmUnreachableError</span></a></span><span>
</span><span id="line-1051"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TMeta"><span class="hs-identifier hs-type">T.TMeta</span></a></span><span> </span><span id="local-6989586621682206822"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206822"><span class="hs-identifier hs-var">s</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmHole"><span class="hs-identifier hs-var">rtmHole</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206822"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1054"></span><span id="hsCoerce"><span class="annot"><span class="annottext">hsCoerce :: Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var hs-var">hsCoerce</span></a></span></span><span> </span><span id="local-6989586621682206824"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206824"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerce"><span class="hs-identifier hs-var">mazCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206824"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-type">compilePrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1057"></span><span id="compilePrim"><span class="annot"><span class="annottext">compilePrim :: TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var hs-var">compilePrim</span></a></span></span><span> </span><span id="local-6989586621682206826"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621682206826"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; QName) -&gt; [Char] -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; [Char]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621682206826"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-type">alt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAlt"><span class="hs-identifier hs-type">T.TAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-1060"></span><span id="alt"><span class="annot"><span class="annottext">alt :: Nat
-&gt; TAlt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-var hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621682206828"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206828"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621682206829"><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621682206829"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1061"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621682206829"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1062"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">T.TACon</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">aCon :: TAlt -&gt; QName
</span><a href="Agda.Syntax.Treeless.html#aCon"><span class="hs-identifier hs-var">T.aCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206831"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206831"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1063"></span><span>      </span><span class="annot"><span class="annottext">Nat
-&gt; ([Name]
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         Alt)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TAlt -&gt; Nat
</span><a href="Agda.Syntax.Treeless.html#aArity"><span class="hs-identifier hs-var">T.aArity</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621682206829"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name]
  -&gt; ReaderT
       CCEnv
       (WriterT
          UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
       Alt)
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; ([Name]
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         Alt)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682206833"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682206833"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1064"></span><span>        </span><span id="local-6989586621682206834"><span class="annot"><a href="#local-6989586621682206834"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206831"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1065"></span><span>        </span><span id="local-6989586621682206835"><span class="annot"><a href="#local-6989586621682206835"><span class="hs-identifier hs-var">env</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-type">askGHCEnv</span></a></span><span>
</span><span id="line-1066"></span><span>        </span><span id="local-6989586621682206836"><span class="annot"><a href="#local-6989586621682206836"><span class="hs-identifier hs-var">hConNm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1067"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682206831"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNil"><span class="hs-identifier hs-var">ghcEnvNil</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206835"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1068"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-type">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-type">HS.Ident</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;[]&quot;</span></span><span>
</span><span id="line-1069"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682206831"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvCons"><span class="hs-identifier hs-var">ghcEnvCons</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206835"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1070"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-type">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Symbol"><span class="hs-identifier hs-type">HS.Symbol</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-1071"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-type">conhqn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206831"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-1072"></span><span>        </span><span class="annot"><a href="#local-6989586621682206838"><span class="hs-identifier hs-type">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-type">HS.PApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206836"><span class="hs-identifier hs-type">hConNm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206839"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682206839"><span class="annot"><a href="#local-6989586621682206839"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Zip.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206833"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206834"><span class="hs-identifier hs-type">erased</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1073"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAGuard"><span class="hs-identifier hs-type">T.TAGuard</span></a></span><span> </span><span id="local-6989586621682206841"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206841"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682206842"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206842"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1074"></span><span>      </span><span id="local-6989586621682206843"><span class="annot"><a href="#local-6989586621682206843"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206841"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1075"></span><span>      </span><span id="local-6989586621682206844"><span class="annot"><a href="#local-6989586621682206844"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206842"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1076"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-type">HS.PWildCard</span></a></span><span>
</span><span id="line-1077"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-type">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-type">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-type">HS.Qualifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206843"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682206844"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>                      </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span>
</span><span id="line-1079"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span> </span><span id="local-6989586621682206851"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206851"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206838"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var">litqnamepat</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206851"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitMeta"><span class="hs-identifier hs-type">LitMeta</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682206854"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682206854"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206838"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litmetapat"><span class="hs-identifier hs-var">litmetapat</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682206854"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206856"><span class="annot"><span class="annottext">l :: Literal
</span><a href="#local-6989586621682206856"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206859"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206859"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1082"></span><span>      </span><span class="annot"><span class="annottext">UsesFloat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span>
</span><span id="line-1083"></span><span>      </span><span id="local-6989586621682206861"><span class="annot"><a href="#local-6989586621682206861"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206856"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1084"></span><span>      </span><span class="annot"><a href="#local-6989586621682206862"><span class="hs-identifier hs-type">mkGuarded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-type">treelessPrimName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#PEqF"><span class="hs-identifier hs-type">T.PEqF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682206861"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206859"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1085"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682206865"><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206865"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206866"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206866"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206862"><span class="hs-identifier hs-var">mkGuarded</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(==)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BackendName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206865"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1086"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206838"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Pat) -&gt; Literal -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; Literal -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621682206829"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1088"></span><span>    </span><span id="local-6989586621682206862"><span class="annot"><span class="annottext">mkGuarded :: [Char]
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206862"><span class="hs-identifier hs-var hs-var">mkGuarded</span></a></span></span><span> </span><span id="local-6989586621682206878"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206878"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621682206879"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206879"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621682206880"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206880"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1089"></span><span>      </span><span id="local-6989586621682206881"><span class="annot"><a href="#local-6989586621682206881"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621682206880"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1090"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206882"><span class="annot"><a href="#local-6989586621682206882"><span class="hs-identifier hs-var hs-var">varName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;l&quot;</span></span><span> </span><span class="hs-comment">-- only used locally in the guard</span><span>
</span><span id="line-1091"></span><span>          </span><span id="local-6989586621682206883"><span class="annot"><a href="#local-6989586621682206883"><span class="hs-identifier hs-var hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206882"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-1092"></span><span>          </span><span id="local-6989586621682206884"><span class="annot"><a href="#local-6989586621682206884"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682206882"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-1093"></span><span>          </span><span id="local-6989586621682206885"><span class="annot"><a href="#local-6989586621682206885"><span class="hs-identifier hs-var hs-var">guard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1094"></span><span>            </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206878"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-1095"></span><span>              </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206884"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206879"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1096"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206883"><span class="hs-identifier hs-type">pv</span></a></span><span>
</span><span id="line-1097"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-type">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-type">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-type">HS.Qualifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206885"><span class="hs-identifier hs-type">guard</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682206881"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>                      </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span>
</span><span id="line-1099"></span><span>
</span><span id="line-1100"></span><span>    </span><span class="annot"><a href="#local-6989586621682206838"><span class="hs-identifier hs-type">mkAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-1101"></span><span>    </span><span id="local-6989586621682206838"><span class="annot"><span class="annottext">mkAlt :: Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621682206838"><span class="hs-identifier hs-var hs-var">mkAlt</span></a></span></span><span> </span><span id="local-6989586621682206886"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682206886"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1102"></span><span>        </span><span id="local-6989586621682206887"><span class="annot"><a href="#local-6989586621682206887"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621682206829"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1103"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682206888"><span class="annot"><a href="#local-6989586621682206888"><span class="hs-identifier hs-var hs-var">body''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206887"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1104"></span><span>                       </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-type">HS.Lambda</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206887"><span class="hs-identifier hs-var">body'</span></a></span><span>
</span><span id="line-1105"></span><span>                       </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206887"><span class="hs-identifier hs-var">body'</span></a></span><span>
</span><span id="line-1106"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206886"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206888"><span class="hs-identifier hs-type">body''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-type">literal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682204546"><span class="annot"><a href="#local-6989586621682204546"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682204546"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204546"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1109"></span><span id="literal"><span class="annot"><span class="annottext">literal :: forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var hs-var">literal</span></a></span></span><span> </span><span id="local-6989586621682206909"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206909"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206909"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1110"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206911"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Integer&quot;</span></span><span>
</span><span id="line-1111"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206911"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MAlonzo.RTE.Word64&quot;</span></span><span>
</span><span id="line-1112"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621682206913"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206913"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Char] -&gt; CCT m Exp
</span><a href="#local-6989586621682206914"><span class="hs-identifier hs-var">floatExp</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206913"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Double&quot;</span></span><span>
</span><span id="line-1113"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621682206915"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206915"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var">litqname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206915"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1114"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682206917"><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206917"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BackendName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206917"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitMeta"><span class="hs-identifier hs-type">LitMeta</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682206918"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682206918"><span class="hs-identifier hs-var">m</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1116"></span><span>    </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(,)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-1117"></span><span>             </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Word64
</span><a href="Agda.Syntax.Common.html#metaId"><span class="hs-identifier hs-var">metaId</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682206918"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-1118"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleNameHash -&gt; Word64
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#moduleNameHash"><span class="hs-identifier hs-var">moduleNameHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleNameHash -&gt; Word64) -&gt; ModuleNameHash -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ModuleNameHash
</span><a href="Agda.Syntax.Common.html#metaModule"><span class="hs-identifier hs-var">metaModule</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682206918"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206923"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1121"></span><span>    </span><span id="local-6989586621682206923"><span class="annot"><span class="annottext">l' :: Exp
</span><a href="#local-6989586621682206923"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682206909"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1122"></span><span>    </span><span id="local-6989586621682206911"><span class="annot"><span class="annottext">typed :: [Char] -&gt; Exp
</span><a href="#local-6989586621682206911"><span class="hs-identifier hs-var hs-var">typed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#ExpTypeSig"><span class="hs-identifier hs-var">HS.ExpTypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682206923"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Exp) -&gt; ([Char] -&gt; Type) -&gt; [Char] -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Type) -&gt; ([Char] -&gt; QName) -&gt; [Char] -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-var">rtmQual</span></a></span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span>    </span><span class="hs-comment">-- ASR (2016-09-14): See Issue #2169.</span><span>
</span><span id="line-1125"></span><span>    </span><span class="hs-comment">-- Ulf, 2016-09-28: and #2218.</span><span>
</span><span id="line-1126"></span><span>    </span><span class="annot"><a href="#local-6989586621682206914"><span class="hs-identifier hs-type">floatExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204546"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1127"></span><span>    </span><span id="local-6989586621682206914"><span class="annot"><span class="annottext">floatExp :: Double -&gt; [Char] -&gt; CCT m Exp
</span><a href="#local-6989586621682206914"><span class="hs-identifier hs-var hs-var">floatExp</span></a></span></span><span> </span><span id="local-6989586621682206926"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206926"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682206927"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206927"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-1128"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isPosInf"><span class="hs-identifier hs-var">isPosInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206926"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; [Char] -&gt; m Exp
</span><a href="#local-6989586621682206929"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;positiveInfinity&quot;</span></span><span>
</span><span id="line-1129"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegInf"><span class="hs-identifier hs-var">isNegInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206926"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; [Char] -&gt; m Exp
</span><a href="#local-6989586621682206929"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;negativeInfinity&quot;</span></span><span>
</span><span id="line-1130"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegZero"><span class="hs-identifier hs-var">isNegZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206926"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; [Char] -&gt; m Exp
</span><a href="#local-6989586621682206929"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;negativeZero&quot;</span></span><span>
</span><span id="line-1131"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span>     </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206926"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; [Char] -&gt; m Exp
</span><a href="#local-6989586621682206929"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;nan&quot;</span></span><span>
</span><span id="line-1132"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall a. a -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206911"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206927"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1133"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1134"></span><span>        </span><span id="local-6989586621682206929"><span class="annot"><span class="annottext">rte :: [Char] -&gt; m Exp
</span><a href="#local-6989586621682206929"><span class="hs-identifier hs-var hs-var">rte</span></a></span></span><span> </span><span id="local-6989586621682206947"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206947"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; m ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m Exp
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206947"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-type">hslit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Literal"><span class="hs-identifier hs-type">HS.Literal</span></a></span><span>
</span><span id="line-1137"></span><span id="hslit"><span class="annot"><span class="annottext">hslit :: Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var hs-var">hslit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1138"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span id="local-6989586621682206948"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682206948"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682206948"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1139"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span id="local-6989586621682206950"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206950"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206950"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621682206951"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206951"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Frac"><span class="hs-identifier hs-var">HS.Frac</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206951"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span>   </span><span id="local-6989586621682206954"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682206954"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Char"><span class="hs-identifier hs-var">HS.Char</span></a></span><span>   </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682206954"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1142"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621682206956"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206956"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1143"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span class="annot"><span class="annottext">BackendName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1144"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitMeta"><span class="hs-identifier hs-type">LitMeta</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1145"></span><span>
</span><span id="line-1146"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-type">litString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1147"></span><span id="litString"><span class="annot"><span class="annottext">litString :: BackendName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var hs-var">litString</span></a></span></span><span> </span><span id="local-6989586621682206957"><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206957"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Ann"><span class="hs-identifier hs-var">HS.Ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BackendName -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">BackendName
</span><a href="#local-6989586621682206957"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Data.Text&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Text&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-type">litqname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1151"></span><span id="litqname"><span class="annot"><span class="annottext">litqname :: QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var hs-var">litqname</span></a></span></span><span> </span><span id="local-6989586621682206959"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206959"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1152"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;QName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621682206961"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-1153"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206962"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1154"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206963"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BackendName -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">(BackendName -&gt; Literal) -&gt; BackendName -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BackendName
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; BackendName) -&gt; [Char] -&gt; BackendName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206959"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Fixity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621682206961"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-1157"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Associativity -&gt; Exp
</span><a href="#local-6989586621682206964"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; Associativity
</span><a href="Agda.Syntax.Common.html#fixityAssoc"><span class="hs-identifier hs-var">fixityAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682206966"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FixityLevel -&gt; Exp
</span><a href="#local-6989586621682206967"><span class="hs-identifier hs-var">litPrec</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; FixityLevel
</span><a href="Agda.Syntax.Common.html#fixityLevel"><span class="hs-identifier hs-var">fixityLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682206966"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1160"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-1161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1162"></span><span>    </span><span id="local-6989586621682206961"><span class="annot"><span class="annottext">apps :: Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621682206961"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span>
</span><span id="line-1163"></span><span>    </span><span id="local-6989586621682206960"><span class="annot"><span class="annottext">rteCon :: [Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var hs-var">rteCon</span></a></span></span><span> </span><span id="local-6989586621682206970"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206970"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-var">HS.Con</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682206970"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1164"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621682206962"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206962"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.Boot.html#ModuleNameHash"><span class="hs-identifier hs-type">ModuleNameHash</span></a></span><span> </span><span id="local-6989586621682206963"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206963"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206959"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1165"></span><span>    </span><span id="local-6989586621682206966"><span class="annot"><span class="annottext">fx :: Fixity
</span><a href="#local-6989586621682206966"><span class="hs-identifier hs-var hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Fixity
</span><a href="Agda.Syntax.Common.html#theFixity"><span class="hs-identifier hs-var">theFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity' -&gt; Fixity) -&gt; Fixity' -&gt; Fixity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity'
</span><a href="Agda.Syntax.Abstract.Name.html#nameFixity"><span class="hs-identifier hs-var">nameFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Fixity') -&gt; Name -&gt; Fixity'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206959"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1166"></span><span>
</span><span id="line-1167"></span><span>    </span><span id="local-6989586621682206964"><span class="annot"><span class="annottext">litAssoc :: Associativity -&gt; Exp
</span><a href="#local-6989586621682206964"><span class="hs-identifier hs-var hs-var">litAssoc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#NonAssoc"><span class="hs-identifier hs-var">NonAssoc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NonAssoc&quot;</span></span><span>
</span><span id="line-1168"></span><span>    </span><span class="annot"><a href="#local-6989586621682206964"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#LeftAssoc"><span class="hs-identifier hs-var">LeftAssoc</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;LeftAssoc&quot;</span></span><span>
</span><span id="line-1169"></span><span>    </span><span class="annot"><a href="#local-6989586621682206964"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#RightAssoc"><span class="hs-identifier hs-var">RightAssoc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RightAssoc&quot;</span></span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span>    </span><span id="local-6989586621682206967"><span class="annot"><span class="annottext">litPrec :: FixityLevel -&gt; Exp
</span><a href="#local-6989586621682206967"><span class="hs-identifier hs-var hs-var">litPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityLevel
</span><a href="Agda.Syntax.Common.html#Unrelated"><span class="hs-identifier hs-var">Unrelated</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unrelated&quot;</span></span><span>
</span><span id="line-1172"></span><span>    </span><span class="annot"><a href="#local-6989586621682206967"><span class="hs-identifier hs-var">litPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Related"><span class="hs-identifier hs-type">Related</span></a></span><span> </span><span id="local-6989586621682206983"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206983"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp
</span><a href="#local-6989586621682206960"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Related&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp
forall a. Real a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedDouble"><span class="hs-identifier hs-var">hsTypedDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682206983"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1173"></span><span>
</span><span id="line-1174"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-type">litqnamepat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span>
</span><span id="line-1175"></span><span id="litqnamepat"><span class="annot"><span class="annottext">litqnamepat :: QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var hs-var">litqnamepat</span></a></span></span><span> </span><span id="local-6989586621682206985"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206985"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1176"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;QName&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206986"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206987"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1179"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1180"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1181"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621682206986"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206986"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.Boot.html#ModuleNameHash"><span class="hs-identifier hs-type">ModuleNameHash</span></a></span><span> </span><span id="local-6989586621682206987"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206987"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206985"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1182"></span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litmetapat"><span class="hs-identifier hs-type">litmetapat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span>
</span><span id="line-1184"></span><span id="litmetapat"><span class="annot"><span class="annottext">litmetapat :: MetaId -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litmetapat"><span class="hs-identifier hs-var hs-var">litmetapat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span id="local-6989586621682206989"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206989"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682206990"><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621682206990"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1185"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(,)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682206989"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1187"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Integer) -&gt; Word64 -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash -&gt; Word64
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#moduleNameHash"><span class="hs-identifier hs-var">moduleNameHash</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621682206990"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-type">condecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span>
</span><span id="line-1190"></span><span id="condecl"><span class="annot"><span class="annottext">condecl :: QName
-&gt; Induction
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var hs-var">condecl</span></a></span></span><span> </span><span id="local-6989586621682206991"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682206991"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682206992"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682206992"><span class="hs-identifier hs-var">_ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1191"></span><span>  </span><span id="local-6989586621682206993"><span class="annot"><a href="#local-6989586621682206993"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1192"></span><span>  </span><span id="local-6989586621682206994"><span class="annot"><a href="#local-6989586621682206994"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-type">getConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206991"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1193"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682206996"><span class="annot"><a href="#local-6989586621682206996"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682206997"><span class="annot"><a href="#local-6989586621682206997"><span class="hs-identifier hs-var hs-var">conSrcCon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conErased"><span class="hs-identifier hs-var">conErased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682207000"><span class="annot"><a href="#local-6989586621682207000"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206994"><span class="hs-identifier hs-type">def</span></a></span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682207001"><span class="annot"><a href="#local-6989586621682207001"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-type">hsTelApproximation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206994"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207002"><span class="annot"><a href="#local-6989586621682207002"><span class="hs-identifier hs-var hs-var">strict</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; Induction
</span><a href="Agda.Syntax.Internal.html#conInductive"><span class="hs-identifier hs-var">conInductive</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682206997"><span class="hs-identifier hs-var">conSrcCon</span></a></span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Induction -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-1196"></span><span>                      </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var">optGhcStrictData</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621682206993"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1197"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Strict"><span class="hs-identifier hs-var">HS.Strict</span></a></span><span>
</span><span id="line-1198"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Lazy"><span class="hs-identifier hs-var">HS.Lazy</span></a></span><span>
</span><span id="line-1199"></span><span>      </span><span id="local-6989586621682207006"><span class="annot"><a href="#local-6989586621682207006"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strictness -&gt; Maybe Strictness
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621682207002"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682207007"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1200"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682207007"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682207007"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Infinite Bool -&gt; [(Type, Bool)]
forall a b. [a] -&gt; Infinite b -&gt; [(a, b)]
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) a b.
Zip f g h =&gt;
f a -&gt; g b -&gt; h (a, b)
</span><a href="Agda.Utils.Zip.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; [Type] -&gt; [Type]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682206996"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682207001"><span class="hs-identifier hs-var">argTypes0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1201"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Bool -&gt; Infinite Bool
forall a. [a] -&gt; a -&gt; ListInf a
</span><a href="Agda.Utils.ListInf.html#pad"><span class="hs-identifier hs-var">ListInf.pad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Maybe [Bool] -&gt; [Bool]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [Bool]
</span><a href="#local-6989586621682207000"><span class="hs-identifier hs-var">erased</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-1203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-type">ConK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682206991"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682207006"><span class="hs-identifier hs-type">argTypes</span></a></span><span>
</span><span id="line-1204"></span><span>
</span><span id="line-1205"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span>
</span><span id="line-1206"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The constructor's arity (after erasure).</span></span><span>
</span><span id="line-1207"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-1208"></span><span id="compiledcondecl"><span class="annot"><span class="annottext">compiledcondecl :: Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var hs-var">compiledcondecl</span></a></span></span><span> </span><span id="local-6989586621682207011"><span class="annot"><span class="annottext">Maybe Nat
</span><a href="#local-6989586621682207011"><span class="hs-identifier hs-var">mar</span></a></span></span><span> </span><span id="local-6989586621682207012"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207012"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1209"></span><span>  </span><span id="local-6989586621682207013"><span class="annot"><a href="#local-6989586621682207013"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Nat
</span><a href="#local-6989586621682207011"><span class="hs-identifier hs-var">mar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1210"></span><span>    </span><span class="annot"><span class="annottext">Maybe Nat
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCMT IO Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a.
TCM a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Nat
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat)
-&gt; TCMT IO Nat
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Nat
forall {f :: * -&gt; *}. HasConstInfo f =&gt; QName -&gt; f Nat
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207012"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1211"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682207014"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207014"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a. a -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207014"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-1212"></span><span>  </span><span id="local-6989586621682207015"><span class="annot"><a href="#local-6989586621682207015"><span class="hs-identifier hs-var">hsCon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellConstructor"><span class="hs-identifier hs-type">getHaskellConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207012"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1213"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207017"><span class="annot"><a href="#local-6989586621682207017"><span class="hs-identifier hs-var hs-var">patVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Pat) -&gt; [Nat] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207013"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-1214"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PatSyn"><span class="hs-identifier hs-type">HS.PatSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-type">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-type">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-type">ConK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207012"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682207017"><span class="hs-identifier hs-type">patVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-type">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-type">hsName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207015"><span class="hs-identifier hs-type">hsCon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682207017"><span class="hs-identifier hs-type">patVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-1218"></span><span id="compiledTypeSynonym"><span class="annot"><span class="annottext">compiledTypeSynonym :: QName -&gt; [Char] -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var hs-var">compiledTypeSynonym</span></a></span></span><span> </span><span id="local-6989586621682207019"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207019"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682207020"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207020"><span class="hs-identifier hs-var">hsT</span></a></span></span><span> </span><span id="local-6989586621682207021"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207021"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1219"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207019"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; [Name] -&gt; [TyVarBind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682207022"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1220"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyApp"><span class="hs-identifier hs-var">HS.TyApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207020"><span class="hs-identifier hs-var">hsT</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; [Name] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyVar"><span class="hs-identifier hs-var">HS.TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682207022"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1222"></span><span>    </span><span id="local-6989586621682207022"><span class="annot"><span class="annottext">vs :: [Name]
</span><a href="#local-6989586621682207022"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207024"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682207024"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207024"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207021"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1223"></span><span>
</span><span id="line-1224"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-1225"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span>
</span><span id="line-1226"></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ Is the type inductive or coinductive?</span></span><span>
</span><span id="line-1227"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1228"></span><span id="tvaldecl"><span class="annot"><span class="annottext">tvaldecl :: QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var hs-var">tvaldecl</span></a></span></span><span> </span><span id="local-6989586621682207025"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207025"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682207026"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682207026"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621682207027"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207027"><span class="hs-identifier hs-var">npar</span></a></span></span><span> </span><span id="local-6989586621682207028"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621682207028"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span id="local-6989586621682207029"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621682207029"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1229"></span><span>  </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207030"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682207031"><span class="hs-identifier hs-var">pvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-1230"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; (Clause -&gt; [Decl]) -&gt; Maybe Clause -&gt; [Decl]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DataOrNew -&gt; Name -&gt; [TyVarBind] -&gt; [ConDecl] -&gt; [Deriving] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#DataDecl"><span class="hs-identifier hs-var">HS.DataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621682207034"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207035"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621682207036"><span class="hs-identifier hs-var">cds'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1231"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; Clause -&gt; [Decl]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621682207029"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-1232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682207035"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207035"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682207030"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207030"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207025"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207025"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>  </span><span id="local-6989586621682207031"><span class="annot"><span class="annottext">pvs :: [Pat]
</span><a href="#local-6989586621682207031"><span class="hs-identifier hs-var hs-var">pvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Name -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207037"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682207037"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207037"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682207027"><span class="hs-identifier hs-var">npar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span>  </span><span class="hs-comment">-- Inductive data types consisting of a single constructor with a</span><span>
</span><span id="line-1237"></span><span>  </span><span class="hs-comment">-- single argument are translated into newtypes.</span><span>
</span><span id="line-1238"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682207034"><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621682207034"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682207036"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621682207036"><span class="hs-identifier hs-var">cds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682207026"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621682207028"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1239"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span> </span><span id="local-6989586621682207038"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207038"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682207039"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682207039"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1240"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#NewType"><span class="hs-identifier hs-var">HS.NewType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [(Maybe Strictness, Type)] -&gt; ConDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-var">HS.ConDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682207038"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682207039"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>      </span><span class="hs-comment">-- The strictness annotations are removed for newtype</span><span>
</span><span id="line-1242"></span><span>      </span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-1243"></span><span>    </span><span class="annot"><span class="annottext">(Induction, [ConDecl])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#DataType"><span class="hs-identifier hs-var">HS.DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621682207028"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>
</span><span id="line-1245"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-type">infodecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1246"></span><span id="infodecl"><span class="annot"><span class="annottext">infodecl :: QName -&gt; [Decl] -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var hs-var">infodecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1247"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var">infodecl</span></a></span><span> </span><span id="local-6989586621682207042"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207042"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682207043"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682207043"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#Comment"><span class="hs-identifier hs-var">HS.Comment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682207042"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682207043"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- Writing out a haskell module</span><span>
</span><span id="line-1251"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-1252"></span><span>
</span><span id="line-1253"></span><span class="hs-keyword">type</span><span> </span><span id="MonadGHCIO"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-var">MonadGHCIO</span></a></span></span><span> </span><span id="local-6989586621682207045"><span class="annot"><a href="#local-6989586621682207045"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621682207045"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207045"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span id="local-6989586621682204321"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-type">copyRTEModules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204321"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204321"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1256"></span><span id="copyRTEModules"><span class="annot"><span class="annottext">copyRTEModules :: forall (m :: * -&gt; *). MonadGHCIO m =&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-var hs-var">copyRTEModules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1257"></span><span>  </span><span id="local-6989586621682207059"><span class="annot"><a href="#local-6989586621682207059"><span class="hs-identifier hs-var">dataDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; m [Char]
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><a href="Agda.Setup.html#getDataDir"><span class="hs-identifier hs-var">getDataDir</span></a></span><span>
</span><span id="line-1258"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207060"><span class="annot"><a href="#local-6989586621682207060"><span class="hs-identifier hs-var hs-var">srcDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207059"><span class="hs-identifier hs-var">dataDir</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MAlonzo&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;src&quot;</span></span><span>
</span><span id="line-1259"></span><span>  </span><span id="local-6989586621682207062"><span class="annot"><a href="#local-6989586621682207062"><span class="hs-identifier hs-var">dstDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span><span>
</span><span id="line-1260"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.IO.Directory.html#copyDirContent"><span class="hs-identifier hs-type">copyDirContent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207060"><span class="hs-identifier hs-type">srcDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207062"><span class="hs-identifier hs-type">dstDir</span></a></span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span id="local-6989586621682204364"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-type">writeModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204364"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204364"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1263"></span><span id="writeModule"><span class="annot"><span class="annottext">writeModule :: forall (m :: * -&gt; *). MonadGHCIO m =&gt; Module -&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-var hs-var">writeModule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span id="local-6989586621682207087"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682207087"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682207088"><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621682207088"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682207089"><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621682207089"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span id="local-6989586621682207090"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621682207090"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1264"></span><span>  </span><span class="hs-comment">-- Note that GHC assumes that sources use ASCII or UTF-8.</span><span>
</span><span id="line-1265"></span><span>  </span><span id="local-6989586621682207091"><span class="annot"><a href="#local-6989586621682207091"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Char], [Char]) -&gt; [Char]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Char], [Char]) -&gt; [Char]) -&gt; m ([Char], [Char]) -&gt; m [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m ([Char], [Char])
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m ([Char], [Char])
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682207087"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1266"></span><span>  </span><span id="local-6989586621682207094"><span class="annot"><a href="#local-6989586621682207094"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span><span>
</span><span id="line-1267"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207095"><span class="annot"><a href="#local-6989586621682207095"><span class="hs-identifier hs-var hs-var">languagePragmas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1268"></span><span>        </span><span class="annot"><span class="annottext">([Char] -&gt; ModulePragma) -&gt; [[Char]] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#LanguagePragma"><span class="hs-identifier hs-var">HS.LanguagePragma</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ModulePragma)
-&gt; ([Char] -&gt; [Name]) -&gt; [Char] -&gt; ModulePragma
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name]
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Name]) -&gt; ([Char] -&gt; Name) -&gt; [Char] -&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [ModulePragma]) -&gt; [[Char]] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1269"></span><span>          </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1270"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;QualifiedDo&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682207094"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1271"></span><span>                </span><span class="hs-comment">-- If --ghc-strict is used, then the language extension</span><span>
</span><span id="line-1272"></span><span>                </span><span class="hs-comment">-- QualifiedDo is activated. At the time of writing no</span><span>
</span><span id="line-1273"></span><span>                </span><span class="hs-comment">-- code is generated that depends on this extension</span><span>
</span><span id="line-1274"></span><span>                </span><span class="hs-comment">-- (except for the pragmas), but --ghc-strict is broken</span><span>
</span><span id="line-1275"></span><span>                </span><span class="hs-comment">-- with at least some versions of GHC prior to version 9,</span><span>
</span><span id="line-1276"></span><span>                </span><span class="hs-comment">-- and QualifiedDo was introduced with GHC 9.</span><span>
</span><span id="line-1277"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BangPatterns&quot;</span></span><span>
</span><span id="line-1278"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;EmptyDataDecls&quot;</span></span><span>
</span><span id="line-1279"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;EmptyCase&quot;</span></span><span>
</span><span id="line-1280"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ExistentialQuantification&quot;</span></span><span>
</span><span id="line-1281"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ScopedTypeVariables&quot;</span></span><span>
</span><span id="line-1282"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NoMonomorphismRestriction&quot;</span></span><span>
</span><span id="line-1283"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RankNTypes&quot;</span></span><span>
</span><span id="line-1284"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;PatternSynonyms&quot;</span></span><span>
</span><span id="line-1285"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OverloadedStrings&quot;</span></span><span>
</span><span id="line-1286"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1287"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207101"><span class="annot"><a href="#local-6989586621682207101"><span class="hs-identifier hs-var hs-var">ghcOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1288"></span><span>        </span><span class="annot"><span class="annottext">([Char] -&gt; ModulePragma) -&gt; [[Char]] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#OtherPragma"><span class="hs-identifier hs-var">HS.OtherPragma</span></a></span><span>
</span><span id="line-1289"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>  </span><span class="hs-comment">-- to separate from LANGUAGE pragmas</span><span>
</span><span id="line-1290"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;{-# OPTIONS_GHC -Wno-overlapping-patterns #-}&quot;</span></span><span>
</span><span id="line-1291"></span><span>              </span><span class="hs-comment">-- Andreas, 2022-01-26, issue #5758:</span><span>
</span><span id="line-1292"></span><span>              </span><span class="hs-comment">-- Place this in generated file rather than</span><span>
</span><span id="line-1293"></span><span>              </span><span class="hs-comment">-- passing it only when calling GHC from within Agda.</span><span>
</span><span id="line-1294"></span><span>              </span><span class="hs-comment">-- This will silence the warning for the Agda-generated .hs</span><span>
</span><span id="line-1295"></span><span>              </span><span class="hs-comment">-- files while it can be on for other .hs files in the same</span><span>
</span><span id="line-1296"></span><span>              </span><span class="hs-comment">-- project.  (E.g., when using cabal/stack to compile.)</span><span>
</span><span id="line-1297"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1298"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.IO.UTF8.html#writeFile"><span class="hs-identifier hs-type">UTF8.writeFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207091"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-type">prettyPrint</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1299"></span><span>    </span><span class="hs-comment">-- TODO: It might make sense to skip bang patterns for the unused</span><span>
</span><span id="line-1300"></span><span>    </span><span class="hs-comment">-- arguments of the &quot;non-stripped&quot; functions.</span><span>
</span><span id="line-1301"></span><span>    </span><span class="annot"><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-type">applyWhen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207094"><span class="hs-identifier hs-type">strict</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Strict.html#makeStrict"><span class="hs-identifier hs-type">makeStrict</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1302"></span><span>    </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682207095"><span class="hs-identifier hs-type">languagePragmas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682207101"><span class="hs-identifier hs-type">ghcOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682207088"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682207089"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207090"><span class="hs-identifier hs-type">ds</span></a></span><span>
</span><span id="line-1303"></span><span>
</span><span id="line-1304"></span><span id="local-6989586621682204581"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-type">outFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1305"></span><span id="outFileAndDir"><span class="annot"><span class="annottext">outFileAndDir :: forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m ([Char], [Char])
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var hs-var">outFileAndDir</span></a></span></span><span> </span><span id="local-6989586621682207117"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682207117"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1306"></span><span>  </span><span id="local-6989586621682207118"><span class="annot"><a href="#local-6989586621682207118"><span class="hs-identifier hs-var">mdir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; [Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; [Char]) -&gt; m GHCOptions -&gt; m [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1307"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682207119"><span class="annot"><a href="#local-6989586621682207119"><span class="hs-identifier hs-var">fdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682207120"><span class="annot"><a href="#local-6989586621682207120"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">splitFileName</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682207122"><span class="hs-identifier hs-type">repldot</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pathSeparator</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1308"></span><span>                   </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-type">prettyPrint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207117"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1309"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207124"><span class="annot"><a href="#local-6989586621682207124"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207118"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207119"><span class="hs-identifier hs-var">fdir</span></a></span><span>
</span><span id="line-1310"></span><span>      </span><span id="local-6989586621682207125"><span class="annot"><a href="#local-6989586621682207125"><span class="hs-identifier hs-var hs-var">fp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207124"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">replaceExtension</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207120"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;hs&quot;</span></span><span>
</span><span id="line-1311"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621682207124"><span class="hs-identifier hs-type">dir</span></a></span><span>
</span><span id="line-1312"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682207118"><span class="hs-identifier hs-type">mdir</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682207125"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1314"></span><span>  </span><span id="local-6989586621682207122"><span class="annot"><span class="annottext">repldot :: Char -&gt; [Char] -&gt; [Char]
</span><a href="#local-6989586621682207122"><span class="hs-identifier hs-var hs-var">repldot</span></a></span></span><span> </span><span id="local-6989586621682207129"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682207129"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; Char) -&gt; [Char] -&gt; [Char])
-&gt; (Char -&gt; Char) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682207130"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682207130"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682207130"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682207129"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682207130"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-1315"></span><span>
</span><span id="line-1316"></span><span id="local-6989586621682204586"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-type">curOutFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204586"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204586"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204586"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1317"></span><span id="curOutFileAndDir"><span class="annot"><span class="annottext">curOutFileAndDir :: forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m ([Char], [Char])
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var hs-var">curOutFileAndDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m ([Char], [Char])
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m ([Char], [Char])
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; m ([Char], [Char]))
-&gt; m ModuleName -&gt; m ([Char], [Char])
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m ModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span id="local-6989586621682204331"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-type">curOutFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204331"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682204331"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682204331"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-1320"></span><span id="curOutFile"><span class="annot"><span class="annottext">curOutFile :: forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m [Char]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var hs-var">curOutFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], [Char]) -&gt; [Char]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Char], [Char]) -&gt; [Char]) -&gt; m ([Char], [Char]) -&gt; m [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ([Char], [Char])
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m ([Char], [Char])
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var">curOutFileAndDir</span></a></span><span>
</span><span id="line-1321"></span><span>
</span><span id="line-1322"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-type">callGHC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span id="callGHC"><span class="annot"><span class="annottext">callGHC :: ReaderT GHCModule TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-var hs-var">callGHC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1324"></span><span>  </span><span id="local-6989586621682207148"><span class="annot"><a href="#local-6989586621682207148"><span class="hs-identifier hs-var">opts</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1325"></span><span>  </span><span id="local-6989586621682207149"><span class="annot"><a href="#local-6989586621682207149"><span class="hs-identifier hs-var">agdaOpts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#commandLineOptions"><span class="hs-identifier hs-type">commandLineOptions</span></a></span><span>
</span><span id="line-1326"></span><span>  </span><span id="local-6989586621682207151"><span class="annot"><a href="#local-6989586621682207151"><span class="hs-identifier hs-var">hsmod</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-type">prettyPrint</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-type">curHsMod</span></a></span><span>
</span><span id="line-1327"></span><span>  </span><span id="local-6989586621682207152"><span class="annot"><a href="#local-6989586621682207152"><span class="hs-identifier hs-var">agdaMod</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-type">curAgdaMod</span></a></span><span>
</span><span id="line-1328"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207154"><span class="annot"><a href="#local-6989586621682207154"><span class="hs-identifier hs-var hs-var">outputName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BackendName -&gt; [Char]
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">(BackendName -&gt; [Char]) -&gt; BackendName -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty BackendName -&gt; BackendName
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty BackendName -&gt; BackendName)
-&gt; NonEmpty BackendName -&gt; BackendName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; NonEmpty BackendName
forall range. TopLevelModuleName' range -&gt; NonEmpty BackendName
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#moduleNameParts"><span class="hs-identifier hs-var">moduleNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682207152"><span class="hs-identifier hs-var">agdaMod</span></a></span><span>
</span><span id="line-1329"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682207158"><span class="annot"><a href="#local-6989586621682207158"><span class="hs-identifier hs-var">mdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682207159"><span class="annot"><a href="#local-6989586621682207159"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-type">curOutFileAndDir</span></a></span><span>
</span><span id="line-1330"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207160"><span class="annot"><a href="#local-6989586621682207160"><span class="hs-identifier hs-var hs-var">ghcopts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; [[Char]]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcFlags"><span class="hs-identifier hs-var">optGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621682207148"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1331"></span><span>
</span><span id="line-1332"></span><span>  </span><span id="local-6989586621682207161"><span class="annot"><a href="#local-6989586621682207161"><span class="hs-identifier hs-var">modIsMain</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-type">curIsMainModule</span></a></span><span>
</span><span id="line-1333"></span><span>  </span><span id="local-6989586621682207162"><span class="annot"><a href="#local-6989586621682207162"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var">ghcModMainFuncs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1334"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207164"><span class="annot"><a href="#local-6989586621682207164"><span class="hs-identifier hs-var hs-var">isMain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682207161"><span class="hs-identifier hs-var">modIsMain</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682207162"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span><span>  </span><span class="hs-comment">-- both need to be IsMain</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span>  </span><span class="hs-comment">-- Warn if no main function and not --no-main</span><span>
</span><span id="line-1337"></span><span>  </span><span class="annot"><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-type">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682207161"><span class="hs-identifier hs-type">modIsMain</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="#local-6989586621682207164"><span class="hs-identifier hs-type">isMain</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-type">warning</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#NoMain"><span class="hs-identifier hs-type">NoMain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207152"><span class="hs-identifier hs-type">agdaMod</span></a></span><span>
</span><span id="line-1338"></span><span>
</span><span id="line-1339"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207166"><span class="annot"><a href="#local-6989586621682207166"><span class="hs-identifier hs-var hs-var">overridableArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1340"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-O&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1341"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682207164"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-o&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207158"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207154"><span class="hs-identifier hs-var">outputName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1342"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-Werror&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-1343"></span><span>      </span><span id="local-6989586621682207167"><span class="annot"><a href="#local-6989586621682207167"><span class="hs-identifier hs-var hs-var">otherArgs</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span>
</span><span id="line-1344"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-i&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207158"><span class="hs-identifier hs-var">mdir</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1345"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682207164"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-main-is&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207151"><span class="hs-identifier hs-var">hsmod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1346"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207159"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-1347"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--make&quot;</span></span><span>
</span><span id="line-1348"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-fwarn-incomplete-patterns&quot;</span></span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1350"></span><span>      </span><span id="local-6989586621682207168"><span class="annot"><a href="#local-6989586621682207168"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682207166"><span class="hs-identifier hs-var">overridableArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682207160"><span class="hs-identifier hs-var">ghcopts</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682207167"><span class="hs-identifier hs-var">otherArgs</span></a></span><span>
</span><span id="line-1351"></span><span>
</span><span id="line-1352"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207169"><span class="annot"><a href="#local-6989586621682207169"><span class="hs-identifier hs-var hs-var">ghcBin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; [Char]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcBin"><span class="hs-identifier hs-var">optGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621682207148"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1353"></span><span>
</span><span id="line-1354"></span><span>  </span><span class="hs-comment">-- Make GHC use UTF-8 when writing to stdout and stderr.</span><span>
</span><span id="line-1355"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">setEnv</span></span><span> </span><span class="annot"><span class="hs-string">&quot;GHC_CHARENC&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;UTF-8&quot;</span></span><span>
</span><span id="line-1356"></span><span>  </span><span class="hs-comment">-- Note: Some versions of GHC use stderr for progress reports. For</span><span>
</span><span id="line-1357"></span><span>  </span><span class="hs-comment">-- those versions of GHC we don't print any progress information</span><span>
</span><span id="line-1358"></span><span>  </span><span class="hs-comment">-- unless an error is encountered.</span><span>
</span><span id="line-1359"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682207170"><span class="annot"><a href="#local-6989586621682207170"><span class="hs-identifier hs-var hs-var">doCall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCallGhc"><span class="hs-identifier hs-var">optGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621682207148"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1360"></span><span>      </span><span id="local-6989586621682207171"><span class="annot"><a href="#local-6989586621682207171"><span class="hs-identifier hs-var hs-var">cwd</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optGHCiInteraction"><span class="hs-identifier hs-var">optGHCiInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682207149"><span class="hs-identifier hs-var">agdaOpts</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-1361"></span><span>                  </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optJSONInteraction"><span class="hs-identifier hs-var">optJSONInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682207149"><span class="hs-identifier hs-var">agdaOpts</span></a></span><span>
</span><span id="line-1362"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682207158"><span class="hs-identifier hs-var">mdir</span></a></span><span>
</span><span id="line-1363"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1364"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-type">liftTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.CallCompiler.html#callCompiler"><span class="hs-identifier hs-type">callCompiler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207170"><span class="hs-identifier hs-type">doCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207169"><span class="hs-identifier hs-type">ghcBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207168"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682207171"><span class="hs-identifier hs-type">cwd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">utf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1365"></span></pre></body></html>