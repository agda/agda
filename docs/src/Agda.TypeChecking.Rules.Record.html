<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation   #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Record</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">not</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(||)</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html"><span class="hs-identifier">Agda.Syntax.Abstract.Views</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html"><span class="hs-identifier">Agda.Syntax.Info</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Info</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html"><span class="hs-identifier">Agda.TypeChecking.Positivity.Occurrence</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Polarity.html"><span class="hs-identifier">Agda.TypeChecking.Polarity</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html"><span class="hs-identifier">Agda.TypeChecking.CompiledClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#hasProjectionPatterns"><span class="hs-identifier">hasProjectionPatterns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.Compile.html"><span class="hs-identifier">Agda.TypeChecking.CompiledClause.Compile</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.InstanceArguments.html"><span class="hs-identifier">Agda.TypeChecking.InstanceArguments</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.Cubical.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Record.Cubical</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.Cubical.html#addCompositionForRecord"><span class="hs-identifier">addCompositionForRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Data</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#getGeneralizedParameters"><span class="hs-identifier">getGeneralizedParameters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#bindGeneralizedParameters"><span class="hs-identifier">bindGeneralizedParameters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#bindParameters"><span class="hs-identifier">bindParameters</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#checkDataSort"><span class="hs-identifier">checkDataSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#fitsIn"><span class="hs-identifier">fitsIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#forceSort"><span class="hs-identifier">forceSort</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Term</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html#isType_"><span class="hs-identifier">isType_</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Decl.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Decl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.Decl.html#checkDecl"><span class="hs-identifier">checkDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Boolean.html"><span class="hs-identifier">Agda.Utils.Boolean</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier">applyWhen</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html"><span class="hs-identifier">Agda.Utils.Size</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.POMonoid.html"><span class="hs-identifier">Agda.Utils.POMonoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.POMonoid.html#hasLeftAdjoint"><span class="hs-identifier">hasLeftAdjoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-55"></span><span class="annot"><span class="hs-comment">-- * Records</span></span><span>
</span><span id="line-56"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | @checkRecDef i name con ps contel fields@</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">--     [@name@]    Record type identifier.</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">--     [@con@]     Maybe constructor name and info.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">--     [@ps@]      Record parameters.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">--     [@contel@]  Approximate type of constructor (@fields@ -&gt; dummy).</span><span>
</span><span id="line-67"></span><span class="hs-comment">--                 Does not include record parameters.</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">--     [@fields@]  List of field signatures.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#checkRecDef"><span class="hs-identifier hs-type">checkRecDef</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefInfo"><span class="hs-identifier hs-type">A.DefInfo</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ Position and other info.</span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Record type identifier.</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#PositivityCheck"><span class="hs-identifier hs-type">PositivityCheck</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Report positivity errors for this record type?</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#UniverseCheck"><span class="hs-identifier hs-type">UniverseCheck</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Check universes?</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordDirectives"><span class="hs-identifier hs-type">A.RecordDirectives</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ (Co)Inductive, (No)Eta, (Co)Pattern, Constructor?</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataDefParams"><span class="hs-identifier hs-type">A.DataDefParams</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Record parameters.</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span>                    </span><span class="hs-comment">-- ^ Approximate type of constructor (@fields@ -&gt; dummy).</span><span>
</span><span id="line-79"></span><span>                               </span><span class="hs-comment">--   Does not include record parameters.</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span class="hs-special">]</span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ Field signatures.</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span id="checkRecDef"><span class="annot"><span class="annottext">checkRecDef :: DefInfo
-&gt; QName
-&gt; PositivityCheck
-&gt; UniverseCheck
-&gt; RecordDirectives
-&gt; DataDefParams
-&gt; Expr
-&gt; [Declaration]
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#checkRecDef"><span class="hs-identifier hs-var hs-var">checkRecDef</span></a></span></span><span> </span><span id="local-6989586621682211060"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211060"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682211061"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211061"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682211062"><span class="annot"><span class="annottext">PositivityCheck
</span><a href="#local-6989586621682211062"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span id="local-6989586621682211063"><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621682211063"><span class="hs-identifier hs-var">uc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#RecordDirectives"><span class="hs-identifier hs-type">RecordDirectives</span></a></span><span> </span><span id="local-6989586621682211065"><span class="annot"><span class="annottext">Maybe (Ranged Induction)
</span><a href="#local-6989586621682211065"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621682211066"><span class="annot"><span class="annottext">Maybe (Ranged HasEta0)
</span><a href="#local-6989586621682211066"><span class="hs-identifier hs-var">eta0</span></a></span></span><span> </span><span id="local-6989586621682211067"><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621682211067"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621682211068"><span class="annot"><span class="annottext">RecordConName
</span><a href="#local-6989586621682211068"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataDefParams"><span class="hs-identifier hs-type">A.DataDefParams</span></a></span><span> </span><span id="local-6989586621682211070"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621682211070"><span class="hs-identifier hs-var">gpars</span></a></span></span><span> </span><span id="local-6989586621682211071"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682211071"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682211072"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682211072"><span class="hs-identifier hs-var">contel0</span></a></span></span><span> </span><span id="local-6989586621682211073"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211073"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- Andreas, 2022-10-06, issue #6165:</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- The target type of the constructor is a meaningless dummy expression which does not type-check.</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- We replace it by Set/Type (builtinSet) which is still incorrect but type-checks.</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- It will be fixed after type-checking.</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621682211074"><span class="annot"><a href="#local-6989586621682211074"><span class="hs-identifier hs-var">aType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Expr
</span><a href="Agda.Syntax.Abstract.html#Def"><span class="hs-identifier hs-var">A.Def</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; (Maybe QName -&gt; QName) -&gt; Maybe QName -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName -&gt; QName
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">QName
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe QName -&gt; Expr) -&gt; TCMT IO (Maybe QName) -&gt; TCMT IO Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *). HasBuiltins m =&gt; BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getBuiltinName%27"><span class="hs-identifier hs-var">getBuiltinName'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinSet"><span class="hs-identifier hs-var">builtinSet</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211082"><span class="annot"><a href="#local-6989586621682211082"><span class="hs-identifier hs-var hs-var">contel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PiView -&gt; Expr
</span><a href="Agda.Syntax.Abstract.Views.html#unPiView"><span class="hs-identifier hs-var">A.unPiView</span></a></span><span> </span><span class="annot"><span class="annottext">(PiView -&gt; Expr) -&gt; (Expr -&gt; PiView) -&gt; Expr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#PiView"><span class="hs-identifier hs-type">A.PiView</span></a></span><span> </span><span id="local-6989586621682211085"><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)]
</span><a href="#local-6989586621682211085"><span class="hs-identifier hs-var">tels</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)] -&gt; Expr -&gt; PiView
</span><a href="Agda.Syntax.Abstract.Views.html#PiView"><span class="hs-identifier hs-var">A.PiView</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)]
</span><a href="#local-6989586621682211085"><span class="hs-identifier hs-var">tels</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682211074"><span class="hs-identifier hs-var">aType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PiView -&gt; PiView) -&gt; (Expr -&gt; PiView) -&gt; Expr -&gt; PiView
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; PiView
</span><a href="Agda.Syntax.Abstract.Views.html#piView"><span class="hs-identifier hs-var">A.piView</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; Expr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682211072"><span class="hs-identifier hs-var">contel0</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Trace.html#traceCall"><span class="hs-identifier hs-type">traceCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CheckRecDef"><span class="hs-identifier hs-type">CheckRecDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211071"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211073"><span class="hs-identifier hs-type">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;checking record def&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ps =&quot;</span></span><span>     </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-type">prettyA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211071"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;contel =&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-type">prettyA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211082"><span class="hs-identifier hs-type">contel</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;fields =&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-type">prettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211073"><span class="hs-identifier hs-type">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- get type of record</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621682211098"><span class="annot"><a href="#local-6989586621682211098"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#instantiateDef"><span class="hs-identifier hs-type">instantiateDef</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-type">getConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621682211102"><span class="annot"><a href="#local-6989586621682211102"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-type">instantiateFull</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211098"><span class="hs-identifier hs-type">def</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211105"><span class="annot"><a href="#local-6989586621682211105"><span class="hs-identifier hs-var hs-var">npars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682211098"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span> </span><span id="local-6989586621682211108"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682211108"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682211108"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- If the record type is erased, then hard compile-time mode is</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- entered.</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#setHardCompileTimeModeIfErased%27"><span class="hs-identifier hs-type">setHardCompileTimeModeIfErased'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211098"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621682211110"><span class="annot"><a href="#local-6989586621682211110"><span class="hs-identifier hs-var">parNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#getGeneralizedParameters"><span class="hs-identifier hs-type">getGeneralizedParameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211070"><span class="hs-identifier hs-type">gpars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#bindGeneralizedParameters"><span class="hs-identifier hs-type">bindGeneralizedParameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211110"><span class="hs-identifier hs-type">parNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211102"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682211111"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211111"><span class="hs-identifier hs-var">gtel</span></a></span></span><span> </span><span id="local-6989586621682211112"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211112"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>     </span><span class="annot"><span class="annottext">Nat
-&gt; [LamBinding] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a.
Nat
-&gt; [LamBinding] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM a) -&gt; TCM a
</span><a href="Agda.TypeChecking.Rules.Data.html#bindParameters"><span class="hs-identifier hs-var">bindParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682211105"><span class="hs-identifier hs-var">npars</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621682211110"><span class="hs-identifier hs-var">parNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682211071"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211112"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="annot"><span class="annottext">((Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ())
-&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682211114"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211114"><span class="hs-identifier hs-var">ptel</span></a></span></span><span> </span><span id="local-6989586621682211115"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211115"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211116"><span class="annot"><span class="annottext">tel :: Telescope
</span><a href="#local-6989586621682211116"><span class="hs-identifier hs-var hs-var hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211111"><span class="hs-identifier hs-var">gtel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211114"><span class="hs-identifier hs-var">ptel</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-comment">-- Generate type of constructor from field telescope @contel@,</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- which is the approximate constructor type (target missing).</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-comment">-- Check and evaluate field types.</span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking fields&quot;</span></span><span>
</span><span id="line-122"></span><span>      </span><span id="local-6989586621682211118"><span class="annot"><a href="#local-6989586621682211118"><span class="hs-identifier hs-var">contype</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Type -&gt; TCMT IO Type
forall (m :: * -&gt; *) a.
(MonadTCEnv m, HasOptions m, MonadDebug m) =&gt;
m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Modality.html#workOnTypes"><span class="hs-identifier hs-var">workOnTypes</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Type -&gt; TCMT IO Type) -&gt; TCMT IO Type -&gt; TCMT IO Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Type
forall a (m :: * -&gt; *).
(InstantiateFull a, MonadReduce m) =&gt;
a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-var">instantiateFull</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TCMT IO Type) -&gt; TCMT IO Type -&gt; TCMT IO Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; TCMT IO Type
</span><a href="Agda.TypeChecking.Rules.Term.html#isType_"><span class="hs-identifier hs-var">isType_</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682211082"><span class="hs-identifier hs-var">contel</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;contype = &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211118"><span class="hs-identifier hs-type">contype</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-comment">-- compute the field telescope (does not include record parameters)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621682211121"><span class="annot"><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#telView%27"><span class="hs-identifier hs-type">telView'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211118"><span class="hs-identifier hs-type">contype</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-comment">-- Compute correct type of constructor</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- t = tel -&gt; t0 where t0 must be a sort s</span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621682211123"><span class="annot"><a href="#local-6989586621682211123"><span class="hs-identifier hs-var">idxTel</span></a></span></span><span> </span><span id="local-6989586621682211124"><span class="annot"><a href="#local-6989586621682211124"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#telView"><span class="hs-identifier hs-type">telView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211115"><span class="hs-identifier hs-type">t0</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-type">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211123"><span class="hs-identifier hs-type">idxTel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-type">typeError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ShouldBeASort"><span class="hs-identifier hs-type">ShouldBeASort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211115"><span class="hs-identifier hs-type">t0</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621682211130"><span class="annot"><a href="#local-6989586621682211130"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#forceSort"><span class="hs-identifier hs-type">forceSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211124"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-comment">-- needed for impredicative Prop (not implemented yet)</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-comment">-- ftel &lt;- return $</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-comment">--   if s == Prop</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">--   then telFromList $ map (setRelevance Irrelevant) $ telToList ftel</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-comment">--   else ftel</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621682211131"><span class="annot"><a href="#local-6989586621682211131"><span class="hs-identifier hs-var">gamma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span>  </span><span class="hs-comment">-- the record params (incl. module params)</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="hs-string">&quot;gamma = &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211131"><span class="hs-identifier hs-type">gamma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-comment">-- record type (name applied to parameters)</span><span>
</span><span id="line-147"></span><span>      </span><span id="local-6989586621682211134"><span class="annot"><a href="#local-6989586621682211134"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211130"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-type">getContextArgs</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-comment">-- Put in @rect@ as correct target of constructor type.</span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-comment">-- Andreas, 2011-05-10 use telePi_ instead of telePi to preserve</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-comment">-- even names of non-dependent fields in constructor type (Issue 322).</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211139"><span class="annot"><a href="#local-6989586621682211139"><span class="hs-identifier hs-var hs-var">contype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#telePi_"><span class="hs-identifier hs-var">telePi_</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211134"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-comment">-- NB: contype does not contain the parameter telescope</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>      </span><span class="hs-comment">-- Obtain name of constructor (if present).</span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682211143"><span class="annot"><a href="#local-6989586621682211143"><span class="hs-identifier hs-var">hasNamedCon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682211144"><span class="annot"><a href="#local-6989586621682211144"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682211068"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.html#NamedRecCon"><span class="hs-identifier hs-type">A.NamedRecCon</span></a></span><span> </span><span id="local-6989586621682211146"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211146"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, QName) -&gt; TCMT IO (Bool, QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211146"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.html#FreshRecCon"><span class="hs-identifier hs-type">A.FreshRecCon</span></a></span><span> </span><span id="local-6989586621682211148"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211148"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, QName) -&gt; TCMT IO (Bool, QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211148"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-comment">-- Add record type to signature.</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;adding record type to signature&quot;</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>      </span><span id="local-6989586621682211149"><span class="annot"><a href="#local-6989586621682211149"><span class="hs-identifier hs-var">etaenabled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#etaEnabled"><span class="hs-identifier hs-type">etaEnabled</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682211151"><span class="hs-identifier hs-type">getName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>          </span><span id="local-6989586621682211151"><span class="annot"><a href="#local-6989586621682211151"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682211153"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682211154"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682211154"><span class="hs-identifier hs-var">arg</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211153"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Dom' Term Expr -&gt; Dom' Term QName
forall a b. a -&gt; Dom' Term b -&gt; Dom' Term a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Arg Expr -&gt; Dom' Term Expr
forall a. Arg a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#domFromArg"><span class="hs-identifier hs-var">domFromArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682211154"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">A.ScopedDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682211158"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682211158"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Dom' Term QName]
</span><a href="#local-6989586621682211151"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682211158"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">Declaration
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>          </span><span id="local-6989586621682211159"><span class="annot"><a href="#local-6989586621682211159"><span class="hs-identifier hs-var hs-var">setTactic</span></a></span></span><span> </span><span id="local-6989586621682211160"><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621682211160"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621682211161"><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621682211161"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621682211161"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#domTactic"><span class="hs-identifier hs-var">domTactic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#domTactic"><span class="hs-identifier hs-var">domTactic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211160"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>          </span><span id="local-6989586621682211163"><span class="annot"><a href="#local-6989586621682211163"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dom (ArgName, Type) -&gt; Dom' Term QName -&gt; Dom' Term QName)
-&gt; [Dom (ArgName, Type)] -&gt; [Dom' Term QName] -&gt; [Dom' Term QName]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Dom (ArgName, Type) -&gt; Dom' Term QName -&gt; Dom' Term QName
forall {t} {e} {t} {e}. Dom' t e -&gt; Dom' t e -&gt; Dom' t e
</span><a href="#local-6989586621682211159"><span class="hs-identifier hs-var">setTactic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (ArgName, Type)]
forall t. Tele (Dom t) -&gt; [Dom (ArgName, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dom' Term QName] -&gt; [Dom' Term QName])
-&gt; [Dom' Term QName] -&gt; [Dom' Term QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; [Dom' Term QName])
-&gt; [Declaration] -&gt; [Dom' Term QName]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Dom' Term QName]
</span><a href="#local-6989586621682211151"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211073"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-comment">-- indCo is what the user wrote: inductive/coinductive/Nothing.</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-comment">-- We drop the Range.</span><span>
</span><span id="line-177"></span><span>          </span><span id="local-6989586621682211167"><span class="annot"><a href="#local-6989586621682211167"><span class="hs-identifier hs-var hs-var">indCo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ranged Induction -&gt; Induction
forall a. Ranged a -&gt; a
</span><a href="Agda.Syntax.Common.html#rangedThing"><span class="hs-identifier hs-var">rangedThing</span></a></span><span> </span><span class="annot"><span class="annottext">(Ranged Induction -&gt; Induction)
-&gt; Maybe (Ranged Induction) -&gt; Maybe Induction
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged Induction)
</span><a href="#local-6989586621682211065"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-comment">-- A constructor is inductive unless declared coinductive.</span><span>
</span><span id="line-179"></span><span>          </span><span id="local-6989586621682211169"><span class="annot"><a href="#local-6989586621682211169"><span class="hs-identifier hs-var hs-var">conInduction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction -&gt; Induction
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621682211167"><span class="hs-identifier hs-var">indCo</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-comment">-- Andreas, 2016-09-20, issue #2197.</span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-comment">-- Eta is inferred by the positivity checker.</span><span>
</span><span id="line-182"></span><span>          </span><span class="hs-comment">-- We should turn it off until it is proven to be safe.</span><span>
</span><span id="line-183"></span><span>          </span><span id="local-6989586621682211171"><span class="annot"><a href="#local-6989586621682211171"><span class="hs-identifier hs-var hs-var">noEta</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasEta -&gt; EtaEquality
</span><a href="Agda.TypeChecking.Monad.Base.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span> </span><span class="annot"><span class="annottext">(HasEta -&gt; EtaEquality) -&gt; HasEta -&gt; EtaEquality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; HasEta
forall a. a -&gt; HasEta' a
</span><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-var">NoEta</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621682211174"><span class="hs-identifier hs-var">patCopat</span></a></span><span>
</span><span id="line-184"></span><span>          </span><span id="local-6989586621682211175"><span class="annot"><a href="#local-6989586621682211175"><span class="hs-identifier hs-var hs-var">haveEta0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EtaEquality
-&gt; (HasEta -&gt; EtaEquality) -&gt; Maybe HasEta -&gt; EtaEquality
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621682211171"><span class="hs-identifier hs-var">noEta</span></a></span><span> </span><span class="annot"><span class="annottext">HasEta -&gt; EtaEquality
</span><a href="Agda.TypeChecking.Monad.Base.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HasEta
</span><a href="#local-6989586621682211178"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-185"></span><span>          </span><span id="local-6989586621682211179"><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-var hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; DataOrRecord -&gt; Induction -&gt; [Arg QName] -&gt; ConHead
</span><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-var">ConHead</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211144"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; DataOrRecord
forall p. p -&gt; DataOrRecord' p
</span><a href="Agda.Syntax.Common.html#IsRecord"><span class="hs-identifier hs-var">IsRecord</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621682211174"><span class="hs-identifier hs-var">patCopat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682211169"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg QName] -&gt; ConHead) -&gt; [Arg QName] -&gt; ConHead
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dom' Term QName -&gt; Arg QName) -&gt; [Dom' Term QName] -&gt; [Arg QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term QName -&gt; Arg QName
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName]
</span><a href="#local-6989586621682211163"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-comment">-- A record is irrelevant if all of its fields are.</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-comment">-- In this case, the associated module parameter will be irrelevant.</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-comment">-- See issue #392.</span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-comment">-- Unless it's been declared coinductive or no-eta-equality (#2607).</span><span>
</span><span id="line-191"></span><span>          </span><span id="local-6989586621682211183"><span class="annot"><a href="#local-6989586621682211183"><span class="hs-identifier hs-var hs-var">recordRelevance</span></a></span></span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-type">NoEta</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HasEta
</span><a href="#local-6989586621682211178"><span class="hs-identifier hs-var">eta</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#relevant"><span class="hs-identifier hs-var">relevant</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621682211169"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#relevant"><span class="hs-identifier hs-var">relevant</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Dom (ArgName, Type)] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (ArgName, Type)]
forall t. Tele (Dom t) -&gt; [Dom (ArgName, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#relevant"><span class="hs-identifier hs-var">relevant</span></a></span><span>    </span><span class="hs-comment">-- #6270: eta unit types don't need to be irrelevant</span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relevance] -&gt; Relevance
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Relevance] -&gt; Relevance) -&gt; [Relevance] -&gt; Relevance
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#irrelevant"><span class="hs-identifier hs-var">irrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [Relevance] -&gt; [Relevance]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Dom (ArgName, Type) -&gt; Relevance)
-&gt; [Dom (ArgName, Type)] -&gt; [Relevance]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom (ArgName, Type) -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (ArgName, Type)]
forall t. Tele (Dom t) -&gt; [Dom (ArgName, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211121"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-comment">-- Andreas, 2017-01-26, issue #2436</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-comment">-- Disallow coinductive records with eta-equality</span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-comment">-- Andreas, 2024-06-14, PR #7300</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-comment">-- Just make this a deadcode warning.</span><span>
</span><span id="line-201"></span><span>      </span><span id="local-6989586621682211189"><span class="annot"><a href="#local-6989586621682211189"><span class="hs-identifier hs-var">haveEta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682211169"><span class="hs-identifier hs-type">conInduction</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-type">CoInductive</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Boolean.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theEtaEquality"><span class="hs-identifier hs-var">theEtaEquality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211175"><span class="hs-identifier hs-type">haveEta0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#YesEta"><span class="hs-identifier hs-type">YesEta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>          </span><span class="annot"><a href="#local-6989586621682211171"><span class="hs-identifier hs-type">noEta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-type">setCurrentRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211066"><span class="hs-identifier hs-type">eta0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-type">warning</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CoinductiveEtaRecord"><span class="hs-identifier hs-type">CoinductiveEtaRecord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682211175"><span class="hs-identifier hs-type">haveEta0</span></a></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;record constructor is &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-type">con</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-comment">-- Add the record definition.</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-06-17, Issue #2018:</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-comment">-- Do not rely on @addConstant@ to put in the record parameters,</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-comment">-- as they might be renamed in the context.</span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- By putting them ourselves (e.g. by using the original type @t@)</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-comment">-- we make sure we get the original names!</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211196"><span class="annot"><a href="#local-6989586621682211196"><span class="hs-identifier hs-var hs-var">npars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211116"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-216"></span><span>          </span><span id="local-6989586621682211197"><span class="annot"><a href="#local-6989586621682211197"><span class="hs-identifier hs-var hs-var">telh</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; Tele a -&gt; Tele b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Dom Type
forall a. (LensHiding a, LensRelevance a) =&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Modality.html#hideAndRelParams"><span class="hs-identifier hs-var">hideAndRelParams</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211116"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-type">escapeContext</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211196"><span class="hs-identifier hs-type">npars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#addConstant%27"><span class="hs-identifier hs-type">addConstant'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-type">defaultArgInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211102"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-219"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span>
</span><span id="line-220"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recPars"><span class="hs-identifier hs-var">recPars</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211196"><span class="hs-identifier hs-type">npars</span></a></span><span>
</span><span id="line-221"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recClause"><span class="hs-identifier hs-var">recClause</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-222"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-type">con</span></a></span><span>
</span><span id="line-223"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recNamedCon"><span class="hs-identifier hs-var">recNamedCon</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211143"><span class="hs-identifier hs-type">hasNamedCon</span></a></span><span>
</span><span id="line-224"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recFields"><span class="hs-identifier hs-var">recFields</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211163"><span class="hs-identifier hs-type">fs</span></a></span><span>
</span><span id="line-225"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recTel"><span class="hs-identifier hs-var">recTel</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211197"><span class="hs-identifier hs-type">telh</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-type">`abstract`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211121"><span class="hs-identifier hs-type">ftel</span></a></span><span>
</span><span id="line-226"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recPositivityCheck"><span class="hs-identifier hs-var">recPositivityCheck</span></a></span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211062"><span class="hs-identifier hs-type">pc</span></a></span><span>
</span><span id="line-227"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recAbstr"><span class="hs-identifier hs-var">recAbstr</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211060"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-228"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recEtaEquality%27"><span class="hs-identifier hs-var">recEtaEquality'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211189"><span class="hs-identifier hs-type">haveEta</span></a></span><span>
</span><span id="line-229"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recPatternMatching"><span class="hs-identifier hs-var">recPatternMatching</span></a></span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211174"><span class="hs-identifier hs-type">patCopat</span></a></span><span>
</span><span id="line-230"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211167"><span class="hs-identifier hs-type">indCo</span></a></span><span>
</span><span id="line-231"></span><span>                  </span><span class="hs-comment">-- We retain the original user declaration [(co)inductive]</span><span>
</span><span id="line-232"></span><span>                  </span><span class="hs-comment">-- in case the record turns out to be recursive.</span><span>
</span><span id="line-233"></span><span>              </span><span class="hs-comment">-- Determined by positivity checker (analysis running always, independently of recPositivityCheck):</span><span>
</span><span id="line-234"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recMutual"><span class="hs-identifier hs-var">recMutual</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-235"></span><span>              </span><span class="hs-comment">-- Determined by the termination checker:</span><span>
</span><span id="line-236"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recTerminates"><span class="hs-identifier hs-var">recTerminates</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-237"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recComp"><span class="hs-identifier hs-var">recComp</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-type">emptyCompKit</span></a></span><span> </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-238"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>        </span><span id="local-6989586621682211220"><span class="annot"><a href="#local-6989586621682211220"><span class="hs-identifier hs-var">erasure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optErasure"><span class="hs-identifier hs-type">optErasure</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-comment">-- Add record constructor to signature</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#addConstant%27"><span class="hs-identifier hs-type">addConstant'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211144"><span class="hs-identifier hs-type">conName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-type">defaultArgInfo</span></a></span><span>
</span><span id="line-243"></span><span>             </span><span class="hs-comment">-- If --erasure is used, then the parameters are erased</span><span>
</span><span id="line-244"></span><span>             </span><span class="hs-comment">-- in the constructor's type.</span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-type">applyWhen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211220"><span class="hs-identifier hs-type">erasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#applyQuantity"><span class="hs-identifier hs-type">applyQuantity</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-type">zeroQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211197"><span class="hs-identifier hs-type">telh</span></a></span><span>
</span><span id="line-246"></span><span>             </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-type">`abstract`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211139"><span class="hs-identifier hs-type">contype</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-247"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span>
</span><span id="line-248"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211196"><span class="hs-identifier hs-type">npars</span></a></span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conArity"><span class="hs-identifier hs-var">conArity</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211163"><span class="hs-identifier hs-type">fs</span></a></span><span>
</span><span id="line-250"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conSrcCon"><span class="hs-identifier hs-var">conSrcCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-type">con</span></a></span><span>
</span><span id="line-251"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conData"><span class="hs-identifier hs-var">conData</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-252"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conAbstr"><span class="hs-identifier hs-var">conAbstr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211060"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-253"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conComp"><span class="hs-identifier hs-var">conComp</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-type">emptyCompKit</span></a></span><span>  </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conProj"><span class="hs-identifier hs-var">conProj</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>       </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-255"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conForced"><span class="hs-identifier hs-var">conForced</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conErased"><span class="hs-identifier hs-var">conErased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-257"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conErasure"><span class="hs-identifier hs-var">conErasure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211220"><span class="hs-identifier hs-type">erasure</span></a></span><span>
</span><span id="line-258"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conInline"><span class="hs-identifier hs-var">conInline</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-259"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-comment">-- Declare the constructor as eligible for instance search</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">Info.defInstance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211060"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Common.html#InstanceDef"><span class="hs-identifier hs-type">InstanceDef</span></a></span><span> </span><span id="local-6989586621682211239"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682211239"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682211239"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-comment">-- Andreas, 2020-01-28, issue #4360:</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-comment">-- Use addTypedInstance instead of addNamedInstance</span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-comment">-- to detect unusable instances.</span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="annottext">KwRange -&gt; QName -&gt; Type -&gt; TCM ()
</span><a href="Agda.TypeChecking.InstanceArguments.html#addTypedInstance"><span class="hs-identifier hs-var">addTypedInstance</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682211239"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211144"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211139"><span class="hs-identifier hs-var">contype</span></a></span><span>
</span><span id="line-268"></span><span>          </span><span class="hs-comment">-- addNamedInstance conName name</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-comment">-- Check that the fields fit inside the sort</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#fitsIn"><span class="hs-identifier hs-type">fitsIn</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsRecord_"><span class="hs-identifier hs-type">IsRecord_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211144"><span class="hs-identifier hs-type">conName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211063"><span class="hs-identifier hs-type">uc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682211139"><span class="hs-identifier hs-type">contype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211130"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-comment">-- Check that the sort admits record declarations.</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#checkDataSort"><span class="hs-identifier hs-type">checkDataSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211130"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-comment">{- Andreas, 2011-04-27 WRONG because field types are checked again
         and then non-stricts should not yet be irrelevant

      -- make record parameters hidden and non-stricts irrelevant
      -- ctx &lt;- (reverse . map hideAndRelParams . take (size tel)) &lt;$&gt; getContext
      -}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">{- Andreas, 2013-09-13 DEBUGGING the debug printout
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (prettyTCM =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (text . show =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (inTopContext . prettyTCM =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ do
           tel &lt;- getContextTelescope
           text (show tel) $+$ do
           inTopContext $ do
             prettyTCM tel $+$ do
               telA &lt;- reify tel
               text (show telA) $+$ do
               ctx &lt;- getContextTelescope
               &quot;should be empty:&quot; &lt;+&gt; prettyTCM ctx
        ]
-}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-comment">-- Make a note of what variable is the 'self' variable in the telescope.</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211243"><span class="annot"><a href="#local-6989586621682211243"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; ArgInfo -&gt; ArgInfo
forall a. LensOrigin a =&gt; Origin -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setOrigin"><span class="hs-identifier hs-var">setOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#RecordSelf"><span class="hs-identifier hs-var">RecordSelf</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgInfo -&gt; ArgInfo) -&gt; ArgInfo -&gt; ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; ArgInfo -&gt; ArgInfo
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682211183"><span class="hs-identifier hs-var">recordRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span>
</span><span id="line-314"></span><span>          </span><span id="local-6989586621682211247"><span class="annot"><a href="#local-6989586621682211247"><span class="hs-identifier hs-var hs-var">addRecordVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) b.
(MonadAddContext m, MonadFresh NameId m) =&gt;
Dom Type -&gt; m b -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#addRecordNameContext"><span class="hs-identifier hs-var">addRecordNameContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Dom Type -&gt; Dom Type
forall a. LensArgInfo a =&gt; ArgInfo -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setArgInfo"><span class="hs-identifier hs-var">setArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211243"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Dom Type -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Dom Type
forall a. a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-var">defaultDom</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211134"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211251"><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ModuleName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameToMName"><span class="hs-identifier hs-var">qnameToMName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211061"><span class="hs-identifier hs-var">name</span></a></span><span>  </span><span class="hs-comment">-- Name of record module.</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621682211253"><span class="annot"><a href="#local-6989586621682211253"><span class="hs-identifier hs-var">eraseRecordParameters</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optEraseRecordParameters"><span class="hs-identifier hs-type">optEraseRecordParameters</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682211255"><span class="hs-identifier hs-type">maybeErase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682210297"><span class="annot"><a href="#local-6989586621682210297"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensQuantity"><span class="hs-identifier hs-type">LensQuantity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682210297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682210297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682210297"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-320"></span><span>          </span><span id="local-6989586621682211255"><span class="annot"><a href="#local-6989586621682211255"><span class="hs-identifier hs-var hs-var">maybeErase</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682211253"><span class="hs-identifier hs-var">eraseRecordParameters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; a -&gt; a
forall a. LensQuantity a =&gt; Quantity -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setQuantity"><span class="hs-identifier hs-var">setQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span>
</span><span id="line-321"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-02-09 setting all parameters hidden in the record</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-comment">-- section telescope changes the semantics, see e.g.</span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-comment">-- test/Succeed/RecordInParModule.</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-comment">-- Ulf, 2016-03-02 but it's the right thing to do (#1759)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#modifyContextInfo"><span class="hs-identifier hs-type">modifyContextInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#hideOrKeepInstance"><span class="hs-identifier hs-type">hideOrKeepInstance</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682211255"><span class="hs-identifier hs-type">maybeErase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682211247"><span class="hs-identifier hs-type">addRecordVar</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-comment">-- Add the record section.</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.def&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;record section:&quot;</span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-334"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-type">fsep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#punctuate"><span class="hs-identifier hs-type">punctuate</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#comma"><span class="hs-identifier hs-type">comma</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-type">P.pretty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-type">argFromDom</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682211151"><span class="hs-identifier hs-type">getName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211073"><span class="hs-identifier hs-type">fields</span></a></span><span>
</span><span id="line-336"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.def&quot;</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-339"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;field tel =&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-type">escapeContext</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211121"><span class="hs-identifier hs-type">ftel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#addSection"><span class="hs-identifier hs-type">addSection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-02-09, Issue 1815 (see also issue 1759).</span><span>
</span><span id="line-344"></span><span>      </span><span class="hs-comment">-- For checking the record declarations, hide the record parameters</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-comment">-- and the parameters of the parent modules.</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#modifyContextInfo"><span class="hs-identifier hs-type">modifyContextInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#hideOrKeepInstance"><span class="hs-identifier hs-type">hideOrKeepInstance</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682211255"><span class="hs-identifier hs-type">maybeErase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-comment">-- If --erasure is used, then the parameters are erased in the</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-comment">-- types of the projections.</span><span>
</span><span id="line-349"></span><span>        </span><span id="local-6989586621682211272"><span class="annot"><a href="#local-6989586621682211272"><span class="hs-identifier hs-var">erasure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optErasure"><span class="hs-identifier hs-type">optErasure</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span id="local-6989586621682211273"><span class="annot"><a href="#local-6989586621682211273"><span class="hs-identifier hs-var">params</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-type">applyWhen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211272"><span class="hs-identifier hs-type">erasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#applyQuantity"><span class="hs-identifier hs-type">applyQuantity</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-type">zeroQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-type">getContext</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-comment">-- Check the types of the fields and the other record declarations.</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><a href="#local-6989586621682211247"><span class="hs-identifier hs-type">addRecordVar</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Env.html#withCurrentModule"><span class="hs-identifier hs-type">withCurrentModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>          </span><span class="hs-comment">-- Andreas, 2013-09-13, 2016-01-06.</span><span>
</span><span id="line-356"></span><span>          </span><span class="hs-comment">-- Argument telescope for the projections: all parameters are hidden.</span><span>
</span><span id="line-357"></span><span>          </span><span class="hs-comment">-- This means parameters of the parent modules and of the current</span><span>
</span><span id="line-358"></span><span>          </span><span class="hs-comment">-- record type.</span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-comment">-- See test/Succeed/ProjectionsTakeModuleTelAsParameters.agda.</span><span>
</span><span id="line-360"></span><span>          </span><span id="local-6989586621682211276"><span class="annot"><a href="#local-6989586621682211276"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>            </span><span id="local-6989586621682211277"><span class="annot"><a href="#local-6989586621682211277"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#cxLookup"><span class="hs-identifier hs-type">cxLookup</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-type">getContext</span></a></span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#contextToTel"><span class="hs-identifier hs-type">contextToTel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#CxExtend"><span class="hs-identifier hs-type">CxExtend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211277"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211273"><span class="hs-identifier hs-type">params</span></a></span><span>
</span><span id="line-363"></span><span>          </span><span id="local-6989586621682211281"><span class="annot"><a href="#local-6989586621682211281"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#viewTC"><span class="hs-identifier hs-type">viewTC</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#eCurrentCheckpoint"><span class="hs-identifier hs-type">eCurrentCheckpoint</span></a></span><span>
</span><span id="line-364"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#setModuleCheckpoint"><span class="hs-identifier hs-type">setModuleCheckpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211281"><span class="hs-identifier hs-type">cp</span></a></span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-type">checkRecordProjections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211143"><span class="hs-identifier hs-type">hasNamedCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211276"><span class="hs-identifier hs-type">tel'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211121"><span class="hs-identifier hs-type">ftel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211073"><span class="hs-identifier hs-type">fields</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-comment">-- we define composition here so that the projections are already in the signature.</span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><a href="Agda.Utils.Monad.html#whenM"><span class="hs-identifier hs-type">whenM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#cubicalCompatibleOption"><span class="hs-identifier hs-type">cubicalCompatibleOption</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-type">escapeContext</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211196"><span class="hs-identifier hs-type">npars</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.Cubical.html#addCompositionForRecord"><span class="hs-identifier hs-type">addCompositionForRecord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211061"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211189"><span class="hs-identifier hs-type">haveEta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211179"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211116"><span class="hs-identifier hs-type">tel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-type">argFromDom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211163"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211121"><span class="hs-identifier hs-type">ftel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211134"><span class="hs-identifier hs-type">rect</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-comment">-- The confluence checker needs to know what symbols match against</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-comment">-- the constructor.</span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-type">modifySignature</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-type">updateDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211144"><span class="hs-identifier hs-type">conName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682211292"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682211292"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682211292"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defMatchable"><span class="hs-identifier hs-var">defMatchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.fromList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211163"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- Andreas, 2020-04-19, issue #4560</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-comment">-- If the user declared the record constructor as @pattern@,</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-comment">-- then switch on pattern matching for no-eta-equality.</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-comment">-- Default is no pattern matching, but definition by copatterns instead.</span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621682211174"><span class="annot"><span class="annottext">patCopat :: PatternOrCopattern
</span><a href="#local-6989586621682211174"><span class="hs-identifier hs-var hs-var">patCopat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
-&gt; (Range -&gt; PatternOrCopattern)
-&gt; Maybe Range
-&gt; PatternOrCopattern
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="Agda.Syntax.Common.html#CopatternMatching"><span class="hs-identifier hs-var">CopatternMatching</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; Range -&gt; PatternOrCopattern
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="Agda.Syntax.Common.html#PatternMatching"><span class="hs-identifier hs-var">PatternMatching</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621682211067"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621682211178"><span class="annot"><span class="annottext">eta :: Maybe HasEta
</span><a href="#local-6989586621682211178"><span class="hs-identifier hs-var hs-var">eta</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621682211174"><span class="hs-identifier hs-var">patCopat</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; HasEta0 -&gt; HasEta
forall a b. a -&gt; HasEta' b -&gt; HasEta' a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HasEta0 -&gt; HasEta)
-&gt; (Ranged HasEta0 -&gt; HasEta0) -&gt; Ranged HasEta0 -&gt; HasEta
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ranged HasEta0 -&gt; HasEta0
forall a. Ranged a -&gt; a
</span><a href="Agda.Syntax.Common.html#rangedThing"><span class="hs-identifier hs-var">rangedThing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ranged HasEta0 -&gt; HasEta)
-&gt; Maybe (Ranged HasEta0) -&gt; Maybe HasEta
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged HasEta0)
</span><a href="#local-6989586621682211066"><span class="hs-identifier hs-var">eta0</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><span class="hs-comment">{-| @checkRecordProjections m r q tel ftel fs@.

    [@m@    ]  name of the generated module

    [@r@    ]  name of the record type

    [@con@  ]  name of the record constructor

    [@tel@  ]  parameters (perhaps erased) and record variable r (&quot;self&quot;)

    [@ftel@ ]  telescope of fields

    [@fs@   ]  the fields to be checked
-}</span></span><span>
</span><span id="line-401"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-type">checkRecordProjections</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="checkRecordProjections"><span class="annot"><span class="annottext">checkRecordProjections :: ModuleName
-&gt; QName
-&gt; Bool
-&gt; ConHead
-&gt; Telescope
-&gt; Telescope
-&gt; [Declaration]
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-var hs-var">checkRecordProjections</span></a></span></span><span> </span><span id="local-6989586621682211299"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682211299"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682211300"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211300"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682211301"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682211301"><span class="hs-identifier hs-var">hasNamedCon</span></a></span></span><span> </span><span id="local-6989586621682211302"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682211302"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682211303"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211303"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682211304"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211304"><span class="hs-identifier hs-var">ftel</span></a></span></span><span> </span><span id="local-6989586621682211305"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211305"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Declaration] -&gt; TCM ()
</span><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
forall a. Tele a
</span><a href="Agda.Syntax.Internal.html#EmptyTel"><span class="hs-identifier hs-var">EmptyTel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211304"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211305"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="#local-6989586621682211306"><span class="hs-identifier hs-type">checkProjs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621682211306"><span class="annot"><span class="annottext">checkProjs :: Telescope -&gt; Telescope -&gt; [Term] -&gt; [Declaration] -&gt; TCM ()
</span><a href="#local-6989586621682211306"><span class="hs-identifier hs-var hs-var">checkProjs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621682211308"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211308"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span id="local-6989586621682211309"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211309"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span> </span><span id="local-6989586621682211310"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211310"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">A.ScopedDecl</span></a></span><span> </span><span id="local-6989586621682211311"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682211311"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621682211312"><span class="annot"><span class="annottext">List1 Declaration
</span><a href="#local-6989586621682211312"><span class="hs-identifier hs-var">fs'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682211313"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211313"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">ScopeInfo -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-identifier hs-var">setScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682211311"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM () -&gt; TCM ()
forall a b. TCMT IO a -&gt; TCMT IO b -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Declaration] -&gt; TCM ()
</span><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211308"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211309"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211310"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 Declaration -&gt; [Item (List1 Declaration)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 Declaration
</span><a href="#local-6989586621682211312"><span class="hs-identifier hs-var">fs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211313"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-comment">-- Case: projection.</span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621682211315"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#ExtendTel"><span class="hs-identifier hs-type">ExtendTel</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682211317"><span class="annot"><span class="annottext">dom :: Dom Type
</span><a href="#local-6989586621682211317"><span class="hs-identifier hs-var">dom</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">domInfo :: forall t e. Dom' t e -&gt; ArgInfo
</span><a href="Agda.Syntax.Internal.html#domInfo"><span class="hs-identifier hs-var">domInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682211320"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682211321"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682211322"><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682211323"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211323"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span> </span><span id="local-6989586621682211324"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211324"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682211325"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211325"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682211326"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211326"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><span class="annottext">Call -&gt; TCM () -&gt; TCM ()
forall a. Call -&gt; TCMT IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadTrace m =&gt; Call -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#traceCall"><span class="hs-identifier hs-var">traceCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Type -&gt; Call
</span><a href="Agda.TypeChecking.Monad.Base.html#CheckProjection"><span class="hs-identifier hs-var">CheckProjection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211324"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211325"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-comment">-- Andreas, 2012-06-07:</span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-comment">-- Issue 387: It is wrong to just type check field types again</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-comment">-- because then meta variables are created again.</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-comment">-- Instead, we take the field type t from the field telescope.</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking projection&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211325"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-425"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;top   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;tel   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211303"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-comment">-- Andreas, 2021-05-11, issue #5378</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-comment">-- The impossible is sometimes possible, so splitting out this part...</span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec.proj.escapeContext&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">45</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-432"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;t     =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
-&gt; Abs Telescope -&gt; (Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Doc
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction"><span class="hs-identifier hs-var">underAbstraction</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682211317"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-437"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; Nat -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#unsafeEscapeContext"><span class="hs-identifier hs-var">unsafeEscapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;t     =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; Nat -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#unsafeEscapeContext"><span class="hs-identifier hs-var">unsafeEscapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; Nat -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#unsafeEscapeContext"><span class="hs-identifier hs-var">unsafeEscapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
-&gt; Abs Telescope -&gt; (Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Doc
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction"><span class="hs-identifier hs-var">underAbstraction</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682211317"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">55</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-442"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel1 (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span>
</span><span id="line-443"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;t     (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-444"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel2 (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span>
</span><span id="line-445"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-447"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;vs    =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyList_"><span class="hs-identifier hs-var">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term -&gt; TCMT IO Doc) -&gt; [Term] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211323"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;abstr =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; ArgName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; TCMT IO Doc)
-&gt; (IsAbstract -&gt; ArgName) -&gt; IsAbstract -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IsAbstract -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; IsAbstract
forall t. DefInfo' t -&gt; IsAbstract
</span><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211324"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;quant =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; ArgName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; TCMT IO Doc)
-&gt; (Quantity -&gt; ArgName) -&gt; Quantity -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;coh   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; ArgName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; TCMT IO Doc)
-&gt; (Cohesion -&gt; ArgName) -&gt; Cohesion -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-comment">-- Cohesion check:</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- For a field `@c &#960; : A`, if c has a left adjoint, we create a projection</span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-comment">-- `@(c^-1) &#960; : .., (@(c^-1 . c) r : R as) -&gt; A`</span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-comment">-- So we want to check that `@.., (c^-1 . c) x : A |- x : A` is allowed by the modalities.</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-comment">-- Currently only sharp and continuous have left adjoints under composition.</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-comment">-- This check happens at scope checking time, so we should only be left</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-comment">-- with annotations with left adjoints here</span><span>
</span><span id="line-461"></span><span>      </span><span id="local-6989586621682211337"><span class="annot"><a href="#local-6989586621682211337"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnderComposition Cohesion -&gt; Bool
forall a. LeftClosedPOMonoid a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.POMonoid.html#hasLeftAdjoint"><span class="hs-identifier hs-var">hasLeftAdjoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; UnderComposition Cohesion
forall t. t -&gt; UnderComposition t
</span><a href="Agda.Syntax.Common.html#UnderComposition"><span class="hs-identifier hs-var">UnderComposition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Telescope
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Telescope) -&gt; Telescope -&gt; TCMT IO Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' Telescope [Dom (ArgName, Type)]
-&gt; LensMap Telescope [Dom (ArgName, Type)]
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">([Dom (ArgName, Type)] -&gt; f [Dom (ArgName, Type)])
-&gt; Telescope -&gt; f Telescope
Lens' Telescope [Dom (ArgName, Type)]
</span><a href="Agda.Syntax.Internal.html#listTel"><span class="hs-identifier hs-var">listTel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dom (ArgName, Type) -&gt; Dom (ArgName, Type))
-&gt; [Dom (ArgName, Type)] -&gt; [Dom (ArgName, Type)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; Dom (ArgName, Type) -&gt; Dom (ArgName, Type)
forall a. LensCohesion a =&gt; Cohesion -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyCohesion"><span class="hs-identifier hs-var">inverseApplyCohesion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211303"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>      </span><span class="hs-comment">-- For now, we forbid any polarity annotations on record fields (we would need to do as above,</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-comment">-- and eta-equality or projection existence would be in danger).</span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-type">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#getModalPolarity"><span class="hs-identifier hs-type">getModalPolarity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211320"><span class="hs-identifier hs-type">ai</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#samePolarity"><span class="hs-operator hs-type">`samePolarity`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#withStandardLock"><span class="hs-identifier hs-type">withStandardLock</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MixedPolarity"><span class="hs-identifier hs-type">MixedPolarity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-comment">-- Andreas, 2025-05-03, already checked in ConcreteToAbstract.checkFieldArgInfo</span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-comment">-- The telescope tel includes the variable of record type as last one</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-comment">-- e.g. for cartesion product it is</span><span>
</span><span id="line-473"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-comment">--   tel = {A' : Set} {B' : Set} (r : Prod A' B')</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-comment">-- create the projection functions (instantiate the type with the values</span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-comment">-- of the previous fields)</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-comment">-- The type of the projection function should be</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-comment">--  {&#916;} -&gt; (r : R &#916;) -&gt; t</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-comment">-- where &#916; are the parameters of R</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-comment">{- what are the contexts?

          &#916; , ftel&#8321;              &#8866; t
          &#916; , (r : R &#916;)          &#8866; parallelS vs : ftel&#8321;
          &#916; , (r : R &#916;) , ftel&#8321;  &#8866; t' = raiseFrom (size ftel&#8321;) 1 t
          &#916; , (r : R &#916;)          &#8866; t'' = applySubst (parallelS vs) t'
                                 &#8866; finalt = telePi tel t''
      -}</span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211348"><span class="annot"><a href="#local-6989586621682211348"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raiseFrom"><span class="hs-identifier hs-var">raiseFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-492"></span><span>          </span><span id="local-6989586621682211350"><span class="annot"><a href="#local-6989586621682211350"><span class="hs-identifier hs-var hs-var">t''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution' (SubstArg Type) -&gt; Type -&gt; Type
forall a. Subst a =&gt; Substitution' (SubstArg a) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Term] -&gt; Substitution' Term
forall a. DeBruijn a =&gt; [a] -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#parallelS"><span class="hs-identifier hs-var">parallelS</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211323"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211348"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-493"></span><span>          </span><span id="local-6989586621682211353"><span class="annot"><a href="#local-6989586621682211353"><span class="hs-identifier hs-var hs-var">finalt</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#telePi"><span class="hs-identifier hs-var">telePi</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211337"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211350"><span class="hs-identifier hs-var">t''</span></a></span><span>
</span><span id="line-494"></span><span>          </span><span id="local-6989586621682211355"><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-var hs-var">projname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#qualify"><span class="hs-identifier hs-var">qualify</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682211299"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211325"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-495"></span><span>          </span><span id="local-6989586621682211358"><span class="annot"><a href="#local-6989586621682211358"><span class="hs-identifier hs-var hs-var">projcall</span></a></span></span><span> </span><span id="local-6989586621682211359"><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621682211359"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Elim
forall a. ProjOrigin -&gt; QName -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-var">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621682211359"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211355"><span class="hs-identifier hs-var">projname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-496"></span><span>          </span><span id="local-6989586621682211362"><span class="annot"><a href="#local-6989586621682211362"><span class="hs-identifier hs-var hs-var">rel</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span>
</span><span id="line-497"></span><span>          </span><span class="hs-comment">-- the recursive call</span><span>
</span><span id="line-498"></span><span>          </span><span id="local-6989586621682211363"><span class="annot"><a href="#local-6989586621682211363"><span class="hs-identifier hs-var hs-var">recurse</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Declaration] -&gt; TCM ()
</span><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211315"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Telescope) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs Telescope -&gt; Telescope
forall a. a -&gt; Abs (Tele a) -&gt; Tele a
</span><a href="Agda.Syntax.Internal.html#ExtendTel"><span class="hs-identifier hs-var">ExtendTel</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682211317"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-499"></span><span>                                 </span><span class="annot"><span class="annottext">(Abs Telescope -&gt; Telescope) -&gt; Abs Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Telescope -&gt; Abs Telescope
forall a. ArgName -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ArgName
</span><a href="Agda.Syntax.Abstract.Name.html#nameToArgName"><span class="hs-identifier hs-var">nameToArgName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ArgName) -&gt; Name -&gt; ArgName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211355"><span class="hs-identifier hs-var">projname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
forall a. Tele a
</span><a href="Agda.Syntax.Internal.html#EmptyTel"><span class="hs-identifier hs-var">EmptyTel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Telescope -&gt; Telescope
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProjOrigin -&gt; Term
</span><a href="#local-6989586621682211358"><span class="hs-identifier hs-var">projcall</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; [Term] -&gt; [Term]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211323"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211326"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="hs-number">25</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;finalt=&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211353"><span class="hs-identifier hs-type">finalt</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-comment">-- -- Andreas, 2012-02-20 do not add irrelevant projections if</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-comment">-- -- disabled by --no-irrelevant-projections</span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-comment">-- ifM (return (rel == Irrelevant) `and2M` do not . optIrrelevantProjections &lt;$&gt; pragmaOptions) recurse $ do</span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-comment">-- Andreas, 2018-06-09 issue #2170</span><span>
</span><span id="line-509"></span><span>      </span><span class="hs-comment">-- Always create irrelevant projections (because the scope checker accepts irrelevant fields).</span><span>
</span><span id="line-510"></span><span>      </span><span class="hs-comment">-- If --no-irrelevant-projections, then their use should be disallowed by the type checker for expressions.</span><span>
</span><span id="line-511"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-513"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-514"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211353"><span class="hs-identifier hs-type">finalt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-comment">-- The body should be</span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-comment">--  P.xi {tel} (r _ .. x .. _) = x</span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-comment">-- Ulf, 2011-08-22: actually we're dropping the parameters from the</span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-comment">-- projection functions so the body is now</span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-comment">--  P.xi (r _ .. x .. _) = x</span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-comment">-- Andreas, 2012-01-12: irrelevant projections get translated to</span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-comment">--  P.xi (r _ .. x .. _) = irrAxiom {level of t} {t} x</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-comment">-- PROBLEM: because of dropped parameters, cannot refer to t</span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-comment">-- 2012-04-02: DontCare instead of irrAxiom</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-comment">-- compute body modification for irrelevant projections</span><span>
</span><span id="line-528"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211368"><span class="annot"><a href="#local-6989586621682211368"><span class="hs-identifier hs-var hs-var">bodyMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Term -&gt; Term) -&gt; Term -&gt; Term
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682211362"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#dontCare"><span class="hs-identifier hs-var">dontCare</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Andreas, 2010-09-09: comment for existing code</span><span>
</span><span id="line-531"></span><span>            </span><span class="hs-comment">-- split the telescope into parameters (ptel) and the type or the record</span><span>
</span><span id="line-532"></span><span>            </span><span class="hs-comment">-- (rt) which should be  R ptel</span><span>
</span><span id="line-533"></span><span>            </span><span id="local-6989586621682211371"><span class="annot"><a href="#local-6989586621682211371"><span class="hs-identifier hs-var hs-var">telList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (ArgName, Type)]
forall t. Tele (Dom t) -&gt; [Dom (ArgName, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211337"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-534"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682211372"><span class="annot"><a href="#local-6989586621682211372"><span class="hs-identifier hs-var">ptelList</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682211373"><span class="annot"><a href="#local-6989586621682211373"><span class="hs-identifier hs-var">rt</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211337"><span class="hs-identifier hs-type">tel</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211371"><span class="hs-identifier hs-type">telList</span></a></span><span>
</span><span id="line-535"></span><span>            </span><span id="local-6989586621682211375"><span class="annot"><a href="#local-6989586621682211375"><span class="hs-identifier hs-var hs-var">ptel</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dom (ArgName, Type)] -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList"><span class="hs-identifier hs-var">telFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom (ArgName, Type)]
</span><a href="#local-6989586621682211372"><span class="hs-identifier hs-var">ptelList</span></a></span><span>
</span><span id="line-536"></span><span>            </span><span id="local-6989586621682211377"><span class="annot"><a href="#local-6989586621682211377"><span class="hs-identifier hs-var hs-var">cpo</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682211301"><span class="hs-identifier hs-var">hasNamedCon</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="Agda.Syntax.Internal.html#PatOCon"><span class="hs-identifier hs-var">PatOCon</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="Agda.Syntax.Internal.html#PatORec"><span class="hs-identifier hs-var">PatORec</span></a></span><span>
</span><span id="line-537"></span><span>            </span><span id="local-6989586621682211380"><span class="annot"><a href="#local-6989586621682211380"><span class="hs-identifier hs-var hs-var">cpi</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConPatternInfo"><span class="hs-identifier hs-type">ConPatternInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conPInfo :: PatternInfo
</span><a href="Agda.Syntax.Internal.html#conPInfo"><span class="hs-identifier hs-var">conPInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatOrigin -&gt; [Name] -&gt; PatternInfo
</span><a href="Agda.Syntax.Internal.html#PatternInfo"><span class="hs-identifier hs-var">PatternInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="#local-6989586621682211377"><span class="hs-identifier hs-var">cpo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPRecord :: Bool
</span><a href="Agda.Syntax.Internal.html#conPRecord"><span class="hs-identifier hs-var">conPRecord</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-539"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPFallThrough :: Bool
</span><a href="Agda.Syntax.Internal.html#conPFallThrough"><span class="hs-identifier hs-var">conPFallThrough</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-540"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#conPType"><span class="hs-identifier hs-var">conPType</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Arg Type) -&gt; Dom Type -&gt; Arg Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ArgName, Type) -&gt; Type) -&gt; Dom (ArgName, Type) -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; Dom' Term a -&gt; Dom' Term b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(ArgName, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Dom (ArgName, Type)
</span><a href="#local-6989586621682211373"><span class="hs-identifier hs-var">rt</span></a></span><span>
</span><span id="line-541"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPLazy :: Bool
</span><a href="Agda.Syntax.Internal.html#conPLazy"><span class="hs-identifier hs-var">conPLazy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-542"></span><span>            </span><span id="local-6989586621682211389"><span class="annot"><a href="#local-6989586621682211389"><span class="hs-identifier hs-var hs-var">conp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar))
-&gt; Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConHead
-&gt; ConPatternInfo
-&gt; [NamedArg (Pattern' DBPatVar)]
-&gt; Pattern' DBPatVar
forall x.
ConHead -&gt; ConPatternInfo -&gt; [NamedArg (Pattern' x)] -&gt; Pattern' x
</span><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-var">ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682211302"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatternInfo
</span><a href="#local-6989586621682211380"><span class="hs-identifier hs-var">cpi</span></a></span><span> </span><span class="annot"><span class="annottext">([NamedArg (Pattern' DBPatVar)] -&gt; Pattern' DBPatVar)
-&gt; [NamedArg (Pattern' DBPatVar)] -&gt; Pattern' DBPatVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [NamedArg (Pattern' DBPatVar)]
forall a t. DeBruijn a =&gt; Tele (Dom t) -&gt; [NamedArg a]
</span><a href="Agda.TypeChecking.Telescope.html#teleNamedArgs"><span class="hs-identifier hs-var">teleNamedArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211304"><span class="hs-identifier hs-var">ftel</span></a></span><span>
</span><span id="line-543"></span><span>            </span><span id="local-6989586621682211393"><span class="annot"><a href="#local-6989586621682211393"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe Term
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Maybe Term) -&gt; Term -&gt; Maybe Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="#local-6989586621682211368"><span class="hs-identifier hs-var">bodyMod</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>            </span><span id="local-6989586621682211395"><span class="annot"><a href="#local-6989586621682211395"><span class="hs-identifier hs-var hs-var">cltel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211375"><span class="hs-identifier hs-var">ptel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-var">`abstract`</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211304"><span class="hs-identifier hs-var">ftel</span></a></span><span>
</span><span id="line-545"></span><span>            </span><span id="local-6989586621682211396"><span class="annot"><a href="#local-6989586621682211396"><span class="hs-identifier hs-var hs-var">cltype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Type -&gt; Arg Type
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Arg Type) -&gt; Type -&gt; Arg Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Abs Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621682211322"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-546"></span><span>            </span><span id="local-6989586621682211399"><span class="annot"><a href="#local-6989586621682211399"><span class="hs-identifier hs-var hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">clauseLHSRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseLHSRange"><span class="hs-identifier hs-var">clauseLHSRange</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211324"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-547"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseFullRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseFullRange"><span class="hs-identifier hs-var">clauseFullRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682211324"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-548"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseTel :: Telescope
</span><a href="Agda.Syntax.Internal.html#clauseTel"><span class="hs-identifier hs-var">clauseTel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211395"><span class="hs-identifier hs-var">cltel</span></a></span><span>
</span><span id="line-549"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">namedClausePats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="Agda.Syntax.Internal.html#namedClausePats"><span class="hs-identifier hs-var">namedClausePats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NamedArg (Pattern' DBPatVar)
</span><a href="#local-6989586621682211389"><span class="hs-identifier hs-var">conp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseBody :: Maybe Term
</span><a href="Agda.Syntax.Internal.html#clauseBody"><span class="hs-identifier hs-var">clauseBody</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Term
</span><a href="#local-6989586621682211393"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-551"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#clauseType"><span class="hs-identifier hs-var">clauseType</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Arg Type)
</span><a href="#local-6989586621682211396"><span class="hs-identifier hs-var">cltype</span></a></span><span>
</span><span id="line-552"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseCatchall :: Catchall
</span><a href="Agda.Syntax.Internal.html#clauseCatchall"><span class="hs-identifier hs-var">clauseCatchall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Catchall
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-553"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseRecursive :: ClauseRecursive
</span><a href="Agda.Syntax.Internal.html#clauseRecursive"><span class="hs-identifier hs-var">clauseRecursive</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClauseRecursive
</span><a href="Agda.Syntax.Internal.html#NotRecursive"><span class="hs-identifier hs-var">NotRecursive</span></a></span><span>
</span><span id="line-554"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseUnreachable :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseUnreachable"><span class="hs-identifier hs-var">clauseUnreachable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-555"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseEllipsis :: ExpandedEllipsis
</span><a href="Agda.Syntax.Internal.html#clauseEllipsis"><span class="hs-identifier hs-var">clauseEllipsis</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpandedEllipsis
</span><a href="Agda.Syntax.Common.html#NoEllipsis"><span class="hs-identifier hs-var">NoEllipsis</span></a></span><span>
</span><span id="line-556"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseWhereModule :: Maybe ModuleName
</span><a href="Agda.Syntax.Internal.html#clauseWhereModule"><span class="hs-identifier hs-var">clauseWhereModule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-557"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682211416"><span class="annot"><a href="#local-6989586621682211416"><span class="hs-identifier hs-var hs-var">projection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-560"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projProper :: Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projProper"><span class="hs-identifier hs-var">projProper</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211300"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-561"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projOrig :: QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projOrig"><span class="hs-identifier hs-var">projOrig</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211355"><span class="hs-identifier hs-var">projname</span></a></span><span>
</span><span id="line-562"></span><span>              </span><span class="hs-comment">-- name of the record type:</span><span>
</span><span id="line-563"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projFromType :: Arg QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projFromType"><span class="hs-identifier hs-var">projFromType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Arg QName
forall a. a -&gt; Arg a
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211300"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-564"></span><span>              </span><span class="hs-comment">-- index of the record argument (in the type),</span><span>
</span><span id="line-565"></span><span>              </span><span class="hs-comment">-- start counting with 1:</span><span>
</span><span id="line-566"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projIndex :: Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211337"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="hs-comment">-- which is @size ptel + 1@</span><span>
</span><span id="line-567"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projLams :: ProjLams
</span><a href="Agda.TypeChecking.Monad.Base.html#projLams"><span class="hs-identifier hs-var">projLams</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Arg ArgName] -&gt; ProjLams
</span><a href="Agda.TypeChecking.Monad.Base.html#ProjLams"><span class="hs-identifier hs-var">ProjLams</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg ArgName] -&gt; ProjLams) -&gt; [Arg ArgName] -&gt; ProjLams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dom (ArgName, Type) -&gt; Arg ArgName)
-&gt; [Dom (ArgName, Type)] -&gt; [Arg ArgName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom' Term ArgName -&gt; Arg ArgName
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom' Term ArgName -&gt; Arg ArgName)
-&gt; (Dom (ArgName, Type) -&gt; Dom' Term ArgName)
-&gt; Dom (ArgName, Type)
-&gt; Arg ArgName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ArgName, Type) -&gt; ArgName)
-&gt; Dom (ArgName, Type) -&gt; Dom' Term ArgName
forall a b. (a -&gt; b) -&gt; Dom' Term a -&gt; Dom' Term b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(ArgName, Type) -&gt; ArgName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dom (ArgName, Type)]
</span><a href="#local-6989586621682211371"><span class="hs-identifier hs-var">telList</span></a></span><span>
</span><span id="line-568"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="hs-number">70</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-571"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-572"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211399"><span class="hs-identifier hs-type">clause</span></a></span><span>
</span><span id="line-573"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-574"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-575"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-576"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QNamed"><span class="hs-identifier hs-type">QNamed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211399"><span class="hs-identifier hs-type">clause</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>              </span><span class="hs-comment">-- Record patterns should /not/ be translated when the</span><span>
</span><span id="line-580"></span><span>              </span><span class="hs-comment">-- projection functions are defined. Record pattern</span><span>
</span><span id="line-581"></span><span>              </span><span class="hs-comment">-- translation is defined in terms of projection</span><span>
</span><span id="line-582"></span><span>              </span><span class="hs-comment">-- functions.</span><span>
</span><span id="line-583"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682211427"><span class="annot"><a href="#local-6989586621682211427"><span class="hs-identifier hs-var">mst</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682211428"><span class="annot"><a href="#local-6989586621682211428"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.Compile.html#compileClauses"><span class="hs-identifier hs-type">compileClauses</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682211399"><span class="hs-identifier hs-type">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.cc&quot;</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;compiled clauses of &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span>
</span><span id="line-587"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682211428"><span class="hs-identifier hs-type">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-type">escapeContext</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-type">impossible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211337"><span class="hs-identifier hs-type">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-591"></span><span>          </span><span id="local-6989586621682211430"><span class="annot"><a href="#local-6989586621682211430"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#getLanguage"><span class="hs-identifier hs-type">getLanguage</span></a></span><span>
</span><span id="line-592"></span><span>          </span><span id="local-6989586621682211432"><span class="annot"><a href="#local-6989586621682211432"><span class="hs-identifier hs-var">fun</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#emptyFunctionData"><span class="hs-identifier hs-type">emptyFunctionData</span></a></span><span>
</span><span id="line-593"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- It should be fine to mark a field with @&#969; in an</span><span>
</span><span id="line-594"></span><span>              </span><span class="hs-comment">-- erased record type: the field will be non-erased, but</span><span>
</span><span id="line-595"></span><span>              </span><span class="hs-comment">-- the projection will be erased. The following code</span><span>
</span><span id="line-596"></span><span>              </span><span class="hs-comment">-- ensures that the use of addConstant does not trigger</span><span>
</span><span id="line-597"></span><span>              </span><span class="hs-comment">-- a PlentyInHardCompileTimeMode warning.</span><span>
</span><span id="line-598"></span><span>              </span><span id="local-6989586621682211434"><span class="annot"><a href="#local-6989586621682211434"><span class="hs-identifier hs-var hs-var">ai'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Quantity -&gt; Quantity) -&gt; ArgInfo -&gt; ArgInfo)
-&gt; ArgInfo -&gt; (Quantity -&gt; Quantity) -&gt; ArgInfo
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity) -&gt; ArgInfo -&gt; ArgInfo
forall a. LensQuantity a =&gt; (Quantity -&gt; Quantity) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapQuantity"><span class="hs-identifier hs-var">mapQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682211320"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">((Quantity -&gt; Quantity) -&gt; ArgInfo)
-&gt; (Quantity -&gt; Quantity) -&gt; ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-599"></span><span>                      </span><span class="annot"><a href="Agda.Syntax.Common.html#Quantity%3C9"><span class="hs-identifier hs-type">Quantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#Quantity%3C9"><span class="hs-identifier hs-var">Quantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin
</span><a href="Agda.Syntax.Common.html#Q%3C9Inferred"><span class="hs-identifier hs-var">Q&#969;Inferred</span></a></span><span>
</span><span id="line-600"></span><span>                      </span><span id="local-6989586621682211439"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621682211439"><span class="hs-identifier hs-var">q</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621682211439"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-601"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#addConstant"><span class="hs-identifier hs-type">addConstant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-602"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defaultDefn"><span class="hs-identifier hs-type">defaultDefn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211434"><span class="hs-identifier hs-type">ai'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-type">killRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211353"><span class="hs-identifier hs-type">finalt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682211430"><span class="hs-identifier hs-type">lang</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#FunctionDefn"><span class="hs-identifier hs-type">FunctionDefn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-603"></span><span>             </span><span class="annot"><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#funProj_"><span class="hs-identifier hs-type">funProj_</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-604"></span><span>              </span><span class="annot"><a href="#local-6989586621682211432"><span class="hs-identifier hs-type">fun</span></a></span><span>
</span><span id="line-605"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funClauses"><span class="hs-identifier hs-var">_funClauses</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682211399"><span class="hs-identifier hs-type">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funCompiled"><span class="hs-identifier hs-var">_funCompiled</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682211428"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-607"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funSplitTree"><span class="hs-identifier hs-var">_funSplitTree</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682211427"><span class="hs-identifier hs-type">mst</span></a></span><span>
</span><span id="line-608"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funProjection"><span class="hs-identifier hs-var">_funProjection</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682211416"><span class="hs-identifier hs-type">projection</span></a></span><span>
</span><span id="line-609"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funMutual"><span class="hs-identifier hs-var">_funMutual</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Projections are not mutually recursive with anything</span><span>
</span><span id="line-610"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funTerminates"><span class="hs-identifier hs-var">_funTerminates</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-611"></span><span>                </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defArgOccurrences"><span class="hs-identifier hs-var">defArgOccurrences</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#StrictPos"><span class="hs-identifier hs-type">StrictPos</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defCopatternLHS"><span class="hs-identifier hs-var">defCopatternLHS</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#hasProjectionPatterns"><span class="hs-identifier hs-type">hasProjectionPatterns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211428"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-614"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-615"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Polarity.html#computePolarity"><span class="hs-identifier hs-type">computePolarity</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682211355"><span class="hs-identifier hs-type">projname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211315"><span class="hs-identifier hs-type">ftel1</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">Info.defInstance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682211324"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-618"></span><span>          </span><span class="hs-comment">-- Instance projections have to be added with their types &quot;qua</span><span>
</span><span id="line-619"></span><span>          </span><span class="hs-comment">-- local variable&quot; (i.e. the type you'd get were you to open</span><span>
</span><span id="line-620"></span><span>          </span><span class="hs-comment">-- the record module), but this type has to be treated in the</span><span>
</span><span id="line-621"></span><span>          </span><span class="hs-comment">-- context ftel1 otherwise it's nonsense</span><span>
</span><span id="line-622"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#InstanceDef"><span class="hs-identifier hs-type">InstanceDef</span></a></span><span> </span><span id="local-6989586621682211457"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682211457"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; QName -&gt; Type -&gt; TCM ()
</span><a href="Agda.TypeChecking.InstanceArguments.html#addTypedInstance"><span class="hs-identifier hs-var">addTypedInstance</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682211457"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682211355"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682211321"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-623"></span><span>          </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>        </span><span class="annot"><a href="#local-6989586621682211363"><span class="hs-identifier hs-type">recurse</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-comment">-- Case: definition.</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621682211458"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211458"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span id="local-6989586621682211459"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211459"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span> </span><span id="local-6989586621682211460"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211460"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682211461"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682211461"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682211462"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211462"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>      </span><span class="annot"><span class="annottext">Declaration -&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Decl.html#checkDecl"><span class="hs-identifier hs-var">checkDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682211461"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-630"></span><span>      </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Declaration] -&gt; TCM ()
</span><a href="#local-6989586621682211306"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211458"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682211459"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621682211460"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682211462"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-631"></span></pre></body></html>