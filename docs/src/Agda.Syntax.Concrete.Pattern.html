<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- {-# OPTIONS_GHC -Wunused-imports #-}  -- no, because of liftA2</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-matches #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-binds #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">-- | Tools for patterns in concrete syntax.</span></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html"><span class="hs-identifier">Agda.Syntax.Concrete.Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">liftA2</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Any</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Endo</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Sum</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html"><span class="hs-identifier">Agda.Syntax.Concrete</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.AffineHole.html"><span class="hs-identifier">Agda.Utils.AffineHole</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier">List1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List2.html"><span class="hs-identifier">Agda.Utils.List2</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List2.html#List2"><span class="hs-identifier">List2</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Tuple.html"><span class="hs-identifier">Agda.Utils.Tuple</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><span class="hs-comment">-- | Check for ellipsis @...@.</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">class</span><span> </span><span id="IsEllipsis"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsEllipsis"><span class="hs-identifier hs-var">IsEllipsis</span></a></span></span><span> </span><span id="local-6989586621681802957"><span class="annot"><a href="#local-6989586621681802957"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span id="isEllipsis"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#isEllipsis"><span class="hs-identifier hs-type">isEllipsis</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681802957"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="annot"><span class="hs-comment">-- | Is the pattern just @...@?</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsEllipsis"><span class="hs-identifier hs-type">IsEllipsis</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621681803206"><span class="annot"><span class="annottext">isEllipsis :: Pattern -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#isEllipsis"><span class="hs-identifier hs-var hs-var hs-var">isEllipsis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803209"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803209"><span class="hs-identifier hs-var">p</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
forall a. IsEllipsis a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#isEllipsis"><span class="hs-identifier hs-var">isEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803209"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><span class="hs-comment">-- | Has the lhs an occurrence of the ellipsis @...@?</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">class</span><span> </span><span id="HasEllipsis"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#HasEllipsis"><span class="hs-identifier hs-var">HasEllipsis</span></a></span></span><span> </span><span id="local-6989586621681802960"><span class="annot"><a href="#local-6989586621681802960"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>  </span><span id="hasEllipsis"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis"><span class="hs-identifier hs-type">hasEllipsis</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681802960"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#HasEllipsis"><span class="hs-identifier hs-type">HasEllipsis</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621681803215"><span class="annot"><span class="annottext">hasEllipsis :: Pattern -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis"><span class="hs-identifier hs-var hs-var hs-var">hasEllipsis</span></a></span></span><span> </span><span id="local-6989586621681803216"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803216"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; AffineHole Pattern Pattern
forall p. CPatternLike p =&gt; p -&gt; AffineHole Pattern p
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis%27"><span class="hs-identifier hs-var">hasEllipsis'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803216"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><a href="Agda.Utils.AffineHole.html#ZeroHoles"><span class="hs-identifier hs-type">ZeroHoles</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><a href="Agda.Utils.AffineHole.html#OneHole"><span class="hs-identifier hs-type">OneHole</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="annottext">AffineHole Pattern Pattern
</span><a href="Agda.Utils.AffineHole.html#ManyHoles"><span class="hs-identifier hs-var">ManyHoles</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="annot"><span class="hs-comment">-- | Does the lhs contain an ellipsis?</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#HasEllipsis"><span class="hs-identifier hs-type">HasEllipsis</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621681803224"><span class="annot"><span class="annottext">hasEllipsis :: LHS -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis"><span class="hs-identifier hs-var hs-var hs-var">hasEllipsis</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span id="local-6989586621681803226"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803226"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
forall a. HasEllipsis a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis"><span class="hs-identifier hs-var">hasEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803226"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">-- clauses that are already expanded don't have an ellipsis</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><span class="hs-comment">-- | Check for with-pattern @| p@.</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">class</span><span> </span><span id="IsWithP"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-var">IsWithP</span></a></span></span><span> </span><span id="local-6989586621681802969"><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="isWithP"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-type">isWithP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="isWithP"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-type">isWithP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681802966"><span id="local-6989586621681802967"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802966"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html#Decoration"><span class="hs-identifier hs-type">Decoration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802967"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681802967"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802966"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681802969"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621681803229"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var hs-var">isWithP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(q -&gt; Maybe q) -&gt; f q -&gt; Maybe (f q)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Decoration t, Functor m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Functor m =&gt; (a -&gt; m b) -&gt; f a -&gt; m (f b)
</span><a href="Agda.Utils.Functor.html#traverseF"><span class="hs-identifier hs-var">traverseF</span></a></span><span> </span><span class="annot"><span class="annottext">q -&gt; Maybe q
forall p. IsWithP p =&gt; p -&gt; Maybe p
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var">isWithP</span></a></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621681803243"><span class="annot"><span class="annottext">isWithP :: Pattern -&gt; Maybe Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var hs-var hs-var">isWithP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803245"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803245"><span class="hs-identifier hs-var">p</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Maybe Pattern
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803245"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803246"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803246"><span class="hs-identifier hs-var">p</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Maybe Pattern
forall p. IsWithP p =&gt; p -&gt; Maybe p
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var">isWithP</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803246"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681802954"><span id="local-6989586621681803249"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802954"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802954"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681802952"><span id="local-6989586621681802953"><span id="local-6989586621681803257"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802952"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802953"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802952"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- * LHS manipulation (see also ''Agda.Syntax.Abstract.Pattern'')</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | The next patterns are ...</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- (This view discards 'PatInfo'.)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="LHSPatternView"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSPatternView"><span class="hs-identifier hs-var">LHSPatternView</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LHSAppP"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSAppP"><span class="hs-identifier hs-var">LHSAppP</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Application patterns (non-empty list).</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LHSWithP"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSWithP"><span class="hs-identifier hs-var">LHSWithP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- ^ With patterns (non-empty list).</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-comment">--   These patterns are not prefixed with 'WithP'.</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Construct the 'LHSPatternView' of the given list (if not empty).</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- Return the view and the remaining patterns.</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsPatternView"><span class="hs-identifier hs-type">lhsPatternView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSPatternView"><span class="hs-identifier hs-type">LHSPatternView</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span id="lhsPatternView"><span class="annot"><span class="annottext">lhsPatternView :: [NamedArg Pattern] -&gt; Maybe (LHSPatternView, [NamedArg Pattern])
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsPatternView"><span class="hs-identifier hs-var hs-var">lhsPatternView</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LHSPatternView, [NamedArg Pattern])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsPatternView"><span class="hs-identifier hs-var">lhsPatternView</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803266"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803266"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681803267"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803267"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Pattern
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803266"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span> </span><span id="local-6989586621681803269"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803269"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621681803270"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803270"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LHSPatternView, [NamedArg Pattern])
-&gt; Maybe (LHSPatternView, [NamedArg Pattern])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 Pattern -&gt; LHSPatternView
</span><a href="Agda.Syntax.Concrete.Pattern.html#LHSWithP"><span class="hs-identifier hs-var">LHSWithP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803270"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; List1 Pattern
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Pattern) -&gt; [NamedArg Pattern] -&gt; [Pattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Pattern
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803271"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803272"><span class="hs-identifier hs-var">ps2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681803271"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803271"><span class="hs-identifier hs-var">ps1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803272"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803272"><span class="hs-identifier hs-var">ps2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Maybe (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; ([NamedArg Pattern], [NamedArg Pattern])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; (Prefix b, [a])
</span><a href="Agda.Utils.List.html#spanJust"><span class="hs-identifier hs-var">spanJust</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Maybe (NamedArg Pattern)
forall p. IsWithP p =&gt; p -&gt; Maybe p
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var">isWithP</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803267"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- If the next pattern is an application pattern, collect more of these</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LHSPatternView, [NamedArg Pattern])
-&gt; Maybe (LHSPatternView, [NamedArg Pattern])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 (NamedArg Pattern) -&gt; LHSPatternView
</span><a href="Agda.Syntax.Concrete.Pattern.html#LHSAppP"><span class="hs-identifier hs-var">LHSAppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803266"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; [NamedArg Pattern] -&gt; List1 (NamedArg Pattern)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803274"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803275"><span class="hs-identifier hs-var">ps2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681803274"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803274"><span class="hs-identifier hs-var">ps1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803275"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803275"><span class="hs-identifier hs-var">ps2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Bool)
-&gt; [NamedArg Pattern] -&gt; ([NamedArg Pattern], [NamedArg Pattern])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (NamedArg Pattern) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (NamedArg Pattern) -&gt; Bool)
-&gt; (NamedArg Pattern -&gt; Maybe (NamedArg Pattern))
-&gt; NamedArg Pattern
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Maybe (NamedArg Pattern)
forall p. IsWithP p =&gt; p -&gt; Maybe p
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var">isWithP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803267"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- | Add applicative patterns (non-projection / non-with patterns) to the right.</span></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreApp"><span class="hs-identifier hs-type">lhsCoreApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span>
</span><span id="line-107"></span><span id="lhsCoreApp"><span class="annot"><span class="annottext">lhsCoreApp :: LHSCore -&gt; List1 (NamedArg Pattern) -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreApp"><span class="hs-identifier hs-var hs-var">lhsCoreApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSEllipsis"><span class="hs-identifier hs-type">LHSEllipsis</span></a></span><span> </span><span id="local-6989586621681803281"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803281"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803282"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803282"><span class="hs-identifier hs-var">core</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681803283"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803283"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; LHSCore -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.html#LHSEllipsis"><span class="hs-identifier hs-var">LHSEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803281"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(LHSCore -&gt; LHSCore) -&gt; LHSCore -&gt; LHSCore
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; List1 (NamedArg Pattern) -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreApp"><span class="hs-identifier hs-var">lhsCoreApp</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803282"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803283"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreApp"><span class="hs-identifier hs-var">lhsCoreApp</span></a></span><span> </span><span id="local-6989586621681803284"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803284"><span class="hs-identifier hs-var">core</span></a></span></span><span> </span><span id="local-6989586621681803285"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803285"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803284"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#lhsPats"><span class="hs-identifier hs-var">lhsPats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#lhsPats"><span class="hs-identifier hs-var">lhsPats</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803284"><span class="hs-identifier hs-type">core</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">List1.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621681803285"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Add with-patterns to the right.</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreWith"><span class="hs-identifier hs-type">lhsCoreWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span>
</span><span id="line-112"></span><span id="lhsCoreWith"><span class="annot"><span class="annottext">lhsCoreWith :: LHSCore -&gt; List1 Pattern -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreWith"><span class="hs-identifier hs-var hs-var">lhsCoreWith</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSWith"><span class="hs-identifier hs-type">LHSWith</span></a></span><span> </span><span id="local-6989586621681803289"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803289"><span class="hs-identifier hs-var">core</span></a></span></span><span> </span><span id="local-6989586621681803290"><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803290"><span class="hs-identifier hs-var">wps</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681803291"><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803291"><span class="hs-identifier hs-var">wps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; List1 Pattern -&gt; [NamedArg Pattern] -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.html#LHSWith"><span class="hs-identifier hs-var">LHSWith</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803289"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803290"><span class="hs-identifier hs-var">wps</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Pattern -&gt; List1 Pattern -&gt; List1 Pattern
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803291"><span class="hs-identifier hs-var">wps'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreWith"><span class="hs-identifier hs-var">lhsCoreWith</span></a></span><span> </span><span id="local-6989586621681803292"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803292"><span class="hs-identifier hs-var">core</span></a></span></span><span>                  </span><span id="local-6989586621681803293"><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803293"><span class="hs-identifier hs-var">wps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; List1 Pattern -&gt; [NamedArg Pattern] -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.html#LHSWith"><span class="hs-identifier hs-var">LHSWith</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803292"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803293"><span class="hs-identifier hs-var">wps'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- | Append patterns to 'LHSCore', separating with patterns from the rest.</span></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreAddSpine"><span class="hs-identifier hs-type">lhsCoreAddSpine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span>
</span><span id="line-117"></span><span id="lhsCoreAddSpine"><span class="annot"><span class="annottext">lhsCoreAddSpine :: LHSCore -&gt; [NamedArg Pattern] -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreAddSpine"><span class="hs-identifier hs-var hs-var">lhsCoreAddSpine</span></a></span></span><span> </span><span id="local-6989586621681803295"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803295"><span class="hs-identifier hs-var">core</span></a></span></span><span> </span><span id="local-6989586621681803296"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803296"><span class="hs-identifier hs-var">ps0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- Recurse on lhsPatternView until no patterns left.</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Maybe (LHSPatternView, [NamedArg Pattern])
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsPatternView"><span class="hs-identifier hs-var">lhsPatternView</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803296"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">Maybe (LHSPatternView, [NamedArg Pattern])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803295"><span class="hs-identifier hs-var">core</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSAppP"><span class="hs-identifier hs-type">LHSAppP</span></a></span><span>  </span><span id="local-6989586621681803297"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803297"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803298"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803298"><span class="hs-identifier hs-var">ps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; List1 (NamedArg Pattern) -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreApp"><span class="hs-identifier hs-var">lhsCoreApp</span></a></span><span>  </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803295"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803297"><span class="hs-identifier hs-var">ps</span></a></span><span>  </span><span class="annot"><span class="annottext">LHSCore -&gt; [NamedArg Pattern] -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreAddSpine"><span class="hs-operator hs-var">`lhsCoreAddSpine`</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803298"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#LHSWithP"><span class="hs-identifier hs-type">LHSWithP</span></a></span><span> </span><span id="local-6989586621681803299"><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803299"><span class="hs-identifier hs-var">wps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803300"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803300"><span class="hs-identifier hs-var">ps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; List1 Pattern -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreWith"><span class="hs-identifier hs-var">lhsCoreWith</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803295"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Pattern
</span><a href="#local-6989586621681803299"><span class="hs-identifier hs-var">wps</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; [NamedArg Pattern] -&gt; LHSCore
</span><a href="Agda.Syntax.Concrete.Pattern.html#lhsCoreAddSpine"><span class="hs-operator hs-var">`lhsCoreAddSpine`</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803300"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | Modify the 'Pattern' component in 'LHS'.</span></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#mapLhsOriginalPattern"><span class="hs-identifier hs-type">mapLhsOriginalPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span>
</span><span id="line-127"></span><span id="mapLhsOriginalPattern"><span class="annot"><span class="annottext">mapLhsOriginalPattern :: (Pattern -&gt; Pattern) -&gt; LHS -&gt; LHS
</span><a href="Agda.Syntax.Concrete.Pattern.html#mapLhsOriginalPattern"><span class="hs-identifier hs-var hs-var">mapLhsOriginalPattern</span></a></span></span><span> </span><span id="local-6989586621681803302"><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621681803302"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681803303"><span class="annot"><span class="annottext">lhs :: LHS
</span><a href="#local-6989586621681803303"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lhsOriginalPattern :: LHS -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#lhsOriginalPattern"><span class="hs-identifier hs-var">lhsOriginalPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681803305"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803305"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">LHS
</span><a href="#local-6989586621681803303"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#lhsOriginalPattern"><span class="hs-identifier hs-var">lhsOriginalPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681803302"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803305"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><span class="hs-comment">-- | Effectfully modify the 'Pattern' component in 'LHS'.</span></span><span>
</span><span id="line-131"></span><span id="local-6989586621681803004"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#mapLhsOriginalPatternM"><span class="hs-identifier hs-type">mapLhsOriginalPatternM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621681803004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span></span><span>
</span><span id="line-132"></span><span id="mapLhsOriginalPatternM"><span class="annot"><span class="annottext">mapLhsOriginalPatternM :: forall (m :: * -&gt; *).
Functor m =&gt;
(Pattern -&gt; m Pattern) -&gt; LHS -&gt; m LHS
</span><a href="Agda.Syntax.Concrete.Pattern.html#mapLhsOriginalPatternM"><span class="hs-identifier hs-var hs-var">mapLhsOriginalPatternM</span></a></span></span><span> </span><span id="local-6989586621681803309"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803309"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681803310"><span class="annot"><span class="annottext">lhs :: LHS
</span><a href="#local-6989586621681803310"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lhsOriginalPattern :: LHS -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#lhsOriginalPattern"><span class="hs-identifier hs-var">lhsOriginalPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681803311"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803311"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803309"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803311"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m Pattern -&gt; (Pattern -&gt; LHS) -&gt; m LHS
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681803313"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803313"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">LHS
</span><a href="#local-6989586621681803310"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#lhsOriginalPattern"><span class="hs-identifier hs-var">lhsOriginalPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681803313"><span class="hs-identifier hs-type">p'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><span class="hs-comment">-- | Does the LHS contain projection patterns?</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#hasCopatterns"><span class="hs-identifier hs-type">hasCopatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSCore"><span class="hs-identifier hs-type">LHSCore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-137"></span><span id="hasCopatterns"><span class="annot"><span class="annottext">hasCopatterns :: LHSCore -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasCopatterns"><span class="hs-identifier hs-var hs-var">hasCopatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSHead"><span class="hs-identifier hs-type">LHSHead</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSProj"><span class="hs-identifier hs-type">LHSProj</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSWith"><span class="hs-identifier hs-type">LHSWith</span></a></span><span> </span><span id="local-6989586621681803317"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803317"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">List1 Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasCopatterns"><span class="hs-identifier hs-var">hasCopatterns</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621681803317"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHSEllipsis"><span class="hs-identifier hs-type">LHSEllipsis</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><span class="hs-comment">-- * Generic fold</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Generic pattern traversal.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- See 'Agda.Syntax.Abstract.Pattern.APatternLike'.</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">class</span><span> </span><span id="CPatternLike"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-var">CPatternLike</span></a></span></span><span> </span><span id="local-6989586621681803012"><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- | Fold pattern.</span><span>
</span><span id="line-152"></span><span>  </span><span id="foldrCPattern"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-type">foldrCPattern</span></a></span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803019"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681803019"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803019"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803019"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Combine a pattern and the value computed from its subpatterns.</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803019"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="foldrCPattern"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-type">foldrCPattern</span></a></span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803009"><span id="local-6989586621681803010"><span id="local-6989586621681803011"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681803009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621681803010"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803011"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681803010"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803011"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803009"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803009"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621681803320"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var hs-var">foldrCPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(q -&gt; m) -&gt; p -&gt; m
(q -&gt; m) -&gt; f q -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; f a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">((q -&gt; m) -&gt; p -&gt; m)
-&gt; ((Pattern -&gt; m -&gt; m) -&gt; q -&gt; m) -&gt; (Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; q -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; q -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- | Traverse pattern with option of post-traversal modification.</span><span>
</span><span id="line-164"></span><span>  </span><span id="traverseCPatternA"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-type">traverseCPatternA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803030"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621681803030"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Combine a pattern and the its recursively computed version.</span></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="traverseCPatternA"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-type">traverseCPatternA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803020"><span id="local-6989586621681803021"><span id="local-6989586621681803022"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621681803020"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803021"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681803020"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803021"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621681803022"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span></span></span></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621681803333"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var hs-var">traverseCPatternA</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(q -&gt; m q) -&gt; p -&gt; m p
(q -&gt; m q) -&gt; f q -&gt; m (f q)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((q -&gt; m q) -&gt; p -&gt; m p)
-&gt; ((Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; q -&gt; m q)
-&gt; (Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; p
-&gt; m p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; q -&gt; m q
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; q -&gt; m q
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- | Traverse pattern.</span><span>
</span><span id="line-175"></span><span>  </span><span id="traverseCPatternM"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-type">traverseCPatternM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803038"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681803038"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ @pre@: Modification before recursion.</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ @post@: Modification after recursion.</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="traverseCPatternM"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-type">traverseCPatternM</span></a></span></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681803031"><span id="local-6989586621681803032"><span id="local-6989586621681803033"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621681803031"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803032"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681803031"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803032"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681803033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803012"><span class="hs-identifier hs-type">p</span></a></span></span></span></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621681803346"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var hs-var">traverseCPatternM</span></a></span><span> </span><span id="local-6989586621681803359"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803359"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621681803360"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803360"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(q -&gt; m q) -&gt; f q -&gt; m (f q)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((q -&gt; m q) -&gt; f q -&gt; m (f q)) -&gt; (q -&gt; m q) -&gt; f q -&gt; m (f q)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; q -&gt; m q
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; q -&gt; m q
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803359"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803360"><span class="hs-identifier hs-var">post</span></a></span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621681803404"><span class="annot"><span class="annottext">foldrCPattern :: forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var hs-var hs-var">foldrCPattern</span></a></span></span><span> </span><span id="local-6989586621681803405"><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681803406"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803406"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803406"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">(m -&gt; m) -&gt; m -&gt; m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803406"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-comment">-- Recursive cases:</span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">AppP</span></a></span><span> </span><span id="local-6989586621681803408"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803408"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803409"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803409"><span class="hs-identifier hs-var">ps</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; (Pattern, NamedArg Pattern) -&gt; m
forall m.
Monoid m =&gt;
(Pattern -&gt; m -&gt; m) -&gt; (Pattern, NamedArg Pattern) -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803408"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803409"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803411"><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803411"><span class="hs-identifier hs-var">ps</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; List2 Pattern -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; List2 Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803411"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-type">OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set1 Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803413"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803413"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; List1 (NamedArg Pattern) -&gt; m
forall m.
Monoid m =&gt;
(Pattern -&gt; m -&gt; m) -&gt; List1 (NamedArg Pattern) -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803413"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-type">HiddenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803415"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803415"><span class="hs-identifier hs-var">ps</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Named NamedName Pattern -&gt; m
forall m.
Monoid m =&gt;
(Pattern -&gt; m -&gt; m) -&gt; Named NamedName Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803415"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-type">InstanceP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803417"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803417"><span class="hs-identifier hs-var">ps</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Named NamedName Pattern -&gt; m
forall m.
Monoid m =&gt;
(Pattern -&gt; m -&gt; m) -&gt; Named NamedName Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803417"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803418"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803418"><span class="hs-identifier hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803418"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-type">AsP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803420"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803420"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803420"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803421"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803421"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803421"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-type">RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803423"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803423"><span class="hs-identifier hs-var">ps</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; [FieldAssignment' Pattern] -&gt; m
forall m.
Monoid m =&gt;
(Pattern -&gt; m -&gt; m) -&gt; [FieldAssignment' Pattern] -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803423"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803424"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803424"><span class="hs-identifier hs-var">mp</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; Maybe Pattern -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; Maybe Pattern -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803424"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-comment">-- Nonrecursive cases:</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-type">WildP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AbsurdP"><span class="hs-identifier hs-type">AbsurdP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuoteP"><span class="hs-identifier hs-type">QuoteP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EqualP"><span class="hs-identifier hs-type">EqualP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621681803476"><span class="annot"><span class="annottext">traverseCPatternA :: forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var hs-var hs-var">traverseCPatternA</span></a></span></span><span> </span><span id="local-6989586621681803477"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681803478"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">(m Pattern -&gt; m Pattern) -&gt; m Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-comment">-- Recursive cases:</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">AppP</span></a></span><span>        </span><span id="local-6989586621681803479"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803479"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803480"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803480"><span class="hs-identifier hs-var">ps</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; NamedArg Pattern -&gt; Pattern)
-&gt; m Pattern -&gt; m (NamedArg Pattern) -&gt; m Pattern
forall a b c. (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-var">AppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803479"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; NamedArg Pattern -&gt; m (NamedArg Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; NamedArg Pattern -&gt; m (NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803480"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span>   </span><span id="local-6989586621681803481"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803481"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803482"><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803482"><span class="hs-identifier hs-var">ps</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; List2 Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-var">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803481"><span class="hs-identifier hs-var">r</span></a></span><span>     </span><span class="annot"><span class="annottext">(List2 Pattern -&gt; Pattern) -&gt; m (List2 Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; List2 Pattern -&gt; m (List2 Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; List2 Pattern -&gt; m (List2 Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803482"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-type">OpAppP</span></a></span><span>    </span><span id="local-6989586621681803484"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803484"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803485"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803485"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681803486"><span class="annot"><span class="annottext">Set1 Name
</span><a href="#local-6989586621681803486"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681803487"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803487"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Set1 Name -&gt; List1 (NamedArg Pattern) -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-var">OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803484"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803485"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set1 Name
</span><a href="#local-6989586621681803486"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 (NamedArg Pattern) -&gt; Pattern)
-&gt; m (List1 (NamedArg Pattern)) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; List1 (NamedArg Pattern) -&gt; m (List1 (NamedArg Pattern))
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; List1 (NamedArg Pattern) -&gt; m (List1 (NamedArg Pattern))
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803487"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-type">HiddenP</span></a></span><span>   </span><span id="local-6989586621681803488"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803488"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803489"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803489"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named NamedName Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-var">HiddenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803488"><span class="hs-identifier hs-var">r</span></a></span><span>     </span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Pattern)
-&gt; m (Named NamedName Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern -&gt; m (Named NamedName Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern -&gt; m (Named NamedName Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803489"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-type">InstanceP</span></a></span><span> </span><span id="local-6989586621681803490"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803490"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803491"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803491"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named NamedName Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-var">InstanceP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803490"><span class="hs-identifier hs-var">r</span></a></span><span>   </span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Pattern)
-&gt; m (Named NamedName Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern -&gt; m (Named NamedName Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern -&gt; m (Named NamedName Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803491"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span>    </span><span id="local-6989586621681803492"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803492"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803493"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803493"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-var">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803492"><span class="hs-identifier hs-var">r</span></a></span><span>      </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803493"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-type">AsP</span></a></span><span>       </span><span id="local-6989586621681803494"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803494"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803495"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681803495"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681803496"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803496"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-var">AsP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803494"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681803495"><span class="hs-identifier hs-var">x</span></a></span><span>       </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803496"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span>     </span><span id="local-6989586621681803497"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803497"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803498"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803498"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-var">WithP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803497"><span class="hs-identifier hs-var">r</span></a></span><span>       </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803498"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-type">RecP</span></a></span><span>  </span><span id="local-6989586621681803499"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681803499"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621681803500"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803500"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803501"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803501"><span class="hs-identifier hs-var">ps</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; [FieldAssignment' Pattern] -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-var">RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681803499"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803500"><span class="hs-identifier hs-var">r</span></a></span><span>    </span><span class="annot"><span class="annottext">([FieldAssignment' Pattern] -&gt; Pattern)
-&gt; m [FieldAssignment' Pattern] -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; [FieldAssignment' Pattern] -&gt; m [FieldAssignment' Pattern]
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; [FieldAssignment' Pattern] -&gt; m [FieldAssignment' Pattern]
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803501"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span> </span><span id="local-6989586621681803502"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803502"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803503"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803503"><span class="hs-identifier hs-var">mp</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-var">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803502"><span class="hs-identifier hs-var">r</span></a></span><span>   </span><span class="annot"><span class="annottext">(Maybe Pattern -&gt; Pattern) -&gt; m (Maybe Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Maybe Pattern -&gt; m (Maybe Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern)
-&gt; Maybe Pattern -&gt; m (Maybe Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803503"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">-- Nonrecursive cases:</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-type">WildP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AbsurdP"><span class="hs-identifier hs-type">AbsurdP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuoteP"><span class="hs-identifier hs-type">QuoteP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EqualP"><span class="hs-identifier hs-type">EqualP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803478"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621681803549"><span class="annot"><span class="annottext">traverseCPatternM :: forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var hs-var hs-var">traverseCPatternM</span></a></span></span><span> </span><span id="local-6989586621681803550"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621681803551"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803552"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621681803552"><span class="annot"><span class="annottext">recurse :: Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803552"><span class="hs-identifier hs-var hs-var">recurse</span></a></span></span><span> </span><span id="local-6989586621681803553"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-comment">-- Recursive cases:</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">AppP</span></a></span><span>        </span><span id="local-6989586621681803554"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803554"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803555"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803555"><span class="hs-identifier hs-var">ps</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; NamedArg Pattern -&gt; Pattern)
-&gt; (Pattern, NamedArg Pattern) -&gt; Pattern
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-var">AppP</span></a></span><span>  </span><span class="annot"><span class="annottext">((Pattern, NamedArg Pattern) -&gt; Pattern)
-&gt; m (Pattern, NamedArg Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; (Pattern, NamedArg Pattern)
-&gt; m (Pattern, NamedArg Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; (Pattern, NamedArg Pattern)
-&gt; m (Pattern, NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803554"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803555"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span>   </span><span id="local-6989586621681803557"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803557"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803558"><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803558"><span class="hs-identifier hs-var">ps</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; List2 Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-var">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803557"><span class="hs-identifier hs-var">r</span></a></span><span>     </span><span class="annot"><span class="annottext">(List2 Pattern -&gt; Pattern) -&gt; m (List2 Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; List2 Pattern -&gt; m (List2 Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; List2 Pattern -&gt; m (List2 Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681803558"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-type">OpAppP</span></a></span><span>    </span><span id="local-6989586621681803559"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803559"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803560"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803560"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681803561"><span class="annot"><span class="annottext">Set1 Name
</span><a href="#local-6989586621681803561"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681803562"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803562"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Set1 Name -&gt; List1 (NamedArg Pattern) -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-var">OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803559"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803560"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set1 Name
</span><a href="#local-6989586621681803561"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 (NamedArg Pattern) -&gt; Pattern)
-&gt; m (List1 (NamedArg Pattern)) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; List1 (NamedArg Pattern)
-&gt; m (List1 (NamedArg Pattern))
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; List1 (NamedArg Pattern)
-&gt; m (List1 (NamedArg Pattern))
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803562"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-type">HiddenP</span></a></span><span>   </span><span id="local-6989586621681803563"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803563"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803564"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803564"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named NamedName Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-var">HiddenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803563"><span class="hs-identifier hs-var">r</span></a></span><span>     </span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Pattern)
-&gt; m (Named NamedName Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern
-&gt; m (Named NamedName Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern
-&gt; m (Named NamedName Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803564"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-type">InstanceP</span></a></span><span> </span><span id="local-6989586621681803565"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803565"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803566"><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803566"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named NamedName Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-var">InstanceP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803565"><span class="hs-identifier hs-var">r</span></a></span><span>   </span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Pattern)
-&gt; m (Named NamedName Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern
-&gt; m (Named NamedName Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; Named NamedName Pattern
-&gt; m (Named NamedName Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><a href="#local-6989586621681803566"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span>    </span><span id="local-6989586621681803567"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803567"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803568"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803568"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-var">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803567"><span class="hs-identifier hs-var">r</span></a></span><span>      </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803568"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-type">AsP</span></a></span><span>       </span><span id="local-6989586621681803569"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803569"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803570"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681803570"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681803571"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803571"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-var">AsP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803569"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681803570"><span class="hs-identifier hs-var">x</span></a></span><span>       </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803571"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span>     </span><span id="local-6989586621681803572"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803572"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803573"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803573"><span class="hs-identifier hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-var">WithP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803572"><span class="hs-identifier hs-var">r</span></a></span><span>       </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803573"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-type">RecP</span></a></span><span>  </span><span id="local-6989586621681803574"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681803574"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621681803575"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803575"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803576"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803576"><span class="hs-identifier hs-var">ps</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; [FieldAssignment' Pattern] -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-var">RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681803574"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803575"><span class="hs-identifier hs-var">r</span></a></span><span>    </span><span class="annot"><span class="annottext">([FieldAssignment' Pattern] -&gt; Pattern)
-&gt; m [FieldAssignment' Pattern] -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; [FieldAssignment' Pattern]
-&gt; m [FieldAssignment' Pattern]
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern)
-&gt; [FieldAssignment' Pattern]
-&gt; m [FieldAssignment' Pattern]
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621681803576"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span> </span><span id="local-6989586621681803577"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803577"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803578"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803578"><span class="hs-identifier hs-var">mp</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-var">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803577"><span class="hs-identifier hs-var">r</span></a></span><span>   </span><span class="annot"><span class="annottext">(Maybe Pattern -&gt; Pattern) -&gt; m (Maybe Pattern) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Maybe Pattern -&gt; m (Maybe Pattern)
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; Maybe Pattern -&gt; m (Maybe Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803550"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803551"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681803578"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-comment">-- Nonrecursive cases:</span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-type">WildP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AbsurdP"><span class="hs-identifier hs-type">AbsurdP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuoteP"><span class="hs-identifier hs-type">QuoteP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EqualP"><span class="hs-identifier hs-type">EqualP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803553"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803050"><span id="local-6989586621681803051"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803050"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803051"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681803050"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681803051"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621681803590"><span class="annot"><span class="annottext">foldrCPattern :: forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; (a, b) -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var hs-var hs-var">foldrCPattern</span></a></span></span><span> </span><span id="local-6989586621681803591"><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803591"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803592"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803592"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803593"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803593"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; a -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; a -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803591"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803592"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; b -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; b -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m -&gt; m
</span><a href="#local-6989586621681803591"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803593"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621681803600"><span class="annot"><span class="annottext">traverseCPatternA :: forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; (a, b) -&gt; m (a, b)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var hs-var hs-var">traverseCPatternA</span></a></span></span><span> </span><span id="local-6989586621681803601"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803601"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803602"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803602"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803603"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803603"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, b)) -&gt; m a -&gt; m b -&gt; m (a, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; a -&gt; m a
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; a -&gt; m a
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803601"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803602"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; b -&gt; m b
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; b -&gt; m b
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803601"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803603"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621681803611"><span class="annot"><span class="annottext">traverseCPatternM :: forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; m Pattern) -&gt; (a, b) -&gt; m (a, b)
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var hs-var hs-var">traverseCPatternM</span></a></span></span><span> </span><span id="local-6989586621681803612"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803612"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621681803613"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803613"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803614"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803614"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803615"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803615"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, b)) -&gt; m a -&gt; m b -&gt; m (a, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; a -&gt; m a
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; a -&gt; m a
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803612"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803613"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681803614"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; b -&gt; m b
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; b -&gt; m b
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803612"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803613"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681803615"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803049"><span id="local-6989586621681803618"><span id="local-6989586621681803627"><span id="local-6989586621681803636"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803049"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803049"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-269"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803047"><span id="local-6989586621681803048"><span id="local-6989586621681803645"><span id="local-6989586621681803654"><span id="local-6989586621681803663"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803047"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803048"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803047"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803046"><span id="local-6989586621681803672"><span id="local-6989586621681803680"><span id="local-6989586621681803689"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803046"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681803046"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-271"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803045"><span id="local-6989586621681803698"><span id="local-6989586621681803707"><span id="local-6989586621681803716"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803045"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803045"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-272"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803044"><span id="local-6989586621681803725"><span id="local-6989586621681803734"><span id="local-6989586621681803743"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803044"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List2.html#List2"><span class="hs-identifier hs-type">List2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803044"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-273"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803043"><span id="local-6989586621681803752"><span id="local-6989586621681803761"><span id="local-6989586621681803770"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803043"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681803043"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681803042"><span id="local-6989586621681803779"><span id="local-6989586621681803788"><span id="local-6989586621681803797"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803042"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment%27"><span class="hs-identifier hs-type">FieldAssignment'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803042"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Compute a value from each subpattern and collect all values in a monoid.</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621681803114"><span id="local-6989586621681803115"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#foldCPattern"><span class="hs-identifier hs-type">foldCPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803114"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681803115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803114"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803115"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-279"></span><span id="foldCPattern"><span class="annot"><span class="annottext">foldCPattern :: forall p m. (CPatternLike p, Monoid m) =&gt; (Pattern -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldCPattern"><span class="hs-identifier hs-var hs-var">foldCPattern</span></a></span></span><span> </span><span id="local-6989586621681803810"><span class="annot"><span class="annottext">Pattern -&gt; m
</span><a href="#local-6989586621681803810"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
forall m. Monoid m =&gt; (Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
forall p m.
(CPatternLike p, Monoid m) =&gt;
(Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldrCPattern"><span class="hs-identifier hs-var">foldrCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">((Pattern -&gt; m -&gt; m) -&gt; p -&gt; m) -&gt; (Pattern -&gt; m -&gt; m) -&gt; p -&gt; m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681803811"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803811"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803812"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681803812"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m
</span><a href="#local-6989586621681803810"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803811"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681803812"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><span class="hs-comment">-- | Traverse pattern(s) with a modification before the recursive descent.</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621681803118"><span id="local-6989586621681803119"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#preTraverseCPatternM"><span class="hs-identifier hs-type">preTraverseCPatternM</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803118"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681803119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803119"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ @pre@: Modification before recursion.</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803118"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803119"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803118"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-287"></span><span id="preTraverseCPatternM"><span class="annot"><span class="annottext">preTraverseCPatternM :: forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#preTraverseCPatternM"><span class="hs-identifier hs-var hs-var">preTraverseCPatternM</span></a></span></span><span> </span><span id="local-6989586621681803819"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803819"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621681803820"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803820"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803819"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803820"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><span class="hs-comment">-- | Traverse pattern(s) with a modification after the recursive descent.</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span id="local-6989586621681803821"><span id="local-6989586621681803822"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#postTraverseCPatternM"><span class="hs-identifier hs-type">postTraverseCPatternM</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803821"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681803822"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ @post@: Modification after recursion.</span></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803821"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803821"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-295"></span><span id="postTraverseCPatternM"><span class="annot"><span class="annottext">postTraverseCPatternM :: forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#postTraverseCPatternM"><span class="hs-identifier hs-var hs-var">postTraverseCPatternM</span></a></span></span><span> </span><span id="local-6989586621681803829"><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803829"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span id="local-6989586621681803830"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803830"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Monad m =&gt;
(Pattern -&gt; m Pattern) -&gt; (Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternM"><span class="hs-identifier hs-var">traverseCPatternM</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
</span><a href="#local-6989586621681803829"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803830"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">-- | Map pattern(s) with a modification after the recursive descent.</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span id="local-6989586621681803124"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#mapCPattern"><span class="hs-identifier hs-type">mapCPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803124"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803124"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803124"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-300"></span><span id="mapCPattern"><span class="annot"><span class="annottext">mapCPattern :: forall p. CPatternLike p =&gt; (Pattern -&gt; Pattern) -&gt; p -&gt; p
</span><a href="Agda.Syntax.Concrete.Pattern.html#mapCPattern"><span class="hs-identifier hs-var hs-var">mapCPattern</span></a></span></span><span> </span><span id="local-6989586621681803836"><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621681803836"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity p -&gt; p
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity p -&gt; p) -&gt; (p -&gt; Identity p) -&gt; p -&gt; p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Identity Pattern) -&gt; p -&gt; Identity p
forall p (m :: * -&gt; *).
(CPatternLike p, Monad m) =&gt;
(Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#postTraverseCPatternM"><span class="hs-identifier hs-var">postTraverseCPatternM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Identity Pattern
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Identity Pattern)
-&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Identity Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621681803836"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">-- * Specific folds.</span></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Get all the identifiers in a pattern in left-to-right order.</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- Implemented using difference lists.</span><span>
</span><span id="line-308"></span><span id="local-6989586621681803129"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#patternQNames"><span class="hs-identifier hs-type">patternQNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803129"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803129"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-309"></span><span id="patternQNames"><span class="annot"><span class="annottext">patternQNames :: forall p. CPatternLike p =&gt; p -&gt; [QName]
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternQNames"><span class="hs-identifier hs-var hs-var">patternQNames</span></a></span></span><span> </span><span id="local-6989586621681803859"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803859"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Endo [QName]) -&gt; p -&gt; Endo [QName]
forall p m. (CPatternLike p, Monoid m) =&gt; (Pattern -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldCPattern"><span class="hs-identifier hs-var">foldCPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Endo [QName]
</span><a href="#local-6989586621681803860"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803859"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Endo [QName] -&gt; [QName] -&gt; [QName]
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`appEndo`</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><a href="#local-6989586621681803860"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621681803860"><span class="annot"><span class="annottext">f :: Pattern -&gt; Endo [QName]
</span><a href="#local-6989586621681803860"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803862"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803862"><span class="hs-identifier hs-var">x</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; [QName]) -&gt; Endo [QName]
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803862"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; [QName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-type">OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803864"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803864"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set1 Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; [QName]) -&gt; Endo [QName]
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803864"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; [QName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-type">AsP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803865"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681803865"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>  </span><span class="hs-comment">-- _x must be a bound name, can't be a constructor!</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">AppP</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-type">HiddenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-type">WildP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AbsurdP"><span class="hs-identifier hs-type">AbsurdP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuoteP"><span class="hs-identifier hs-type">QuoteP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-type">InstanceP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Named NamedName Pattern
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-type">RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EqualP"><span class="hs-identifier hs-type">EqualP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endo [QName]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><span class="hs-comment">-- | Get all the identifiers in a pattern in left-to-right order.</span></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#patternNames"><span class="hs-identifier hs-type">patternNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span id="patternNames"><span class="annot"><span class="annottext">patternNames :: Pattern -&gt; [Name]
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternNames"><span class="hs-identifier hs-var hs-var">patternNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; [QName] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">unqualify</span></a></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; [Name]) -&gt; (Pattern -&gt; [QName]) -&gt; Pattern -&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [QName]
forall p. CPatternLike p =&gt; p -&gt; [QName]
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternQNames"><span class="hs-identifier hs-var">patternQNames</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Does the pattern contain a with-pattern?</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- (Shortcutting.)</span><span>
</span><span id="line-337"></span><span id="local-6989586621681803135"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#hasWithPatterns"><span class="hs-identifier hs-type">hasWithPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803135"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803135"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-338"></span><span id="hasWithPatterns"><span class="annot"><span class="annottext">hasWithPatterns :: forall p. CPatternLike p =&gt; p -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasWithPatterns"><span class="hs-identifier hs-var hs-var">hasWithPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; Bool) -&gt; (p -&gt; Any) -&gt; p -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Any) -&gt; p -&gt; Any
forall p m. (CPatternLike p, Monoid m) =&gt; (Pattern -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldCPattern"><span class="hs-identifier hs-var">foldCPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Any) -&gt; (Pattern -&gt; Bool) -&gt; Pattern -&gt; Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithPattern"><span class="hs-identifier hs-var">isWithPattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><span class="hs-comment">-- | Is 'WithP'?</span></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#isWithPattern"><span class="hs-identifier hs-type">isWithPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-342"></span><span id="isWithPattern"><span class="annot"><span class="annottext">isWithPattern :: Pattern -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithPattern"><span class="hs-identifier hs-var hs-var">isWithPattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-type">WithP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="annot"><span class="hs-comment">-- | Count the number of with-subpatterns in a pattern?</span></span><span>
</span><span id="line-347"></span><span id="local-6989586621681803138"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#numberOfWithPatterns"><span class="hs-identifier hs-type">numberOfWithPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803138"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681803138"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-348"></span><span id="numberOfWithPatterns"><span class="annot"><span class="annottext">numberOfWithPatterns :: forall p. CPatternLike p =&gt; p -&gt; Int
</span><a href="Agda.Syntax.Concrete.Pattern.html#numberOfWithPatterns"><span class="hs-identifier hs-var hs-var">numberOfWithPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sum Int -&gt; Int
forall a. Sum a -&gt; a
</span><span class="hs-identifier hs-var">getSum</span></span><span> </span><span class="annot"><span class="annottext">(Sum Int -&gt; Int) -&gt; (p -&gt; Sum Int) -&gt; p -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Sum Int) -&gt; p -&gt; Sum Int
forall p m. (CPatternLike p, Monoid m) =&gt; (Pattern -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Concrete.Pattern.html#foldCPattern"><span class="hs-identifier hs-var">foldCPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Sum Int
forall a. a -&gt; Sum a
</span><span class="hs-identifier hs-var">Sum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Sum Int) -&gt; (Pattern -&gt; Int) -&gt; Pattern -&gt; Sum Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Int
forall {a}. Num a =&gt; Pattern -&gt; a
</span><a href="#local-6989586621681803886"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681803886"><span class="annot"><span class="annottext">f :: Pattern -&gt; a
</span><a href="#local-6989586621681803886"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681803890"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803890"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithPattern"><span class="hs-identifier hs-var">isWithPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803890"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Compute the context in which the ellipsis occurs, if at all.</span><span>
</span><span id="line-352"></span><span class="hs-comment">--   If there are several occurrences, this is an error.</span><span>
</span><span id="line-353"></span><span class="hs-comment">--   This only counts ellipsis that haven't already been expanded.</span><span>
</span><span id="line-354"></span><span id="local-6989586621681802962"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis%27"><span class="hs-identifier hs-type">hasEllipsis'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#CPatternLike"><span class="hs-identifier hs-type">CPatternLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802962"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681802962"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.AffineHole.html#AffineHole"><span class="hs-identifier hs-type">AffineHole</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681802962"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-355"></span><span id="hasEllipsis%27"><span class="annot"><span class="annottext">hasEllipsis' :: forall p. CPatternLike p =&gt; p -&gt; AffineHole Pattern p
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis%27"><span class="hs-identifier hs-var hs-var">hasEllipsis'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern
 -&gt; AffineHole Pattern Pattern -&gt; AffineHole Pattern Pattern)
-&gt; p -&gt; AffineHole Pattern p
forall p (m :: * -&gt; *).
(CPatternLike p, Applicative m) =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
forall (m :: * -&gt; *).
Applicative m =&gt;
(Pattern -&gt; m Pattern -&gt; m Pattern) -&gt; p -&gt; m p
</span><a href="Agda.Syntax.Concrete.Pattern.html#traverseCPatternA"><span class="hs-identifier hs-var">traverseCPatternA</span></a></span><span> </span><span class="annot"><span class="annottext">((Pattern
  -&gt; AffineHole Pattern Pattern -&gt; AffineHole Pattern Pattern)
 -&gt; p -&gt; AffineHole Pattern p)
-&gt; (Pattern
    -&gt; AffineHole Pattern Pattern -&gt; AffineHole Pattern Pattern)
-&gt; p
-&gt; AffineHole Pattern p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681803895"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803895"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803896"><span class="annot"><span class="annottext">AffineHole Pattern Pattern
</span><a href="#local-6989586621681803896"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803895"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-type">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; AffineHole Pattern Pattern
forall r a. (r -&gt; a) -&gt; r -&gt; AffineHole r a
</span><a href="Agda.Utils.AffineHole.html#OneHole"><span class="hs-identifier hs-var">OneHole</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803895"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AffineHole Pattern Pattern
</span><a href="#local-6989586621681803896"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><span class="hs-comment">-- | Reconstruct the ellipsis, used in printing (AbstractToConcrete).</span></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#reintroduceEllipsis"><span class="hs-identifier hs-type">reintroduceEllipsis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ExpandedEllipsis"><span class="hs-identifier hs-type">ExpandedEllipsis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-362"></span><span id="reintroduceEllipsis"><span class="annot"><span class="annottext">reintroduceEllipsis :: ExpandedEllipsis -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#reintroduceEllipsis"><span class="hs-identifier hs-var hs-var">reintroduceEllipsis</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#ExpandedEllipsis"><span class="hs-identifier hs-type">ExpandedEllipsis</span></a></span><span> </span><span id="local-6989586621681803900"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803900"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681803901"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803901"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681803902"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803902"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
forall p. CPatternLike p =&gt; p -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasWithPatterns"><span class="hs-identifier hs-var">hasWithPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803902"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803903"><span class="annot"><span class="annottext">[Item (List1 (NamedArg Pattern))]
</span><a href="#local-6989586621681803903"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681803904"><span class="annot"><span class="annottext">[Item (List1 (NamedArg Pattern))]
</span><a href="#local-6989586621681803904"><span class="hs-identifier hs-var">wargs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [Item (List1 (NamedArg Pattern))]
-&gt; ([Item (List1 (NamedArg Pattern))],
    [Item (List1 (NamedArg Pattern))])
forall p. IsWithP p =&gt; Int -&gt; [p] -&gt; ([p], [p])
</span><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-var">splitEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803901"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">([Item (List1 (NamedArg Pattern))]
 -&gt; ([Item (List1 (NamedArg Pattern))],
     [Item (List1 (NamedArg Pattern))]))
-&gt; [Item (List1 (NamedArg Pattern))]
-&gt; ([Item (List1 (NamedArg Pattern))],
    [Item (List1 (NamedArg Pattern))])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern) -&gt; [Item (List1 (NamedArg Pattern))]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">(List1 (NamedArg Pattern) -&gt; [Item (List1 (NamedArg Pattern))])
-&gt; List1 (NamedArg Pattern) -&gt; [Item (List1 (NamedArg Pattern))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; List1 (NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternAppView"><span class="hs-identifier hs-var">patternAppView</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803902"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681803907"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803907"><span class="hs-identifier hs-var">hd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681803908"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803908"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern, [NamedArg Pattern])
-&gt; Maybe (NamedArg Pattern, [NamedArg Pattern])
-&gt; (NamedArg Pattern, [NamedArg Pattern])
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern, [NamedArg Pattern])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NamedArg Pattern, [NamedArg Pattern])
 -&gt; (NamedArg Pattern, [NamedArg Pattern]))
-&gt; Maybe (NamedArg Pattern, [NamedArg Pattern])
-&gt; (NamedArg Pattern, [NamedArg Pattern])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Maybe (NamedArg Pattern, [NamedArg Pattern])
forall a. [a] -&gt; Maybe (a, [a])
</span><span class="hs-identifier hs-var">uncons</span></span><span> </span><span class="annot"><span class="annottext">[Item (List1 (NamedArg Pattern))]
[NamedArg Pattern]
</span><a href="#local-6989586621681803903"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621681803912"><span class="annot"><span class="annottext">core :: Pattern
</span><a href="#local-6989586621681803912"><span class="hs-identifier hs-var hs-var">core</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; NamedArg Pattern -&gt; Pattern)
-&gt; Pattern -&gt; [NamedArg Pattern] -&gt; Pattern
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-var">AppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Pattern
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803907"><span class="hs-identifier hs-var">hd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621681803908"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; NamedArg Pattern -&gt; Pattern)
-&gt; Pattern -&gt; [NamedArg Pattern] -&gt; Pattern
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-var">AppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#EllipsisP"><span class="hs-identifier hs-var">EllipsisP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681803900"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Pattern -&gt; Pattern) -&gt; Maybe Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Maybe Pattern
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Maybe Pattern) -&gt; Pattern -&gt; Maybe Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803912"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Item (List1 (NamedArg Pattern))]
[NamedArg Pattern]
</span><a href="#local-6989586621681803904"><span class="hs-identifier hs-var">wargs</span></a></span><span>
</span><span id="line-367"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#reintroduceEllipsis"><span class="hs-identifier hs-var">reintroduceEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">ExpandedEllipsis
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803914"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803914"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803914"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621681803152"><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-type">splitEllipsis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#IsWithP"><span class="hs-identifier hs-type">IsWithP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681803152"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681803152"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681803152"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681803152"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-370"></span><span id="splitEllipsis"><span class="annot"><span class="annottext">splitEllipsis :: forall p. IsWithP p =&gt; Int -&gt; [p] -&gt; ([p], [p])
</span><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-var hs-var">splitEllipsis</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-var">splitEllipsis</span></a></span><span> </span><span id="local-6989586621681803927"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803927"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681803928"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803928"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681803929"><span class="annot"><span class="annottext">[p]
</span><a href="#local-6989586621681803929"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe p -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Maybe p
forall p. IsWithP p =&gt; p -&gt; Maybe p
</span><a href="Agda.Syntax.Concrete.Pattern.html#isWithP"><span class="hs-identifier hs-var">isWithP</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803928"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803927"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803928"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">p -&gt; [p] -&gt; [p]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[p]
</span><a href="#local-6989586621681803929"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([p] -&gt; [p]) -&gt; ([p], [p]) -&gt; ([p], [p])
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803928"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">p -&gt; [p] -&gt; [p]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([p], [p]) -&gt; ([p], [p])) -&gt; ([p], [p]) -&gt; ([p], [p])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [p] -&gt; ([p], [p])
forall p. IsWithP p =&gt; Int -&gt; [p] -&gt; ([p], [p])
</span><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-var">splitEllipsis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803927"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[p]
</span><a href="#local-6989586621681803929"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([p] -&gt; [p]) -&gt; ([p], [p]) -&gt; ([p], [p])
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681803928"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">p -&gt; [p] -&gt; [p]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([p], [p]) -&gt; ([p], [p])) -&gt; ([p], [p]) -&gt; ([p], [p])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [p] -&gt; ([p], [p])
forall p. IsWithP p =&gt; Int -&gt; [p] -&gt; ([p], [p])
</span><a href="Agda.Syntax.Concrete.Pattern.html#splitEllipsis"><span class="hs-identifier hs-var">splitEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681803927"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[p]
</span><a href="#local-6989586621681803929"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- * Helpers for pattern and lhs parsing</span></span><span>
</span><span id="line-379"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | View a pattern @p@ as a list @p0 .. pn@ where @p0@ is the identifier</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   (in most cases a constructor).</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">--  Pattern needs to be parsed already (operators resolved).</span><span>
</span><span id="line-385"></span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html#patternAppView"><span class="hs-identifier hs-type">patternAppView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span id="patternAppView"><span class="annot"><span class="annottext">patternAppView :: Pattern -&gt; List1 (NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternAppView"><span class="hs-identifier hs-var hs-var">patternAppView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">AppP</span></a></span><span> </span><span id="local-6989586621681803931"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803931"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681803932"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803932"><span class="hs-identifier hs-var">arg</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; List1 (NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternAppView"><span class="hs-identifier hs-var">patternAppView</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803931"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
-&gt; [NamedArg Pattern] -&gt; List1 (NamedArg Pattern)
forall a. NonEmpty a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">`List1.appendList`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621681803932"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-type">OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803934"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803934"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set1 Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803935"><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803935"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-var">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681803934"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
-&gt; List1 (NamedArg Pattern) -&gt; List1 (NamedArg Pattern)
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
</span><a href="#local-6989586621681803935"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681803937"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803937"><span class="hs-identifier hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; List1 (NamedArg Pattern)
</span><a href="Agda.Syntax.Concrete.Pattern.html#patternAppView"><span class="hs-identifier hs-var">patternAppView</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803937"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Pattern)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621681803938"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803938"><span class="hs-identifier hs-var">p</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; List1 (NamedArg Pattern)
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; List1 (NamedArg Pattern))
-&gt; NamedArg Pattern -&gt; List1 (NamedArg Pattern)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; NamedArg Pattern
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681803938"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-392"></span></pre></body></html>