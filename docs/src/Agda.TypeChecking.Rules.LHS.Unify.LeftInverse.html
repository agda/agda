<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">{-| Functions for building the left inverse part of a 'UnifyEquiv'.
 -}</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html"><span class="hs-identifier">Agda.TypeChecking.Rules.LHS.Unify.LeftInverse</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(!!)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Benchmark.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bench</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.html#Nat"><span class="hs-identifier">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html"><span class="hs-identifier">Agda.TypeChecking.Names</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html"><span class="hs-identifier">Agda.TypeChecking.Records</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Problem.html"><span class="hs-identifier">Agda.TypeChecking.Rules.LHS.Problem</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html"><span class="hs-identifier">Agda.TypeChecking.Rules.LHS.Unify.Types</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Permutation.html"><span class="hs-identifier">Agda.Utils.Permutation</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html"><span class="hs-identifier">Agda.Utils.Size</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="DigestedUnifyStep"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyStep"><span class="hs-identifier hs-var">DigestedUnifyStep</span></a></span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DSolution"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DSolution"><span class="hs-identifier hs-var">DSolution</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Problem.html#FlexibleVar"><span class="hs-identifier hs-type">FlexibleVar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DEtaExpandVar"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DEtaExpandVar"><span class="hs-identifier hs-var">DEtaExpandVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Problem.html#FlexibleVar"><span class="hs-identifier hs-type">FlexibleVar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Args"><span class="hs-identifier hs-type">Args</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyStep"><span class="hs-identifier hs-type">DigestedUnifyStep</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621682064997"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; DigestedUnifyStep -&gt; m Doc
</span><a href="#local-6989586621682064997"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DSolution"><span class="hs-identifier hs-type">DSolution</span></a></span><span> </span><span id="local-6989586621682064999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682064999"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682065000"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682065000"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682065001"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065001"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682065002"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065002"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682065003"><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065003"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Dom Type -&gt; FlexibleVar Int -&gt; Term -&gt; Either () () -&gt; UnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Solution"><span class="hs-identifier hs-var">Solution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682064999"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682065000"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065001"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065002"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065003"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DEtaExpandVar"><span class="hs-identifier hs-type">DEtaExpandVar</span></a></span><span> </span><span id="local-6989586621682065005"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065005"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682065006"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682065006"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682065007"><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065007"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleVar Int -&gt; QName -&gt; [Arg Term] -&gt; UnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#EtaExpandVar"><span class="hs-identifier hs-var">EtaExpandVar</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065005"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682065006"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065007"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="DigestedUnifyLogEntry"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyLogEntry"><span class="hs-identifier hs-var">DigestedUnifyLogEntry</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DUnificationStep"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DUnificationStep"><span class="hs-identifier hs-var">DUnificationStep</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyState"><span class="hs-identifier hs-type">UnifyState</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyStep"><span class="hs-identifier hs-type">DigestedUnifyStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyOutput"><span class="hs-identifier hs-type">UnifyOutput</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="DigestedUnifyLog"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyLog"><span class="hs-identifier hs-var">DigestedUnifyLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyLogEntry"><span class="hs-identifier hs-type">DigestedUnifyLogEntry</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyState"><span class="hs-identifier hs-type">UnifyState</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><span class="hs-comment">-- | Pre-process a UnifyLog so that we catch unsupported steps early.</span></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#digestUnifyLog"><span class="hs-identifier hs-type">digestUnifyLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyLog"><span class="hs-identifier hs-type">UnifyLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyLog"><span class="hs-identifier hs-type">DigestedUnifyLog</span></a></span><span>
</span><span id="line-60"></span><span id="digestUnifyLog"><span class="annot"><span class="annottext">digestUnifyLog :: UnifyLog -&gt; Either NoLeftInv DigestedUnifyLog
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#digestUnifyLog"><span class="hs-identifier hs-var hs-var">digestUnifyLog</span></a></span></span><span> </span><span id="local-6989586621682065011"><span class="annot"><span class="annottext">UnifyLog
</span><a href="#local-6989586621682065011"><span class="hs-identifier hs-var">log</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyLog
-&gt; ((UnifyLogEntry, UnifyState)
    -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState))
-&gt; Either NoLeftInv DigestedUnifyLog
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">UnifyLog
</span><a href="#local-6989586621682065011"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnificationStep"><span class="hs-identifier hs-type">UnificationStep</span></a></span><span> </span><span id="local-6989586621682065014"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065014"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682065015"><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065015"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621682065016"><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065016"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682065017"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065017"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065018"><span class="annot"><span class="annottext">illegal :: Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065018"><span class="hs-identifier hs-var hs-var">illegal</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(NoLeftInv -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState))
-&gt; NoLeftInv
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Illegal"><span class="hs-identifier hs-var">Illegal</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065015"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span id="local-6989586621682065020"><span class="annot"><span class="annottext">unsupported :: Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065020"><span class="hs-identifier hs-var hs-var">unsupported</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(NoLeftInv -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState))
-&gt; NoLeftInv
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedYet"><span class="hs-identifier hs-var">UnsupportedYet</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065015"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span id="local-6989586621682065022"><span class="annot"><span class="annottext">ret :: DigestedUnifyStep
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065022"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span> </span><span id="local-6989586621682065023"><span class="annot"><span class="annottext">DigestedUnifyStep
</span><a href="#local-6989586621682065023"><span class="hs-identifier hs-var">step</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DigestedUnifyLogEntry, UnifyState)
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a. a -&gt; Either NoLeftInv a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState
-&gt; DigestedUnifyStep -&gt; UnifyOutput -&gt; DigestedUnifyLogEntry
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DUnificationStep"><span class="hs-identifier hs-var">DUnificationStep</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065014"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">DigestedUnifyStep
</span><a href="#local-6989586621682065023"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065016"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065017"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065015"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span id="local-6989586621682065024"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065024"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682065025"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682065025"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682065026"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065026"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682065027"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065027"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682065028"><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065028"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DigestedUnifyStep
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065022"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(DigestedUnifyStep
 -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState))
-&gt; DigestedUnifyStep
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Dom Type
-&gt; FlexibleVar Int
-&gt; Term
-&gt; Either () ()
-&gt; DigestedUnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DSolution"><span class="hs-identifier hs-var">DSolution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065024"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682065025"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065026"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065027"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065028"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#EtaExpandVar"><span class="hs-identifier hs-type">EtaExpandVar</span></a></span><span> </span><span id="local-6989586621682065029"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065029"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682065030"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682065030"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682065031"><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065031"><span class="hs-identifier hs-var">c</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DigestedUnifyStep
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065022"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(DigestedUnifyStep
 -&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState))
-&gt; DigestedUnifyStep
-&gt; Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int -&gt; QName -&gt; [Arg Term] -&gt; DigestedUnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DEtaExpandVar"><span class="hs-identifier hs-var">DEtaExpandVar</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065029"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682065030"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065031"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Deletion"><span class="hs-identifier hs-type">Deletion</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065018"><span class="hs-identifier hs-var">illegal</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#TypeConInjectivity"><span class="hs-identifier hs-type">TypeConInjectivity</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065018"><span class="hs-identifier hs-var">illegal</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- These should end up in a NoUnify</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Conflict"><span class="hs-identifier hs-type">Conflict</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#LitConflict"><span class="hs-identifier hs-type">LitConflict</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Cycle"><span class="hs-identifier hs-type">Cycle</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="annottext">UnifyStep
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (DigestedUnifyLogEntry, UnifyState)
</span><a href="#local-6989586621682065020"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621682065088"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; NoLeftInv -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedYet"><span class="hs-identifier hs-type">UnsupportedYet</span></a></span><span> </span><span id="local-6989586621682065089"><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065089"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;It relies on&quot;</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnifyStep -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065089"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;which is not yet supported&quot;</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedCxt"><span class="hs-identifier hs-var">UnsupportedCxt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fwords"><span class="hs-identifier hs-var">fwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;it relies on higher-dimensional unification, which is not yet supported&quot;</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Illegal"><span class="hs-identifier hs-type">Illegal</span></a></span><span> </span><span id="local-6989586621682065095"><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065095"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;It relies on&quot;</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnifyStep -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep
</span><a href="#local-6989586621682065095"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;which is incompatible with&quot;</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cubical Agda&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoCubical"><span class="hs-identifier hs-var">NoCubical</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fwords"><span class="hs-identifier hs-var">fwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cubical Agda is disabled&quot;</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#WithKEnabled"><span class="hs-identifier hs-var">WithKEnabled</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fwords"><span class="hs-identifier hs-var">fwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The K rule is enabled&quot;</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#SplitOnStrict"><span class="hs-identifier hs-var">SplitOnStrict</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fwords"><span class="hs-identifier hs-var">fwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;It splits on a type in SSet&quot;</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#SplitOnFlat"><span class="hs-identifier hs-var">SplitOnFlat</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fwords"><span class="hs-identifier hs-var">fwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;It splits on a @&#9837; argument&quot;</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport"><span class="hs-identifier hs-type">CantTransport</span></a></span><span> </span><span id="local-6989586621682065102"><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065102"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The type&quot;</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Closure (Abs Type) -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Closure (Abs Type) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065102"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;can not be transported&quot;</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport%27"><span class="hs-identifier hs-type">CantTransport'</span></a></span><span> </span><span id="local-6989586621682065104"><span class="annot"><span class="annottext">Closure Type
</span><a href="#local-6989586621682065104"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The type&quot;</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Closure Type -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Closure Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Closure Type
</span><a href="#local-6989586621682065104"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; [m Doc] -&gt; [m Doc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [m Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;can not be transported&quot;</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">data</span><span> </span><span id="NoLeftInv"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-var">NoLeftInv</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="UnsupportedYet"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedYet"><span class="hs-identifier hs-var">UnsupportedYet</span></a></span></span><span> </span><span class="hs-special">{</span><span id="badStep"><span class="annot"><span class="annottext">NoLeftInv -&gt; UnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#badStep"><span class="hs-identifier hs-var hs-var">badStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyStep"><span class="hs-identifier hs-type">UnifyStep</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Illegal"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Illegal"><span class="hs-identifier hs-var">Illegal</span></a></span></span><span>        </span><span class="hs-special">{</span><span id="badStep"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#badStep"><span class="hs-identifier hs-var">badStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyStep"><span class="hs-identifier hs-type">UnifyStep</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoCubical"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoCubical"><span class="hs-identifier hs-var">NoCubical</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WithKEnabled"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#WithKEnabled"><span class="hs-identifier hs-var">WithKEnabled</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SplitOnStrict"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#SplitOnStrict"><span class="hs-identifier hs-var">SplitOnStrict</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ splitting on a Strict Set.</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SplitOnFlat"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#SplitOnFlat"><span class="hs-identifier hs-var">SplitOnFlat</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ splitting on a @&#9837; argument</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnsupportedCxt"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedCxt"><span class="hs-identifier hs-var">UnsupportedCxt</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CantTransport"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport"><span class="hs-identifier hs-var">CantTransport</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CantTransport%27"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport%27"><span class="hs-identifier hs-var">CantTransport'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682065107"><span id="local-6989586621682065122"><span id="local-6989586621682065126"><span class="annot"><span class="annottext">Int -&gt; NoLeftInv -&gt; ShowS
[NoLeftInv] -&gt; ShowS
NoLeftInv -&gt; String
(Int -&gt; NoLeftInv -&gt; ShowS)
-&gt; (NoLeftInv -&gt; String)
-&gt; ([NoLeftInv] -&gt; ShowS)
-&gt; Show NoLeftInv
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; NoLeftInv -&gt; ShowS
showsPrec :: Int -&gt; NoLeftInv -&gt; ShowS
$cshow :: NoLeftInv -&gt; String
show :: NoLeftInv -&gt; String
$cshowList :: [NoLeftInv] -&gt; ShowS
showList :: [NoLeftInv] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | Build the left inverse part of a 'UnifyEquiv' (@&#964;@, @leftInv@).</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildLeftInverse"><span class="hs-identifier hs-type">buildLeftInverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyState"><span class="hs-identifier hs-type">UnifyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyLog"><span class="hs-identifier hs-type">UnifyLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span id="buildLeftInverse"><span class="annot"><span class="annottext">buildLeftInverse :: UnifyState
-&gt; UnifyLog -&gt; TCM (Either NoLeftInv (Substitution, Substitution))
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildLeftInverse"><span class="hs-identifier hs-var hs-var">buildLeftInverse</span></a></span></span><span> </span><span id="local-6989586621682065136"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span id="local-6989586621682065137"><span class="annot"><span class="annottext">UnifyLog
</span><a href="#local-6989586621682065137"><span class="hs-identifier hs-var">log</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Account (BenchPhase (TCMT IO))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall (m :: * -&gt; *) c.
MonadBench m =&gt;
Account (BenchPhase m) -&gt; m c -&gt; m c
</span><a href="Agda.Utils.Benchmark.html#billTo"><span class="hs-identifier hs-var">Bench.billTo</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BenchPhase (TCMT IO)
Phase
</span><a href="Agda.Benchmarking.html#UnifyIndices"><span class="hs-identifier hs-var">Bench.UnifyIndices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BenchPhase (TCMT IO)
Phase
</span><a href="Agda.Benchmarking.html#CubicalLeftInversion"><span class="hs-identifier hs-var">Bench.CubicalLeftInversion</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(TCM (Either NoLeftInv (Substitution, Substitution))
 -&gt; TCM (Either NoLeftInv (Substitution, Substitution)))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnifyLog -&gt; Either NoLeftInv DigestedUnifyLog
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#digestUnifyLog"><span class="hs-identifier hs-var">digestUnifyLog</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyLog
</span><a href="#local-6989586621682065137"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682065141"><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065141"><span class="hs-identifier hs-var">no</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv.badstep&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;No Left Inverse:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NoLeftInv -&gt; UnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#badStep"><span class="hs-identifier hs-var">badStep</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065141"><span class="hs-identifier hs-var">no</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">Either NoLeftInv (Substitution, Substitution)
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (Substitution, Substitution)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065141"><span class="hs-identifier hs-var">no</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682065144"><span class="annot"><span class="annottext">DigestedUnifyLog
</span><a href="#local-6989586621682065144"><span class="hs-identifier hs-var">log</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv.badstep&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>      </span><span id="local-6989586621682065145"><span class="annot"><a href="#local-6989586621682065145"><span class="hs-identifier hs-var">cubical</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe Cubical)
forall (m :: * -&gt; *). HasOptions m =&gt; m (Maybe Cubical)
</span><a href="Agda.TypeChecking.Monad.Base.html#cubicalOption"><span class="hs-identifier hs-var">cubicalOption</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="hs-string">&quot;cubical:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682065145"><span class="hs-identifier hs-type">cubical</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv.badstep&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>      </span><span id="local-6989586621682065148"><span class="annot"><a href="#local-6989586621682065148"><span class="hs-identifier hs-var">pathp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; TCMT IO (Maybe Term)
forall (m :: * -&gt; *) a.
(HasBuiltins m, IsBuiltin a) =&gt;
a -&gt; m (Maybe Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getTerm%27"><span class="hs-identifier hs-var">getTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinPathP"><span class="hs-identifier hs-var">builtinPathP</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span class="annot"><span class="hs-string">&quot;pathp:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="annot"><a href="#local-6989586621682065148"><span class="hs-identifier hs-type">pathp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-113"></span><span>      </span><span id="local-6989586621682065163"><span class="annot"><span class="annottext">cond :: TCMT IO Bool
</span><a href="#local-6989586621682065163"><span class="hs-identifier hs-var hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TCMT IO Bool] -&gt; TCMT IO Bool
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, Monad m) =&gt;
f (m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#andM"><span class="hs-identifier hs-var">andM</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-comment">-- TODO: handle open contexts: they happen during &quot;higher dimensional&quot; unification,</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-comment">--       in injectivity cases.</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Bool) -&gt; TCMT IO Context -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Context
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Context
</span><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><a href="#local-6989586621682065168"><span class="hs-identifier hs-type">compose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span id="local-6989586621682065168"><span class="annot"><span class="annottext">compose :: [(Retract, Term)] -&gt; ExceptT NoLeftInv (TCMT IO) Retract
</span><a href="#local-6989586621682065168"><span class="hs-identifier hs-var hs-var">compose</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) Retract
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><a href="#local-6989586621682065168"><span class="hs-identifier hs-var">compose</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621682065169"><span class="annot"><span class="annottext">Retract
</span><a href="#local-6989586621682065169"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Retract -&gt; ExceptT NoLeftInv (TCMT IO) Retract
forall a. a -&gt; ExceptT NoLeftInv (TCMT IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Retract
</span><a href="#local-6989586621682065169"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><a href="#local-6989586621682065168"><span class="hs-identifier hs-var">compose</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682065170"><span class="annot"><span class="annottext">Retract
</span><a href="#local-6989586621682065170"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682065171"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065171"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065172"><span class="annot"><span class="annottext">[(Retract, Term)]
</span><a href="#local-6989586621682065172"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621682065173"><span class="annot"><a href="#local-6989586621682065173"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Retract, Term)] -&gt; ExceptT NoLeftInv (TCMT IO) Retract
</span><a href="#local-6989586621682065168"><span class="hs-identifier hs-var">compose</span></a></span><span> </span><span class="annot"><span class="annottext">[(Retract, Term)]
</span><a href="#local-6989586621682065172"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#composeRetract"><span class="hs-identifier hs-type">composeRetract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065170"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065171"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065173"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682065177"><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065177"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv Retract
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Closure (Abs Type) -&gt; NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport"><span class="hs-identifier hs-var">CantTransport</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065177"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682065178"><span class="annot"><span class="annottext">Retract
</span><a href="#local-6989586621682065178"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Retract -&gt; Either NoLeftInv Retract
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Retract
</span><a href="#local-6989586621682065178"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">TCMT IO Bool
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifNotM"><span class="hs-identifier hs-var">ifNotM</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Bool
</span><a href="#local-6989586621682065163"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either NoLeftInv (Substitution, Substitution)
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either NoLeftInv (Substitution, Substitution)
 -&gt; TCM (Either NoLeftInv (Substitution, Substitution)))
-&gt; Either NoLeftInv (Substitution, Substitution)
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (Substitution, Substitution)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#UnsupportedCxt"><span class="hs-identifier hs-var">UnsupportedCxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM (Either NoLeftInv (Substitution, Substitution))
 -&gt; TCM (Either NoLeftInv (Substitution, Substitution)))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621682065180"><span class="annot"><a href="#local-6989586621682065180"><span class="hs-identifier hs-var">equivs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DigestedUnifyLog
-&gt; ((DigestedUnifyLogEntry, UnifyState)
    -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
-&gt; TCMT IO [Either NoLeftInv (Retract, Term)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">DigestedUnifyLog
</span><a href="#local-6989586621682065144"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(((DigestedUnifyLogEntry, UnifyState)
  -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
 -&gt; TCMT IO [Either NoLeftInv (Retract, Term)])
-&gt; ((DigestedUnifyLogEntry, UnifyState)
    -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
-&gt; TCMT IO [Either NoLeftInv (Retract, Term)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DigestedUnifyLogEntry
 -&gt; UnifyState -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
-&gt; (DigestedUnifyLogEntry, UnifyState)
-&gt; TCMT IO (Either NoLeftInv (Retract, Term))
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">DigestedUnifyLogEntry
-&gt; UnifyState -&gt; TCMT IO (Either NoLeftInv (Retract, Term))
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildEquiv"><span class="hs-identifier hs-var">buildEquiv</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">sequence</span></span><span> </span><span class="annot"><a href="#local-6989586621682065180"><span class="hs-identifier hs-type">equivs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682065184"><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065184"><span class="hs-identifier hs-var">no</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv.badstep&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;No Left Inverse:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyStep -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NoLeftInv -&gt; UnifyStep
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#badStep"><span class="hs-identifier hs-var">badStep</span></a></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065184"><span class="hs-identifier hs-var">no</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">Either NoLeftInv (Substitution, Substitution)
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (Substitution, Substitution)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065184"><span class="hs-identifier hs-var">no</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682065185"><span class="annot"><span class="annottext">[(Retract, Term)]
</span><a href="#local-6989586621682065185"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) Retract
-&gt; TCM (Either NoLeftInv Retract)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Retract, Term)] -&gt; ExceptT NoLeftInv (TCMT IO) Retract
</span><a href="#local-6989586621682065168"><span class="hs-identifier hs-var">compose</span></a></span><span> </span><span class="annot"><span class="annottext">[(Retract, Term)]
</span><a href="#local-6989586621682065185"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM (Either NoLeftInv Retract)
-&gt; (Either NoLeftInv Retract
    -&gt; TCM (Either NoLeftInv (Substitution, Substitution)))
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a b. TCMT IO a -&gt; (a -&gt; TCMT IO b) -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682065187"><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065187"><span class="hs-identifier hs-var">no</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either NoLeftInv (Substitution, Substitution)
-&gt; TCM (Either NoLeftInv (Substitution, Substitution))
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NoLeftInv -&gt; Either NoLeftInv (Substitution, Substitution)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">NoLeftInv
</span><a href="#local-6989586621682065187"><span class="hs-identifier hs-var">no</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682065188"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065188"><span class="hs-identifier hs-var">tau0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682065189"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065189"><span class="hs-identifier hs-var">leftInv0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-comment">-- &#915;,&#966;,us =_&#916; vs &#8866; &#964;0 : &#915;', &#966;</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-comment">-- leftInv0 : [wkS |&#966;,us =_&#916; vs| &#961;,1,refls][&#964;] = idS : &#915;,&#966;,us =_&#916; vs</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065190"><span class="annot"><span class="annottext">tau :: Substitution
</span><a href="#local-6989586621682065190"><span class="hs-identifier hs-var hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065188"><span class="hs-identifier hs-var">tau0</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Substitution
forall a. Int -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raiseS"><span class="hs-identifier hs-var">raiseS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-140"></span><span>        </span><span id="local-6989586621682065193"><span class="annot"><a href="#local-6989586621682065193"><span class="hs-identifier hs-var">unview</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO (IntervalView -&gt; Term)
forall (m :: * -&gt; *). HasBuiltins m =&gt; m (IntervalView -&gt; Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#intervalUnview%27"><span class="hs-identifier hs-var">intervalUnview'</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065195"><span class="annot"><a href="#local-6989586621682065195"><span class="hs-identifier hs-var hs-var">replaceAt</span></a></span></span><span> </span><span id="local-6989586621682065196"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065196"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682065197"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065197"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682065198"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065198"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065199"><span class="hs-identifier hs-var">xs0</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065197"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065200"><span class="hs-identifier hs-var">xs1</span></a></span><span>
</span><span id="line-142"></span><span>                    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065199"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065199"><span class="hs-identifier hs-var">xs0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065200"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065200"><span class="hs-identifier hs-var">xs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065196"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065198"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065202"><span class="annot"><a href="#local-6989586621682065202"><span class="hs-identifier hs-var hs-var">max</span></a></span></span><span> </span><span id="local-6989586621682065203"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065203"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682065204"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065204"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065193"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="annot"><span class="annottext">(IntervalView -&gt; Term) -&gt; IntervalView -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#IMax"><span class="hs-identifier hs-var">IMax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065203"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065204"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>            </span><span id="local-6989586621682065207"><span class="annot"><a href="#local-6989586621682065207"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span id="local-6989586621682065208"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065208"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065193"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="annot"><span class="annottext">(IntervalView -&gt; Term) -&gt; IntervalView -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#INeg"><span class="hs-identifier hs-var">INeg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065208"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065210"><span class="annot"><a href="#local-6989586621682065210"><span class="hs-identifier hs-var hs-var">phieq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="#local-6989586621682065207"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term -&gt; Term
</span><a href="#local-6989586621682065202"><span class="hs-operator hs-var">`max`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                          </span><span class="hs-comment">-- I + us =_&#916; vs -- inplaceS</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065215"><span class="annot"><a href="#local-6989586621682065215"><span class="hs-identifier hs-var hs-var">leftInv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; [Term] -&gt; Substitution
forall a. DeBruijn a =&gt; Impossible -&gt; [a] -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-var">termsS</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([Term] -&gt; Substitution) -&gt; [Term] -&gt; Substitution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term -&gt; [Term] -&gt; [Term]
forall {a}. Int -&gt; a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621682065195"><span class="hs-identifier hs-var">replaceAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065210"><span class="hs-identifier hs-var">phieq</span></a></span><span> </span><span class="annot"><span class="annottext">([Term] -&gt; [Term]) -&gt; [Term] -&gt; [Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Term) -&gt; [Int] -&gt; [Term]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Substitution -&gt; Int -&gt; Term
forall a. EndoSubst a =&gt; Substitution' a -&gt; Int -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#lookupS"><span class="hs-identifier hs-var">lookupS</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065189"><span class="hs-identifier hs-var">leftInv0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Term]) -&gt; [Int] -&gt; [Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
forall a. Integral a =&gt; a -&gt; [a]
</span><a href="Agda.Utils.List.html#downFrom"><span class="hs-identifier hs-var">downFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065220"><span class="annot"><a href="#local-6989586621682065220"><span class="hs-identifier hs-var hs-var">working_tel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Abs Telescope -&gt; Telescope
forall a. a -&gt; Abs (Tele a) -&gt; Tele a
</span><a href="Agda.Syntax.Internal.html#ExtendTel"><span class="hs-identifier hs-var">ExtendTel</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Telescope -&gt; Telescope) -&gt; Abs Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Telescope -&gt; Abs Telescope
forall a. String -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phi0&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Abs Telescope) -&gt; Telescope -&gt; Abs Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065136"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;=== before mod&quot;</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065220"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;tau0    :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065188"><span class="hs-identifier hs-type">tau0</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065220"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-type">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                                  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leftInv0:  &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065189"><span class="hs-identifier hs-type">leftInv0</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;=== after mod&quot;</span></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065220"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;tau    :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065190"><span class="hs-identifier hs-type">tau</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065220"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-type">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                                  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leftInv:   &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065215"><span class="hs-identifier hs-type">leftInv</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065190"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682065215"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">type</span><span> </span><span id="Retract"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-var">Retract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>     </span><span class="hs-comment">-- &#915; (the problem, including equalities),</span><span>
</span><span id="line-165"></span><span>     </span><span class="hs-comment">-- &#916; &#8866; &#961; : &#915;</span><span>
</span><span id="line-166"></span><span>     </span><span class="hs-comment">-- &#915; &#8866; &#964; : &#916;</span><span>
</span><span id="line-167"></span><span>     </span><span class="hs-comment">-- &#915;, i : I &#8866; leftInv : &#915;, such that (&#955;i. leftInv) : &#961;[&#964;] = id_&#915;</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">--- &#915; &#8866; us : &#916;   &#915; &#8866; termsS e us : &#916;</span><span>
</span><span id="line-170"></span><span id="local-6989586621682063907"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-type">termsS</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Substitute.DeBruijn.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063907"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#Impossible"><span class="hs-identifier hs-type">Impossible</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682063907"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Substitution%27"><span class="hs-identifier hs-type">Substitution'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063907"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-171"></span><span id="termsS"><span class="annot"><span class="annottext">termsS :: forall a. DeBruijn a =&gt; Impossible -&gt; [a] -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-var hs-var">termsS</span></a></span></span><span> </span><span id="local-6989586621682065228"><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621682065228"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682065229"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065229"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065229"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Substitution' a -&gt; Substitution' a
forall a. DeBruijn a =&gt; [a] -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#%2B%2B%23"><span class="hs-operator hs-var">++#</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Substitution' a
forall a. Impossible -&gt; Substitution' a
</span><a href="Agda.Syntax.Internal.html#EmptyS"><span class="hs-identifier hs-var">EmptyS</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621682065228"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#composeRetract"><span class="hs-identifier hs-type">composeRetract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span id="composeRetract"><span class="annot"><span class="annottext">composeRetract :: Retract
-&gt; Term -&gt; Retract -&gt; TCM (Either (Closure (Abs Type)) Retract)
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#composeRetract"><span class="hs-identifier hs-var hs-var">composeRetract</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065233"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065234"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065234"><span class="hs-identifier hs-var">rho0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065235"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065236"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065236"><span class="hs-identifier hs-var">leftInv0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682065237"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065237"><span class="hs-identifier hs-var">phi0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065238"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065238"><span class="hs-identifier hs-var">prob1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065239"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065239"><span class="hs-identifier hs-var">rho1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065240"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065240"><span class="hs-identifier hs-var">tau1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065241"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065241"><span class="hs-identifier hs-var">leftInv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;=== composing&quot;</span></span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;&#915;0   :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;tau0  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;&#915;1   :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065238"><span class="hs-identifier hs-var">prob1</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065238"><span class="hs-identifier hs-var">prob1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;tau1  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065240"><span class="hs-identifier hs-var">tau1</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">{-
  &#915;0 = prob0
  S0 &#8866; &#961;0 : &#915;0
  &#915;0 &#8866; &#964;0 : S0
  &#915;0 &#8866; leftInv0 : &#961;0[&#964;0] = id&#915;0
  &#915;0 &#8866; &#966;0
  &#915;0,&#966;0 &#8866; leftInv0 = refl

  &#915;1 = prob1
  S1 &#8866; &#961;1 : &#915;1
  &#915;1 &#8866; &#964;1 : S1
  &#915;1 &#8866; leftInv1 : &#961;1[&#964;1] = id&#915;1
  &#915;1 &#8866; &#966;1 = &#966;0[&#964;0] (**)
  &#915;1,&#966;1 &#8866; leftInv1 = refl
  S0 = &#915;1

  (**) implies?
  &#915;0,&#966;0 &#8866; leftInv1[&#964;0] = refl  (*)


  S1 &#8866; &#961; := &#961;0[&#961;1] : &#915;0
  &#915;0 &#8866; &#964; := &#964;1[&#964;0] : S1
  -}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065242"><span class="annot"><span class="annottext">prob :: Telescope
</span><a href="#local-6989586621682065242"><span class="hs-identifier hs-var hs-var hs-var">prob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065243"><span class="annot"><span class="annottext">rho :: Substitution
</span><a href="#local-6989586621682065243"><span class="hs-identifier hs-var hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065239"><span class="hs-identifier hs-var">rho1</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065234"><span class="hs-identifier hs-var">rho0</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065244"><span class="annot"><span class="annottext">tau :: Substitution
</span><a href="#local-6989586621682065244"><span class="hs-identifier hs-var hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065240"><span class="hs-identifier hs-var">tau1</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;tau  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065244"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">{-
  &#915;0 &#8866; leftInv : &#961;[&#964;] = id&#915;0
  &#915;0 &#8866; leftInv : &#961;0[&#961;1[&#964;1]][&#964;0] = id&#915;0
  &#915;0 &#8866; step0 := &#961;0[leftInv1[&#964;0]] : &#961;0[&#961;1[&#964;1]][&#964;0] = &#961;0[&#964;0]

  &#915;0,&#966;0 &#8866; step0 = refl     by (*)


  &#915;0 &#8866; leftInv := step0 &#183; leftInv0 : &#961;0[&#961;1[&#964;1]][&#964;0] = id&#915;0

  &#915;0 &#8866; leftInv := tr (\ i &#8594; &#961;0[&#961;1[&#964;1]][&#964;0] = leftInv0[i]) &#966;0 step0
  &#915;0,&#966;0 &#8866; leftInv = refl  -- because it will become step0, which is refl when &#966;0

  &#915;0, i : I &#8866; hcomp {&#915;0} (\ j &#8594; \ { (i = 0) -&gt; &#961;0[&#961;1[&#964;1]][&#964;0]
                                  ; (i = 1) -&gt; leftInv0[j]
                                  ; (&#966;0 = 1) -&gt; &#947;0
                                  })
                         (step0[i])




  -}</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065245"><span class="annot"><span class="annottext">step0 :: Substitution
</span><a href="#local-6989586621682065245"><span class="hs-identifier hs-var hs-var hs-var">step0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Substitution -&gt; Substitution
forall a. Int -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065241"><span class="hs-identifier hs-var">leftInv1</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065234"><span class="hs-identifier hs-var">rho0</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Dom Type) -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
(String, Dom Type) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;leftInv0  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065236"><span class="hs-identifier hs-var">leftInv0</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065238"><span class="hs-identifier hs-var">prob1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;rho0  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065234"><span class="hs-identifier hs-var">rho0</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;tau0  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;rhos0[tau0]  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065235"><span class="hs-identifier hs-var">tau0</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065234"><span class="hs-identifier hs-var">rho0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065238"><span class="hs-identifier hs-var">prob1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Dom Type) -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
(String, Dom Type) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;leftInv1  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065241"><span class="hs-identifier hs-var">leftInv1</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Dom Type) -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
(String, Dom Type) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;step0  :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065245"><span class="hs-identifier hs-var">step0</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621682065247"><span class="annot"><a href="#local-6989586621682065247"><span class="hs-identifier hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Type
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Type
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#primIntervalType"><span class="hs-identifier hs-var">primIntervalType</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621682065249"><span class="annot"><a href="#local-6989586621682065249"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Builtin.html#primIMax"><span class="hs-identifier hs-type">primIMax</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621682065251"><span class="annot"><a href="#local-6989586621682065251"><span class="hs-identifier hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Builtin.html#primINeg"><span class="hs-identifier hs-type">primINeg</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621682065253"><span class="annot"><a href="#local-6989586621682065253"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">sequenceA</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#runNamesT"><span class="hs-identifier hs-type">runNamesT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#teleNames"><span class="hs-identifier hs-type">teleNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>             </span><span id="local-6989586621682065257"><span class="annot"><a href="#local-6989586621682065257"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065237"><span class="hs-identifier hs-type">phi0</span></a></span><span>
</span><span id="line-251"></span><span>             </span><span id="local-6989586621682065259"><span class="annot"><a href="#local-6989586621682065259"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span>
</span><span id="line-252"></span><span>             </span><span id="local-6989586621682065261"><span class="annot"><a href="#local-6989586621682065261"><span class="hs-identifier hs-var">step0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682065245"><span class="hs-identifier hs-type">step0</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-operator hs-type">`applySubst`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#teleArgs"><span class="hs-identifier hs-type">teleArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span>
</span><span id="line-253"></span><span>             </span><span id="local-6989586621682065264"><span class="annot"><a href="#local-6989586621682065264"><span class="hs-identifier hs-var">leftInv0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682065236"><span class="hs-identifier hs-type">leftInv0</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-operator hs-type">`applySubst`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#teleArgs"><span class="hs-identifier hs-type">teleArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065233"><span class="hs-identifier hs-type">prob0</span></a></span><span>
</span><span id="line-254"></span><span>             </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065271"><span class="annot"><span class="annottext">forall b. (Subst b, DeBruijn b) =&gt; NamesT (TCMT IO) b
</span><a href="#local-6989586621682065271"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String, Dom Type)
-&gt; NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term])
-&gt; NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term])
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
(String, Dom Type) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Dom Type
forall a. a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-var">defaultDom</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682065247"><span class="hs-identifier hs-var">interval</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term])
 -&gt; NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term]))
-&gt; NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term])
-&gt; NamesT (TCMT IO) (Either (Closure (Abs Type)) [Term])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>              </span><span id="local-6989586621682065273"><span class="annot"><a href="#local-6989586621682065273"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ((forall b. (Subst b, DeBruijn b) =&gt; NamesT (TCMT IO) b)
    -&gt; NamesT (TCMT IO) Telescope)
-&gt; NamesT (TCMT IO) (Abs Telescope)
forall (m :: * -&gt; *) a.
Monad m =&gt;
String
-&gt; ((forall b. (Subst b, DeBruijn b) =&gt; NamesT m b) -&gt; NamesT m a)
-&gt; NamesT m (Abs a)
</span><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">(((forall b. (Subst b, DeBruijn b) =&gt; NamesT (TCMT IO) b)
  -&gt; NamesT (TCMT IO) Telescope)
 -&gt; NamesT (TCMT IO) (Abs Telescope))
-&gt; ((forall b. (Subst b, DeBruijn b) =&gt; NamesT (TCMT IO) b)
    -&gt; NamesT (TCMT IO) Telescope)
-&gt; NamesT (TCMT IO) (Abs Telescope)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065278"><span class="annot"><span class="annottext">NamesT (TCMT IO) Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#NamesT"><span class="hs-identifier hs-type">NamesT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065278"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamesT (TCMT IO) Telescope
</span><a href="#local-6989586621682065259"><span class="hs-identifier hs-var">g0</span></a></span><span>
</span><span id="line-256"></span><span>              </span><span id="local-6989586621682065279"><span class="annot"><a href="#local-6989586621682065279"><span class="hs-identifier hs-var">step0i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#lazyAbsApp"><span class="hs-identifier hs-type">lazyAbsApp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682065261"><span class="hs-identifier hs-type">step0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;*&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682065271"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-257"></span><span>              </span><span id="local-6989586621682065281"><span class="annot"><a href="#local-6989586621682065281"><span class="hs-identifier hs-var">face</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682065249"><span class="hs-identifier hs-type">max</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%3E"><span class="hs-operator hs-type">&lt;@&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682065251"><span class="hs-identifier hs-type">neg</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%3E"><span class="hs-operator hs-type">&lt;@&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065271"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%3E"><span class="hs-operator hs-type">&lt;@&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065257"><span class="hs-identifier hs-type">phi</span></a></span><span>
</span><span id="line-258"></span><span>              </span><span id="local-6989586621682065283"><span class="annot"><a href="#local-6989586621682065283"><span class="hs-identifier hs-var">leftInv0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682065264"><span class="hs-identifier hs-type">leftInv0</span></a></span><span>
</span><span id="line-259"></span><span>              </span><span id="local-6989586621682065284"><span class="annot"><a href="#local-6989586621682065284"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682065271"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-260"></span><span>              </span><span class="hs-comment">-- this composition could be optimized further whenever step0i is actually constant in i.</span><span>
</span><span id="line-261"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">runExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.html#transpSysTel%27"><span class="hs-identifier hs-type">transpSysTel'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621682065273"><span class="hs-identifier hs-type">tel</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065284"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682065283"><span class="hs-identifier hs-type">leftInv0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682065281"><span class="hs-identifier hs-type">face</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065279"><span class="hs-identifier hs-type">step0i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682065253"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621682065287"><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065287"><span class="hs-identifier hs-var">cl</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (Closure (Abs Type)) Retract
-&gt; TCM (Either (Closure (Abs Type)) Retract)
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Closure (Abs Type) -&gt; Either (Closure (Abs Type)) Retract
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Closure (Abs Type)
</span><a href="#local-6989586621682065287"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682065288"><span class="annot"><span class="annottext">Abs [Term]
</span><a href="#local-6989586621682065288"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065289"><span class="annot"><span class="annottext">sigma :: Substitution
</span><a href="#local-6989586621682065289"><span class="hs-identifier hs-var hs-var hs-var">sigma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; [Term] -&gt; Substitution
forall a. DeBruijn a =&gt; Impossible -&gt; [a] -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-var">termsS</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([Term] -&gt; Substitution) -&gt; [Term] -&gt; Substitution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Abs [Term] -&gt; [Term]
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs [Term]
</span><a href="#local-6989586621682065288"><span class="hs-identifier hs-var">leftInv</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCMT IO () -&gt; TCMT IO ()
forall (m :: * -&gt; *). MonadDebug m =&gt; String -&gt; Int -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier hs-var">verboseS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065233"><span class="hs-identifier hs-var">prob0</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO () -&gt; TCMT IO ()) -&gt; TCMT IO () -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Dom Type) -&gt; TCMT IO () -&gt; TCMT IO ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
(String, Dom Type) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;leftInv    :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Term] -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; [Term] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs [Term] -&gt; [Term]
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs [Term]
</span><a href="#local-6989586621682065288"><span class="hs-identifier hs-var">leftInv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;leftInv    :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Term] -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs [Term] -&gt; [Term]
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs [Term]
</span><a href="#local-6989586621682065288"><span class="hs-identifier hs-var">leftInv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;leftInvSub :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065289"><span class="hs-identifier hs-var">sigma</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><span class="annottext">Either (Closure (Abs Type)) Retract
-&gt; TCM (Either (Closure (Abs Type)) Retract)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (Closure (Abs Type)) Retract
 -&gt; TCM (Either (Closure (Abs Type)) Retract))
-&gt; Either (Closure (Abs Type)) Retract
-&gt; TCM (Either (Closure (Abs Type)) Retract)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Retract -&gt; Either (Closure (Abs Type)) Retract
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065242"><span class="hs-identifier hs-var">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065243"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065244"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065289"><span class="hs-identifier hs-var">sigma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><span class="hs-comment">-- | Build the left inverse corresponding to a single unification step.</span></span><span>
</span><span id="line-274"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildEquiv"><span class="hs-identifier hs-type">buildEquiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DigestedUnifyLogEntry"><span class="hs-identifier hs-type">DigestedUnifyLogEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyState"><span class="hs-identifier hs-type">UnifyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="buildEquiv"><span class="annot"><span class="annottext">buildEquiv :: DigestedUnifyLogEntry
-&gt; UnifyState -&gt; TCMT IO (Either NoLeftInv (Retract, Term))
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildEquiv"><span class="hs-identifier hs-var hs-var">buildEquiv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DUnificationStep"><span class="hs-identifier hs-type">DUnificationStep</span></a></span><span> </span><span id="local-6989586621682065293"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621682065294"><span class="annot"><span class="annottext">step :: DigestedUnifyStep
</span><a href="#local-6989586621682065294"><span class="hs-identifier hs-var">step</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DSolution"><span class="hs-identifier hs-type">DSolution</span></a></span><span> </span><span id="local-6989586621682065295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065295"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682065296"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682065296"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682065297"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065297"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span id="local-6989586621682065298"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065298"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621682065299"><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065299"><span class="hs-identifier hs-var">side</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682065300"><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065300"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682065301"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065301"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) (Retract, Term)
-&gt; TCMT IO (Either NoLeftInv (Retract, Term))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT NoLeftInv (TCMT IO) (Retract, Term)
 -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
-&gt; ExceptT NoLeftInv (TCMT IO) (Retract, Term)
-&gt; TCMT IO (Either NoLeftInv (Retract, Term))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-277"></span><span>          </span><span id="local-6989586621682063955"><span class="annot"><a href="#local-6989586621682065302"><span class="hs-identifier hs-type">cantTransport'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063955"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063955"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-278"></span><span>          </span><span id="local-6989586621682065302"><span class="annot"><span class="annottext">cantTransport' :: forall b.
ExceptT (Closure Type) (TCMT IO) b -&gt; ExceptT NoLeftInv (TCMT IO) b
</span><a href="#local-6989586621682065302"><span class="hs-identifier hs-var hs-var hs-var">cantTransport'</span></a></span></span><span> </span><span id="local-6989586621682065304"><span class="annot"><span class="annottext">ExceptT (Closure Type) (TCMT IO) b
</span><a href="#local-6989586621682065304"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Closure Type -&gt; NoLeftInv)
-&gt; ExceptT (Closure Type) (TCMT IO) b
-&gt; ExceptT NoLeftInv (TCMT IO) b
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><span class="hs-identifier hs-var">withExceptT</span></span><span> </span><span class="annot"><span class="annottext">Closure Type -&gt; NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport%27"><span class="hs-identifier hs-var">CantTransport'</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT (Closure Type) (TCMT IO) b
</span><a href="#local-6989586621682065304"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-279"></span><span>          </span><span id="local-6989586621682063961"><span class="annot"><a href="#local-6989586621682065306"><span class="hs-identifier hs-type">cantTransport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063961"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#NoLeftInv"><span class="hs-identifier hs-type">NoLeftInv</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063961"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-280"></span><span>          </span><span id="local-6989586621682065306"><span class="annot"><span class="annottext">cantTransport :: forall b.
ExceptT (Closure (Abs Type)) (TCMT IO) b
-&gt; ExceptT NoLeftInv (TCMT IO) b
</span><a href="#local-6989586621682065306"><span class="hs-identifier hs-var hs-var hs-var">cantTransport</span></a></span></span><span> </span><span id="local-6989586621682065308"><span class="annot"><span class="annottext">ExceptT (Closure (Abs Type)) (TCMT IO) b
</span><a href="#local-6989586621682065308"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Closure (Abs Type) -&gt; NoLeftInv)
-&gt; ExceptT (Closure (Abs Type)) (TCMT IO) b
-&gt; ExceptT NoLeftInv (TCMT IO) b
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><span class="hs-identifier hs-var">withExceptT</span></span><span> </span><span class="annot"><span class="annottext">Closure (Abs Type) -&gt; NoLeftInv
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport"><span class="hs-identifier hs-var">CantTransport</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT (Closure (Abs Type)) (TCMT IO) b
</span><a href="#local-6989586621682065308"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ())
-&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;step unifyState:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyState -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ())
-&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;step step:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc -&gt; TCM Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DigestedUnifyStep -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; DigestedUnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">DigestedUnifyStep
</span><a href="#local-6989586621682065294"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621682065309"><span class="annot"><a href="#local-6989586621682065309"><span class="hs-identifier hs-var">unview</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) (IntervalView -&gt; Term)
forall (m :: * -&gt; *). HasBuiltins m =&gt; m (IntervalView -&gt; Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#intervalUnview%27"><span class="hs-identifier hs-var">intervalUnview'</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621682065310"><span class="annot"><a href="#local-6989586621682065310"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;context:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065310"><span class="hs-identifier hs-type">cxt</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-288"></span><span>          </span><span id="local-6989586621682065312"><span class="annot"><a href="#local-6989586621682065312"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Int
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varCount"><span class="hs-identifier hs-var">varCount</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621682065314"><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-var hs-var">gamma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-290"></span><span>          </span><span id="local-6989586621682065315"><span class="annot"><a href="#local-6989586621682065315"><span class="hs-identifier hs-var hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-comment">-- k counts in eqs from the left</span><span>
</span><span id="line-292"></span><span>          </span><span id="local-6989586621682065316"><span class="annot"><a href="#local-6989586621682065316"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; [Arg Term]
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqLHS"><span class="hs-identifier hs-var">eqLHS</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term] -&gt; Int -&gt; Arg Term
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="Agda.Utils.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065295"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-293"></span><span>          </span><span id="local-6989586621682065319"><span class="annot"><a href="#local-6989586621682065319"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; [Arg Term]
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqRHS"><span class="hs-identifier hs-var">eqRHS</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065293"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term] -&gt; Int -&gt; Arg Term
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="Agda.Utils.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065295"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-294"></span><span>          </span><span class="hs-comment">-- &#915; &#8866; perm : &#915;' is a reordering used by instantiateTelescope to ensure the</span><span>
</span><span id="line-295"></span><span>          </span><span class="hs-comment">-- resulting context is well-formed. Works on de Bruijn levels.</span><span>
</span><span id="line-296"></span><span>          </span><span id="local-6989586621682065321"><span class="annot"><a href="#local-6989586621682065321"><span class="hs-identifier hs-var hs-var">perm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation -&gt; Maybe Permutation -&gt; Permutation
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Permutation
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Permutation -&gt; Permutation)
-&gt; Maybe Permutation -&gt; Permutation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyOutput -&gt; Maybe Permutation
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#unifySolutionPerm"><span class="hs-identifier hs-var">unifySolutionPerm</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065300"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-297"></span><span>          </span><span class="hs-comment">-- The new de Bruijn index of fx in &#915;'. The target context for &#964; is obtained by dropping</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-comment">-- x from &#915;' (and the kth equation from the equation telescope) and instantiating</span><span>
</span><span id="line-299"></span><span>          </span><span class="hs-comment">-- it with u (resp. refl).</span><span>
</span><span id="line-300"></span><span>          </span><span id="local-6989586621682065324"><span class="annot"><a href="#local-6989586621682065324"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Permutation -&gt; Int -&gt; Maybe Int
</span><a href="Agda.Utils.Permutation.html#lookupRP"><span class="hs-identifier hs-var">lookupRP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation -&gt; Permutation
</span><a href="Agda.Utils.Permutation.html#reverseP"><span class="hs-identifier hs-var">reverseP</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation
</span><a href="#local-6989586621682065321"><span class="hs-identifier hs-var">perm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleVar Int -&gt; Int
forall a. FlexibleVar a -&gt; a
</span><a href="Agda.TypeChecking.Rules.LHS.Problem.html#flexVar"><span class="hs-identifier hs-var">flexVar</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065297"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>          </span><span id="local-6989586621682065328"><span class="annot"><a href="#local-6989586621682065328"><span class="hs-identifier hs-var hs-var">neqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065315"><span class="hs-identifier hs-var">eqs</span></a></span><span>
</span><span id="line-302"></span><span>          </span><span id="local-6989586621682065330"><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-var hs-var">phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621682065331"><span class="annot"><a href="#local-6989586621682065331"><span class="hs-identifier hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#primIntervalType"><span class="hs-identifier hs-type">primIntervalType</span></a></span><span>
</span><span id="line-304"></span><span>         </span><span class="hs-comment">-- &#915;, &#966; : I</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065332"><span class="annot"><a href="#local-6989586621682065332"><span class="hs-identifier hs-var hs-var">gamma_phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065314"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Telescope) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ListTel -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList"><span class="hs-identifier hs-var">telFromList</span></a></span><span> </span><span class="annot"><span class="annottext">(ListTel -&gt; Telescope) -&gt; ListTel -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-306"></span><span>              </span><span class="annot"><span class="annottext">(Int -&gt; Dom (String, Type)) -&gt; [Int] -&gt; ListTel
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Type) -&gt; Dom (String, Type)
forall a. a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-var">defaultDom</span></a></span><span> </span><span class="annot"><span class="annottext">((String, Type) -&gt; Dom (String, Type))
-&gt; (Int -&gt; (String, Type)) -&gt; Int -&gt; Dom (String, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682065331"><span class="hs-identifier hs-var">interval</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, Type))
-&gt; (Int -&gt; String) -&gt; Int -&gt; (String, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phi&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (Int -&gt; String) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065330"><span class="hs-identifier hs-var">phis</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-comment">-- working_tel = &#915;, &#966; : I, eqs : lhs &#8801; rhs</span><span>
</span><span id="line-308"></span><span>        </span><span id="local-6989586621682065335"><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-var">working_tel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-type">abstract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065332"><span class="hs-identifier hs-type">gamma_phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span>
</span><span id="line-309"></span><span>          </span><span class="annot"><a href="#local-6989586621682065302"><span class="hs-identifier hs-type">cantTransport'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.html#pathTelescope%27"><span class="hs-identifier hs-type">pathTelescope'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqLHS"><span class="hs-identifier hs-var">eqLHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqRHS"><span class="hs-identifier hs-var">eqRHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-comment">-- working_tel' = &#915;'           , &#966; : I, eqs : lhs &#8801; rhs</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-comment">--              = &#915;&#8321;, x : A, &#915;&#8322;, &#966; : I, eqs : lhs &#8801; rhs</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065337"><span class="annot"><a href="#local-6989586621682065337"><span class="hs-identifier hs-var hs-var">permw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Permutation -&gt; Permutation
</span><a href="Agda.Utils.Permutation.html#liftP"><span class="hs-identifier hs-var">liftP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065335"><span class="hs-identifier hs-var">working_tel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065314"><span class="hs-identifier hs-var">gamma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Permutation
</span><a href="#local-6989586621682065321"><span class="hs-identifier hs-var">perm</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span id="local-6989586621682065339"><span class="annot"><a href="#local-6989586621682065339"><span class="hs-identifier hs-var">working_tel'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#permuteTel"><span class="hs-identifier hs-type">permuteTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065337"><span class="hs-identifier hs-type">permw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-315"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;working tel:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;working tel args:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#teleArgs"><span class="hs-identifier hs-type">teleArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;perm:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065321"><span class="hs-identifier hs-type">perm</span></a></span><span>
</span><span id="line-318"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682065342"><span class="annot"><a href="#local-6989586621682065342"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065343"><span class="annot"><a href="#local-6989586621682065343"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065344"><span class="annot"><a href="#local-6989586621682065344"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#runNamesT"><span class="hs-identifier hs-type">runNamesT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-321"></span><span>            </span><span id="local-6989586621682063973"><span class="annot"><a href="#local-6989586621682065345"><span class="hs-identifier hs-type">raiseFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682063973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682063973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682063973"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-322"></span><span>            </span><span id="local-6989586621682065345"><span class="annot"><a href="#local-6989586621682065345"><span class="hs-identifier hs-var hs-var">raiseFrom</span></a></span></span><span> </span><span id="local-6989586621682065351"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065351"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682065352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065352"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
forall a. Subst a =&gt; Int -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065335"><span class="hs-identifier hs-var">working_tel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065351"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065352"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-323"></span><span>            </span><span id="local-6989586621682065353"><span class="annot"><a href="#local-6989586621682065353"><span class="hs-identifier hs-var hs-var">bindSplit</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065354"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065354"><span class="hs-identifier hs-var">tel1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065355"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065355"><span class="hs-identifier hs-var">tel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065354"><span class="hs-identifier hs-var">tel1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Names -&gt; a -&gt; AbsN a
forall a. Names -&gt; a -&gt; AbsN a
</span><a href="Agda.TypeChecking.Names.html#AbsN"><span class="hs-identifier hs-var">AbsN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Names
</span><a href="Agda.TypeChecking.Telescope.html#teleNames"><span class="hs-identifier hs-var">teleNames</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065354"><span class="hs-identifier hs-var">tel1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065355"><span class="hs-identifier hs-var">tel2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>          </span><span id="local-6989586621682065357"><span class="annot"><a href="#local-6989586621682065357"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682065345"><span class="hs-identifier hs-type">raiseFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682065316"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-325"></span><span>          </span><span id="local-6989586621682065358"><span class="annot"><a href="#local-6989586621682065358"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682065345"><span class="hs-identifier hs-type">raiseFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682065319"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-326"></span><span>          </span><span class="hs-comment">-- &#966;</span><span>
</span><span id="line-327"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065359"><span class="annot"><a href="#local-6989586621682065359"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Term -&gt; Term
forall a. Subst a =&gt; Telescope -&gt; a -&gt; a
</span><a href="#local-6989586621682065345"><span class="hs-identifier hs-var">raiseFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065332"><span class="hs-identifier hs-var">gamma_phis</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-comment">-- working_tel &#8866; &#947;&#8321;,x,&#947;&#8322;,&#966;,eqs : working_tel'</span><span>
</span><span id="line-329"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065360"><span class="annot"><a href="#local-6989586621682065360"><span class="hs-identifier hs-var hs-var">all_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation -&gt; [Arg Term] -&gt; [Arg Term]
forall a. Permutation -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.Permutation.html#permute"><span class="hs-identifier hs-var">permute</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation
</span><a href="#local-6989586621682065337"><span class="hs-identifier hs-var">permw</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg Term] -&gt; [Arg Term]) -&gt; [Arg Term] -&gt; [Arg Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Arg Term]
forall a t. DeBruijn a =&gt; Tele (Dom t) -&gt; [Arg a]
</span><a href="Agda.TypeChecking.Telescope.html#teleArgs"><span class="hs-identifier hs-var">teleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065335"><span class="hs-identifier hs-var">working_tel</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>          </span><span class="hs-comment">-- . &#8866; &#915;&#8321;  ,  &#947;&#8321;. x : A, &#915;&#8322;, &#966; : I, eqs : lhs &#8801; rhs</span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065362"><span class="annot"><a href="#local-6989586621682065362"><span class="hs-identifier hs-var">gamma1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682065363"><span class="annot"><a href="#local-6989586621682065363"><span class="hs-identifier hs-var">xxi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682065353"><span class="hs-identifier hs-type">bindSplit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#splitTelescopeAt"><span class="hs-identifier hs-type">splitTelescopeAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682065324"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065339"><span class="hs-identifier hs-type">working_tel'</span></a></span><span>
</span><span id="line-333"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682065365"><span class="annot"><a href="#local-6989586621682065365"><span class="hs-identifier hs-var">gamma1_args</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065366"><span class="annot"><a href="#local-6989586621682065366"><span class="hs-identifier hs-var">xxi_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065362"><span class="hs-identifier hs-type">gamma1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065360"><span class="hs-identifier hs-type">all_args</span></a></span><span>
</span><span id="line-334"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682065367"><span class="annot"><a href="#local-6989586621682065367"><span class="hs-identifier hs-var">_x_arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065368"><span class="annot"><a href="#local-6989586621682065368"><span class="hs-identifier hs-var">xi_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682065366"><span class="hs-identifier hs-type">xxi_args</span></a></span><span>
</span><span id="line-335"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682065369"><span class="annot"><a href="#local-6989586621682065369"><span class="hs-identifier hs-var">x_arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065370"><span class="annot"><a href="#local-6989586621682065370"><span class="hs-identifier hs-var">xi0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065371"><span class="annot"><a href="#local-6989586621682065371"><span class="hs-identifier hs-var">k_arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065372"><span class="annot"><a href="#local-6989586621682065372"><span class="hs-identifier hs-var">xi1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065362"><span class="hs-identifier hs-type">gamma1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682065295"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065366"><span class="hs-identifier hs-type">xxi_args</span></a></span><span>
</span><span id="line-336"></span><span>              </span><span class="hs-comment">-- working_tel &#8866; x : A, &#915;&#8322;, &#966; : I, eqs : lhs &#8801; rhs</span><span>
</span><span id="line-337"></span><span>              </span><span id="local-6989586621682065373"><span class="annot"><a href="#local-6989586621682065373"><span class="hs-identifier hs-var hs-var">xxi_here</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsN Telescope -&gt; [SubstArg Telescope] -&gt; Telescope
forall a. Subst a =&gt; AbsN a -&gt; [SubstArg a] -&gt; a
</span><a href="Agda.TypeChecking.Names.html#absAppN"><span class="hs-identifier hs-var">absAppN</span></a></span><span> </span><span class="annot"><span class="annottext">AbsN Telescope
</span><a href="#local-6989586621682065363"><span class="hs-identifier hs-var">xxi</span></a></span><span> </span><span class="annot"><span class="annottext">([SubstArg Telescope] -&gt; Telescope)
-&gt; [SubstArg Telescope] -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; SubstArg Telescope)
-&gt; [Arg Term] -&gt; [SubstArg Telescope]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Term
Arg Term -&gt; SubstArg Telescope
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065365"><span class="hs-identifier hs-var">gamma1_args</span></a></span><span>
</span><span id="line-338"></span><span>              </span><span class="hs-comment">--                                                  x:A, &#915;&#8322;               &#966;</span><span>
</span><span id="line-339"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682065375"><span class="annot"><a href="#local-6989586621682065375"><span class="hs-identifier hs-var">xpre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065376"><span class="annot"><a href="#local-6989586621682065376"><span class="hs-identifier hs-var">krest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682065353"><span class="hs-identifier hs-type">bindSplit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#splitTelescopeAt"><span class="hs-identifier hs-type">splitTelescopeAt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065314"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065362"><span class="hs-identifier hs-type">gamma1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682065295"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065373"><span class="hs-identifier hs-type">xxi_here</span></a></span><span>
</span><span id="line-340"></span><span>          </span><span id="local-6989586621682065377"><span class="annot"><a href="#local-6989586621682065377"><span class="hs-identifier hs-var">k_arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065371"><span class="hs-identifier hs-type">k_arg</span></a></span><span>
</span><span id="line-341"></span><span>          </span><span id="local-6989586621682065378"><span class="annot"><a href="#local-6989586621682065378"><span class="hs-identifier hs-var">xpre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065375"><span class="hs-identifier hs-type">xpre</span></a></span><span>
</span><span id="line-342"></span><span>          </span><span id="local-6989586621682065379"><span class="annot"><a href="#local-6989586621682065379"><span class="hs-identifier hs-var">krest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065376"><span class="hs-identifier hs-type">krest</span></a></span><span>
</span><span id="line-343"></span><span>          </span><span class="hs-comment">-- &#916;&#8320; = &#915;&#8321;, &#915;&#8322;</span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-comment">-- &#916;  = x eq. &#916;&#8320;, &#966; : I, eqs-k : lhs-k &#8801; rhs-k</span><span>
</span><span id="line-345"></span><span>          </span><span id="local-6989586621682065380"><span class="annot"><a href="#local-6989586621682065380"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bindN"><span class="hs-identifier hs-type">bindN</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;eq&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682065386"><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065386"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065387"><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065387"><span class="hs-identifier hs-var">eq</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065388"><span class="annot"><span class="annottext">pre :: NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
</span><a href="#local-6989586621682065388"><span class="hs-identifier hs-var hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Term -&gt; Telescope
forall t. Apply t =&gt; t -&gt; Term -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply1"><span class="hs-identifier hs-var">apply1</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Term -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Telescope)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
</span><a href="#local-6989586621682065378"><span class="hs-identifier hs-var">xpre</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065386"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-347"></span><span>                     </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
-&gt; (Vars (ExceptT NoLeftInv (TCMT IO))
    -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall (m :: * -&gt; *) a.
(Monad m, Abstract a) =&gt;
NamesT m Telescope -&gt; (Vars m -&gt; NamesT m a) -&gt; NamesT m a
</span><a href="Agda.TypeChecking.Names.html#abstractN"><span class="hs-identifier hs-var">abstractN</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
</span><a href="#local-6989586621682065388"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">((Vars (ExceptT NoLeftInv (TCMT IO))
  -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope)
 -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope)
-&gt; (Vars (ExceptT NoLeftInv (TCMT IO))
    -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065395"><span class="annot"><span class="annottext">Vars (ExceptT NoLeftInv (TCMT IO))
</span><a href="#local-6989586621682065395"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>                       </span><span class="annot"><span class="annottext">Telescope -&gt; Term -&gt; Telescope
forall t. Apply t =&gt; t -&gt; Term -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply1"><span class="hs-identifier hs-var">apply1</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Term -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Telescope)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (AbsN Telescope)
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) (SubstArg Telescope)]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall (m :: * -&gt; *) a.
(Monad m, Subst a) =&gt;
NamesT m (AbsN a) -&gt; [NamesT m (SubstArg a)] -&gt; NamesT m a
</span><a href="Agda.TypeChecking.Names.html#applyN"><span class="hs-identifier hs-var">applyN</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (AbsN Telescope)
</span><a href="#local-6989586621682065379"><span class="hs-identifier hs-var">krest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065386"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
Vars (ExceptT NoLeftInv (TCMT IO))
</span><a href="#local-6989586621682065395"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065387"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-comment">-- working_tel &#8866; delta0_args : &#916;&#8320;</span><span>
</span><span id="line-350"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065397"><span class="annot"><a href="#local-6989586621682065397"><span class="hs-identifier hs-var hs-var">delta0_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065370"><span class="hs-identifier hs-var">xi0</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term] -&gt; [Arg Term] -&gt; [Arg Term]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065372"><span class="hs-identifier hs-var">xi1</span></a></span><span>
</span><span id="line-351"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065398"><span class="annot"><a href="#local-6989586621682065398"><span class="hs-identifier hs-var hs-var">appSide</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065299"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-353"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065309"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="annot"><span class="annottext">(IntervalView -&gt; Term) -&gt; (Term -&gt; IntervalView) -&gt; Term -&gt; Term
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#INeg"><span class="hs-identifier hs-var">INeg</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; IntervalView)
-&gt; (Term -&gt; Arg Term) -&gt; Term -&gt; IntervalView
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-355"></span><span>                  </span><span class="hs-comment">-- csingl :: NamesT tcm Term -&gt; NamesT tcm [Arg Term]</span><span>
</span><span id="line-356"></span><span>                  </span><span id="local-6989586621682065400"><span class="annot"><a href="#local-6989586621682065400"><span class="hs-identifier hs-var hs-var">csingl</span></a></span></span><span> </span><span id="local-6989586621682065401"><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065401"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamesT (ExceptT NoLeftInv (TCMT IO)) Term
 -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Arg Term))
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term -&gt; Arg Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Arg Term)
forall a b.
(a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
 -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term])
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
</span><a href="#local-6989586621682065404"><span class="hs-identifier hs-var">csingl'</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065401"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-357"></span><span>                  </span><span class="hs-comment">-- csingl' :: NamesT tcm Term -&gt; [NamesT tcm Term]</span><span>
</span><span id="line-358"></span><span>                  </span><span id="local-6989586621682065404"><span class="annot"><a href="#local-6989586621682065404"><span class="hs-identifier hs-var hs-var">csingl'</span></a></span></span><span> </span><span id="local-6989586621682065405"><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065405"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065377"><span class="hs-identifier hs-var">k_arg</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; (NamesT (ExceptT NoLeftInv (TCMT IO)) Term,
    NamesT (ExceptT NoLeftInv (TCMT IO)) Term,
    NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (m :: * -&gt; *).
Applicative m =&gt;
m Term -&gt; (m Term, m Term, m Term) -&gt; m Term
</span><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%40%3E"><span class="hs-operator hs-var">&lt;@@&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065357"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065358"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="#local-6989586621682065398"><span class="hs-identifier hs-var">appSide</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065405"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (NamesT (ExceptT NoLeftInv (TCMT IO)) Term
    -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (m :: * -&gt; *).
Monad m =&gt;
String -&gt; (NamesT m Term -&gt; NamesT m Term) -&gt; NamesT m Term
</span><a href="Agda.TypeChecking.Names.html#lam"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;j&quot;</span></span><span> </span><span class="annot"><span class="annottext">((NamesT (ExceptT NoLeftInv (TCMT IO)) Term
  -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
 -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
-&gt; (NamesT (ExceptT NoLeftInv (TCMT IO)) Term
    -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065408"><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065408"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>                                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065409"><span class="annot"><span class="annottext">r :: Term -&gt; Term -&gt; Term
</span><a href="#local-6989586621682065409"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682065410"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065410"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682065411"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065411"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either () ()
</span><a href="#local-6989586621682065299"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-361"></span><span>                                            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065309"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg Term -&gt; Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#IMax"><span class="hs-identifier hs-var">IMax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065411"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065410"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                                            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065309"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg Term -&gt; Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#IMin"><span class="hs-identifier hs-var">IMin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065411"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Arg Term)
-&gt; (IntervalView -&gt; Term) -&gt; IntervalView -&gt; Arg Term
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntervalView -&gt; Term
</span><a href="#local-6989586621682065309"><span class="hs-identifier hs-var">unview</span></a></span><span> </span><span class="annot"><span class="annottext">(IntervalView -&gt; Arg Term) -&gt; IntervalView -&gt; Arg Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; IntervalView
</span><a href="Agda.Syntax.Internal.html#INeg"><span class="hs-identifier hs-var">INeg</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; IntervalView) -&gt; Arg Term -&gt; IntervalView
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065410"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065377"><span class="hs-identifier hs-var">k_arg</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; (NamesT (ExceptT NoLeftInv (TCMT IO)) Term,
    NamesT (ExceptT NoLeftInv (TCMT IO)) Term,
    NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (m :: * -&gt; *).
Applicative m =&gt;
m Term -&gt; (m Term, m Term, m Term) -&gt; m Term
</span><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%40%3E"><span class="hs-operator hs-var">&lt;@@&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065357"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065358"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term -&gt; Term
</span><a href="#local-6989586621682065409"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term -&gt; Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Term)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065405"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; Term)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065408"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>                              </span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065413"><span class="annot"><a href="#local-6989586621682065413"><span class="hs-identifier hs-var hs-var">replaceAt</span></a></span></span><span> </span><span id="local-6989586621682065414"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065414"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682065415"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065415"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682065416"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065416"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065417"><span class="hs-identifier hs-var">xs0</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682065415"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065418"><span class="hs-identifier hs-var">xs1</span></a></span><span>
</span><span id="line-366"></span><span>                </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065417"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065417"><span class="hs-identifier hs-var">xs0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065418"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065418"><span class="hs-identifier hs-var">xs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065416"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-367"></span><span>              </span><span id="local-6989586621682065419"><span class="annot"><a href="#local-6989586621682065419"><span class="hs-identifier hs-var hs-var">dropAt</span></a></span></span><span> </span><span id="local-6989586621682065420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065420"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682065421"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065421"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065422"><span class="hs-identifier hs-var">xs0</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065423"><span class="hs-identifier hs-var">xs1</span></a></span><span>
</span><span id="line-368"></span><span>                </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682065422"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065422"><span class="hs-identifier hs-var">xs0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682065423"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065423"><span class="hs-identifier hs-var">xs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065420"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682065421"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-369"></span><span>          </span><span id="local-6989586621682065424"><span class="annot"><a href="#local-6989586621682065424"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065380"><span class="hs-identifier hs-type">delta</span></a></span><span>
</span><span id="line-370"></span><span>          </span><span class="hs-comment">-- d = i. &#916; (k i) (&#955; j &#8594; k (i &#8743; j))</span><span>
</span><span id="line-371"></span><span>          </span><span id="local-6989586621682065425"><span class="annot"><a href="#local-6989586621682065425"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065430"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065430"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (AbsN Telescope)
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) (SubstArg Telescope)]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall (m :: * -&gt; *) a.
(Monad m, Subst a) =&gt;
NamesT m (AbsN a) -&gt; [NamesT m (SubstArg a)] -&gt; NamesT m a
</span><a href="Agda.TypeChecking.Names.html#applyN"><span class="hs-identifier hs-var">applyN</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (AbsN Telescope)
</span><a href="#local-6989586621682065424"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
</span><a href="#local-6989586621682065404"><span class="hs-identifier hs-var">csingl'</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065430"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>          </span><span class="hs-comment">-- Andrea 06/06/2018</span><span>
</span><span id="line-374"></span><span>          </span><span class="hs-comment">-- We do not actually add a transp/fill if the family is</span><span>
</span><span id="line-375"></span><span>          </span><span class="hs-comment">-- constant (TODO: postpone for metas) This is so variables</span><span>
</span><span id="line-376"></span><span>          </span><span class="hs-comment">-- whose types do not depend on &quot;x&quot; are left alone, in</span><span>
</span><span id="line-377"></span><span>          </span><span class="hs-comment">-- particular those the solution &quot;t&quot; depends on.</span><span>
</span><span id="line-378"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span>          </span><span class="hs-comment">-- We might want to instead use the info discovered by instantiateTelescope</span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-comment">-- when checking if &quot;t&quot; depends on &quot;x&quot; to decide what</span><span>
</span><span id="line-381"></span><span>          </span><span class="hs-comment">-- to transp and what not to.</span><span>
</span><span id="line-382"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065431"><span class="annot"><a href="#local-6989586621682065431"><span class="hs-identifier hs-var hs-var">flag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-383"></span><span>          </span><span id="local-6989586621682065432"><span class="annot"><a href="#local-6989586621682065432"><span class="hs-identifier hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gamma1_args</span></span><span> </span><span class="annot"><span class="hs-operator">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065306"><span class="hs-identifier hs-type">cantTransport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.html#transpTel%27"><span class="hs-identifier hs-type">transpTel'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065431"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065425"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065359"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065397"><span class="hs-identifier hs-type">delta0_args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;tau    :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-type">setHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-type">NotHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065432"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>          </span><span id="local-6989586621682065436"><span class="annot"><a href="#local-6989586621682065436"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-386"></span><span>            </span><span id="local-6989586621682065437"><span class="annot"><a href="#local-6989586621682065437"><span class="hs-identifier hs-var">gamma1_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065365"><span class="hs-identifier hs-type">gamma1_args</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span id="local-6989586621682065438"><span class="annot"><a href="#local-6989586621682065438"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065359"><span class="hs-identifier hs-type">phi</span></a></span><span>
</span><span id="line-388"></span><span>            </span><span class="hs-comment">-- xxi_here &lt;- open xxi_here</span><span>
</span><span id="line-389"></span><span>            </span><span class="hs-comment">-- (xi_here_f :: Abs Telescope) &lt;- bind &quot;i&quot; $ \ i -&gt; apply &lt;$&gt; xxi_here &lt;*&gt; (take 1 `fmap` csingl i)</span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-comment">-- xi_here_f &lt;- open xi_here_f</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-comment">-- xi_args &lt;- open xi_args</span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-comment">-- xif &lt;- bind &quot;i&quot; $ \ i -&gt; do</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-comment">--                      m &lt;- (runExceptT &lt;$&gt; (trFillTel' flag &lt;$&gt; xi_here_f &lt;*&gt; phi &lt;*&gt; xi_args &lt;*&gt; i))</span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-comment">--                      either __IMPOSSIBLE__ id &lt;$&gt; lift m</span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-comment">-- xif &lt;- open xif</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>            </span><span id="local-6989586621682065439"><span class="annot"><a href="#local-6989586621682065439"><span class="hs-identifier hs-var">xi0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065370"><span class="hs-identifier hs-type">xi0</span></a></span><span>
</span><span id="line-398"></span><span>            </span><span id="local-6989586621682065440"><span class="annot"><a href="#local-6989586621682065440"><span class="hs-identifier hs-var">xi1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065372"><span class="hs-identifier hs-type">xi1</span></a></span><span>
</span><span id="line-399"></span><span>            </span><span id="local-6989586621682065441"><span class="annot"><a href="#local-6989586621682065441"><span class="hs-identifier hs-var">delta0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065446"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065446"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Arg Term] -&gt; Telescope
forall t. Apply t =&gt; t -&gt; [Arg Term] -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; [Arg Term] -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) ([Arg Term] -&gt; Telescope)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
</span><a href="#local-6989586621682065378"><span class="hs-identifier hs-var">xpre</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) ([Arg Term] -&gt; Telescope)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Telescope
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Arg Term] -&gt; [Arg Term]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([Arg Term] -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
(a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065400"><span class="hs-identifier hs-var">csingl</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065446"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>            </span><span id="local-6989586621682065449"><span class="annot"><a href="#local-6989586621682065449"><span class="hs-identifier hs-var">delta0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065441"><span class="hs-identifier hs-type">delta0</span></a></span><span>
</span><span id="line-401"></span><span>            </span><span id="local-6989586621682065450"><span class="annot"><a href="#local-6989586621682065450"><span class="hs-identifier hs-var">xi0f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065455"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065455"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>                                 </span><span id="local-6989586621682065456"><span class="annot"><a href="#local-6989586621682065456"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Abs Telescope
-&gt; Term
-&gt; [Arg Term]
-&gt; Term
-&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term]
forall (m :: * -&gt; *).
(PureTCM m, MonadError TCErr m) =&gt;
Bool
-&gt; Abs Telescope
-&gt; Term
-&gt; [Arg Term]
-&gt; Term
-&gt; ExceptT (Closure (Abs Type)) m [Arg Term]
</span><a href="Agda.TypeChecking.Primitive.Cubical.html#trFillTel%27"><span class="hs-identifier hs-var">trFillTel'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682065431"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Telescope
 -&gt; Term
 -&gt; [Arg Term]
 -&gt; Term
 -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs Telescope)
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (Term
      -&gt; [Arg Term]
      -&gt; Term
      -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs Telescope)
</span><a href="#local-6989586621682065449"><span class="hs-identifier hs-var">delta0</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  (Term
   -&gt; [Arg Term]
   -&gt; Term
   -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     ([Arg Term]
      -&gt; Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065438"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  ([Arg Term]
   -&gt; Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065439"><span class="hs-identifier hs-var">xi0</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  (Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065455"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-403"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065306"><span class="hs-identifier hs-type">cantTransport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065456"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>            </span><span id="local-6989586621682065458"><span class="annot"><a href="#local-6989586621682065458"><span class="hs-identifier hs-var">xi0f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065450"><span class="hs-identifier hs-type">xi0f</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>            </span><span id="local-6989586621682065459"><span class="annot"><a href="#local-6989586621682065459"><span class="hs-identifier hs-var">delta1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065464"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065464"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>                   </span><span id="local-6989586621682065465"><span class="annot"><a href="#local-6989586621682065465"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Arg Term
 -&gt; NamesT
      (ExceptT NoLeftInv (TCMT IO))
      (NamesT (ExceptT NoLeftInv (TCMT IO)) Term))
-&gt; [Arg Term]
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
forall (m :: * -&gt; *) a.
(Monad m, Subst a) =&gt;
a -&gt; NamesT m (NamesT m a)
</span><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="annot"><span class="annottext">(Term
 -&gt; NamesT
      (ExceptT NoLeftInv (TCMT IO))
      (NamesT (ExceptT NoLeftInv (TCMT IO)) Term))
-&gt; (Arg Term -&gt; Term)
-&gt; Arg Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (NamesT (ExceptT NoLeftInv (TCMT IO)) Term)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Term
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Arg Term]
 -&gt; NamesT
      (ExceptT NoLeftInv (TCMT IO))
      [NamesT (ExceptT NoLeftInv (TCMT IO)) Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     [NamesT (ExceptT NoLeftInv (TCMT IO)) Term]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs [Arg Term] -&gt; Term -&gt; [Arg Term]
Abs [Arg Term] -&gt; SubstArg [Arg Term] -&gt; [Arg Term]
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#lazyAbsApp"><span class="hs-identifier hs-var">lazyAbsApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs [Arg Term] -&gt; Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
</span><a href="#local-6989586621682065458"><span class="hs-identifier hs-var">xi0f</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065464"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                   </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#applyN"><span class="hs-identifier hs-type">applyN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065379"><span class="hs-identifier hs-type">krest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065404"><span class="hs-identifier hs-type">csingl'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682065465"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`fmap`</span></span><span> </span><span class="annot"><a href="#local-6989586621682065400"><span class="hs-identifier hs-type">csingl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>            </span><span id="local-6989586621682065468"><span class="annot"><a href="#local-6989586621682065468"><span class="hs-identifier hs-var">delta1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065459"><span class="hs-identifier hs-type">delta1</span></a></span><span>
</span><span id="line-411"></span><span>            </span><span id="local-6989586621682065469"><span class="annot"><a href="#local-6989586621682065469"><span class="hs-identifier hs-var">xi1f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065474"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065474"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>                                 </span><span id="local-6989586621682065475"><span class="annot"><a href="#local-6989586621682065475"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Abs Telescope
-&gt; Term
-&gt; [Arg Term]
-&gt; Term
-&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term]
forall (m :: * -&gt; *).
(PureTCM m, MonadError TCErr m) =&gt;
Bool
-&gt; Abs Telescope
-&gt; Term
-&gt; [Arg Term]
-&gt; Term
-&gt; ExceptT (Closure (Abs Type)) m [Arg Term]
</span><a href="Agda.TypeChecking.Primitive.Cubical.html#trFillTel%27"><span class="hs-identifier hs-var">trFillTel'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682065431"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Telescope
 -&gt; Term
 -&gt; [Arg Term]
 -&gt; Term
 -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs Telescope)
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (Term
      -&gt; [Arg Term]
      -&gt; Term
      -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs Telescope)
</span><a href="#local-6989586621682065468"><span class="hs-identifier hs-var">delta1</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  (Term
   -&gt; [Arg Term]
   -&gt; Term
   -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     ([Arg Term]
      -&gt; Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065438"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  ([Arg Term]
   -&gt; Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065440"><span class="hs-identifier hs-var">xi1</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT
  (ExceptT NoLeftInv (TCMT IO))
  (Term -&gt; ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT
     (ExceptT NoLeftInv (TCMT IO))
     (ExceptT (Closure (Abs Type)) (TCMT IO) [Arg Term])
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065474"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-413"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065306"><span class="hs-identifier hs-type">cantTransport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065475"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>            </span><span id="local-6989586621682065476"><span class="annot"><a href="#local-6989586621682065476"><span class="hs-identifier hs-var">xi1f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065469"><span class="hs-identifier hs-type">xi1f</span></a></span><span>
</span><span id="line-415"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-type">absBody</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Names.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682065481"><span class="annot"><span class="annottext">forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065481"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065490"><span class="annot"><span class="annottext">+++ :: m [a] -&gt; m [a] -&gt; m [a]
</span><a href="#local-6989586621682065490"><span class="hs-operator hs-var hs-var">(+++)</span></a></span></span><span> </span><span id="local-6989586621682065491"><span class="annot"><span class="annottext">m [a]
</span><a href="#local-6989586621682065491"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a] -&gt; [a]) -&gt; m [a] -&gt; m [a] -&gt; m [a]
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">m [a]
</span><a href="#local-6989586621682065491"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-417"></span><span>                  </span><span id="local-6989586621682065493"><span class="annot"><span class="annottext">i :: NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065493"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; NamesT m a
</span><a href="Agda.TypeChecking.Names.html#cl"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Term -&gt; ExceptT NoLeftInv (TCMT IO) Term
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT NoLeftInv m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primINeg"><span class="hs-identifier hs-var">primINeg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall (m :: * -&gt; *). Applicative m =&gt; m Term -&gt; m Term -&gt; m Term
</span><a href="Agda.TypeChecking.Primitive.Base.html#%3C%40%3E"><span class="hs-operator hs-var">&lt;@&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
forall b.
(Subst b, DeBruijn b) =&gt;
NamesT (ExceptT NoLeftInv (TCMT IO)) b
</span><a href="#local-6989586621682065481"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-418"></span><span>              </span><span class="annot"><span class="annottext">([Arg Term] -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
(a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation -&gt; [Arg Term] -&gt; [Arg Term]
forall a. Permutation -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.Permutation.html#permute"><span class="hs-identifier hs-var">permute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Permutation -&gt; Permutation
</span><a href="Agda.Utils.Permutation.html#invertP"><span class="hs-identifier hs-var">invertP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation
</span><a href="#local-6989586621682065337"><span class="hs-identifier hs-var">permw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
 -&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-419"></span><span>                </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065437"><span class="hs-identifier hs-var">gamma1_args</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall {m :: * -&gt; *} {a}. Monad m =&gt; m [a] -&gt; m [a] -&gt; m [a]
</span><a href="#local-6989586621682065490"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Arg Term] -&gt; [Arg Term]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([Arg Term] -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
(a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065400"><span class="hs-identifier hs-var">csingl</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065493"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall {m :: * -&gt; *} {a}. Monad m =&gt; m [a] -&gt; m [a] -&gt; m [a]
</span><a href="#local-6989586621682065490"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs [Arg Term] -&gt; Term -&gt; [Arg Term]
Abs [Arg Term] -&gt; SubstArg [Arg Term] -&gt; [Arg Term]
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#lazyAbsApp"><span class="hs-identifier hs-var">lazyAbsApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs [Arg Term] -&gt; Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
</span><a href="#local-6989586621682065458"><span class="hs-identifier hs-var">xi0f</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065493"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall {m :: * -&gt; *} {a}. Monad m =&gt; m [a] -&gt; m [a] -&gt; m [a]
</span><a href="#local-6989586621682065490"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Arg Term] -&gt; [Arg Term]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([Arg Term] -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
(a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
</span><a href="#local-6989586621682065400"><span class="hs-identifier hs-var">csingl</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065493"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall {m :: * -&gt; *} {a}. Monad m =&gt; m [a] -&gt; m [a] -&gt; m [a]
</span><a href="#local-6989586621682065490"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs [Arg Term] -&gt; Term -&gt; [Arg Term]
Abs [Arg Term] -&gt; SubstArg [Arg Term] -&gt; [Arg Term]
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#lazyAbsApp"><span class="hs-identifier hs-var">lazyAbsApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs [Arg Term] -&gt; Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Abs [Arg Term])
</span><a href="#local-6989586621682065476"><span class="hs-identifier hs-var">xi1f</span></a></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) (Term -&gt; [Arg Term])
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) Term
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) [Arg Term]
forall a b.
NamesT (ExceptT NoLeftInv (TCMT IO)) (a -&gt; b)
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) a
-&gt; NamesT (ExceptT NoLeftInv (TCMT IO)) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamesT (ExceptT NoLeftInv (TCMT IO)) Term
</span><a href="#local-6989586621682065493"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065432"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682065436"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682065359"><span class="hs-identifier hs-type">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621682065496"><span class="annot"><a href="#local-6989586621682065496"><span class="hs-identifier hs-var">iz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Builtin.html#primIZero"><span class="hs-identifier hs-type">primIZero</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621682065498"><span class="annot"><a href="#local-6989586621682065498"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Builtin.html#primIOne"><span class="hs-identifier hs-type">primIOne</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;tau    :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-type">setHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-type">NotHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065342"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;tauS   :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-type">termsS</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065342"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-type">defaultDom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065331"><span class="hs-identifier hs-type">interval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>                               </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leftInv:   &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-type">setHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-type">NotHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065343"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leftInv[0]:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-type">reduce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#subst"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621682065496"><span class="hs-identifier hs-type">iz</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-type">setHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-type">NotHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065343"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leftInv[1]:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-type">reduce</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#subst"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621682065498"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-type">setHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-type">NotHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065343"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[rho]tau :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-430"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-identifier hs-type">applySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-type">termsS</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065342"><span class="hs-identifier hs-type">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#fromPatternSubstitution"><span class="hs-identifier hs-type">fromPatternSubstitution</span></a></span><span>
</span><span id="line-431"></span><span>                                                                      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682065330"><span class="hs-identifier hs-type">phis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>                                                                      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#unifySubst"><span class="hs-identifier hs-var">unifySubst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065300"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065504"><span class="annot"><a href="#local-6989586621682065504"><span class="hs-identifier hs-var hs-var">rho0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatternSubstitution -&gt; Substitution
</span><a href="Agda.TypeChecking.Substitute.html#fromPatternSubstitution"><span class="hs-identifier hs-var">fromPatternSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">(PatternSubstitution -&gt; Substitution)
-&gt; PatternSubstitution -&gt; Substitution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyOutput -&gt; PatternSubstitution
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#unifySubst"><span class="hs-identifier hs-var">unifySubst</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065300"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-436"></span><span>          </span><span class="annot"><span class="hs-string">&quot;prf :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#fromPatternSubstitution"><span class="hs-identifier hs-type">fromPatternSubstitution</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#unifyProof"><span class="hs-identifier hs-var">unifyProof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065300"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065506"><span class="annot"><a href="#local-6989586621682065506"><span class="hs-identifier hs-var hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Abs Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Term -&gt; Term) -&gt; Abs Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Term -&gt; Abs Term
forall a. String -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;i&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Abs Term) -&gt; Term -&gt; Abs Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term -&gt; Term
forall a. Subst a =&gt; Int -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; Int -&gt; Term
forall a. EndoSubst a =&gt; Substitution' a -&gt; Int -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#lookupS"><span class="hs-identifier hs-var">lookupS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternSubstitution -&gt; Substitution
</span><a href="Agda.TypeChecking.Substitute.html#fromPatternSubstitution"><span class="hs-identifier hs-var">fromPatternSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">(PatternSubstitution -&gt; Substitution)
-&gt; PatternSubstitution -&gt; Substitution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyOutput -&gt; PatternSubstitution
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#unifyProof"><span class="hs-identifier hs-var">unifyProof</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065300"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065328"><span class="hs-identifier hs-var">neqs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065295"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065509"><span class="annot"><a href="#local-6989586621682065509"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Substitution -&gt; Substitution
forall a. Int -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Int) -&gt; Telescope -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065301"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Substitution
forall a. Int -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raiseS"><span class="hs-identifier hs-var">raiseS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Substitution' (SubstArg Term) -&gt; Term -&gt; Term
forall a. Subst a =&gt; Substitution' (SubstArg a) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-operator hs-var">`applySubst`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065506"><span class="hs-identifier hs-var">c0</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&#966;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-type">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-440"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;c :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065509"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065510"><span class="annot"><a href="#local-6989586621682065510"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term -&gt; Substitution
forall a. DeBruijn a =&gt; Int -&gt; a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#singletonS"><span class="hs-identifier hs-var">singletonS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065328"><span class="hs-identifier hs-var">neqs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065295"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065509"><span class="hs-identifier hs-var">c</span></a></span><span>  </span><span class="annot"><span class="annottext">Substitution -&gt; Substitution -&gt; Substitution
forall a.
EndoSubst a =&gt;
Substitution' a -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#composeS"><span class="hs-operator hs-var">`composeS`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Substitution -&gt; Substitution
forall a. Int -&gt; Substitution' a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065328"><span class="hs-identifier hs-var">neqs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065504"><span class="hs-identifier hs-var">rho0</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;old_sizes: &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065293"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;new_sizes: &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&#966;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-type">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-type">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065301"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-445"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rho   :&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065510"><span class="hs-identifier hs-type">rho</span></a></span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065335"><span class="hs-identifier hs-type">working_tel</span></a></span><span>
</span><span id="line-447"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682065510"><span class="hs-identifier hs-type">rho</span></a></span><span>
</span><span id="line-448"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-type">termsS</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065342"><span class="hs-identifier hs-type">tau</span></a></span><span>
</span><span id="line-449"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#termsS"><span class="hs-identifier hs-type">termsS</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065343"><span class="hs-identifier hs-type">leftInv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682065344"><span class="hs-identifier hs-type">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#buildEquiv"><span class="hs-identifier hs-var">buildEquiv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DUnificationStep"><span class="hs-identifier hs-type">DUnificationStep</span></a></span><span> </span><span id="local-6989586621682065512"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065512"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621682065513"><span class="annot"><span class="annottext">step :: DigestedUnifyStep
</span><a href="#local-6989586621682065513"><span class="hs-identifier hs-var">step</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#DEtaExpandVar"><span class="hs-identifier hs-type">DEtaExpandVar</span></a></span><span> </span><span id="local-6989586621682065514"><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065514"><span class="hs-identifier hs-var">fv</span></a></span></span><span> </span><span id="local-6989586621682065515"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682065515"><span class="hs-identifier hs-var">_d</span></a></span></span><span> </span><span id="local-6989586621682065516"><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682065516"><span class="hs-identifier hs-var">_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682065517"><span class="annot"><span class="annottext">UnifyOutput
</span><a href="#local-6989586621682065517"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682065518"><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065518"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT NoLeftInv (TCMT IO) (Retract, Term)
-&gt; TCMT IO (Either NoLeftInv (Retract, Term))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT NoLeftInv (TCMT IO) (Retract, Term)
 -&gt; TCMT IO (Either NoLeftInv (Retract, Term)))
-&gt; ExceptT NoLeftInv (TCMT IO) (Retract, Term)
-&gt; TCMT IO (Either NoLeftInv (Retract, Term))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;buildEquiv EtaExpandVar&quot;</span></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-454"></span><span>          </span><span id="local-6989586621682065519"><span class="annot"><span class="annottext">gamma :: Telescope
</span><a href="#local-6989586621682065519"><span class="hs-identifier hs-var hs-var hs-var">gamma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#varTel"><span class="hs-identifier hs-var">varTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065512"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-455"></span><span>          </span><span id="local-6989586621682065520"><span class="annot"><span class="annottext">eqs :: Telescope
</span><a href="#local-6989586621682065520"><span class="hs-identifier hs-var hs-var hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnifyState -&gt; Telescope
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyState
</span><a href="#local-6989586621682065512"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-456"></span><span>          </span><span id="local-6989586621682065521"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621682065521"><span class="hs-identifier hs-var hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int -&gt; Int
forall a. FlexibleVar a -&gt; a
</span><a href="Agda.TypeChecking.Rules.LHS.Problem.html#flexVar"><span class="hs-identifier hs-var">flexVar</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleVar Int
</span><a href="#local-6989586621682065514"><span class="hs-identifier hs-var">fv</span></a></span><span>
</span><span id="line-457"></span><span>          </span><span id="local-6989586621682065522"><span class="annot"><span class="annottext">neqs :: Int
</span><a href="#local-6989586621682065522"><span class="hs-identifier hs-var hs-var hs-var">neqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065520"><span class="hs-identifier hs-var">eqs</span></a></span><span>
</span><span id="line-458"></span><span>          </span><span id="local-6989586621682065524"><span class="annot"><span class="annottext">phis :: Int
</span><a href="#local-6989586621682065524"><span class="hs-identifier hs-var hs-var hs-var">phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621682065525"><span class="annot"><a href="#local-6989586621682065525"><span class="hs-identifier hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Type -&gt; ExceptT NoLeftInv (TCMT IO) Type
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT NoLeftInv m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Type
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Type
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#primIntervalType"><span class="hs-identifier hs-var">primIntervalType</span></a></span><span>
</span><span id="line-460"></span><span>         </span><span class="hs-comment">-- &#915;, &#966;s : I^phis</span><span>
</span><span id="line-461"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065526"><span class="annot"><a href="#local-6989586621682065526"><span class="hs-identifier hs-var hs-var">gamma_phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065519"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Telescope) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ListTel -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList"><span class="hs-identifier hs-var">telFromList</span></a></span><span> </span><span class="annot"><span class="annottext">(ListTel -&gt; Telescope) -&gt; ListTel -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-462"></span><span>              </span><span class="annot"><span class="annottext">(Int -&gt; Dom (String, Type)) -&gt; [Int] -&gt; ListTel
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Type) -&gt; Dom (String, Type)
forall a. a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-var">defaultDom</span></a></span><span> </span><span class="annot"><span class="annottext">((String, Type) -&gt; Dom (String, Type))
-&gt; (Int -&gt; (String, Type)) -&gt; Int -&gt; Dom (String, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682065525"><span class="hs-identifier hs-var">interval</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, Type))
-&gt; (Int -&gt; String) -&gt; Int -&gt; (String, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phi&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (Int -&gt; String) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065524"><span class="hs-identifier hs-var">phis</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621682065527"><span class="annot"><a href="#local-6989586621682065527"><span class="hs-identifier hs-var">working_tel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-type">abstract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065526"><span class="hs-identifier hs-type">gamma_phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">withExceptT</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#CantTransport%27"><span class="hs-identifier hs-type">CantTransport'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-465"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.html#pathTelescope%27"><span class="hs-identifier hs-type">pathTelescope'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065524"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqTel"><span class="hs-identifier hs-var">eqTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065512"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065524"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqLHS"><span class="hs-identifier hs-var">eqLHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065512"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065524"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#eqRHS"><span class="hs-identifier hs-var">eqRHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065512"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065528"><span class="annot"><a href="#local-6989586621682065528"><span class="hs-identifier hs-var hs-var">raiseFrom</span></a></span></span><span> </span><span id="local-6989586621682065529"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065529"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682065530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065530"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065527"><span class="hs-identifier hs-var">working_tel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int
forall a. Sized a =&gt; a -&gt; Int
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065529"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682065530"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682065531"><span class="annot"><a href="#local-6989586621682065531"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Term) -&gt; Int -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Int -&gt; Int
</span><a href="#local-6989586621682065528"><span class="hs-identifier hs-var">raiseFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065526"><span class="hs-identifier hs-var">gamma_phis</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><a href="Agda.Utils.Maybe.html#caseMaybeM"><span class="hs-identifier hs-type">caseMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Records.html#expandRecordVar"><span class="hs-identifier hs-type">expandRecordVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682065528"><span class="hs-identifier hs-type">raiseFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065519"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065521"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682065527"><span class="hs-identifier hs-type">working_tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682065534"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065534"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682065535"><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065535"><span class="hs-identifier hs-var">rho</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tc.lhs.unify.inv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ())
-&gt; TCM Doc -&gt; ExceptT NoLeftInv (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc -&gt; TCM Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065527"><span class="hs-identifier hs-var">working_tel</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;tau    :&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Substitution -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065534"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-471"></span><span>          </span><span class="annot"><span class="annottext">(Retract, Term) -&gt; ExceptT NoLeftInv (TCMT IO) (Retract, Term)
forall a. a -&gt; ExceptT NoLeftInv (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Retract, Term) -&gt; ExceptT NoLeftInv (TCMT IO) (Retract, Term))
-&gt; (Retract, Term) -&gt; ExceptT NoLeftInv (TCMT IO) (Retract, Term)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682065527"><span class="hs-identifier hs-var">working_tel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065535"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Substitution
</span><a href="#local-6989586621682065534"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Substitution
forall a. Int -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raiseS"><span class="hs-identifier hs-var">raiseS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682065531"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-pragma hs-type">explainStep</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyStep"><span class="hs-pragma hs-type">UnifyStep</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-pragma hs-type">Doc</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-475"></span><span id="local-6989586621682065537"><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-type">explainStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682065537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#UnifyStep"><span class="hs-identifier hs-type">UnifyStep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682065537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span></span><span>
</span><span id="line-476"></span><span id="explainStep"><span class="annot"><span class="annottext">explainStep :: forall (m :: * -&gt; *). MonadPretty m =&gt; UnifyStep -&gt; m Doc
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var hs-var">explainStep</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">injectConstructor :: UnifyStep -&gt; ConHead
</span><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#injectConstructor"><span class="hs-identifier hs-var">injectConstructor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682065559"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682065559"><span class="hs-identifier hs-var">ch</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;injectivity of the data constructor&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682065559"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#TypeConInjectivity"><span class="hs-identifier hs-type">TypeConInjectivity</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;injectivity of type constructors&quot;</span></span><span>
</span><span id="line-479"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Deletion"><span class="hs-identifier hs-type">Deletion</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;the K rule&quot;</span></span><span>
</span><span id="line-480"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;substitution in Set&#969;&quot;</span></span><span>
</span><span id="line-481"></span><span class="hs-comment">-- Note: this is the actual reason that a Solution step can fail, rather</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- than the explanation for the actual step</span><span>
</span><span id="line-483"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Conflict"><span class="hs-identifier hs-type">Conflict</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;the disjointness of data constructors&quot;</span></span><span>
</span><span id="line-484"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#LitConflict"><span class="hs-identifier hs-type">LitConflict</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;the disjointness of literal values&quot;</span></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#Cycle"><span class="hs-identifier hs-type">Cycle</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;the impossibility of cyclic values&quot;</span></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#EtaExpandVar"><span class="hs-identifier hs-type">EtaExpandVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;eta-expansion of variables&quot;</span></span><span>
</span><span id="line-487"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#EtaExpandEquation"><span class="hs-identifier hs-type">EtaExpandEquation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;eta-expansion of equations&quot;</span></span><span>
</span><span id="line-488"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#StripSizeSuc"><span class="hs-identifier hs-type">StripSizeSuc</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;the injectivity of size successors&quot;</span></span><span>
</span><span id="line-489"></span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.LeftInverse.html#explainStep"><span class="hs-identifier hs-var">explainStep</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Unify.Types.html#SkipIrrelevantEquation"><span class="hs-identifier hs-type">SkipIrrelevantEquation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;ignoring irrelevant equations&quot;</span></span><span>
</span><span id="line-490"></span></pre></body></html>