<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">{-| Compile-time irrelevance.

In type theory with compile-time irrelevance &#224; la Pfenning (LiCS 2001),
variables in the context are annotated with relevance attributes.
@@
  &#915; = r&#8321;x&#8321;:A&#8321;, ..., r&#11388;x&#11388;:A&#11388;
@@
To handle irrelevant projections, we also record the current relevance
attribute in the judgement.  For instance, this attribute is equal to
to 'Irrelevant' if we are in an irrelevant position, like an
irrelevant argument.
@@
  &#915; &#8866;r t : A
@@
Only relevant variables can be used:
@@

  (Relevant x : A) &#8712; &#915;
  --------------------
  &#915;  &#8866;r  x  :  A
@@
Irrelevant global declarations can only be used if @r = Irrelevant@.

When we enter a @r'@-relevant function argument, we compose the @r@ with @r'@
and (left-)divide the attributes in the context by @r'@.
@@
  &#915;  &#8866;r  t  :  (r' x : A) &#8594; B      r' \ &#915;  &#8866;(r'&#183;r)  u  :  A
  ---------------------------------------------------------
  &#915;  &#8866;r  t u  :  B[u/x]
@@
No surprises for abstraction:
@@

  &#915;, (r' x : A)  &#8866;r  :  B
  -----------------------------
  &#915;  &#8866;r  &#955;xt  :  (r' x : A) &#8594; B
@@

This is different for runtime irrelevance (erasure) which is ``flat'',
meaning that once one is in an irrelevant context, all new assumptions will
be usable, since they are turned relevant once entering the context.
See Conor McBride (WadlerFest 2016), for a type system in this spirit:

We use such a rule for runtime-irrelevance:
@@
  &#915;, (q \ q') x : A  &#8866;q  t  :  B
  ------------------------------
  &#915;  &#8866;q  &#955;xt  :  (q' x : A) &#8594; B
@@

Conor's system is however set up differently, with a very different
variable rule:

@@

  (q x : A) &#8712; &#915;
  --------------
  &#915;  &#8866;q  x  :  A

  &#915;, (q&#183;p) x : A  &#8866;q  t  :  B
  -----------------------------
  &#915;  &#8866;q  &#955;xt  :  (p x : A) &#8594; B

  &#915;  &#8866;q  t  :  (p x : A) &#8594; B       &#915;'  &#8866;qp  u  :  A
  -------------------------------------------------
  &#915; + &#915;'  &#8866;q  t u  :  B[u/x]
@@


-}</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html"><span class="hs-identifier">Agda.TypeChecking.Irrelevance</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html"><span class="hs-identifier">Agda.TypeChecking.Substitute.Class</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Either.html"><span class="hs-identifier">Agda.Utils.Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Either.html#fromRightM"><span class="hs-identifier">fromRightM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Check whether something can be used in a position of the given relevance.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">--   This is a substitute for double-checking that only makes sure</span><span>
</span><span id="line-98"></span><span class="hs-comment">--   relevances are correct.  See issue #2640.</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">--   Used in unifier (@ unifyStep Solution{}@).</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">--   At the moment, this implements McBride-style irrelevance,</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   where Pfenning-style would be the most accurate thing.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   However, these two notions only differ how they handle</span><span>
</span><span id="line-105"></span><span class="hs-comment">--   bound variables in a term.  Here, we are only concerned</span><span>
</span><span id="line-106"></span><span class="hs-comment">--   in the free variables, used meta-variables, and used</span><span>
</span><span id="line-107"></span><span class="hs-comment">--   (irrelevant) definitions.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-keyword">class</span><span> </span><span id="UsableRelevance"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-var">UsableRelevance</span></a></span></span><span> </span><span id="local-6989586621682055979"><span class="annot"><a href="#local-6989586621682055979"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="usableRel"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-type">usableRel</span></a></span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682055972"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682055972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682055972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682055972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682055979"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682055972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621682056449"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056450"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682056452"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682056452"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682056453"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056453"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621682056454"><span class="annot"><a href="#local-6989586621682056454"><span class="hs-identifier hs-var">irel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Relevance) -&gt; m (Dom Type) -&gt; m Relevance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m (Dom Type)
forall (m :: * -&gt; *).
(MonadDebug m, MonadTCEnv m) =&gt;
Int -&gt; m (Dom Type)
</span><a href="Agda.TypeChecking.Monad.Context.html#domOfBV"><span class="hs-identifier hs-var">domOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682056452"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056458"><span class="annot"><a href="#local-6989586621682056458"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056454"><span class="hs-identifier hs-var">irel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-var">`moreRelevant`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Variable&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056452"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;has relevance &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056454"><span class="hs-identifier hs-type">irel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, which is &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-122"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682056458"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;more relevant than &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682056458"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-type">usableRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056453"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621682056468"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056468"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682056469"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056469"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>      </span><span id="local-6989586621682056470"><span class="annot"><a href="#local-6989586621682056470"><span class="hs-identifier hs-var">frel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Relevance
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Relevance
</span><a href="Agda.TypeChecking.Monad.Signature.html#relOfConst"><span class="hs-identifier hs-var">relOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056468"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682056470"><span class="hs-identifier hs-type">frel</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-type">`moreRelevant`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-type">usableRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056469"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621682056473"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682056473"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056474"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056474"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Elims -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056474"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682056476"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682056476"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056478"><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621682056478"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Abs Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621682056478"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621682056480"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056480"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682056481"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621682056481"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Dom Type, Abs Type) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; (Dom Type, Abs Type) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056480"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621682056481"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621682056483"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056483"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056483"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621682056485"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621682056485"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621682056487"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056487"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682056488"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056488"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621682056489"><span class="annot"><a href="#local-6989586621682056489"><span class="hs-identifier hs-var">mrel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; Relevance) -&gt; m Modality -&gt; m Relevance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Modality
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupMetaModality"><span class="hs-identifier hs-var">lookupMetaModality</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056487"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682056489"><span class="hs-identifier hs-type">mrel</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-type">`moreRelevant`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-type">usableRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056450"><span class="hs-identifier hs-type">rel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056488"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621682056492"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056492"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056450"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056492"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-comment">-- TODO: allow irrelevant things to be used in DontCare position?</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056032"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type%27"><span class="hs-identifier hs-type">Type'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621682056503"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Type' a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056504"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056504"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056506"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056506"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056504"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056506"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621682056552"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056553"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Univ"><span class="hs-identifier hs-type">Univ</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056555"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621682056555"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Level -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Level -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621682056555"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-var">SizeUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-var">LockUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#LevelUniv"><span class="hs-identifier hs-var">LevelUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-var">IntervalUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span> </span><span id="local-6989586621682056562"><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621682056562"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682056563"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056563"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682056564"><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621682056564"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Dom' Term Term, Sort, Abs Sort) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; (Dom' Term Term, Sort, Abs Sort) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621682056562"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056563"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621682056564"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span> </span><span id="local-6989586621682056566"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056566"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682056567"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056567"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Sort, Sort) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; (Sort, Sort) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056566"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056567"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span> </span><span id="local-6989586621682056569"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056569"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056569"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span> </span><span id="local-6989586621682056571"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056571"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682056572"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056572"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Elims -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056572"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span> </span><span id="local-6989586621682056574"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056574"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682056575"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056575"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056553"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Bool) -&gt; Term -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056574"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056575"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621682056587"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Level -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056588"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056588"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056590"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621682056590"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056588"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621682056590"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#PlusLevel"><span class="hs-identifier hs-type">PlusLevel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621682056600"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; PlusLevel' Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056601"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056601"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Plus"><span class="hs-identifier hs-type">Plus</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056603"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056603"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056601"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056603"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056031"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056031"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682056031"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621682056617"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; [a] -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056618"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056618"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Bool] -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, Monad m) =&gt;
f (m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#andM"><span class="hs-identifier hs-var">andM</span></a></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; m Bool) -&gt; ([a] -&gt; [m Bool]) -&gt; [a] -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m Bool) -&gt; [a] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056618"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056029"><span id="local-6989586621682056030"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056030"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682056029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682056030"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621682056637"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; (a, b) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056638"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056638"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682056639"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056639"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682056640"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682056640"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056638"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056639"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; b -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056638"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682056640"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056067"><span id="local-6989586621682056068"><span id="local-6989586621682056069"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056068"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056069"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682056067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682056068"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682056069"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621682056663"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; (a, b, c) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056664"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056664"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682056665"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056665"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682056666"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682056666"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682056667"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682056667"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056664"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056665"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; b -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056664"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682056666"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; c -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; c -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056664"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682056667"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056028"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056028"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Elim%27"><span class="hs-identifier hs-type">Elim'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056028"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621682056686"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Elim' a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056687"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056687"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621682056689"><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621682056689"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Arg a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Arg a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056687"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621682056689"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span id="local-6989586621682056690"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056690"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682056692"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056692"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621682056693"><span class="annot"><a href="#local-6989586621682056693"><span class="hs-identifier hs-var">prel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Relevance
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Relevance
</span><a href="Agda.TypeChecking.Monad.Signature.html#relOfConst"><span class="hs-identifier hs-var">relOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056692"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682056693"><span class="hs-identifier hs-type">prel</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-type">`moreRelevant`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056690"><span class="hs-identifier hs-type">rel</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span id="local-6989586621682056694"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056694"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span> </span><span id="local-6989586621682056696"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056696"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682056697"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056697"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682056698"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056698"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056694"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056698"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056093"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056093"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621682056710"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Arg a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056711"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056711"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682056713"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682056713"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682056714"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056714"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056715"><span class="annot"><span class="annottext">rel' :: Relevance
</span><a href="#local-6989586621682056715"><span class="hs-identifier hs-var hs-var">rel'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682056713"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056711"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#composeRelevance"><span class="hs-operator hs-var">`composeRelevance`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056715"><span class="hs-identifier hs-var">rel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056714"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056027"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056027"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056027"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621682056726"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Dom a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056727"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056727"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682056730"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056730"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056727"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056730"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056026"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621682056743"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621682056744"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056744"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621682056745"><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621682056745"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Abs a -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction_"><span class="hs-identifier hs-var">underAbstraction_</span></a></span><span> </span><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621682056745"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682056747"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056747"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621682056744"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682056747"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Check whether something can be used in a position of the given modality.</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">--   This is a substitute for double-checking that only makes sure</span><span>
</span><span id="line-193"></span><span class="hs-comment">--   modalities are correct.  See issue #2640.</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">--   Used in unifier (@ unifyStep Solution{}@).</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">--   This uses McBride-style modality checking.</span><span>
</span><span id="line-198"></span><span class="hs-comment">--   It does not differ from Pfenning-style if we</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   are only interested in the modality of the</span><span>
</span><span id="line-200"></span><span class="hs-comment">--   free variables, used meta-variables, and used</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   definitions.</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="hs-keyword">class</span><span> </span><span id="UsableModality"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-var">UsableModality</span></a></span></span><span> </span><span id="local-6989586621682056111"><span class="annot"><a href="#local-6989586621682056111"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="usableMod"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682056106"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-type">MonadReduce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056111"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056106"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621682056945"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682056946"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621682056947"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056947"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682056947"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682056948"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682056948"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682056949"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056949"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621682056950"><span class="annot"><a href="#local-6989586621682056950"><span class="hs-identifier hs-var">imod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Modality) -&gt; m (Dom Type) -&gt; m Modality
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m (Dom Type)
forall (m :: * -&gt; *).
(MonadDebug m, MonadTCEnv m) =&gt;
Int -&gt; m (Dom Type)
</span><a href="Agda.TypeChecking.Monad.Context.html#domOfBV"><span class="hs-identifier hs-var">domOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682056948"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056952"><span class="annot"><a href="#local-6989586621682056952"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056950"><span class="hs-identifier hs-var">imod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Variable&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056948"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056950"><span class="hs-identifier hs-type">imod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-217"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682056952"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682056952"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056949"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621682056954"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056954"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682056955"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056955"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621682056956"><span class="annot"><a href="#local-6989586621682056956"><span class="hs-identifier hs-var">fmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682056954"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- Pure modalities don't matter here, only positional ones, hence remove</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">-- them from the equation.</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056958"><span class="annot"><a href="#local-6989586621682056958"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolarityModality -&gt; Modality -&gt; Modality
forall a. LensModalPolarity a =&gt; PolarityModality -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setModalPolarity"><span class="hs-identifier hs-var">setModalPolarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModalPolarity -&gt; PolarityModality
</span><a href="Agda.Syntax.Common.html#withStandardLock"><span class="hs-identifier hs-var">withStandardLock</span></a></span><span> </span><span class="annot"><span class="annottext">ModalPolarity
</span><a href="Agda.Syntax.Common.html#MixedPolarity"><span class="hs-identifier hs-var">MixedPolarity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; Modality -&gt; Modality
forall a. LensCohesion a =&gt; Cohesion -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setCohesion"><span class="hs-identifier hs-var">setCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#Flat"><span class="hs-identifier hs-var">Flat</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056956"><span class="hs-identifier hs-var">fmod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Definition&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056954"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056956"><span class="hs-identifier hs-type">fmod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-227"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682056958"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682056958"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056955"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621682056964"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682056964"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682056965"><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621682056965"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621682056966"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056966"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621682056967"><span class="annot"><a href="#local-6989586621682056967"><span class="hs-identifier hs-var">cmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682056964"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056969"><span class="annot"><a href="#local-6989586621682056969"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056967"><span class="hs-identifier hs-var">cmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="hs-string">&quot;The constructor&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056964"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056965"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;has the modality &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056967"><span class="hs-identifier hs-type">cmod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, which is &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-235"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682056969"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-236"></span><span>              </span><span class="annot"><span class="hs-string">&quot;more usable than the modality &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682056969"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056966"><span class="hs-identifier hs-type">vs</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682056970"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682056970"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621682056971"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682056971"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682056972"><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621682056972"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, HasConstInfo m,
 MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var">usableModAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682056971"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621682056972"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- Even if Pi contains Type, here we check it as a constructor for terms in the universe.</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621682056974"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682056975"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621682056975"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056976"><span class="hs-identifier hs-var">domMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Type -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, HasConstInfo m,
 MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var">usableModAbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; ArgInfo
forall a. LensArgInfo a =&gt; a -&gt; ArgInfo
</span><a href="Agda.Syntax.Common.html#getArgInfo"><span class="hs-identifier hs-var">getArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Abs Type -&gt; Abs Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621682056975"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>        </span><span id="local-6989586621682056976"><span class="annot"><span class="annottext">domMod :: Modality
</span><a href="#local-6989586621682056976"><span class="hs-identifier hs-var hs-var">domMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity) -&gt; Modality -&gt; Modality
forall a. LensQuantity a =&gt; (Quantity -&gt; Quantity) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapQuantity"><span class="hs-identifier hs-var">mapQuantity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#composeQuantity"><span class="hs-identifier hs-var">composeQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity -&gt; Quantity)
-&gt; Quantity -&gt; Quantity -&gt; Quantity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; Modality) -&gt; Modality -&gt; Modality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-244"></span><span>                 </span><span class="annot"><span class="annottext">(Cohesion -&gt; Cohesion) -&gt; Modality -&gt; Modality
forall a. LensCohesion a =&gt; (Cohesion -&gt; Cohesion) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapCohesion"><span class="hs-identifier hs-var">mapCohesion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#composeCohesion"><span class="hs-identifier hs-var">composeCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">(Cohesion -&gt; Cohesion -&gt; Cohesion)
-&gt; Cohesion -&gt; Cohesion -&gt; Cohesion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; Modality) -&gt; Modality -&gt; Modality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-245"></span><span>                 </span><span class="annot"><span class="annottext">(PolarityModality -&gt; PolarityModality) -&gt; Modality -&gt; Modality
forall a.
LensModalPolarity a =&gt;
(PolarityModality -&gt; PolarityModality) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapModalPolarity"><span class="hs-identifier hs-var">mapModalPolarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolarityModality -&gt; PolarityModality -&gt; PolarityModality
</span><a href="Agda.Syntax.Common.html#composePolarity"><span class="hs-identifier hs-var">composePolarity</span></a></span><span> </span><span class="annot"><span class="annottext">(PolarityModality -&gt; PolarityModality -&gt; PolarityModality)
-&gt; PolarityModality -&gt; PolarityModality -&gt; PolarityModality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; PolarityModality
forall a. LensModalPolarity a =&gt; a -&gt; PolarityModality
</span><a href="Agda.Syntax.Common.html#getModalPolarity"><span class="hs-identifier hs-var">getModalPolarity</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682056974"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">-- Andrea 15/10/2020 not updating these cases yet, but they are quite suspicious,</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- do we have special typing rules for Sort and Level?</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621682056988"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056988"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682056988"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621682056989"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621682056989"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621682056990"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056990"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682056991"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682056991"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621682056992"><span class="annot"><a href="#local-6989586621682056992"><span class="hs-identifier hs-var">mmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Modality
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupMetaModality"><span class="hs-identifier hs-var">lookupMetaModality</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056990"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682056993"><span class="annot"><a href="#local-6989586621682056993"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056992"><span class="hs-identifier hs-var">mmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Metavariable&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056992"><span class="hs-identifier hs-type">mmod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-256"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682056993"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682056993"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-type">`and2M`</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056991"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-type">`or2M`</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621682056995"><span class="annot"><a href="#local-6989586621682056995"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiate"><span class="hs-identifier hs-type">instantiate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056947"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-type">caseMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#isMeta"><span class="hs-identifier hs-type">isMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056995"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056946"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056995"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682056999"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056999"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; m Bool
forall a. Blocker -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Blocker
</span><a href="Agda.Syntax.Internal.Blockers.html#UnblockOnMeta"><span class="hs-identifier hs-var">UnblockOnMeta</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621682056999"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621682057002"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057002"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682056946"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057002"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span id="local-6989586621682056142"><span id="local-6989586621682056143"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-type">usableModAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-type">MonadReduce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-264"></span><span>                      </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056142"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056143"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-265"></span><span id="usableModAbs"><span class="annot"><span class="annottext">usableModAbs :: forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, HasConstInfo m,
 MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var hs-var">usableModAbs</span></a></span></span><span> </span><span id="local-6989586621682057019"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682057019"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682057020"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057020"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621682057021"><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621682057021"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs a -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction"><span class="hs-identifier hs-var">underAbstraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Dom Type -&gt; Dom Type
forall a. LensArgInfo a =&gt; ArgInfo -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setArgInfo"><span class="hs-identifier hs-var">setArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682057019"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Dom Type -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621682057021"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682057025"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057025"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057020"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057025"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056162"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type%27"><span class="hs-identifier hs-type">Type'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621682057039"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Type' a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057040"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057040"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057041"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057041"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057040"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057041"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621682057053"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057054"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057054"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621682057055"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682057055"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; Sort -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057054"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682057055"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621682057069"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Level -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057070"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057070"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057071"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621682057071"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m,
 MonadAddContext m) =&gt;
Relevance -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadAddContext m) =&gt;
Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057070"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621682057071"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- instance UsableModality PlusLevel where</span><span>
</span><span id="line-277"></span><span class="hs-comment">--   usableMod mod ClosedLevel{} = return True</span><span>
</span><span id="line-278"></span><span class="hs-comment">--   usableMod mod (Plus _ l)    = usableMod mod l</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056134"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056134"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682056134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621682057086"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; [a] -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057087"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057087"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Bool] -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, Monad m) =&gt;
f (m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#andM"><span class="hs-identifier hs-var">andM</span></a></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; m Bool) -&gt; ([a] -&gt; [m Bool]) -&gt; [a] -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m Bool) -&gt; [a] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057087"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056170"><span id="local-6989586621682056171"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056170"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056171"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682056170"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682056171"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621682057108"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; (a, b) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057109"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057109"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682057110"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057110"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682057111"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682057111"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057109"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057110"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; b -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057109"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682057111"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056133"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056133"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Elim%27"><span class="hs-identifier hs-type">Elim'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056133"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621682057133"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Elim' a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057134"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057134"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621682057135"><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621682057135"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Arg a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Arg a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057134"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621682057135"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span id="local-6989586621682057136"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057136"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057137"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682057137"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621682057138"><span class="annot"><a href="#local-6989586621682057138"><span class="hs-identifier hs-var">pmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682057137"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682057138"><span class="hs-identifier hs-type">pmod</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-type">`moreUsableModality`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057136"><span class="hs-identifier hs-type">mod</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span id="local-6989586621682057139"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057139"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span> </span><span id="local-6989586621682057140"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682057141"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057141"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682057142"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057142"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057139"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057142"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056175"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621682057156"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Arg a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057157"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057157"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682057158"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682057158"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682057159"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057159"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682057160"><span class="annot"><span class="annottext">mod' :: Modality
</span><a href="#local-6989586621682057160"><span class="hs-identifier hs-var hs-var">mod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682057158"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057157"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.Syntax.Common.html#composeModality"><span class="hs-operator hs-var">`composeModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057160"><span class="hs-identifier hs-var">mod'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057159"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682056179"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056179"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056179"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621682057174"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Dom a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621682057175"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057175"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057176"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057176"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057175"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057176"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality%27"><span class="hs-identifier hs-type">usableAtModality'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Constraints.html#MonadConstraint"><span class="hs-identifier hs-type">MonadConstraint</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-comment">-- Note: This weird-looking constraint is to trick GHC into accepting</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">-- that an instance of MonadConstraint TCM will exist, even if we</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">-- can't import the module in which it is defined.</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#WhyCheckModality"><span class="hs-identifier hs-type">WhyCheckModality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span id="usableAtModality%27"><span class="annot"><span class="annottext">usableAtModality' :: MonadConstraint (TCMT IO) =&gt;
Maybe Sort -&gt; WhyCheckModality -&gt; Modality -&gt; Term -&gt; TCM ()
</span><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality%27"><span class="hs-identifier hs-var hs-var">usableAtModality'</span></a></span></span><span> </span><span id="local-6989586621682057224"><span class="annot"><span class="annottext">Maybe Sort
</span><a href="#local-6989586621682057224"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span id="local-6989586621682057225"><span class="annot"><span class="annottext">WhyCheckModality
</span><a href="#local-6989586621682057225"><span class="hs-identifier hs-var">why</span></a></span></span><span> </span><span id="local-6989586621682057226"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057226"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621682057227"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057227"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">Constraint -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *).
MonadConstraint m =&gt;
Constraint -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Constraints.html#catchConstraint"><span class="hs-identifier hs-var">catchConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WhyCheckModality -&gt; Maybe Sort -&gt; Modality -&gt; Term -&gt; Constraint
</span><a href="Agda.TypeChecking.Monad.Base.html#UsableAtModality"><span class="hs-identifier hs-var">UsableAtModality</span></a></span><span> </span><span class="annot"><span class="annottext">WhyCheckModality
</span><a href="#local-6989586621682057225"><span class="hs-identifier hs-var">why</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Sort
</span><a href="#local-6989586621682057224"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057226"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057227"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">TCMT IO Bool -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#whenM"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Bool
-&gt; (Sort -&gt; TCMT IO Bool) -&gt; Maybe Sort -&gt; TCMT IO Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TCMT IO Bool
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; TCMT IO Bool
forall a (m :: * -&gt; *).
(LensSort a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isFibrant"><span class="hs-identifier hs-var">isFibrant</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Sort
</span><a href="#local-6989586621682057224"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621682057233"><span class="annot"><a href="#local-6989586621682057233"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool))
-&gt; ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; ExceptT Blocker (TCMT IO) Bool
forall a (m :: * -&gt; *).
(UsableModality a, HasConstInfo m, MonadAddContext m,
 MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
forall (m :: * -&gt; *).
(HasConstInfo m, MonadAddContext m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; Term -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057226"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057227"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682057233"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682057234"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682057234"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682057234"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; TypeError -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WhyCheckModality -&gt; Modality -&gt; Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#UnusableAtModality"><span class="hs-identifier hs-var">UnusableAtModality</span></a></span><span> </span><span class="annot"><span class="annottext">WhyCheckModality
</span><a href="#local-6989586621682057225"><span class="hs-identifier hs-var">why</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621682057226"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057227"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682057238"><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057238"><span class="hs-identifier hs-var">blocker</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; TCM ()
forall a. Blocker -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadBlock m =&gt; Blocker -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#patternViolation"><span class="hs-identifier hs-var">patternViolation</span></a></span><span> </span><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057238"><span class="hs-identifier hs-var">blocker</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality"><span class="hs-identifier hs-type">usableAtModality</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Constraints.html#MonadConstraint"><span class="hs-identifier hs-type">MonadConstraint</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#WhyCheckModality"><span class="hs-identifier hs-type">WhyCheckModality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="usableAtModality"><span class="annot"><span class="annottext">usableAtModality :: MonadConstraint (TCMT IO) =&gt;
WhyCheckModality -&gt; Modality -&gt; Term -&gt; TCM ()
</span><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality"><span class="hs-identifier hs-var hs-var">usableAtModality</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Sort -&gt; WhyCheckModality -&gt; Modality -&gt; Term -&gt; TCM ()
MonadConstraint (TCMT IO) =&gt;
Maybe Sort -&gt; WhyCheckModality -&gt; Modality -&gt; Term -&gt; TCM ()
</span><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality%27"><span class="hs-identifier hs-var">usableAtModality'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Sort
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isDefSing"><span class="hs-pragma hs-type">isDefSing</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DefSing"><span class="hs-pragma hs-type">DefSing</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Compute whether a type is a definitional singleton or might become one</span><span>
</span><span id="line-319"></span><span class="hs-comment">--   after a substitution or after the addition of some rewrite rules</span><span>
</span><span id="line-320"></span><span class="hs-comment">--   Assumes type passed in has been reduced (otherwise will be even more</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   conservative than necessary).</span><span>
</span><span id="line-322"></span><span id="local-6989586621682056219"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isDefSing"><span class="hs-identifier hs-type">isDefSing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056219"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056219"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056219"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DefSing"><span class="hs-identifier hs-type">DefSing</span></a></span></span><span>
</span><span id="line-323"></span><span id="isDefSing"><span class="annot"><span class="annottext">isDefSing :: forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Type -&gt; m DefSing
</span><a href="Agda.TypeChecking.Irrelevance.html#isDefSing"><span class="hs-identifier hs-var hs-var">isDefSing</span></a></span></span><span> </span><span id="local-6989586621682057326"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682057326"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682057327"><span class="annot"><span class="annottext">s :: Sort
</span><a href="#local-6989586621682057327"><span class="hs-identifier hs-var hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682057326"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621682057329"><span class="annot"><a href="#local-6989586621682057329"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Bool
forall t. Sort' t -&gt; Bool
</span><a href="Agda.Syntax.Internal.html#isProp"><span class="hs-identifier hs-var">isProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Bool) -&gt; m Sort -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682057327"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-comment">-- Strict propositions are always definitional singletons</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682057329"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MaybeSing"><span class="hs-identifier hs-type">MaybeSing</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057326"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#MaybeSing"><span class="hs-identifier hs-var">MaybeSing</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621682057334"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682057334"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682057335"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682057335"><span class="hs-identifier hs-var">es</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621682057336"><span class="annot"><a href="#local-6989586621682057336"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Defn) -&gt; m Definition -&gt; m Defn
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Definition
forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682057334"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682057336"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#NeverSing"><span class="hs-identifier hs-var">NeverSing</span></a></span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">recTel :: Defn -&gt; Tele (Dom Type)
</span><a href="Agda.TypeChecking.Monad.Base.html#recTel"><span class="hs-identifier hs-var">recTel</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682057343"><span class="annot"><span class="annottext">Tele (Dom Type)
</span><a href="#local-6989586621682057343"><span class="hs-identifier hs-var">tel</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; HasEta
</span><a href="Agda.TypeChecking.Monad.Base.html#recEtaEquality"><span class="hs-identifier hs-var">recEtaEquality</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621682057336"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>          </span><span class="annot"><span class="annottext">HasEta
</span><a href="Agda.Syntax.Common.html#YesEta"><span class="hs-identifier hs-var">YesEta</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682057346"><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682057346"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Elims -&gt; Maybe [Arg Term]
forall a. [Elim' a] -&gt; Maybe [Arg a]
</span><a href="Agda.Syntax.Internal.Elim.html#allApplyElims"><span class="hs-identifier hs-var">allApplyElims</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621682057335"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-341"></span><span>            </span><span id="local-6989586621682057348"><span class="annot"><a href="#local-6989586621682057348"><span class="hs-identifier hs-var">sings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; m DefSing) -&gt; Tele (Dom Type) -&gt; m (Tele DefSing)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Tele a -&gt; f (Tele b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; m DefSing
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Dom Type -&gt; m DefSing
</span><a href="Agda.TypeChecking.Irrelevance.html#isDefSing%27"><span class="hs-identifier hs-var">isDefSing'</span></a></span><span> </span><span class="annot"><span class="annottext">(Tele (Dom Type) -&gt; m (Tele DefSing))
-&gt; Tele (Dom Type) -&gt; m (Tele DefSing)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tele (Dom Type)
</span><a href="#local-6989586621682057343"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Tele (Dom Type) -&gt; [Arg Term] -&gt; Tele (Dom Type)
forall t. Apply t =&gt; t -&gt; [Arg Term] -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-operator hs-var">`apply`</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg Term]
</span><a href="#local-6989586621682057346"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#minDefSing"><span class="hs-identifier hs-type">minDefSing</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AlwaysSing"><span class="hs-identifier hs-type">AlwaysSing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057348"><span class="hs-identifier hs-type">sings</span></a></span><span>
</span><span id="line-343"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-type">NoEta</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#NeverSing"><span class="hs-identifier hs-var">NeverSing</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DefSing -&gt; m DefSing) -&gt; DefSing -&gt; m DefSing
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#NeverSing"><span class="hs-identifier hs-var">NeverSing</span></a></span><span>
</span><span id="line-345"></span><span>          </span><span class="hs-comment">-- TODO: Postulated type formers might still become definitionally</span><span>
</span><span id="line-346"></span><span>          </span><span class="hs-comment">-- singular if further rewrites are added (see #8266)</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#NeverSing"><span class="hs-identifier hs-var">NeverSing</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#MaybeSing"><span class="hs-identifier hs-var">MaybeSing</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-comment">-- I am erring on the side of caution here: specifically, I am</span><span>
</span><span id="line-350"></span><span>          </span><span class="hs-comment">-- worried about the possibility that a rewrite might look fine</span><span>
</span><span id="line-351"></span><span>          </span><span class="hs-comment">-- outside of an abstract block, but then inside an abstract block,</span><span>
</span><span id="line-352"></span><span>          </span><span class="hs-comment">-- all the abstract definitions will reduce and the rewrite will</span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-comment">-- become invalid.</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#MaybeSing"><span class="hs-identifier hs-var">MaybeSing</span></a></span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#MaybeSing"><span class="hs-identifier hs-var">MaybeSing</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; Type
forall a. Abs a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unAbs"><span class="hs-identifier hs-var">unAbs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621682057365"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682057365"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m DefSing
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Type -&gt; m DefSing
</span><a href="Agda.TypeChecking.Irrelevance.html#isDefSing"><span class="hs-identifier hs-var">isDefSing</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682057365"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#NeverSing"><span class="hs-identifier hs-var">NeverSing</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621682057366"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682057366"><span class="hs-identifier hs-var">a</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span> </span><span class="annot"><span class="annottext">DummyTermKind
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m DefSing
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isDefSing%27"><span class="hs-pragma hs-type">isDefSing'</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-pragma hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DefSing"><span class="hs-pragma hs-type">DefSing</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-368"></span><span id="local-6989586621682056246"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isDefSing%27"><span class="hs-identifier hs-type">isDefSing'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056246"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056246"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DefSing"><span class="hs-identifier hs-type">DefSing</span></a></span></span><span>
</span><span id="line-369"></span><span id="isDefSing%27"><span class="annot"><span class="annottext">isDefSing' :: forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Dom Type -&gt; m DefSing
</span><a href="Agda.TypeChecking.Irrelevance.html#isDefSing%27"><span class="hs-identifier hs-var hs-var">isDefSing'</span></a></span></span><span> </span><span id="local-6989586621682057377"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682057377"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">(Relevance -&gt; Bool) -&gt; Relevance -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682057377"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DefSing -&gt; m DefSing
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DefSing
</span><a href="Agda.TypeChecking.Monad.Base.html#AlwaysSing"><span class="hs-identifier hs-var">AlwaysSing</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m DefSing
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Type -&gt; m DefSing
</span><a href="Agda.TypeChecking.Irrelevance.html#isDefSing"><span class="hs-identifier hs-var">isDefSing</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m DefSing) -&gt; Type -&gt; m DefSing
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621682057377"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">-- * Propositions</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="annot"><span class="hs-comment">-- | Is a type a proposition?  (Needs reduction.)</span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-pragma hs-type">isPropM</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-pragma hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-379"></span><span id="local-6989586621682056256"><span id="local-6989586621682056257"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-type">isPropM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056256"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056256"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056257"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056257"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056256"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056257"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-380"></span><span id="isPropM"><span class="annot"><span class="annottext">isPropM :: forall a (m :: * -&gt; *).
(LensSort a, PrettyTCM a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-var hs-var">isPropM</span></a></span></span><span> </span><span id="local-6989586621682057420"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057420"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682057421"><span class="annot"><span class="annottext">s :: Sort
</span><a href="#local-6989586621682057421"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057420"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; TCMT IO Doc -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
[Char] -&gt; Int -&gt; TCMT IO Doc -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#traceSDoc"><span class="hs-identifier hs-var">traceSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.prop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Is &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057420"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;of sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Sort -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682057421"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;in Prop?&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">Sort -&gt; Bool
forall t. Sort' t -&gt; Bool
</span><a href="Agda.Syntax.Internal.html#isProp"><span class="hs-identifier hs-var">isProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Bool) -&gt; m Sort -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621682057421"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-pragma hs-type">isIrrelevantOrPropM</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-pragma hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-386"></span><span id="local-6989586621682056262"><span id="local-6989586621682056263"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-identifier hs-type">isIrrelevantOrPropM</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056262"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056262"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056262"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056263"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056263"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056262"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056263"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-389"></span><span id="isIrrelevantOrPropM"><span class="annot"><span class="annottext">isIrrelevantOrPropM :: forall a (m :: * -&gt; *).
(LensRelevance a, LensSort a, PrettyTCM a, PureTCM m,
 MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-identifier hs-var hs-var">isIrrelevantOrPropM</span></a></span></span><span> </span><span id="local-6989586621682057437"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057437"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057437"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-var">`or2M`</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
forall a (m :: * -&gt; *).
(LensSort a, PrettyTCM a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-var">isPropM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057437"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span id="local-6989586621682056266"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#allIrrelevantOrPropTel"><span class="hs-identifier hs-type">allIrrelevantOrPropTel</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056266"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056266"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-394"></span><span id="allIrrelevantOrPropTel"><span class="annot"><span class="annottext">allIrrelevantOrPropTel :: forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m) =&gt;
Tele (Dom Type) -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#allIrrelevantOrPropTel"><span class="hs-identifier hs-var hs-var">allIrrelevantOrPropTel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">(Dom ([Char], Type) -&gt; m Bool -&gt; m Bool)
-&gt; m Bool -&gt; Tele (Dom Type) -&gt; m Bool
forall (m :: * -&gt; *) b.
MonadAddContext m =&gt;
(Dom ([Char], Type) -&gt; m b -&gt; m b) -&gt; m b -&gt; Tele (Dom Type) -&gt; m b
</span><a href="Agda.TypeChecking.Telescope.html#foldrTelescopeM"><span class="hs-identifier hs-var">foldrTelescopeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-identifier hs-var">and2M</span></a></span><span> </span><span class="annot"><span class="annottext">(m Bool -&gt; m Bool -&gt; m Bool)
-&gt; (Dom ([Char], Type) -&gt; m Bool)
-&gt; Dom ([Char], Type)
-&gt; m Bool
-&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; m Bool
forall a (m :: * -&gt; *).
(LensRelevance a, LensSort a, PrettyTCM a, PureTCM m,
 MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-identifier hs-var">isIrrelevantOrPropM</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; m Bool)
-&gt; (Dom ([Char], Type) -&gt; Dom Type) -&gt; Dom ([Char], Type) -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Char], Type) -&gt; Type) -&gt; Dom ([Char], Type) -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; Dom' Term a -&gt; Dom' Term b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([Char], Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- * Fibrant types</span></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><span class="hs-comment">-- | Is a type fibrant (i.e. Type, Prop)?</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621682056207"><span id="local-6989586621682056208"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isFibrant"><span class="hs-identifier hs-type">isFibrant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056207"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056208"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056208"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-402"></span><span id="isFibrant"><span class="annot"><span class="annottext">isFibrant :: forall a (m :: * -&gt; *).
(LensSort a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isFibrant"><span class="hs-identifier hs-var hs-var">isFibrant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Blocker -&gt; m Bool) -&gt; m (Either Blocker Bool) -&gt; m Bool
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; m (Either a b) -&gt; m b
</span><a href="Agda.Utils.Either.html#fromRightM"><span class="hs-identifier hs-var">fromRightM</span></a></span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; m Bool
forall a. Blocker -&gt; m a
forall (m :: * -&gt; *) a. MonadBlock m =&gt; Blocker -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#patternViolation"><span class="hs-identifier hs-var">patternViolation</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either Blocker Bool) -&gt; m Bool)
-&gt; (a -&gt; m (Either Blocker Bool)) -&gt; a -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Either Blocker Bool)
forall a (m :: * -&gt; *).
(LensSort a, PureTCM m) =&gt;
a -&gt; m (Either Blocker Bool)
</span><a href="Agda.TypeChecking.Irrelevance.html#isFibrant%27"><span class="hs-identifier hs-var">isFibrant'</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span id="local-6989586621682056281"><span id="local-6989586621682056282"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isFibrant%27"><span class="hs-identifier hs-type">isFibrant'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056281"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682056282"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682056282"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-405"></span><span id="isFibrant%27"><span class="annot"><span class="annottext">isFibrant' :: forall a (m :: * -&gt; *).
(LensSort a, PureTCM m) =&gt;
a -&gt; m (Either Blocker Bool)
</span><a href="Agda.TypeChecking.Irrelevance.html#isFibrant%27"><span class="hs-identifier hs-var hs-var">isFibrant'</span></a></span></span><span> </span><span id="local-6989586621682057489"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057489"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">Sort
-&gt; (Blocker -&gt; Sort -&gt; m (Either Blocker Bool))
-&gt; (NotBlocked -&gt; Sort -&gt; m (Either Blocker Bool))
-&gt; m (Either Blocker Bool)
forall t (m :: * -&gt; *) a.
(Reduce t, IsMeta t, MonadReduce m) =&gt;
t -&gt; (Blocker -&gt; t -&gt; m a) -&gt; (NotBlocked -&gt; t -&gt; m a) -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#ifBlocked"><span class="hs-identifier hs-var">ifBlocked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057489"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682057491"><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057491"><span class="hs-identifier hs-var">blocker</span></a></span></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Blocker Bool -&gt; m (Either Blocker Bool))
-&gt; Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; Either Blocker Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057491"><span class="hs-identifier hs-var">blocker</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">NotBlocked
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Blocker Bool -&gt; m (Either Blocker Bool))
-&gt; (Sort -&gt; Either Blocker Bool) -&gt; Sort -&gt; m (Either Blocker Bool)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either Blocker Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Either Blocker Bool)
-&gt; (Sort -&gt; Bool) -&gt; Sort -&gt; Either Blocker Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#Univ"><span class="hs-identifier hs-type">Univ</span></a></span><span> </span><span id="local-6989586621682057492"><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057492"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Level
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Univ -&gt; IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#univFibrancy"><span class="hs-identifier hs-var">univFibrancy</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057492"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621682057495"><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057495"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Univ -&gt; IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#univFibrancy"><span class="hs-identifier hs-var">univFibrancy</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057495"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-type">SizeUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-type">LockUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#LevelUniv"><span class="hs-identifier hs-type">LevelUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-type">IntervalUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Cofibrant types are those that could be the domain of a fibrant</span><span>
</span><span id="line-423"></span><span class="hs-comment">--   pi type. (Notion by C. Sattler).</span><span>
</span><span id="line-424"></span><span id="local-6989586621682057496"><span id="local-6989586621682057497"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isCoFibrantSort"><span class="hs-identifier hs-type">isCoFibrantSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057496"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057497"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682057496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682057497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-425"></span><span id="isCoFibrantSort"><span class="annot"><span class="annottext">isCoFibrantSort :: forall a (m :: * -&gt; *).
(LensSort a, PureTCM m) =&gt;
a -&gt; m (Either Blocker Bool)
</span><a href="Agda.TypeChecking.Irrelevance.html#isCoFibrantSort"><span class="hs-identifier hs-var hs-var">isCoFibrantSort</span></a></span></span><span> </span><span id="local-6989586621682057520"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057520"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">Sort
-&gt; (Blocker -&gt; Sort -&gt; m (Either Blocker Bool))
-&gt; (NotBlocked -&gt; Sort -&gt; m (Either Blocker Bool))
-&gt; m (Either Blocker Bool)
forall t (m :: * -&gt; *) a.
(Reduce t, IsMeta t, MonadReduce m) =&gt;
t -&gt; (Blocker -&gt; t -&gt; m a) -&gt; (NotBlocked -&gt; t -&gt; m a) -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#ifBlocked"><span class="hs-identifier hs-var">ifBlocked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057520"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682057521"><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057521"><span class="hs-identifier hs-var">blocker</span></a></span></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Blocker Bool -&gt; m (Either Blocker Bool))
-&gt; Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; Either Blocker Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621682057521"><span class="hs-identifier hs-var">blocker</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">NotBlocked
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">Either Blocker Bool -&gt; m (Either Blocker Bool)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Blocker Bool -&gt; m (Either Blocker Bool))
-&gt; (Sort -&gt; Either Blocker Bool) -&gt; Sort -&gt; m (Either Blocker Bool)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either Blocker Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Either Blocker Bool)
-&gt; (Sort -&gt; Bool) -&gt; Sort -&gt; Either Blocker Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#Univ"><span class="hs-identifier hs-type">Univ</span></a></span><span> </span><span id="local-6989586621682057522"><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057522"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Level
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Univ -&gt; IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#univFibrancy"><span class="hs-identifier hs-var">univFibrancy</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057522"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621682057523"><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057523"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Univ -&gt; IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#univFibrancy"><span class="hs-identifier hs-var">univFibrancy</span></a></span><span> </span><span class="annot"><span class="annottext">Univ
</span><a href="#local-6989586621682057523"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.Univ.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-type">SizeUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-type">LockUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#LevelUniv"><span class="hs-identifier hs-type">LevelUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-type">IntervalUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-440"></span></pre></body></html>