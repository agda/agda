<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span class="hs-cpp">
#if  __GLASGOW_HASKELL__ &gt; 902
</span><span class="hs-pragma">{-# OPTIONS_GHC -fworker-wrapper-cbv #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">{- |
Computing the free variables of a term.

The distinction between rigid and strongly rigid occurrences comes from: Jason C. Reed, PhD thesis,
2009, page 96 (see also his LFMTP 2009 paper)

The main idea is that x = t(x) is unsolvable if x occurs strongly rigidly in t. It might have a
solution if the occurrence is not strongly rigid, e.g.

  x = \f -&gt; suc (f (x (\ y -&gt; k)))  has  x = \f -&gt; suc (f (suc k))

[Jason C. Reed, PhD thesis, page 106]

The most general function here is 'freeVarMap', which returns returns occurrence information about
every free variable. It is also a legacy function in the sense that it used to be the only function
for computing free occurrences, and it came with various functions for taking views of the resulting
'VarMap'. You can find these under the &quot;Legacy API&quot; here.

There are also also a bunch of specialized and optimized implementations of traversals here.

If you want to write a new function for computing free occurrence information, your task is
essentially to write a 'ComputeFree' instance and invoke 'freeVars'. These together implement a
generic traversal which has a good chance of being converted to decent code by GHC. You can look at
examples here and also look at the comments at 'ComputeFree'.
-}</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html"><span class="hs-identifier">Agda.TypeChecking.Free</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier">FlexRig</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig%27"><span class="hs-identifier">FlexRig'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier">Free</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv"><span class="hs-identifier">FreeEnv</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FreeEnv%27"><span class="hs-identifier">FreeEnv'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IgnoreSorts"><span class="hs-identifier">IgnoreSorts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#IsVarSet"><span class="hs-identifier">IsVarSet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier">LensFlexRig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier">VarCounts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier">VarMap</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap%27"><span class="hs-identifier">VarMap'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier">VarOcc</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc%27"><span class="hs-identifier">VarOcc'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#composeFlexRig"><span class="hs-identifier">composeFlexRig</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lookupVarMap"><span class="hs-identifier">lookupVarMap</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#mapVarMap"><span class="hs-identifier">mapVarMap</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Legacy API</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allVars"><span class="hs-identifier">allVars</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier">filterVarMap</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMapToList"><span class="hs-identifier">filterVarMapToList</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexibleVars"><span class="hs-identifier">flexibleVars</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMap"><span class="hs-identifier">freeVarMap</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isFlexible"><span class="hs-identifier">isFlexible</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isStronglyRigid"><span class="hs-identifier">isStronglyRigid</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isUnguarded"><span class="hs-identifier">isUnguarded</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#isWeaklyRigid"><span class="hs-identifier">isWeaklyRigid</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#rigidVars"><span class="hs-identifier">rigidVars</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#stronglyRigidVars"><span class="hs-identifier">stronglyRigidVars</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#unguardedVars"><span class="hs-identifier">unguardedVars</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-comment">-- * MetaSet</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier">MetaSet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#foldrMetaSet"><span class="hs-identifier">foldrMetaSet</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#insertMetaSet"><span class="hs-identifier">insertMetaSet</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#metaSetToBlocker"><span class="hs-identifier">metaSetToBlocker</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Specialized traversals</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVar"><span class="hs-identifier">allFreeVar</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll"><span class="hs-identifier">allFreeVarIgnoreAll</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVar"><span class="hs-identifier">anyFreeVar</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll"><span class="hs-identifier">anyFreeVarIgnoreAll</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#closed"><span class="hs-identifier">closed</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-identifier">flexRigOccurrenceIn</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-identifier">freeIn</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeInIgnoringSorts"><span class="hs-identifier">freeInIgnoringSorts</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarCounts"><span class="hs-identifier">freeVarCounts</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarList"><span class="hs-identifier">freeVarList</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMapIgnoreAnn"><span class="hs-identifier">freeVarMapIgnoreAnn</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarSet"><span class="hs-identifier">freeVarSet</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#isBinderUsed"><span class="hs-identifier">isBinderUsed</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-identifier">relevantInIgnoringSortAnn</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#setRelInIgnoring"><span class="hs-identifier">setRelInIgnoring</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(-#)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">oneShot</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Any</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">All</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier">Arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier">NamedArg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html"><span class="hs-identifier">Agda.TypeChecking.Free.Base</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html"><span class="hs-identifier">Agda.TypeChecking.Free.Generic</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html"><span class="hs-identifier">Agda.Utils.VarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier">VarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html"><span class="hs-identifier">Agda.Utils.VarSet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VarSet</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.StrictReader.html"><span class="hs-identifier">Agda.Utils.StrictReader</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html"><span class="hs-identifier">Agda.Utils.StrictFlipEndo</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.StrictEndo.html"><span class="hs-identifier">Agda.Utils.StrictEndo</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonFlip</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.ExpandCase.html"><span class="hs-identifier">Agda.Utils.ExpandCase</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- ** All free variables together with information about their occurrence.</span></span><span>
</span><span id="line-112"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">data</span><span> </span><span id="FreeVarMap"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarMap"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-pragma hs-type">lensFlexRig</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621681789138"><span class="annot"><span class="annottext">lensFlexRig :: Lens' FreeVarMap (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681789139"><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span id="local-6989586621681789140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789141"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789141"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarOcc -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789140"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; FreeVarMap) -&gt; f VarOcc -&gt; f FreeVarMap
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)) -&gt; VarOcc -&gt; f VarOcc
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' VarOcc (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789139"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789141"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789145"><span class="annot"><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-type">LensModality</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#getModality"><span class="hs-pragma hs-type">getModality</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621681789153"><span class="annot"><span class="annottext">getModality :: FreeVarMap -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var hs-var hs-var">getModality</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681789154"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789154"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarOcc -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789154"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#mapModality"><span class="hs-pragma hs-type">mapModality</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621681789157"><span class="annot"><span class="annottext">mapModality :: (Modality -&gt; Modality) -&gt; FreeVarMap -&gt; FreeVarMap
</span><a href="Agda.Syntax.Common.html#mapModality"><span class="hs-identifier hs-var hs-var hs-var">mapModality</span></a></span></span><span> </span><span id="local-6989586621681789158"><span class="annot"><span class="annottext">Modality -&gt; Modality
</span><a href="#local-6989586621681789158"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span id="local-6989586621681789159"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789159"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789160"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789160"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarOcc -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789159"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Modality -&gt; Modality) -&gt; VarOcc -&gt; VarOcc
forall a. LensModality a =&gt; (Modality -&gt; Modality) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapModality"><span class="hs-identifier hs-var">mapModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality
</span><a href="#local-6989586621681789158"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789160"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789162"><span id="local-6989586621681789167"><span id="local-6989586621681789170"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span></span></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789187"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621681789196"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeVarMap -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789197"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789197"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span id="local-6989586621681789198"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789198"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789199"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789199"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarOcc -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789197"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789198"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789199"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621681789209"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeVarMap -&gt; Collect FreeVarMap
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789210"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789210"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span> </span><span id="local-6989586621681789211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789211"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789212"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789212"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntMap VarOcc -&gt; IntMap VarOcc) -&gt; Endo (IntMap VarOcc)
forall a. (a -&gt; a) -&gt; Endo a
</span><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-var">Endo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789214"><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789214"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789210"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789211"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789214"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-135"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; VarOcc -&gt; VarOcc)
-&gt; Int -&gt; VarOcc -&gt; IntMap VarOcc -&gt; IntMap VarOcc
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.insertWith</span></span><span> </span><span class="annot"><span class="annottext">VarOcc -&gt; VarOcc -&gt; VarOcc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789210"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789211"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789212"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789214"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621681789219"><span class="annot"><span class="annottext">underConstructor' :: ConHead -&gt; Elims -&gt; FreeVarMap -&gt; FreeVarMap
</span><a href="#local-6989586621681789219"><span class="hs-identifier hs-var hs-var hs-var">underConstructor'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; Elims -&gt; FreeVarMap -&gt; FreeVarMap
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
ConHead -&gt; Elims -&gt; r -&gt; r
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderConstructor"><span class="hs-identifier hs-var">defaultUnderConstructor</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underConstructor%27"><span class="hs-pragma hs-type">underConstructor'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621681789224"><span class="annot"><span class="annottext">underFlexRig' :: Maybe (FlexRig' MetaSet -&gt; FreeVarMap -&gt; FreeVarMap)
</span><a href="#local-6989586621681789224"><span class="hs-identifier hs-var hs-var hs-var">underFlexRig'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FlexRig' MetaSet -&gt; FreeVarMap -&gt; FreeVarMap)
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
Maybe (FlexRig' a -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderFlexRig"><span class="hs-identifier hs-var">defaultUnderFlexRig</span></a></span><span class="hs-special">;</span><span>     </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underFlexRig%27"><span class="hs-pragma hs-type">underFlexRig'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621681789228"><span class="annot"><span class="annottext">underModality' :: Maybe (Modality -&gt; FreeVarMap -&gt; FreeVarMap)
</span><a href="#local-6989586621681789228"><span class="hs-identifier hs-var hs-var hs-var">underModality'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Modality -&gt; FreeVarMap -&gt; FreeVarMap)
forall r. LensModality r =&gt; Maybe (Modality -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderModality"><span class="hs-identifier hs-var">defaultUnderModality</span></a></span><span class="hs-special">;</span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-pragma hs-type">underModality'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621681789232"><span class="annot"><span class="annottext">underRelevance' :: Maybe (Relevance -&gt; FreeVarMap -&gt; FreeVarMap)
</span><a href="#local-6989586621681789232"><span class="hs-identifier hs-var hs-var hs-var">underRelevance'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Relevance -&gt; FreeVarMap -&gt; FreeVarMap)
forall r. LensRelevance r =&gt; Maybe (Relevance -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderRelevance"><span class="hs-identifier hs-var">defaultUnderRelevance</span></a></span><span class="hs-special">;</span><span>   </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-pragma hs-type">underRelevance'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMap"><span class="hs-pragma hs-type">freeVarMap</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-pragma hs-type">VarMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-142"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMap"><span class="hs-pragma hs-type">freeVarMap</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-pragma hs-type">VarMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-143"></span><span class="annot"><span class="hs-comment">-- | Return information about every free variable.</span></span><span>
</span><span id="line-144"></span><span id="local-6989586621681788957"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMap"><span class="hs-identifier hs-type">freeVarMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681788957"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681788957"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span></span><span>
</span><span id="line-145"></span><span id="freeVarMap"><span class="annot"><span class="annottext">freeVarMap :: forall t. Free t =&gt; t -&gt; VarMap
</span><a href="Agda.TypeChecking.Free.html#freeVarMap"><span class="hs-identifier hs-var hs-var">freeVarMap</span></a></span></span><span> </span><span id="local-6989586621681789240"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789240"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="annottext">IntMap VarOcc -&gt; VarMap
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endo (IntMap VarOcc) -&gt; IntMap VarOcc -&gt; IntMap VarOcc
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictFlipEndo.html#appEndo"><span class="hs-identifier hs-var">appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeVarMap (Endo (IntMap VarOcc))
-&gt; FreeVarMap -&gt; Endo (IntMap VarOcc)
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeVarMap (Collect FreeVarMap)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789240"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarOcc -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">VarOcc
forall a. VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#oneVarOcc"><span class="hs-identifier hs-var">oneVarOcc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeVarMapIgnoreAnn"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-var">FreeVarMapIgnoreAnn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarMapIgnoreAnn"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-var">FreeVarMapIgnoreAnn</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-type">FreeVarMap</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681789246"><span id="local-6989586621681789250"><span id="local-6989586621681789254"><span class="annot"><span class="annottext">Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
FreeVarMapIgnoreAnn -&gt; Modality
(Modality -&gt; Modality)
-&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
(FreeVarMapIgnoreAnn -&gt; Modality)
-&gt; (Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
-&gt; ((Modality -&gt; Modality)
    -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
-&gt; LensModality FreeVarMapIgnoreAnn
forall a.
(a -&gt; Modality)
-&gt; (Modality -&gt; a -&gt; a)
-&gt; ((Modality -&gt; Modality) -&gt; a -&gt; a)
-&gt; LensModality a
$cgetModality :: FreeVarMapIgnoreAnn -&gt; Modality
getModality :: FreeVarMapIgnoreAnn -&gt; Modality
$csetModality :: Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
setModality :: Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
$cmapModality :: (Modality -&gt; Modality)
-&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
mapModality :: (Modality -&gt; Modality)
-&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">LensModality</span></a></span></span></span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-pragma hs-type">lensFlexRig</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621681789265"><span class="annot"><span class="annottext">lensFlexRig :: Lens' FreeVarMapIgnoreAnn (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681789266"><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789266"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span id="local-6989586621681789267"><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789267"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVarMap -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-var">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVarMap -&gt; FreeVarMapIgnoreAnn)
-&gt; f FreeVarMap -&gt; f FreeVarMapIgnoreAnn
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FlexRig' MetaSet -&gt; f (FlexRig' MetaSet))
-&gt; FreeVarMap -&gt; f FreeVarMap
forall o a. LensFlexRig o a =&gt; Lens' o (FlexRig' a)
Lens' FreeVarMap (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var">lensFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789269"><span id="local-6989586621681789274"><span id="local-6989586621681789277"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span></span></span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621681789295"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789296"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789296"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span id="local-6989586621681789297"><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789297"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVarMap -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-var">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeVarMap -&gt; FreeVarMap
forall r. ComputeFree r =&gt; Int -&gt; r -&gt; r
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var">underBinders'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789296"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789297"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621681789299"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeVarMapIgnoreAnn -&gt; Collect FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789300"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789300"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-type">FreeVarMapIgnoreAnn</span></a></span><span> </span><span id="local-6989586621681789301"><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789301"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeVarMap -&gt; Collect FreeVarMap
forall r. ComputeFree r =&gt; Int -&gt; r -&gt; Collect r
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var">variable'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789300"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarMap
</span><a href="#local-6989586621681789301"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621681789302"><span class="annot"><span class="annottext">ignoreSorts' :: IgnoreSorts
</span><a href="#local-6989586621681789302"><span class="hs-identifier hs-var hs-var hs-var">ignoreSorts'</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#IgnoreInAnnotations"><span class="hs-identifier hs-var">IgnoreInAnnotations</span></a></span><span class="hs-special">;</span><span>     </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-pragma hs-type">ignoreSorts'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621681789307"><span class="annot"><span class="annottext">underConstructor' :: ConHead -&gt; Elims -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.Generic.html#underConstructor%27"><span class="hs-identifier hs-var hs-var hs-var">underConstructor'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; Elims -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
ConHead -&gt; Elims -&gt; r -&gt; r
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderConstructor"><span class="hs-identifier hs-var">defaultUnderConstructor</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underConstructor%27"><span class="hs-pragma hs-type">underConstructor'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621681789310"><span class="annot"><span class="annottext">underFlexRig' :: Maybe
  (FlexRig' MetaSet -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
</span><a href="Agda.TypeChecking.Free.Generic.html#underFlexRig%27"><span class="hs-identifier hs-var hs-var hs-var">underFlexRig'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe
  (FlexRig' MetaSet -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
Maybe (FlexRig' a -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderFlexRig"><span class="hs-identifier hs-var">defaultUnderFlexRig</span></a></span><span class="hs-special">;</span><span>     </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underFlexRig%27"><span class="hs-pragma hs-type">underFlexRig'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621681789312"><span class="annot"><span class="annottext">underModality' :: Maybe (Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
</span><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-identifier hs-var hs-var hs-var">underModality'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Modality -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
forall r. LensModality r =&gt; Maybe (Modality -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderModality"><span class="hs-identifier hs-var">defaultUnderModality</span></a></span><span class="hs-special">;</span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-pragma hs-type">underModality'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621681789314"><span class="annot"><span class="annottext">underRelevance' :: Maybe (Relevance -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
</span><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-identifier hs-var hs-var hs-var">underRelevance'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Relevance -&gt; FreeVarMapIgnoreAnn -&gt; FreeVarMapIgnoreAnn)
forall r. LensRelevance r =&gt; Maybe (Relevance -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderRelevance"><span class="hs-identifier hs-var">defaultUnderRelevance</span></a></span><span class="hs-special">;</span><span>   </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-pragma hs-type">underRelevance'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMapIgnoreAnn"><span class="hs-pragma hs-type">freeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-pragma hs-type">VarMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMapIgnoreAnn"><span class="hs-pragma hs-type">freeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span class="hs-pragma">,</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-pragma hs-type">VarMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Return information about every free variable, but ignore occurrences</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   in sorts of types.</span><span>
</span><span id="line-175"></span><span id="local-6989586621681789315"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarMapIgnoreAnn"><span class="hs-identifier hs-type">freeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span></span><span>
</span><span id="line-176"></span><span id="freeVarMapIgnoreAnn"><span class="annot"><span class="annottext">freeVarMapIgnoreAnn :: forall t. Free t =&gt; t -&gt; VarMap
</span><a href="Agda.TypeChecking.Free.html#freeVarMapIgnoreAnn"><span class="hs-identifier hs-var hs-var">freeVarMapIgnoreAnn</span></a></span></span><span> </span><span id="local-6989586621681789320"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789320"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="annottext">IntMap VarOcc -&gt; VarMap
forall a. TheVarMap' a -&gt; VarMap' a
</span><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endo (IntMap VarOcc) -&gt; IntMap VarOcc -&gt; IntMap VarOcc
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictFlipEndo.html#appEndo"><span class="hs-identifier hs-var">appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeVarMapIgnoreAnn (Endo (IntMap VarOcc))
-&gt; FreeVarMapIgnoreAnn -&gt; Endo (IntMap VarOcc)
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeVarMapIgnoreAnn (Collect FreeVarMapIgnoreAnn)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789320"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVarMap -&gt; FreeVarMapIgnoreAnn
</span><a href="Agda.TypeChecking.Free.html#FreeVarMapIgnoreAnn"><span class="hs-identifier hs-var">FreeVarMapIgnoreAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; VarOcc -&gt; FreeVarMap
</span><a href="Agda.TypeChecking.Free.html#FreeVarMap"><span class="hs-identifier hs-var">FreeVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">VarOcc
forall a. VarOcc' a
</span><a href="Agda.TypeChecking.Free.Base.html#oneVarOcc"><span class="hs-identifier hs-var">oneVarOcc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeVarCounts"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-var">FreeVarCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarCounts"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-var">FreeVarCounts</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789330"><span id="local-6989586621681789334"><span id="local-6989586621681789337"><span id="local-6989586621681789340"><span id="local-6989586621681789344"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-type">FreeVarCounts</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-type">FreeVarCounts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621681789347"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeVarCounts -&gt; FreeVarCounts
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-type">FreeVarCounts</span></a></span><span> </span><span id="local-6989586621681789349"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789349"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeVarCounts
</span><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-var">FreeVarCounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789349"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621681789354"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeVarCounts -&gt; Collect FreeVarCounts
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789355"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789355"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-type">FreeVarCounts</span></a></span><span> </span><span id="local-6989586621681789356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789356"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntMap Int -&gt; IntMap Int) -&gt; Endo (IntMap Int)
forall a. (a -&gt; a) -&gt; Endo a
</span><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-var">Endo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789357"><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681789357"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789355"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789356"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681789357"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Int -&gt; IntMap Int -&gt; IntMap Int
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.insertWith</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789355"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789356"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">IntMap Int
</span><a href="#local-6989586621681789357"><span class="hs-identifier hs-var">counts</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarCounts"><span class="hs-pragma hs-type">freeVarCounts</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-pragma hs-type">VarCounts</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | Return how many times each free variable occurs.</span></span><span>
</span><span id="line-194"></span><span id="local-6989586621681788979"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarCounts"><span class="hs-identifier hs-type">freeVarCounts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681788979"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681788979"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-type">VarCounts</span></a></span></span><span>
</span><span id="line-195"></span><span id="freeVarCounts"><span class="annot"><span class="annottext">freeVarCounts :: forall t. Free t =&gt; t -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.html#freeVarCounts"><span class="hs-identifier hs-var hs-var">freeVarCounts</span></a></span></span><span> </span><span id="local-6989586621681789362"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789362"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">IntMap Int -&gt; VarCounts
</span><a href="Agda.TypeChecking.Free.Base.html#VarCounts"><span class="hs-identifier hs-var">VarCounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endo (IntMap Int) -&gt; IntMap Int -&gt; IntMap Int
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictFlipEndo.html#appEndo"><span class="hs-identifier hs-var">appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeVarCounts (Endo (IntMap Int))
-&gt; FreeVarCounts -&gt; Endo (IntMap Int)
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeVarCounts (Collect FreeVarCounts)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789362"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeVarCounts
</span><a href="Agda.TypeChecking.Free.html#FreeVarCounts"><span class="hs-identifier hs-var">FreeVarCounts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap Int
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- ** Testing that a predicate holds on any free variable</span></span><span>
</span><span id="line-199"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">data</span><span> </span><span id="AnyFreeVar"><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-var">AnyFreeVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnyFreeVar"><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-var">AnyFreeVar</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789373"><span id="local-6989586621681789377"><span id="local-6989586621681789380"><span id="local-6989586621681789383"><span id="local-6989586621681789387"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-type">AnyFreeVar</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-type">AnyFreeVar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621681789392"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; AnyFreeVar -&gt; AnyFreeVar
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789393"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789393"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-type">AnyFreeVar</span></a></span><span> </span><span id="local-6989586621681789394"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789394"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789395"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789395"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVar
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-var">AnyFreeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789393"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789394"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789395"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621681789398"><span class="annot"><span class="annottext">variable' :: Int -&gt; AnyFreeVar -&gt; Collect AnyFreeVar
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681789399"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789399"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-type">AnyFreeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681789400"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681789401"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789401"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789399"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789400"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Any
Collect AnyFreeVar
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789401"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789399"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">-#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789400"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVar%23"><span class="hs-pragma hs-type">anyFreeVar#</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Int#</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom%27"><span class="hs-pragma hs-type">Dom'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-211"></span><span id="local-6989586621681788984"><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVar%23"><span class="hs-identifier hs-type">anyFreeVar#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681788984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681788984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-212"></span><span id="anyFreeVar%23"><span class="annot"><span class="annottext">anyFreeVar# :: forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVar%23"><span class="hs-identifier hs-var hs-var">anyFreeVar#</span></a></span></span><span> </span><span id="local-6989586621681789407"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789407"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681789408"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789408"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader AnyFreeVar Any -&gt; AnyFreeVar -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader AnyFreeVar (Collect AnyFreeVar)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789408"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVar
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-var">AnyFreeVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789407"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVar"><span class="hs-pragma hs-type">anyFreeVar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-215"></span><span class="annot"><span class="hs-comment">-- | Compute the disjunction of a predicate on free variables.</span></span><span>
</span><span id="line-216"></span><span id="local-6989586621681788986"><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVar"><span class="hs-identifier hs-type">anyFreeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681788986"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681788986"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-217"></span><span id="anyFreeVar"><span class="annot"><span class="annottext">anyFreeVar :: forall t. Free t =&gt; (Int -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVar"><span class="hs-identifier hs-var hs-var">anyFreeVar</span></a></span></span><span> </span><span id="local-6989586621681789412"><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789412"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Bool) -&gt; t -&gt; Bool
forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVar%23"><span class="hs-identifier hs-var">anyFreeVar#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789413"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789413"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789412"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789413"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVar%23"><span class="hs-pragma hs-type">allFreeVar#</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Int#</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom%27"><span class="hs-pragma hs-type">Dom'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-220"></span><span id="local-6989586621681789415"><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVar%23"><span class="hs-identifier hs-type">allFreeVar#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789415"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789415"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-221"></span><span id="allFreeVar%23"><span class="annot"><span class="annottext">allFreeVar# :: forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVar%23"><span class="hs-identifier hs-var hs-var">allFreeVar#</span></a></span></span><span> </span><span id="local-6989586621681789419"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789419"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681789420"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789420"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader AnyFreeVar Any -&gt; AnyFreeVar -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader AnyFreeVar (Collect AnyFreeVar)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789420"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVar
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVar"><span class="hs-identifier hs-var">AnyFreeVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789422"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789422"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789419"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789422"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVar"><span class="hs-pragma hs-type">allFreeVar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-224"></span><span class="annot"><span class="hs-comment">-- | Compute the conjunction of a predicate on free variables.</span></span><span>
</span><span id="line-225"></span><span id="local-6989586621681789423"><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVar"><span class="hs-identifier hs-type">allFreeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789423"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789423"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-226"></span><span id="allFreeVar"><span class="annot"><span class="annottext">allFreeVar :: forall t. Free t =&gt; (Int -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVar"><span class="hs-identifier hs-var hs-var">allFreeVar</span></a></span></span><span> </span><span id="local-6989586621681789426"><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789426"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Bool) -&gt; t -&gt; Bool
forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVar%23"><span class="hs-identifier hs-var">allFreeVar#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789427"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789427"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789426"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789427"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-keyword">data</span><span> </span><span id="AnyFreeVarIgnoreAll"><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-var">AnyFreeVarIgnoreAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnyFreeVarIgnoreAll"><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-var">AnyFreeVarIgnoreAll</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789437"><span id="local-6989586621681789441"><span id="local-6989586621681789444"><span id="local-6989586621681789447"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-type">AnyFreeVarIgnoreAll</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-type">AnyFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621681789452"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; AnyFreeVarIgnoreAll -&gt; AnyFreeVarIgnoreAll
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789453"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789453"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-type">AnyFreeVarIgnoreAll</span></a></span><span> </span><span id="local-6989586621681789454"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789454"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789455"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789455"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVarIgnoreAll
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-var">AnyFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789453"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789454"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789455"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621681789458"><span class="annot"><span class="annottext">variable' :: Int -&gt; AnyFreeVarIgnoreAll -&gt; Collect AnyFreeVarIgnoreAll
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681789459"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789459"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-type">AnyFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621681789460"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789460"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681789461"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789461"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789459"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789460"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Any
Collect AnyFreeVarIgnoreAll
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789461"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789459"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">-#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789460"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-pragma hs-type">ignoreSorts'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621681789462"><span class="annot"><span class="annottext">ignoreSorts' :: IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-identifier hs-var hs-var hs-var">ignoreSorts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#IgnoreAll"><span class="hs-identifier hs-var">IgnoreAll</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll%23"><span class="hs-pragma hs-type">anyFreeVarIgnoreAll#</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Int#</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-241"></span><span id="local-6989586621681789465"><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll%23"><span class="hs-identifier hs-type">anyFreeVarIgnoreAll#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789465"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789465"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-242"></span><span id="anyFreeVarIgnoreAll%23"><span class="annot"><span class="annottext">anyFreeVarIgnoreAll# :: forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll%23"><span class="hs-identifier hs-var hs-var">anyFreeVarIgnoreAll#</span></a></span></span><span> </span><span id="local-6989586621681789469"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789469"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681789470"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789470"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader AnyFreeVarIgnoreAll Any -&gt; AnyFreeVarIgnoreAll -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader AnyFreeVarIgnoreAll (Collect AnyFreeVarIgnoreAll)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789470"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVarIgnoreAll
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-var">AnyFreeVarIgnoreAll</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789469"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll"><span class="hs-pragma hs-type">anyFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | Same as 'anyFreeVar' except occurrences in sorts of types are ignored.</span></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll"><span class="hs-identifier hs-type">anyFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-247"></span><span id="anyFreeVarIgnoreAll"><span class="annot"><span class="annottext">anyFreeVarIgnoreAll :: (Int -&gt; Bool) -&gt; Term -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll"><span class="hs-identifier hs-var hs-var">anyFreeVarIgnoreAll</span></a></span></span><span> </span><span id="local-6989586621681789471"><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789471"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Bool) -&gt; Term -&gt; Bool
forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#anyFreeVarIgnoreAll%23"><span class="hs-identifier hs-var">anyFreeVarIgnoreAll#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789472"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789472"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789471"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789472"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- SPECIALIZED to TCM.Constraint in SizedTypes.Solve</span><span>
</span><span id="line-250"></span><span id="local-6989586621681789473"><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll%23"><span class="hs-identifier hs-type">allFreeVarIgnoreAll#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-251"></span><span id="allFreeVarIgnoreAll%23"><span class="annot"><span class="annottext">allFreeVarIgnoreAll# :: forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll%23"><span class="hs-identifier hs-var hs-var">allFreeVarIgnoreAll#</span></a></span></span><span> </span><span id="local-6989586621681789478"><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789478"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681789479"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789479"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader AnyFreeVarIgnoreAll Any -&gt; AnyFreeVarIgnoreAll -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader AnyFreeVarIgnoreAll (Collect AnyFreeVarIgnoreAll)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789479"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int# -&gt; Bool) -&gt; AnyFreeVarIgnoreAll
</span><a href="Agda.TypeChecking.Free.html#AnyFreeVarIgnoreAll"><span class="hs-identifier hs-var">AnyFreeVarIgnoreAll</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789480"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789480"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="#local-6989586621681789478"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789480"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll"><span class="hs-pragma hs-type">allFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | Same as 'allFreeVar' except occurrences in sorts of types are ignored.</span></span><span>
</span><span id="line-256"></span><span id="local-6989586621681789481"><span class="annot"><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll"><span class="hs-identifier hs-type">allFreeVarIgnoreAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789481"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789481"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-257"></span><span id="allFreeVarIgnoreAll"><span class="annot"><span class="annottext">allFreeVarIgnoreAll :: forall t. Free t =&gt; (Int -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll"><span class="hs-identifier hs-var hs-var">allFreeVarIgnoreAll</span></a></span></span><span> </span><span id="local-6989586621681789484"><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789484"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Bool) -&gt; t -&gt; Bool
forall t. Free t =&gt; (Int# -&gt; Bool) -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#allFreeVarIgnoreAll%23"><span class="hs-identifier hs-var">allFreeVarIgnoreAll#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789485"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789485"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681789484"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621681789485"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><span class="hs-comment">-- ** Flex-rigid occurrence for a single variable</span></span><span>
</span><span id="line-260"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">data</span><span> </span><span id="SingleFR"><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-var">SingleFR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SingleFR"><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-var">SingleFR</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier hs-type">FlexRig</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#LensFlexRig"><span class="hs-identifier hs-type">LensFlexRig</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-pragma hs-type">lensFlexRig</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621681789491"><span class="annot"><span class="annottext">lensFlexRig :: Lens' SingleFR (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.Base.html#lensFlexRig"><span class="hs-identifier hs-var hs-var hs-var">lensFlexRig</span></a></span></span><span> </span><span id="local-6989586621681789492"><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789492"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span><span> </span><span id="local-6989586621681789493"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789493"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789494"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789494"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FlexRig' MetaSet -&gt; SingleFR
</span><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-var">SingleFR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789493"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(FlexRig' MetaSet -&gt; SingleFR)
-&gt; f (FlexRig' MetaSet) -&gt; f SingleFR
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; f (FlexRig' MetaSet)
</span><a href="#local-6989586621681789492"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789494"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">data</span><span> </span><span id="CollectSingleFR"><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSingleFR"><span class="hs-identifier hs-var">CollectSingleFR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CSFRNothing"><span class="annot"><a href="Agda.TypeChecking.Free.html#CSFRNothing"><span class="hs-identifier hs-var">CSFRNothing</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CSFRJust"><span class="annot"><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-var">CSFRJust</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier hs-type">FlexRig</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789499"><span id="local-6989586621681789503"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSingleFR"><span class="hs-identifier hs-type">CollectSingleFR</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-type">CSFRJust</span></a></span><span> </span><span id="local-6989586621681789509"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789509"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span id="local-6989586621681789510"><span class="annot"><span class="annottext">&lt;&gt; :: CollectSingleFR -&gt; CollectSingleFR -&gt; CollectSingleFR
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-type">CSFRJust</span></a></span><span> </span><span id="local-6989586621681789511"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789511"><span class="hs-identifier hs-var">fr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-var">CSFRJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; FlexRig' MetaSet -&gt; FlexRig' MetaSet
forall a. Semigroup a =&gt; FlexRig' a -&gt; FlexRig' a -&gt; FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#addFlexRig"><span class="hs-identifier hs-var">addFlexRig</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789509"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789511"><span class="hs-identifier hs-var">fr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRNothing"><span class="hs-identifier hs-var">CSFRNothing</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621681789513"><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789513"><span class="hs-identifier hs-var">s</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789513"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621681789514"><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789514"><span class="hs-identifier hs-var">s</span></a></span></span><span>           </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRNothing"><span class="hs-identifier hs-var">CSFRNothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789514"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789524"><span id="local-6989586621681789529"><span id="local-6989586621681789533"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSingleFR"><span class="hs-identifier hs-type">CollectSingleFR</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621681789536"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; SingleFR -&gt; SingleFR
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789537"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789537"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span><span> </span><span id="local-6989586621681789538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789538"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789539"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789539"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FlexRig' MetaSet -&gt; SingleFR
</span><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-var">SingleFR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789537"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789538"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789539"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621681789543"><span class="annot"><span class="annottext">variable' :: Int -&gt; SingleFR -&gt; Collect SingleFR
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789544"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789544"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-type">SingleFR</span></a></span><span> </span><span id="local-6989586621681789545"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789545"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789546"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789546"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CollectSingleFR -&gt; CollectSingleFR) -&gt; Endo CollectSingleFR
forall a. (a -&gt; a) -&gt; Endo a
</span><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-var">Endo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789547"><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789547"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789545"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789544"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789547"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">CollectSingleFR -&gt; CollectSingleFR -&gt; CollectSingleFR
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-var">CSFRJust</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789546"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="#local-6989586621681789547"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621681789550"><span class="annot"><span class="annottext">underConstructor' :: ConHead -&gt; Elims -&gt; SingleFR -&gt; SingleFR
</span><a href="Agda.TypeChecking.Free.Generic.html#underConstructor%27"><span class="hs-identifier hs-var hs-var hs-var">underConstructor'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; Elims -&gt; SingleFR -&gt; SingleFR
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
ConHead -&gt; Elims -&gt; r -&gt; r
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderConstructor"><span class="hs-identifier hs-var">defaultUnderConstructor</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underConstructor%27"><span class="hs-pragma hs-type">underConstructor'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621681789553"><span class="annot"><span class="annottext">underFlexRig' :: Maybe (FlexRig' MetaSet -&gt; SingleFR -&gt; SingleFR)
</span><a href="Agda.TypeChecking.Free.Generic.html#underFlexRig%27"><span class="hs-identifier hs-var hs-var hs-var">underFlexRig'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FlexRig' MetaSet -&gt; SingleFR -&gt; SingleFR)
forall a r.
(Semigroup a, LensFlexRig r a) =&gt;
Maybe (FlexRig' a -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderFlexRig"><span class="hs-identifier hs-var">defaultUnderFlexRig</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underFlexRig%27"><span class="hs-pragma hs-type">underFlexRig'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-pragma hs-type">flexRigOccurrenceIn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-pragma hs-type">FlexRig</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-285"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-pragma hs-type">flexRigOccurrenceIn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort%27"><span class="hs-pragma hs-type">Sort'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-pragma hs-type">FlexRig</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- | Compute 'FlexRig' for a single variable.</span></span><span>
</span><span id="line-287"></span><span id="local-6989586621681789001"><span class="annot"><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-identifier hs-type">flexRigOccurrenceIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#FlexRig"><span class="hs-identifier hs-type">FlexRig</span></a></span></span><span>
</span><span id="line-288"></span><span id="flexRigOccurrenceIn"><span class="annot"><span class="annottext">flexRigOccurrenceIn :: forall a. Free a =&gt; Int -&gt; a -&gt; Maybe (FlexRig' MetaSet)
</span><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-identifier hs-var hs-var">flexRigOccurrenceIn</span></a></span></span><span> </span><span id="local-6989586621681789558"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789558"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789559"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789559"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Endo CollectSingleFR -&gt; CollectSingleFR -&gt; CollectSingleFR
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictFlipEndo.html#appEndo"><span class="hs-identifier hs-var">appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader SingleFR (Endo CollectSingleFR)
-&gt; SingleFR -&gt; Endo CollectSingleFR
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Reader SingleFR (Collect SingleFR)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; a -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789559"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FlexRig' MetaSet -&gt; SingleFR
</span><a href="Agda.TypeChecking.Free.html#SingleFR"><span class="hs-identifier hs-var">SingleFR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789558"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
forall a. FlexRig' a
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRNothing"><span class="hs-identifier hs-var">CSFRNothing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="annottext">CollectSingleFR
</span><a href="Agda.TypeChecking.Free.html#CSFRNothing"><span class="hs-identifier hs-var">CSFRNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FlexRig' MetaSet)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CSFRJust"><span class="hs-identifier hs-type">CSFRJust</span></a></span><span> </span><span id="local-6989586621681789561"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789561"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet -&gt; Maybe (FlexRig' MetaSet)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789561"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- ** Plain free occurrence</span></span><span>
</span><span id="line-293"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeIn"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-var">FreeIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeIn"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-var">FreeIn</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789571"><span id="local-6989586621681789575"><span id="local-6989586621681789578"><span id="local-6989586621681789581"><span id="local-6989586621681789585"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621681789588"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeIn -&gt; FreeIn
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789589"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789589"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span id="local-6989586621681789590"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789590"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeIn
</span><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-var">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789589"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789590"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621681789592"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeIn -&gt; Collect FreeIn
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789593"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789593"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span id="local-6989586621681789594"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789594"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789594"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789593"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-pragma hs-type">freeIn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-303"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-pragma hs-type">freeIn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-304"></span><span class="annot"><span class="hs-comment">-- | Check if single variable occurs freely.</span></span><span>
</span><span id="line-305"></span><span id="local-6989586621681789005"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-identifier hs-type">freeIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789005"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789005"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-306"></span><span id="freeIn"><span class="annot"><span class="annottext">freeIn :: forall t. Free t =&gt; Int -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-identifier hs-var hs-var">freeIn</span></a></span></span><span> </span><span id="local-6989586621681789598"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789598"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789599"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789599"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeIn Any -&gt; FreeIn -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeIn (Collect FreeIn)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789599"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeIn
</span><a href="Agda.TypeChecking.Free.html#FreeIn"><span class="hs-identifier hs-var">FreeIn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789598"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeInIgnoringSorts"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-var">FreeInIgnoringSorts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeInIgnoringSorts"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-var">FreeInIgnoringSorts</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789609"><span id="local-6989586621681789613"><span id="local-6989586621681789616"><span id="local-6989586621681789619"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-type">FreeInIgnoringSorts</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-type">FreeInIgnoringSorts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621681789624"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeInIgnoringSorts -&gt; FreeInIgnoringSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789625"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789625"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-type">FreeInIgnoringSorts</span></a></span><span> </span><span id="local-6989586621681789626"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789626"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeInIgnoringSorts
</span><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-var">FreeInIgnoringSorts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789625"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789626"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621681789628"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeInIgnoringSorts -&gt; Collect FreeInIgnoringSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789629"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789629"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-type">FreeInIgnoringSorts</span></a></span><span> </span><span id="local-6989586621681789630"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789630"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789630"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789629"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621681789631"><span class="annot"><span class="annottext">ignoreSorts' :: IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-identifier hs-var hs-var hs-var">ignoreSorts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#IgnoreAll"><span class="hs-identifier hs-var">IgnoreAll</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-pragma hs-type">ignoreSorts'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeInIgnoringSorts"><span class="hs-pragma hs-type">freeInIgnoringSorts</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-317"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeInIgnoringSorts"><span class="hs-pragma hs-type">freeInIgnoringSorts</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-318"></span><span class="annot"><span class="hs-comment">-- | Check if a single variable occurs freely outside of sorts of types.</span></span><span>
</span><span id="line-319"></span><span id="local-6989586621681789632"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeInIgnoringSorts"><span class="hs-identifier hs-type">freeInIgnoringSorts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-320"></span><span id="freeInIgnoringSorts"><span class="annot"><span class="annottext">freeInIgnoringSorts :: forall t. Free t =&gt; Int -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#freeInIgnoringSorts"><span class="hs-identifier hs-var hs-var">freeInIgnoringSorts</span></a></span></span><span> </span><span id="local-6989586621681789636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789636"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789637"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789637"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeInIgnoringSorts Any -&gt; FreeInIgnoringSorts -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Reader FreeInIgnoringSorts (Collect FreeInIgnoringSorts)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; a -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789637"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeInIgnoringSorts
</span><a href="Agda.TypeChecking.Free.html#FreeInIgnoringSorts"><span class="hs-identifier hs-var">FreeInIgnoringSorts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789636"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#isBinderUsed"><span class="hs-pragma hs-type">isBinderUsed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-323"></span><span class="annot"><span class="hs-comment">-- | Is the variable bound by the abstraction actually used?</span></span><span>
</span><span id="line-324"></span><span id="local-6989586621681789009"><span class="annot"><a href="Agda.TypeChecking.Free.html#isBinderUsed"><span class="hs-identifier hs-type">isBinderUsed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-325"></span><span id="isBinderUsed"><span class="annot"><span class="annottext">isBinderUsed :: forall a. Free a =&gt; Abs a -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#isBinderUsed"><span class="hs-identifier hs-var hs-var">isBinderUsed</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#NoAbs"><span class="hs-identifier hs-type">NoAbs</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#isBinderUsed"><span class="hs-identifier hs-var">isBinderUsed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681789642"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789642"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Bool
forall t. Free t =&gt; Int -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#freeIn"><span class="hs-operator hs-var">`freeIn`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681789642"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><span class="hs-comment">-- ** Relevant free occurrence.</span></span><span>
</span><span id="line-329"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-keyword">data</span><span> </span><span id="RelevantInIgnoringSortAnn"><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RelevantInIgnoringSortAnn"><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789646"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621681789650"><span class="annot"><span class="annottext">getRelevance :: RelevantInIgnoringSortAnn -&gt; Relevance
</span><a href="#local-6989586621681789650"><span class="hs-identifier hs-var hs-var hs-var">getRelevance</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681789652"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789652"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789652"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621681789653"><span class="annot"><span class="annottext">mapRelevance :: (Relevance -&gt; Relevance)
-&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn
</span><a href="#local-6989586621681789653"><span class="hs-identifier hs-var hs-var hs-var">mapRelevance</span></a></span></span><span> </span><span id="local-6989586621681789655"><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="#local-6989586621681789655"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span id="local-6989586621681789656"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789656"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789657"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789657"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789656"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="#local-6989586621681789655"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789657"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789666"><span id="local-6989586621681789671"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621681789677"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789678"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789678"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span id="local-6989586621681789679"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789679"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789680"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789680"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789678"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789679"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789680"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621681789684"><span class="annot"><span class="annottext">variable' :: Int
-&gt; RelevantInIgnoringSortAnn -&gt; Collect RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789685"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789685"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span id="local-6989586621681789686"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789686"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789687"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789687"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789685"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789686"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789687"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621681789690"><span class="annot"><span class="annottext">ignoreSorts' :: IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-identifier hs-var hs-var hs-var">ignoreSorts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#IgnoreInAnnotations"><span class="hs-identifier hs-var">IgnoreInAnnotations</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-pragma hs-type">ignoreSorts'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-pragma hs-type">underModality'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621681789693"><span class="annot"><span class="annottext">underModality' :: Maybe
  (Modality
   -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn)
</span><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-identifier hs-var hs-var hs-var">underModality'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Modality
 -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn)
-&gt; Maybe
     (Modality
      -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789694"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681789694"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-type">RelevantInIgnoringSortAnn</span></a></span><span> </span><span id="local-6989586621681789695"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789695"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789696"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789696"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789695"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#composeRelevance"><span class="hs-identifier hs-var">composeRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681789694"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789696"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621681789699"><span class="annot"><span class="annottext">underRelevance' :: Maybe
  (Relevance
   -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn)
</span><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-identifier hs-var hs-var hs-var">underRelevance'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe
  (Relevance
   -&gt; RelevantInIgnoringSortAnn -&gt; RelevantInIgnoringSortAnn)
forall r. LensRelevance r =&gt; Maybe (Relevance -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderRelevance"><span class="hs-identifier hs-var">defaultUnderRelevance</span></a></span><span class="hs-special">;</span><span>   </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-pragma hs-type">underRelevance'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-pragma hs-type">relevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-351"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-pragma hs-type">relevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-352"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-pragma hs-type">relevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-pragma hs-type">Nat</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom%27"><span class="hs-pragma hs-type">Dom'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">-- | Does a variable occur relevantly and outside of sorts of types?</span></span><span>
</span><span id="line-354"></span><span id="local-6989586621681789700"><span class="annot"><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-identifier hs-type">relevantInIgnoringSortAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789700"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789700"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-355"></span><span id="relevantInIgnoringSortAnn"><span class="annot"><span class="annottext">relevantInIgnoringSortAnn :: forall t. Free t =&gt; Int -&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#relevantInIgnoringSortAnn"><span class="hs-identifier hs-var hs-var">relevantInIgnoringSortAnn</span></a></span></span><span> </span><span id="local-6989586621681789704"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789704"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789705"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789705"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader RelevantInIgnoringSortAnn Any
-&gt; RelevantInIgnoringSortAnn -&gt; Any
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
-&gt; Reader
     RelevantInIgnoringSortAnn (Collect RelevantInIgnoringSortAnn)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789705"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; RelevantInIgnoringSortAnn
</span><a href="Agda.TypeChecking.Free.html#RelevantInIgnoringSortAnn"><span class="hs-identifier hs-var">RelevantInIgnoringSortAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789704"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#unitRelevance"><span class="hs-identifier hs-var">unitRelevance</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="annot"><span class="hs-comment">-- ** Closed objects</span></span><span>
</span><span id="line-359"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-keyword">newtype</span><span> </span><span id="Closed"><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Closed"><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Local scope size.</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789716"><span id="local-6989586621681789720"><span id="local-6989586621681789723"><span id="local-6989586621681789726"><span id="local-6989586621681789730"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621681789735"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; Closed -&gt; Closed
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789736"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789736"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span id="local-6989586621681789737"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789737"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Closed
</span><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789737"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621681789739"><span class="annot"><span class="annottext">variable' :: Int -&gt; Closed -&gt; Collect Closed
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789740"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789740"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span id="local-6989586621681789741"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789741"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789740"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789741"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#closed"><span class="hs-pragma hs-type">closed</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-369"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#closed"><span class="hs-pragma hs-type">closed</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom%27"><span class="hs-pragma hs-type">Dom'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-370"></span><span class="annot"><span class="hs-comment">-- | Is a term closed?</span></span><span>
</span><span id="line-371"></span><span id="local-6989586621681789018"><span class="annot"><a href="Agda.TypeChecking.Free.html#closed"><span class="hs-identifier hs-type">closed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789018"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789018"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-372"></span><span id="closed"><span class="annot"><span class="annottext">closed :: forall t. Free t =&gt; t -&gt; Bool
</span><a href="Agda.TypeChecking.Free.html#closed"><span class="hs-identifier hs-var hs-var">closed</span></a></span></span><span> </span><span id="local-6989586621681789746"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789746"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var">getAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader Closed All -&gt; Closed -&gt; All
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader Closed (Collect Closed)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789746"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Closed
</span><a href="Agda.TypeChecking.Free.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">-- ** Test free occurrence for a set of variables</span></span><span>
</span><span id="line-375"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-keyword">data</span><span> </span><span id="SetRelInIgnoring"><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SetRelInIgnoring"><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789751"><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621681789755"><span class="annot"><span class="annottext">getRelevance :: SetRelInIgnoring -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var hs-var hs-var">getRelevance</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681789756"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789756"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789756"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621681789757"><span class="annot"><span class="annottext">mapRelevance :: (Relevance -&gt; Relevance) -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring
</span><a href="Agda.Syntax.Common.html#mapRelevance"><span class="hs-identifier hs-var hs-var hs-var">mapRelevance</span></a></span></span><span> </span><span id="local-6989586621681789758"><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="#local-6989586621681789758"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span id="local-6989586621681789759"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789759"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789760"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789760"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789759"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="#local-6989586621681789758"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789760"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-keyword">newtype</span><span> </span><span id="CollectSFII"><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CollectSFII"><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span></span><span> </span><span class="hs-special">{</span><span id="appCSFII"><span class="annot"><span class="annottext">CollectSFII -&gt; VarSet -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#appCSFII"><span class="hs-identifier hs-var hs-var">appCSFII</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789765"><span id="local-6989586621681789769"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span><span> </span><span id="local-6989586621681789773"><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621681789773"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681789774"><span class="annot"><span class="annottext">&lt;&gt; :: CollectSFII -&gt; CollectSFII -&gt; CollectSFII
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span><span> </span><span id="local-6989586621681789775"><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621681789775"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; CollectSFII
</span><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; VarSet -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789776"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789776"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621681789773"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789776"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621681789777"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789777"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier hs-var">VarSet.null</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789777"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789777"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621681789775"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789777"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789783"><span id="local-6989586621681789787"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">mempty</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621681789790"><span class="annot"><span class="annottext">mempty :: CollectSFII
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; CollectSFII
</span><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789791"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789791"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789791"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.ExpandCase.html#ExpandCase"><span class="hs-identifier hs-type">ExpandCase</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Result"><span class="annot"><a href="Agda.Utils.ExpandCase.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.Utils.ExpandCase.html#expand"><span class="hs-pragma hs-type">expand</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621681789796"><span class="annot"><span class="annottext">expand :: ((CollectSFII -&gt; Result CollectSFII) -&gt; Result CollectSFII)
-&gt; CollectSFII
</span><a href="Agda.Utils.ExpandCase.html#expand"><span class="hs-identifier hs-var hs-var hs-var">expand</span></a></span></span><span> </span><span id="local-6989586621681789797"><span class="annot"><span class="annottext">(CollectSFII -&gt; Result CollectSFII) -&gt; Result CollectSFII
</span><a href="#local-6989586621681789797"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; CollectSFII
</span><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; VarSet -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789798"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789798"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CollectSFII -&gt; Result CollectSFII) -&gt; Result CollectSFII
</span><a href="#local-6989586621681789797"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CollectSFII -&gt; VarSet) -&gt; CollectSFII -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789799"><span class="annot"><span class="annottext">CollectSFII
</span><a href="#local-6989586621681789799"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CollectSFII -&gt; VarSet -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#appCSFII"><span class="hs-identifier hs-var">appCSFII</span></a></span><span> </span><span class="annot"><span class="annottext">CollectSFII
</span><a href="#local-6989586621681789799"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789798"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789808"><span id="local-6989586621681789813"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-type">CollectSFII</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621681789819"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789820"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span id="local-6989586621681789821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789821"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789822"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789822"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789820"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789821"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789822"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621681789826"><span class="annot"><span class="annottext">variable' :: Int -&gt; SetRelInIgnoring -&gt; Collect SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789827"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789827"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span id="local-6989586621681789828"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789828"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789829"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789829"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; CollectSFII
</span><a href="Agda.TypeChecking.Free.html#CollectSFII"><span class="hs-identifier hs-var">CollectSFII</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789830"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789830"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789827"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789828"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789829"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#delete"><span class="hs-identifier hs-var">VarSet.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789827"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789828"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789830"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789830"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621681789832"><span class="annot"><span class="annottext">ignoreSorts' :: IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-identifier hs-var hs-var hs-var">ignoreSorts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreSorts
</span><a href="Agda.TypeChecking.Free.Base.html#IgnoreInAnnotations"><span class="hs-identifier hs-var">IgnoreInAnnotations</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ignoreSorts%27"><span class="hs-pragma hs-type">ignoreSorts'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621681789834"><span class="annot"><span class="annottext">underModality' :: Maybe (Modality -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring)
</span><a href="Agda.TypeChecking.Free.Generic.html#underModality%27"><span class="hs-identifier hs-var hs-var hs-var">underModality'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring)
-&gt; Maybe (Modality -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789835"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681789835"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-type">SetRelInIgnoring</span></a></span><span> </span><span id="local-6989586621681789836"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789836"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681789837"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789837"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789836"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#composeRelevance"><span class="hs-identifier hs-var">composeRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681789835"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681789837"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621681789839"><span class="annot"><span class="annottext">underRelevance' :: Maybe (Relevance -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring)
</span><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-identifier hs-var hs-var hs-var">underRelevance'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Relevance -&gt; SetRelInIgnoring -&gt; SetRelInIgnoring)
forall r. LensRelevance r =&gt; Maybe (Relevance -&gt; r -&gt; r)
</span><a href="Agda.TypeChecking.Free.Generic.html#defaultUnderRelevance"><span class="hs-identifier hs-var">defaultUnderRelevance</span></a></span><span class="hs-special">;</span><span>   </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underRelevance%27"><span class="hs-pragma hs-type">underRelevance'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#setRelInIgnoring"><span class="hs-pragma hs-type">setRelInIgnoring</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-pragma hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-414"></span><span class="hs-pragma">{-# SPECIALIZE NOINLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#setRelInIgnoring"><span class="hs-pragma hs-type">setRelInIgnoring</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Test for a set of variables whether each variable occurs relevantly and outside of sort annotations.</span><span>
</span><span id="line-416"></span><span class="hs-comment">--   Return the set of variables that __don't__ occur.</span><span>
</span><span id="line-417"></span><span id="local-6989586621681789027"><span class="annot"><a href="Agda.TypeChecking.Free.html#setRelInIgnoring"><span class="hs-identifier hs-type">setRelInIgnoring</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789027"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789027"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span><span>
</span><span id="line-418"></span><span id="setRelInIgnoring"><span class="annot"><span class="annottext">setRelInIgnoring :: forall t. Free t =&gt; VarSet -&gt; t -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#setRelInIgnoring"><span class="hs-identifier hs-var hs-var">setRelInIgnoring</span></a></span></span><span> </span><span id="local-6989586621681789843"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789843"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681789844"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789844"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Bool
</span><a href="Agda.Utils.VarSet.html#null"><span class="hs-identifier hs-var">VarSet.null</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789843"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789843"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollectSFII -&gt; VarSet -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#appCSFII"><span class="hs-identifier hs-var">appCSFII</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader SetRelInIgnoring CollectSFII
-&gt; SetRelInIgnoring -&gt; CollectSFII
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader SetRelInIgnoring (Collect SetRelInIgnoring)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789844"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Relevance -&gt; SetRelInIgnoring
</span><a href="Agda.TypeChecking.Free.html#SetRelInIgnoring"><span class="hs-identifier hs-var">SetRelInIgnoring</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#unitRelevance"><span class="hs-identifier hs-var">unitRelevance</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789843"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">-- ** Collect free variables</span></span><span>
</span><span id="line-424"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeVarSet"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-var">FreeVarSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarSet"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-var">FreeVarSet</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789854"><span id="local-6989586621681789858"><span id="local-6989586621681789861"><span id="local-6989586621681789864"><span id="local-6989586621681789868"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-type">FreeVarSet</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-type">FreeVarSet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621681789871"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeVarSet -&gt; FreeVarSet
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789872"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789872"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-type">FreeVarSet</span></a></span><span> </span><span id="local-6989586621681789873"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789873"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeVarSet
</span><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-var">FreeVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789872"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789873"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-433"></span><span>  </span><span id="local-6989586621681789876"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeVarSet -&gt; Collect FreeVarSet
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789877"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789877"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-type">FreeVarSet</span></a></span><span> </span><span id="local-6989586621681789878"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789878"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; Endo VarSet
forall a. (a -&gt; a) -&gt; Endo a
</span><a href="Agda.Utils.StrictFlipEndo.html#Endo"><span class="hs-identifier hs-var">Endo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789879"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789879"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789877"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789878"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789879"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-var">VarSet.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789877"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789878"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789879"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarSet"><span class="hs-pragma hs-type">freeVarSet</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-436"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarSet"><span class="hs-pragma hs-type">freeVarSet</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom%27"><span class="hs-pragma hs-type">Dom'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-pragma hs-type">Type</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-pragma hs-type">VarSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-437"></span><span class="annot"><span class="hs-comment">-- | Compute the set of free variables.</span></span><span>
</span><span id="line-438"></span><span id="local-6989586621681789030"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarSet"><span class="hs-identifier hs-type">freeVarSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789030"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789030"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span></span><span>
</span><span id="line-439"></span><span id="freeVarSet"><span class="annot"><span class="annottext">freeVarSet :: forall t. Free t =&gt; t -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#freeVarSet"><span class="hs-identifier hs-var hs-var">freeVarSet</span></a></span></span><span> </span><span id="local-6989586621681789885"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789885"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet -&gt; VarSet
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictFlipEndo.html#appEndo"><span class="hs-identifier hs-var">appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeVarSet (Endo VarSet) -&gt; FreeVarSet -&gt; Endo VarSet
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeVarSet (Collect FreeVarSet)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789885"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeVarSet
</span><a href="Agda.TypeChecking.Free.html#FreeVarSet"><span class="hs-identifier hs-var">FreeVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeVarList"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-var">FreeVarList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarList"><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-var">FreeVarList</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681789895"><span id="local-6989586621681789899"><span id="local-6989586621681789902"><span id="local-6989586621681789905"><span id="local-6989586621681789909"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#ComputeFree"><span class="hs-identifier hs-type">ComputeFree</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-type">FreeVarList</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-comment">-- Need the non-flipped endo to get left-right element order</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-type">FreeVarList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.StrictEndo.html#Endo"><span class="hs-identifier hs-type">NonFlip.Endo</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-pragma hs-type">underBinders'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621681789914"><span class="annot"><span class="annottext">underBinders' :: Int -&gt; FreeVarList -&gt; FreeVarList
</span><a href="Agda.TypeChecking.Free.Generic.html#underBinders%27"><span class="hs-identifier hs-var hs-var hs-var">underBinders'</span></a></span></span><span> </span><span id="local-6989586621681789915"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789915"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-type">FreeVarList</span></a></span><span> </span><span id="local-6989586621681789916"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789916"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FreeVarList
</span><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-var">FreeVarList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789915"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789916"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-pragma hs-type">variable'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621681789919"><span class="annot"><span class="annottext">variable' :: Int -&gt; FreeVarList -&gt; Collect FreeVarList
</span><a href="Agda.TypeChecking.Free.Generic.html#variable%27"><span class="hs-identifier hs-var hs-var hs-var">variable'</span></a></span></span><span> </span><span id="local-6989586621681789920"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789920"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-type">FreeVarList</span></a></span><span> </span><span id="local-6989586621681789921"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789921"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; Endo [Int]
forall a. (a -&gt; a) -&gt; Endo a
</span><a href="Agda.Utils.StrictEndo.html#Endo"><span class="hs-identifier hs-var">NonFlip.Endo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681789923"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789923"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789920"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789923"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681789924"><span class="annot"><span class="annottext">v :: Int
</span><a href="#local-6989586621681789924"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789920"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789924"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789923"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarList"><span class="hs-pragma hs-type">freeVarList</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-453"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarList"><span class="hs-pragma hs-type">freeVarList</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-pragma hs-type">Term</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">-- | Compute a (possibly non-unique) list of free variables, in preorder traversal order.</span></span><span>
</span><span id="line-455"></span><span id="local-6989586621681789037"><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVarList"><span class="hs-identifier hs-type">freeVarList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Generic.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681789037"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681789037"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-456"></span><span id="freeVarList"><span class="annot"><span class="annottext">freeVarList :: forall t. Free t =&gt; t -&gt; [Int]
</span><a href="Agda.TypeChecking.Free.html#freeVarList"><span class="hs-identifier hs-var hs-var">freeVarList</span></a></span></span><span> </span><span id="local-6989586621681789928"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789928"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo [Int] -&gt; [Int] -&gt; [Int]
forall a. Endo a -&gt; a -&gt; a
</span><a href="Agda.Utils.StrictEndo.html#appEndo"><span class="hs-identifier hs-var">NonFlip.appEndo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader FreeVarList (Endo [Int]) -&gt; FreeVarList -&gt; Endo [Int]
forall r a. Reader r a -&gt; r -&gt; a
</span><a href="Agda.Utils.StrictReader.html#runReader"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Reader FreeVarList (Collect FreeVarList)
forall t r. (Free t, ComputeFree r) =&gt; t -&gt; Reader r (Collect r)
forall r. ComputeFree r =&gt; t -&gt; Reader r (Collect r)
</span><a href="Agda.TypeChecking.Free.Generic.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681789928"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FreeVarList
</span><a href="Agda.TypeChecking.Free.html#FreeVarList"><span class="hs-identifier hs-var">FreeVarList</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><span class="hs-comment">-- ** Backwards-compatible interface, for extracting information from a 'VarMap'.</span></span><span>
</span><span id="line-459"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-pragma hs-type">filterVarMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-462"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-type">filterVarMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-463"></span><span id="filterVarMap"><span class="annot"><span class="annottext">filterVarMap :: (VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-var hs-var">filterVarMap</span></a></span></span><span> </span><span id="local-6989586621681789930"><span class="annot"><span class="annottext">VarOcc -&gt; Bool
</span><a href="#local-6989586621681789930"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span id="local-6989586621681789931"><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789931"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="annottext">(VarSet -&gt; Int -&gt; VarOcc -&gt; VarSet)
-&gt; VarSet -&gt; IntMap VarOcc -&gt; VarSet
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><span class="hs-identifier hs-var">IntMap.foldlWithKey'</span></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789933"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789933"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621681789934"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789934"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681789935"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789935"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VarOcc -&gt; Bool
</span><a href="#local-6989586621681789930"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789935"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet -&gt; VarSet
</span><a href="Agda.Utils.VarSet.html#insert"><span class="hs-identifier hs-var">VarSet.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789934"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789933"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681789933"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789931"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMapToList"><span class="hs-pragma hs-type">filterVarMapToList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-469"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#filterVarMapToList"><span class="hs-identifier hs-type">filterVarMapToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span id="filterVarMapToList"><span class="annot"><span class="annottext">filterVarMapToList :: (VarOcc -&gt; Bool) -&gt; VarMap -&gt; [Int]
</span><a href="Agda.TypeChecking.Free.html#filterVarMapToList"><span class="hs-identifier hs-var hs-var">filterVarMapToList</span></a></span></span><span> </span><span id="local-6989586621681789936"><span class="annot"><span class="annottext">VarOcc -&gt; Bool
</span><a href="#local-6989586621681789936"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span id="local-6989586621681789937"><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789937"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; VarOcc -&gt; [Int] -&gt; [Int])
-&gt; [Int] -&gt; IntMap VarOcc -&gt; [Int]
forall a b. (Int -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; IntMap a -&gt; b
</span><span class="hs-identifier hs-var">IntMap.foldrWithKey'</span></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681789939"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789939"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681789940"><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789940"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681789941"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789941"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VarOcc -&gt; Bool
</span><a href="#local-6989586621681789936"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><a href="#local-6989586621681789940"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681789939"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789941"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681789941"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789937"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><span class="hs-comment">-- | Variables under only and at least one inductive constructor(s).</span></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#stronglyRigidVars"><span class="hs-identifier hs-type">stronglyRigidVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-477"></span><span id="stronglyRigidVars"><span class="annot"><span class="annottext">stronglyRigidVars :: VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#stronglyRigidVars"><span class="hs-identifier hs-var hs-var">stronglyRigidVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-var">filterVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">((VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet)
-&gt; (VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">VarOcc
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">-- | Variables at top or only under inductive record constructors</span><span>
</span><span id="line-482"></span><span class="hs-comment">--   &#955;s and &#928;s.</span><span>
</span><span id="line-483"></span><span class="hs-comment">--   The purpose of recording these separately is that they</span><span>
</span><span id="line-484"></span><span class="hs-comment">--   can still become strongly rigid if put under a constructor</span><span>
</span><span id="line-485"></span><span class="hs-comment">--   whereas weakly rigid ones stay weakly rigid.</span><span>
</span><span id="line-486"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#unguardedVars"><span class="hs-identifier hs-type">unguardedVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-487"></span><span id="unguardedVars"><span class="annot"><span class="annottext">unguardedVars :: VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#unguardedVars"><span class="hs-identifier hs-var hs-var">unguardedVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-var">filterVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">((VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet)
-&gt; (VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="annottext">VarOcc
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">-- | Rigid variables: either strongly rigid, unguarded, or weakly rigid.</span></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#rigidVars"><span class="hs-identifier hs-type">rigidVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-493"></span><span id="rigidVars"><span class="annot"><span class="annottext">rigidVars :: VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#rigidVars"><span class="hs-identifier hs-var hs-var">rigidVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-var">filterVarMap</span></a></span><span> </span><span class="annot"><span class="annottext">((VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet)
-&gt; (VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span id="local-6989586621681789944"><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789944"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="#local-6989586621681789944"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-495"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#WeaklyRigid"><span class="hs-identifier hs-var">WeaklyRigid</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#Unguarded"><span class="hs-identifier hs-var">Unguarded</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><a href="Agda.TypeChecking.Free.Base.html#StronglyRigid"><span class="hs-identifier hs-var">StronglyRigid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">FlexRig' MetaSet
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- | Variables occuring in arguments of metas.</span><span>
</span><span id="line-501"></span><span class="hs-comment">--  These are only potentially free, depending how the meta variable is instantiated.</span><span>
</span><span id="line-502"></span><span class="hs-comment">--  The set contains the id's of the meta variables that this variable is an argument to.</span><span>
</span><span id="line-503"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexibleVars"><span class="hs-identifier hs-type">flexibleVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#MetaSet"><span class="hs-identifier hs-type">MetaSet</span></a></span><span>
</span><span id="line-504"></span><span id="flexibleVars"><span class="annot"><span class="annottext">flexibleVars :: VarMap -&gt; IntMap MetaSet
</span><a href="Agda.TypeChecking.Free.html#flexibleVars"><span class="hs-identifier hs-var hs-var">flexibleVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span id="local-6989586621681789946"><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789946"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((VarOcc -&gt; Maybe MetaSet) -&gt; IntMap VarOcc -&gt; IntMap MetaSet)
-&gt; IntMap VarOcc -&gt; (VarOcc -&gt; Maybe MetaSet) -&gt; IntMap MetaSet
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; Maybe MetaSet) -&gt; IntMap VarOcc -&gt; IntMap MetaSet
forall a b. (a -&gt; Maybe b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IntMap.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">IntMap VarOcc
</span><a href="#local-6989586621681789946"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">((VarOcc -&gt; Maybe MetaSet) -&gt; IntMap MetaSet)
-&gt; (VarOcc -&gt; Maybe MetaSet) -&gt; IntMap MetaSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-505"></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarOcc"><span class="hs-identifier hs-type">VarOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621681789950"><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681789950"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MetaSet -&gt; Maybe MetaSet
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MetaSet
</span><a href="#local-6989586621681789950"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-506"></span><span> </span><span class="annot"><span class="annottext">VarOcc
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe MetaSet
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Agda.TypeChecking.Free.html#allVars"><span class="hs-identifier hs-type">allVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.Base.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-509"></span><span id="allVars"><span class="annot"><span class="annottext">allVars :: VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#allVars"><span class="hs-identifier hs-var hs-var">allVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarOcc -&gt; Bool) -&gt; VarMap -&gt; VarSet
</span><a href="Agda.TypeChecking.Free.html#filterVarMap"><span class="hs-identifier hs-var">filterVarMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">VarOcc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span></pre></body></html>