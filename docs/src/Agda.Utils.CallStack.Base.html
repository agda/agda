<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html"><span class="hs-identifier">Agda.Utils.CallStack.Base</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Simple type aliases</span></span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocPackage"><span class="hs-identifier">SrcLocPackage</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocModule"><span class="hs-identifier">SrcLocModule</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcFun"><span class="hs-identifier">SrcFun</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocFile"><span class="hs-identifier">SrcLocFile</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocLine"><span class="hs-identifier">SrcLocLine</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocCol"><span class="hs-identifier">SrcLocCol</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier">CallSite</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSiteFilter"><span class="hs-identifier">CallSiteFilter</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- * String-based &quot;pretty&quot; representations</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prettySrcLoc</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#prettyCallSite"><span class="hs-identifier">prettyCallSite</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#prettyCallStack"><span class="hs-identifier">prettyCallStack</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Generic utilities over CallStack and CallSite</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#filterCallStack"><span class="hs-identifier">filterCallStack</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#headCallSite"><span class="hs-identifier">headCallSite</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#overCallSites"><span class="hs-identifier">overCallSites</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier">popnCallStack</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#truncatedCallStack"><span class="hs-identifier">truncatedCallStack</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withCallerCallStack"><span class="hs-identifier">withCallerCallStack</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withCurrentCallStack"><span class="hs-identifier">withCurrentCallStack</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withNBackCallStack"><span class="hs-identifier">withNBackCallStack</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Re-exported stuff</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CallStack</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">callStack</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromCallSiteList</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCallStack</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">intercalate</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">listToMaybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">callStack</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CallStack</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">emptyCallStack</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromCallSiteList</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCallStack</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">popCallStack</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prettySrcLoc</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><span class="hs-comment">-- * Type aliases</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Type of the package name of a @SrcLoc@</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | e.g. `Agda-2.&#8230;`</span><span>
</span><span id="line-57"></span><span class="hs-keyword">type</span><span> </span><span id="SrcLocPackage"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocPackage"><span class="hs-identifier hs-var">SrcLocPackage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Type of the module name of a @SrcLoc@</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | e.g. `Agda.Utils.Foo`</span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="SrcLocModule"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocModule"><span class="hs-identifier hs-var">SrcLocModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Type of the name of a function in a @CallSite@</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | e.g. `proveEverything`</span><span>
</span><span id="line-65"></span><span class="hs-keyword">type</span><span> </span><span id="SrcFun"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcFun"><span class="hs-identifier hs-var">SrcFun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Type of a filename of a @SrcLoc@</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | e.g. `src/full/Agda/Utils/Foo.hs`</span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="SrcLocFile"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocFile"><span class="hs-identifier hs-var">SrcLocFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">-- | Type of a line number of a @SrcLoc@</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="SrcLocLine"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocLine"><span class="hs-identifier hs-var">SrcLocLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">-- | Type of a column of a @SrcLoc@</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="SrcLocCol"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcLocCol"><span class="hs-identifier hs-var">SrcLocCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Type of an entry in  a @CallStack@</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">newtype</span><span> </span><span id="CallSite"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-var">CallSite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CallSite"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-var">CallSite</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unCallSite"><span class="annot"><span class="annottext">CallSite -&gt; ([Char], SrcLoc)
</span><a href="Agda.Utils.CallStack.Base.html#unCallSite"><span class="hs-identifier hs-var hs-var">unCallSite</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#SrcFun"><span class="hs-identifier hs-type">SrcFun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SrcLoc</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Type of a filter for @CallSite@</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span id="CallSiteFilter"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSiteFilter"><span class="hs-identifier hs-var">CallSiteFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- * Simple String representations</span></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Note that there are @Agda.Syntax.Common.Pretty@ instances defined in @Agda.Utils.CallStack.Pretty@</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | The same as the un-exported internal function in @GHC.Exceptions (prettyCallStackLines)@</span><span>
</span><span id="line-87"></span><span class="hs-comment">--  Prints like: @doFoo, called at foo.hs:190:24 in main:Main@</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#prettyCallSite"><span class="hs-identifier hs-type">prettyCallSite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-89"></span><span id="prettyCallSite"><span class="annot"><span class="annottext">prettyCallSite :: CallSite -&gt; [Char]
</span><a href="Agda.Utils.CallStack.Base.html#prettyCallSite"><span class="hs-identifier hs-var hs-var">prettyCallSite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681700423"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681700423"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681700424"><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621681700424"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681700423"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, called at &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; [Char]
</span><span class="hs-identifier hs-var">prettySrcLoc</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621681700424"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Pretty-print a @CallStack@. This has a few differences from @GHC.Stack.prettyCallStackLines@.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- We omit the &quot;CallStack (from GetCallStack)&quot; header line for brevity.</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- If there is only one entry (which is common, due to the manual nature of the @HasCallStack@ constraint),</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- shows the entry on one line. If there are multiple, then the following lines are indented.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#prettyCallStack"><span class="hs-identifier hs-type">prettyCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-96"></span><span id="prettyCallStack"><span class="annot"><span class="annottext">prettyCallStack :: CallStack -&gt; [Char]
</span><a href="Agda.Utils.CallStack.Base.html#prettyCallStack"><span class="hs-identifier hs-var hs-var">prettyCallStack</span></a></span></span><span> </span><span id="local-6989586621681700425"><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700425"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(([Char], SrcLoc) -&gt; [Char]) -&gt; [([Char], SrcLoc)] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallSite -&gt; [Char]
</span><a href="Agda.Utils.CallStack.Base.html#prettyCallSite"><span class="hs-identifier hs-var">prettyCallSite</span></a></span><span> </span><span class="annot"><span class="annottext">(CallSite -&gt; [Char])
-&gt; (([Char], SrcLoc) -&gt; CallSite) -&gt; ([Char], SrcLoc) -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Char], SrcLoc) -&gt; CallSite
</span><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-var">CallSite</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallStack -&gt; [([Char], SrcLoc)]
</span><span class="hs-identifier hs-var">getCallStack</span></span><span> </span><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700425"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(empty CallStack)&quot;</span></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621681700427"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681700427"><span class="hs-identifier hs-var">firstLoc</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681700428"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681700428"><span class="hs-identifier hs-var">restLocs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681700427"><span class="hs-identifier hs-var">firstLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681700428"><span class="hs-identifier hs-var">restLocs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><span class="hs-comment">-- * Generic utilities over CallStack and CallSite</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><span class="hs-comment">-- | Get the most recent @CallSite@ in a @CallStack@, if there is one.</span></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#headCallSite"><span class="hs-identifier hs-type">headCallSite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span>
</span><span id="line-104"></span><span id="headCallSite"><span class="annot"><span class="annottext">headCallSite :: CallStack -&gt; Maybe CallSite
</span><a href="Agda.Utils.CallStack.Base.html#headCallSite"><span class="hs-identifier hs-var hs-var">headCallSite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], SrcLoc) -&gt; CallSite)
-&gt; Maybe ([Char], SrcLoc) -&gt; Maybe CallSite
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([Char], SrcLoc) -&gt; CallSite
</span><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-var">CallSite</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ([Char], SrcLoc) -&gt; Maybe CallSite)
-&gt; (CallStack -&gt; Maybe ([Char], SrcLoc))
-&gt; CallStack
-&gt; Maybe CallSite
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[([Char], SrcLoc)] -&gt; Maybe ([Char], SrcLoc)
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([([Char], SrcLoc)] -&gt; Maybe ([Char], SrcLoc))
-&gt; (CallStack -&gt; [([Char], SrcLoc)])
-&gt; CallStack
-&gt; Maybe ([Char], SrcLoc)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; [([Char], SrcLoc)]
</span><span class="hs-identifier hs-var">getCallStack</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><span class="hs-comment">-- | @CallStack@ comprising only the most recent @CallSite@</span></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#truncatedCallStack"><span class="hs-identifier hs-type">truncatedCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span>
</span><span id="line-108"></span><span id="truncatedCallStack"><span class="annot"><span class="annottext">truncatedCallStack :: CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#truncatedCallStack"><span class="hs-identifier hs-var hs-var">truncatedCallStack</span></a></span></span><span> </span><span id="local-6989586621681700429"><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700429"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack
-&gt; (([Char], SrcLoc) -&gt; CallStack)
-&gt; Maybe ([Char], SrcLoc)
-&gt; CallStack
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">CallStack
</span><span class="hs-identifier hs-var">emptyCallStack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([Char], SrcLoc)] -&gt; CallStack
</span><span class="hs-identifier hs-var">fromCallSiteList</span></span><span> </span><span class="annot"><span class="annottext">([([Char], SrcLoc)] -&gt; CallStack)
-&gt; (([Char], SrcLoc) -&gt; [([Char], SrcLoc)])
-&gt; ([Char], SrcLoc)
-&gt; CallStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Char], SrcLoc) -&gt; [([Char], SrcLoc)]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CallSite -&gt; ([Char], SrcLoc))
-&gt; Maybe CallSite -&gt; Maybe ([Char], SrcLoc)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CallSite -&gt; ([Char], SrcLoc)
</span><a href="Agda.Utils.CallStack.Base.html#unCallSite"><span class="hs-identifier hs-var">unCallSite</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe CallSite -&gt; Maybe ([Char], SrcLoc))
-&gt; Maybe CallSite -&gt; Maybe ([Char], SrcLoc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; Maybe CallSite
</span><a href="Agda.Utils.CallStack.Base.html#headCallSite"><span class="hs-identifier hs-var">headCallSite</span></a></span><span> </span><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700429"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Transform a @CallStack@ by transforming its list of @CallSite@</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#overCallSites"><span class="hs-identifier hs-type">overCallSites</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-type">CallSite</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span>
</span><span id="line-112"></span><span id="overCallSites"><span class="annot"><span class="annottext">overCallSites :: ([CallSite] -&gt; [CallSite]) -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#overCallSites"><span class="hs-identifier hs-var hs-var">overCallSites</span></a></span></span><span> </span><span id="local-6989586621681700431"><span class="annot"><span class="annottext">[CallSite] -&gt; [CallSite]
</span><a href="#local-6989586621681700431"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], SrcLoc)] -&gt; CallStack
</span><span class="hs-identifier hs-var">fromCallSiteList</span></span><span> </span><span class="annot"><span class="annottext">([([Char], SrcLoc)] -&gt; CallStack)
-&gt; (CallStack -&gt; [([Char], SrcLoc)]) -&gt; CallStack -&gt; CallStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CallSite -&gt; ([Char], SrcLoc)) -&gt; [CallSite] -&gt; [([Char], SrcLoc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CallSite -&gt; ([Char], SrcLoc)
</span><a href="Agda.Utils.CallStack.Base.html#unCallSite"><span class="hs-identifier hs-var">unCallSite</span></a></span><span> </span><span class="annot"><span class="annottext">([CallSite] -&gt; [([Char], SrcLoc)])
-&gt; ([([Char], SrcLoc)] -&gt; [CallSite])
-&gt; [([Char], SrcLoc)]
-&gt; [([Char], SrcLoc)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[CallSite] -&gt; [CallSite]
</span><a href="#local-6989586621681700431"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([CallSite] -&gt; [CallSite])
-&gt; ([([Char], SrcLoc)] -&gt; [CallSite])
-&gt; [([Char], SrcLoc)]
-&gt; [CallSite]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Char], SrcLoc) -&gt; CallSite) -&gt; [([Char], SrcLoc)] -&gt; [CallSite]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">([Char], SrcLoc) -&gt; CallSite
</span><a href="Agda.Utils.CallStack.Base.html#CallSite"><span class="hs-identifier hs-var">CallSite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Char], SrcLoc)] -&gt; [([Char], SrcLoc)])
-&gt; (CallStack -&gt; [([Char], SrcLoc)])
-&gt; CallStack
-&gt; [([Char], SrcLoc)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; [([Char], SrcLoc)]
</span><span class="hs-identifier hs-var">getCallStack</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">-- | Transform a @CallStack@ by filtering each @CallSite@</span></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#filterCallStack"><span class="hs-identifier hs-type">filterCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#CallSiteFilter"><span class="hs-identifier hs-type">CallSiteFilter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span>
</span><span id="line-116"></span><span id="filterCallStack"><span class="annot"><span class="annottext">filterCallStack :: CallSiteFilter -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#filterCallStack"><span class="hs-identifier hs-var hs-var">filterCallStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CallSite] -&gt; [CallSite]) -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#overCallSites"><span class="hs-identifier hs-var">overCallSites</span></a></span><span> </span><span class="annot"><span class="annottext">(([CallSite] -&gt; [CallSite]) -&gt; CallStack -&gt; CallStack)
-&gt; (CallSiteFilter -&gt; [CallSite] -&gt; [CallSite])
-&gt; CallSiteFilter
-&gt; CallStack
-&gt; CallStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallSiteFilter -&gt; [CallSite] -&gt; [CallSite]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Pops n entries off a @CallStack@ using @popCallStack@.</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- Note that frozen callstacks are unaffected.</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier hs-type">popnCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span>
</span><span id="line-121"></span><span id="popnCallStack"><span class="annot"><span class="annottext">popnCallStack :: Word -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier hs-var hs-var">popnCallStack</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; CallStack
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier hs-var">popnCallStack</span></a></span><span> </span><span id="local-6989586621681700433"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681700433"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier hs-var">popnCallStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681700433"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CallStack -&gt; CallStack)
-&gt; (CallStack -&gt; CallStack) -&gt; CallStack -&gt; CallStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; CallStack
</span><span class="hs-identifier hs-var">popCallStack</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621681700378"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withNBackCallStack"><span class="hs-identifier hs-type">withNBackCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700378"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700378"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-125"></span><span id="withNBackCallStack"><span class="annot"><span class="annottext">withNBackCallStack :: forall b. HasCallStack =&gt; Word -&gt; (CallStack -&gt; b) -&gt; b
</span><a href="Agda.Utils.CallStack.Base.html#withNBackCallStack"><span class="hs-identifier hs-var hs-var">withNBackCallStack</span></a></span></span><span> </span><span id="local-6989586621681700435"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681700435"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681700436"><span class="annot"><span class="annottext">CallStack -&gt; b
</span><a href="#local-6989586621681700436"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; b
</span><a href="#local-6989586621681700436"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CallStack -&gt; CallStack
</span><a href="Agda.Utils.CallStack.Base.html#popnCallStack"><span class="hs-identifier hs-var">popnCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681700435"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700437"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- This very line (always dropped):</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621681700440"><span class="annot"><span class="annottext">here :: CallStack
</span><a href="#local-6989586621681700440"><span class="hs-identifier hs-var hs-var">here</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- The invoker (n = 0):</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621681700437"><span class="annot"><span class="annottext">from :: CallStack
</span><a href="#local-6989586621681700437"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; CallStack
</span><span class="hs-identifier hs-var">popCallStack</span></span><span> </span><span class="annot"><span class="annottext">CallStack
</span><a href="#local-6989586621681700440"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621681700380"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withCurrentCallStack"><span class="hs-identifier hs-type">withCurrentCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700380"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-133"></span><span id="withCurrentCallStack"><span class="annot"><span class="annottext">withCurrentCallStack :: forall b. HasCallStack =&gt; (CallStack -&gt; b) -&gt; b
</span><a href="Agda.Utils.CallStack.Base.html#withCurrentCallStack"><span class="hs-identifier hs-var hs-var">withCurrentCallStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; (CallStack -&gt; b) -&gt; b
forall b. HasCallStack =&gt; Word -&gt; (CallStack -&gt; b) -&gt; b
</span><a href="Agda.Utils.CallStack.Base.html#withNBackCallStack"><span class="hs-identifier hs-var">withNBackCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">-- 0 =&gt; this line in this utility function.</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- 1 =&gt; the invocation of this utility function.</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621681700444"><span class="annot"><a href="Agda.Utils.CallStack.Base.html#withCallerCallStack"><span class="hs-identifier hs-type">withCallerCallStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CallStack</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700444"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681700444"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-138"></span><span id="withCallerCallStack"><span class="annot"><span class="annottext">withCallerCallStack :: forall b. HasCallStack =&gt; (CallStack -&gt; b) -&gt; b
</span><a href="Agda.Utils.CallStack.Base.html#withCallerCallStack"><span class="hs-identifier hs-var hs-var">withCallerCallStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; (CallStack -&gt; b) -&gt; b
forall b. HasCallStack =&gt; Word -&gt; (CallStack -&gt; b) -&gt; b
</span><a href="Agda.Utils.CallStack.Base.html#withNBackCallStack"><span class="hs-identifier hs-var">withNBackCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- 0 =&gt; this line in this utility function.</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-comment">-- 1 =&gt; our caller.</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- 2 =&gt; their caller.</span><span>
</span><span id="line-142"></span></pre></body></html>