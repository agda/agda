<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html"><span class="hs-identifier">Agda.Syntax.Parser.Monad</span></a></span><span>
</span><span id="line-3"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * The parser monad</span></span><span>
</span><span id="line-4"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier">Parser</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier">ParseResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier">ParseState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier">ParseError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier">ParseWarning</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier">LexState</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenBracket"><span class="hs-identifier">OpenBracket</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutBlock"><span class="hs-identifier">LayoutBlock</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier">LayoutContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutStatus"><span class="hs-identifier">LayoutStatus</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Column"><span class="hs-identifier">Column</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier">ParseFlags</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Running the parser</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#initState"><span class="hs-identifier">initState</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#defaultParseFlags"><span class="hs-identifier">defaultParseFlags</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parse"><span class="hs-identifier">parse</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePosString"><span class="hs-identifier">parsePosString</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseFromSrc"><span class="hs-identifier">parseFromSrc</span></a></span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Manipulating the state</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setParsePos"><span class="hs-identifier">setParsePos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setLastPos"><span class="hs-identifier">setLastPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getParseInterval"><span class="hs-identifier">getParseInterval</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setPrevToken"><span class="hs-identifier">setPrevToken</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getParseFlags"><span class="hs-identifier">getParseFlags</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getLexState"><span class="hs-identifier">getLexState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#pushLexState"><span class="hs-identifier">pushLexState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#popLexState"><span class="hs-identifier">popLexState</span></a></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Layout</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#topBlock"><span class="hs-identifier">topBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#popBlock"><span class="hs-identifier">popBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#pushBlock"><span class="hs-identifier">pushBlock</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getContext"><span class="hs-identifier">getContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setContext"><span class="hs-identifier">setContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#modifyContext"><span class="hs-identifier">modifyContext</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#resetLayoutStatus"><span class="hs-identifier">resetLayoutStatus</span></a></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Brackets</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#openBracket"><span class="hs-identifier">openBracket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#closeBracket"><span class="hs-identifier">closeBracket</span></a></span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Errors</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier">parseWarning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarningName"><span class="hs-identifier">parseWarningName</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier">parseError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseErrorAt"><span class="hs-identifier">parseErrorAt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier">parseError'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier">parseErrorRange</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#lexError"><span class="hs-identifier">lexError</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">displayException</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">listToMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">uncons</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Warnings.html"><span class="hs-identifier">Agda.Interaction.Options.Warnings</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html"><span class="hs-identifier">Agda.Syntax.Concrete.Attribute</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html"><span class="hs-identifier">Agda.Syntax.Parser.Tokens</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Keyword"><span class="hs-identifier">Keyword</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#KwMutual"><span class="hs-identifier">KwMutual</span></a></span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Symbol"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#QualifiableToken"><span class="hs-identifier">QualifiableToken</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#QualOpenIdiom"><span class="hs-identifier">QualOpenIdiom</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html"><span class="hs-identifier">Agda.TypeChecking.Positivity.Occurrence</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#Mixed"><span class="hs-identifier">Mixed</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier">applyUnless</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.IO.html"><span class="hs-identifier">Agda.Utils.IO</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.IO.html#showIOException"><span class="hs-identifier">showIOException</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List.html#tailWithDefault"><span class="hs-identifier">tailWithDefault</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.Strict.html"><span class="hs-identifier">Agda.Utils.Maybe.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">{--------------------------------------------------------------------------
    The parse monad
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">-- | The parse monad.</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="Parser"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span id="local-6989586621681843793"><span class="annot"><a href="#local-6989586621681843793"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="P"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_runP"><span class="annot"><span class="annottext">forall a. Parser a -&gt; StateT ParseState (Either ParseError) a
</span><a href="Agda.Syntax.Parser.Monad.html#_runP"><span class="hs-identifier hs-var hs-var">_runP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681843793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681844108"><span id="local-6989586621681844114"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b)
-&gt; (forall a b. a -&gt; Parser b -&gt; Parser a) -&gt; Functor Parser
forall a b. a -&gt; Parser b -&gt; Parser a
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
fmap :: forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
$c&lt;$ :: forall a b. a -&gt; Parser b -&gt; Parser a
&lt;$ :: forall a b. a -&gt; Parser b -&gt; Parser a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844124"><span id="local-6989586621681844131"><span id="local-6989586621681844137"><span id="local-6989586621681844143"><span id="local-6989586621681844149"><span class="annot"><span class="annottext">Functor Parser
Functor Parser =&gt;
(forall a. a -&gt; Parser a)
-&gt; (forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Parser a -&gt; Parser b -&gt; Parser c)
-&gt; (forall a b. Parser a -&gt; Parser b -&gt; Parser b)
-&gt; (forall a b. Parser a -&gt; Parser b -&gt; Parser a)
-&gt; Applicative Parser
forall a. a -&gt; Parser a
forall a b. Parser a -&gt; Parser b -&gt; Parser a
forall a b. Parser a -&gt; Parser b -&gt; Parser b
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall a b c. (a -&gt; b -&gt; c) -&gt; Parser a -&gt; Parser b -&gt; Parser c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; Parser a
pure :: forall a. a -&gt; Parser a
$c&lt;*&gt; :: forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
&lt;*&gt; :: forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Parser a -&gt; Parser b -&gt; Parser c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Parser a -&gt; Parser b -&gt; Parser c
$c*&gt; :: forall a b. Parser a -&gt; Parser b -&gt; Parser b
*&gt; :: forall a b. Parser a -&gt; Parser b -&gt; Parser b
$c&lt;* :: forall a b. Parser a -&gt; Parser b -&gt; Parser a
&lt;* :: forall a b. Parser a -&gt; Parser b -&gt; Parser a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844161"><span id="local-6989586621681844167"><span id="local-6989586621681844172"><span class="annot"><span class="annottext">Applicative Parser
Applicative Parser =&gt;
(forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b)
-&gt; (forall a b. Parser a -&gt; Parser b -&gt; Parser b)
-&gt; (forall a. a -&gt; Parser a)
-&gt; Monad Parser
forall a. a -&gt; Parser a
forall a b. Parser a -&gt; Parser b -&gt; Parser b
forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
&gt;&gt;= :: forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
$c&gt;&gt; :: forall a b. Parser a -&gt; Parser b -&gt; Parser b
&gt;&gt; :: forall a b. Parser a -&gt; Parser b -&gt; Parser b
$creturn :: forall a. a -&gt; Parser a
return :: forall a. a -&gt; Parser a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844180"><span id="local-6989586621681844186"><span id="local-6989586621681844191"><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844202"><span id="local-6989586621681844208"><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | The parser state. Contains everything the parser and the lexer could ever</span><span>
</span><span id="line-76"></span><span class="hs-comment">--   need.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="ParseState"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-var">ParseState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PState"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#PState"><span class="hs-identifier hs-var">PState</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="parseSrcFile"><span class="annot"><span class="annottext">ParseState -&gt; SrcFile
</span><a href="Agda.Syntax.Parser.Monad.html#parseSrcFile"><span class="hs-identifier hs-var hs-var">parseSrcFile</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#SrcFile"><span class="hs-identifier hs-type">SrcFile</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parsePos"><span class="annot"><span class="annottext">ParseState -&gt; PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parsePos"><span class="hs-identifier hs-var hs-var">parsePos</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ position at current input location</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseLastPos"><span class="annot"><span class="annottext">ParseState -&gt; PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var hs-var">parseLastPos</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ position of last token</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseInp"><span class="annot"><span class="annottext">ParseState -&gt; String
</span><a href="Agda.Syntax.Parser.Monad.html#parseInp"><span class="hs-identifier hs-var hs-var">parseInp</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                </span><span class="annot"><span class="hs-comment">-- ^ the current input</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parsePrevChar"><span class="annot"><span class="annottext">ParseState -&gt; Char
</span><a href="Agda.Syntax.Parser.Monad.html#parsePrevChar"><span class="hs-identifier hs-var hs-var">parsePrevChar</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ the character before the input</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parsePrevToken"><span class="annot"><span class="annottext">ParseState -&gt; String
</span><a href="Agda.Syntax.Parser.Monad.html#parsePrevToken"><span class="hs-identifier hs-var hs-var">parsePrevToken</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                </span><span class="annot"><span class="hs-comment">-- ^ the previous token</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseLayout"><span class="annot"><span class="annottext">ParseState -&gt; LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayout"><span class="hs-identifier hs-var hs-var">parseLayout</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-type">LayoutContext</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ the stack of layout blocks</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseLayStatus"><span class="annot"><span class="annottext">ParseState -&gt; LayoutStatus
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayStatus"><span class="hs-identifier hs-var hs-var">parseLayStatus</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutStatus"><span class="hs-identifier hs-type">LayoutStatus</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ the status of the coming layout block</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseLayKw"><span class="annot"><span class="annottext">ParseState -&gt; Keyword
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayKw"><span class="hs-identifier hs-var hs-var">parseLayKw</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Keyword"><span class="hs-identifier hs-type">Keyword</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ the keyword for the coming layout block</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseLexState"><span class="annot"><span class="annottext">ParseState -&gt; [LexState]
</span><a href="Agda.Syntax.Parser.Monad.html#parseLexState"><span class="hs-identifier hs-var hs-var">parseLexState</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span>            </span><span class="hs-comment">-- ^ the state of the lexer</span><span>
</span><span id="line-88"></span><span>                                             </span><span class="hs-comment">--   (states can be nested so we need a stack)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseFlags"><span class="annot"><span class="annottext">ParseState -&gt; ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#parseFlags"><span class="hs-identifier hs-var hs-var">parseFlags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ parametrization of the parser</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseWarnings"><span class="annot"><span class="annottext">ParseState -&gt; [ParseWarning]
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarnings"><span class="hs-identifier hs-var hs-var">parseWarnings</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ In reverse order.</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseBrackets"><span class="annot"><span class="annottext">ParseState -&gt; [OpenBracket]
</span><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var hs-var">parseBrackets</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenBracket"><span class="hs-identifier hs-type">OpenBracket</span></a></span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ stack of open unicode/ASCII brackets</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parseAttributes"><span class="annot"><span class="annottext">ParseState -&gt; Attributes
</span><a href="Agda.Syntax.Parser.Monad.html#parseAttributes"><span class="hs-identifier hs-var hs-var">parseAttributes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Every encountered attribute.</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844233"><span id="local-6989586621681844265"><span id="local-6989586621681844269"><span class="annot"><span class="annottext">LexState -&gt; ParseState -&gt; ShowS
[ParseState] -&gt; ShowS
ParseState -&gt; String
(LexState -&gt; ParseState -&gt; ShowS)
-&gt; (ParseState -&gt; String)
-&gt; ([ParseState] -&gt; ShowS)
-&gt; Show ParseState
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; ParseState -&gt; ShowS
showsPrec :: LexState -&gt; ParseState -&gt; ShowS
$cshow :: ParseState -&gt; String
show :: ParseState -&gt; String
$cshowList :: [ParseState] -&gt; ShowS
showList :: [ParseState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">{-| For context sensitive lexing alex provides what is called /start codes/
    in the Alex documentation.  It is really an integer representing the state
    of the lexer, so we call it @LexState@ instead.
-}</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span id="LexState"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-var">LexState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | The stack of layout blocks.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   When we encounter a layout keyword, we push a 'Tentative' block</span><span>
</span><span id="line-105"></span><span class="hs-comment">--   with 'noColumn'.  This is replaced by aproper column once we</span><span>
</span><span id="line-106"></span><span class="hs-comment">--   reach the next token.</span><span>
</span><span id="line-107"></span><span class="hs-keyword">type</span><span> </span><span id="LayoutContext"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-var">LayoutContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutBlock"><span class="hs-identifier hs-type">LayoutBlock</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | We need to keep track of the context to do layout. The context</span><span>
</span><span id="line-110"></span><span class="hs-comment">--   specifies the indentation columns of the open layout blocks. See</span><span>
</span><span id="line-111"></span><span class="hs-comment">--   &quot;Agda.Syntax.Parser.Layout&quot; for more informaton.</span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="LayoutBlock"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutBlock"><span class="hs-identifier hs-var">LayoutBlock</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Layout"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Layout"><span class="hs-identifier hs-var">Layout</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Keyword"><span class="hs-identifier hs-type">Keyword</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutStatus"><span class="hs-identifier hs-type">LayoutStatus</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Layout at specified 'Column', introduced by 'Keyword'.</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844284"><span id="local-6989586621681844291"><span id="local-6989586621681844294"><span class="annot"><span class="annottext">LexState -&gt; LayoutBlock -&gt; ShowS
LayoutContext -&gt; ShowS
LayoutBlock -&gt; String
(LexState -&gt; LayoutBlock -&gt; ShowS)
-&gt; (LayoutBlock -&gt; String)
-&gt; (LayoutContext -&gt; ShowS)
-&gt; Show LayoutBlock
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; LayoutBlock -&gt; ShowS
showsPrec :: LexState -&gt; LayoutBlock -&gt; ShowS
$cshow :: LayoutBlock -&gt; String
show :: LayoutBlock -&gt; String
$cshowList :: LayoutContext -&gt; ShowS
showList :: LayoutContext -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">-- | A (layout) column.</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">type</span><span> </span><span id="Column"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Column"><span class="hs-identifier hs-var">Column</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Status of a layout column (see #1145).</span><span>
</span><span id="line-121"></span><span class="hs-comment">--   A layout column is 'Tentative' until we encounter a new line.</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   This allows stacking of layout keywords.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">--   Inside a @LayoutContext@ the sequence of 'Confirmed' columns</span><span>
</span><span id="line-125"></span><span class="hs-comment">--   needs to be strictly increasing.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--   'Tentative columns between 'Confirmed' columns need to be</span><span>
</span><span id="line-127"></span><span class="hs-comment">--   strictly increasing as well.</span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="LayoutStatus"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutStatus"><span class="hs-identifier hs-var">LayoutStatus</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Tentative"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Tentative"><span class="hs-identifier hs-var">Tentative</span></a></span></span><span>  </span><span class="hs-comment">-- ^ The token defining the layout column was on the same line</span><span>
</span><span id="line-130"></span><span>               </span><span class="hs-comment">--   as the layout keyword and we have not seen a new line yet.</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Confirmed"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Confirmed"><span class="hs-identifier hs-var">Confirmed</span></a></span></span><span>  </span><span class="hs-comment">-- ^ We have seen a new line since the layout keyword</span><span>
</span><span id="line-132"></span><span>               </span><span class="hs-comment">--   and the layout column has not been superseded by</span><span>
</span><span id="line-133"></span><span>               </span><span class="hs-comment">--   a smaller column.</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681844298"><span id="local-6989586621681844303"><span class="annot"><span class="annottext">LayoutStatus -&gt; LayoutStatus -&gt; Bool
(LayoutStatus -&gt; LayoutStatus -&gt; Bool)
-&gt; (LayoutStatus -&gt; LayoutStatus -&gt; Bool) -&gt; Eq LayoutStatus
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: LayoutStatus -&gt; LayoutStatus -&gt; Bool
== :: LayoutStatus -&gt; LayoutStatus -&gt; Bool
$c/= :: LayoutStatus -&gt; LayoutStatus -&gt; Bool
/= :: LayoutStatus -&gt; LayoutStatus -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844308"><span id="local-6989586621681844310"><span id="local-6989586621681844313"><span class="annot"><span class="annottext">LexState -&gt; LayoutStatus -&gt; ShowS
[LayoutStatus] -&gt; ShowS
LayoutStatus -&gt; String
(LexState -&gt; LayoutStatus -&gt; ShowS)
-&gt; (LayoutStatus -&gt; String)
-&gt; ([LayoutStatus] -&gt; ShowS)
-&gt; Show LayoutStatus
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; LayoutStatus -&gt; ShowS
showsPrec :: LexState -&gt; LayoutStatus -&gt; ShowS
$cshow :: LayoutStatus -&gt; String
show :: LayoutStatus -&gt; String
$cshowList :: [LayoutStatus] -&gt; ShowS
showList :: [LayoutStatus] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Information about an opening unicode-able bracket necessary for</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- correctly parsing its closing delimiter.</span><span>
</span><span id="line-138"></span><span class="hs-keyword">data</span><span> </span><span id="OpenBracket"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenBracket"><span class="hs-identifier hs-var">OpenBracket</span></a></span></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="hs-comment">-- | An opening idiom bracket.</span></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="OpenIdiomBracket"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-var">OpenIdiomBracket</span></a></span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="openBracketUnicode"><span class="annot"><span class="annottext">OpenBracket -&gt; Bool
</span><a href="Agda.Syntax.Parser.Monad.html#openBracketUnicode"><span class="hs-identifier hs-var hs-var">openBracketUnicode</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ 'True' if the user wrote @&#10631;@.</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="openBracketInterval"><span class="annot"><span class="annottext">OpenBracket -&gt; Interval
</span><a href="Agda.Syntax.Parser.Monad.html#openBracketInterval"><span class="hs-identifier hs-var hs-var">openBracketInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Position of the opening bracket.</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="hs-comment">-- | An opening double brace.</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpenDoubleBrace"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-var">OpenDoubleBrace</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="openBracketUnicode"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#openBracketUnicode"><span class="hs-identifier hs-var">openBracketUnicode</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ 'True' if the user wrote @&#10627;@.</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="openBracketInterval"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#openBracketInterval"><span class="hs-identifier hs-var">openBracketInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Position of the opening bracket.</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681844320"><span id="local-6989586621681844330"><span class="annot"><span class="annottext">OpenBracket -&gt; OpenBracket -&gt; Bool
(OpenBracket -&gt; OpenBracket -&gt; Bool)
-&gt; (OpenBracket -&gt; OpenBracket -&gt; Bool) -&gt; Eq OpenBracket
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: OpenBracket -&gt; OpenBracket -&gt; Bool
== :: OpenBracket -&gt; OpenBracket -&gt; Bool
$c/= :: OpenBracket -&gt; OpenBracket -&gt; Bool
/= :: OpenBracket -&gt; OpenBracket -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844337"><span id="local-6989586621681844348"><span id="local-6989586621681844351"><span class="annot"><span class="annottext">LexState -&gt; OpenBracket -&gt; ShowS
[OpenBracket] -&gt; ShowS
OpenBracket -&gt; String
(LexState -&gt; OpenBracket -&gt; ShowS)
-&gt; (OpenBracket -&gt; String)
-&gt; ([OpenBracket] -&gt; ShowS)
-&gt; Show OpenBracket
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; OpenBracket -&gt; ShowS
showsPrec :: LexState -&gt; OpenBracket -&gt; ShowS
$cshow :: OpenBracket -&gt; String
show :: OpenBracket -&gt; String
$cshowList :: [OpenBracket] -&gt; ShowS
showList :: [OpenBracket] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenBracket"><span class="hs-identifier hs-type">OpenBracket</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621681844360"><span class="annot"><span class="annottext">rnf :: OpenBracket -&gt; ()
</span><a href="#local-6989586621681844360"><span class="hs-identifier hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-type">OpenIdiomBracket</span></a></span><span> </span><span id="local-6989586621681844362"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844362"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844362"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-type">OpenDoubleBrace</span></a></span><span>  </span><span id="local-6989586621681844363"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844363"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844363"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Parser flags.</span></span><span>
</span><span id="line-156"></span><span class="hs-keyword">data</span><span> </span><span id="ParseFlags"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-var">ParseFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ParseFlags"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-var">ParseFlags</span></a></span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="parseKeepComments"><span class="annot"><span class="annottext">ParseFlags -&gt; Bool
</span><a href="Agda.Syntax.Parser.Monad.html#parseKeepComments"><span class="hs-identifier hs-var hs-var">parseKeepComments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Should comment tokens be returned by the lexer?</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844367"><span id="local-6989586621681844371"><span id="local-6989586621681844374"><span class="annot"><span class="annottext">LexState -&gt; ParseFlags -&gt; ShowS
[ParseFlags] -&gt; ShowS
ParseFlags -&gt; String
(LexState -&gt; ParseFlags -&gt; ShowS)
-&gt; (ParseFlags -&gt; String)
-&gt; ([ParseFlags] -&gt; ShowS)
-&gt; Show ParseFlags
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; ParseFlags -&gt; ShowS
showsPrec :: LexState -&gt; ParseFlags -&gt; ShowS
$cshow :: ParseFlags -&gt; String
show :: ParseFlags -&gt; String
$cshowList :: [ParseFlags] -&gt; ShowS
showList :: [ParseFlags] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Parse errors: what you get if parsing fails.</span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="ParseError"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Errors that arise at a specific position in the file</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ParseError"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a></span></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="errPos"><span class="annot"><span class="annottext">ParseError -&gt; Position
</span><a href="Agda.Syntax.Parser.Monad.html#errPos"><span class="hs-identifier hs-var hs-var">errPos</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-168"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ Where the error occurred.</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errInput"><span class="annot"><span class="annottext">ParseError -&gt; String
</span><a href="Agda.Syntax.Parser.Monad.html#errInput"><span class="hs-identifier hs-var hs-var">errInput</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-170"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ The remaining input.</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errPrevToken"><span class="annot"><span class="annottext">ParseError -&gt; String
</span><a href="Agda.Syntax.Parser.Monad.html#errPrevToken"><span class="hs-identifier hs-var hs-var">errPrevToken</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-172"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ The previous token.</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errMsg"><span class="annot"><span class="annottext">ParseError -&gt; String
</span><a href="Agda.Syntax.Parser.Monad.html#errMsg"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-174"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ Hopefully an explanation of what happened.</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Parse errors that concern a range in a file.</span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OverlappingTokensError"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-var">OverlappingTokensError</span></a></span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="errRange"><span class="annot"><span class="annottext">ParseError -&gt; Range
</span><a href="Agda.Syntax.Parser.Monad.html#errRange"><span class="hs-identifier hs-var hs-var">errRange</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>
</span><span id="line-180"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ The range of the bigger overlapping token</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Parse errors that concern a whole file.</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidExtensionError"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-var">InvalidExtensionError</span></a></span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="errPath"><span class="annot"><span class="annottext">ParseError -&gt; RangeFile
</span><a href="Agda.Syntax.Parser.Monad.html#errPath"><span class="hs-identifier hs-var hs-var">errPath</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#RangeFile"><span class="hs-identifier hs-type">RangeFile</span></a></span><span>
</span><span id="line-186"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ The file which the error concerns.</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errValidExts"><span class="annot"><span class="annottext">ParseError -&gt; [String]
</span><a href="Agda.Syntax.Parser.Monad.html#errValidExts"><span class="hs-identifier hs-var hs-var">errValidExts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ReadFileError"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-var">ReadFileError</span></a></span></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="errPath"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#errPath"><span class="hs-identifier hs-var">errPath</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Syntax.Position.html#RangeFile"><span class="hs-identifier hs-type">RangeFile</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errIOError"><span class="annot"><span class="annottext">ParseError -&gt; IOError
</span><a href="Agda.Syntax.Parser.Monad.html#errIOError"><span class="hs-identifier hs-var hs-var">errIOError</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOError</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844389"><span id="local-6989586621681844409"><span id="local-6989586621681844413"><span class="annot"><span class="annottext">LexState -&gt; ParseError -&gt; ShowS
[ParseError] -&gt; ShowS
ParseError -&gt; String
(LexState -&gt; ParseError -&gt; ShowS)
-&gt; (ParseError -&gt; String)
-&gt; ([ParseError] -&gt; ShowS)
-&gt; Show ParseError
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; ParseError -&gt; ShowS
showsPrec :: LexState -&gt; ParseError -&gt; ShowS
$cshow :: ParseError -&gt; String
show :: ParseError -&gt; String
$cshowList :: [ParseError] -&gt; ShowS
showList :: [ParseError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#KillRange"><span class="hs-identifier hs-type">KillRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621681844427"><span class="annot"><span class="annottext">killRange :: KillRangeT ParseError
</span><a href="#local-6989586621681844427"><span class="hs-identifier hs-var hs-var hs-var">killRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844429"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844429"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span id="local-6989586621681844430"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844430"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621681844431"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844431"><span class="hs-identifier hs-var">msg</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; String -&gt; String -&gt; String -&gt; ParseError
</span><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a></span><span> </span><span class="annot"><span class="annottext">Position
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844429"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844430"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844431"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-type">OverlappingTokensError</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; ParseError
</span><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-var">OverlappingTokensError</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-type">InvalidExtensionError</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844433"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621681844433"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RangeFile -&gt; [String] -&gt; ParseError
</span><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-var">InvalidExtensionError</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621681844433"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-type">ReadFileError</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844434"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621681844434"><span class="hs-identifier hs-var">err</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RangeFile -&gt; IOError -&gt; ParseError
</span><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-var">ReadFileError</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621681844434"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621681844444"><span class="annot"><span class="annottext">rnf :: ParseError -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span id="local-6989586621681844445"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844445"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844446"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844446"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span id="local-6989586621681844447"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844447"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621681844448"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844448"><span class="hs-identifier hs-var">msg</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844446"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844447"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844448"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-type">OverlappingTokensError</span></a></span><span> </span><span id="local-6989586621681844449"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844449"><span class="hs-identifier hs-var">_r</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-type">InvalidExtensionError</span></a></span><span> </span><span id="local-6989586621681844450"><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844450"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844451"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621681844451"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621681844451"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-type">ReadFileError</span></a></span><span> </span><span id="local-6989586621681844452"><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844452"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844453"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621681844453"><span class="hs-identifier hs-var">_err</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">-- | Warnings for parsing.</span></span><span>
</span><span id="line-210"></span><span class="hs-keyword">data</span><span> </span><span id="ParseWarning"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-var">ParseWarning</span></a></span></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Parse errors that concern a range in a file.</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="OverlappingTokensWarning"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensWarning"><span class="hs-identifier hs-var">OverlappingTokensWarning</span></a></span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="warnRange"><span class="annot"><span class="annottext">ParseWarning -&gt; Range
</span><a href="Agda.Syntax.Parser.Monad.html#warnRange"><span class="hs-identifier hs-var hs-var">warnRange</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Range%27"><span class="hs-identifier hs-type">Range'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#SrcFile"><span class="hs-identifier hs-type">SrcFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The range of the bigger overlapping token.</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MisplacedAttributes"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MisplacedAttributes"><span class="hs-identifier hs-var">MisplacedAttributes</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ The 'String' is the error message.</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnknownPolarity"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownPolarity"><span class="hs-identifier hs-var">UnknownPolarity</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Unknown polarity, ignored.</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnknownAttribute"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownAttribute"><span class="hs-identifier hs-var">UnknownAttribute</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- ^ Unknown attribute, ignored.</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">--   The 'Range' includes the &quot;@&quot;, the 'String' not.</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnsupportedAttribute"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-var">UnsupportedAttribute</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Unsupported attribute.</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MultipleAttributes"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-var">MultipleAttributes</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Multiple attributes.</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MismatchedBrackets"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-var">MismatchedBrackets</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenBracket"><span class="hs-identifier hs-type">OpenBracket</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-comment">-- ^ The closing bracket (at the 'Range') was closed with a</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-comment">-- unicode-ness that doesn't match that of the 'OpenBracket'.</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844464"><span id="local-6989586621681844489"><span id="local-6989586621681844492"><span class="annot"><span class="annottext">LexState -&gt; ParseWarning -&gt; ShowS
[ParseWarning] -&gt; ShowS
ParseWarning -&gt; String
(LexState -&gt; ParseWarning -&gt; ShowS)
-&gt; (ParseWarning -&gt; String)
-&gt; ([ParseWarning] -&gt; ShowS)
-&gt; Show ParseWarning
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: LexState -&gt; ParseWarning -&gt; ShowS
showsPrec :: LexState -&gt; ParseWarning -&gt; ShowS
$cshow :: ParseWarning -&gt; String
show :: ParseWarning -&gt; String
$cshowList :: [ParseWarning] -&gt; ShowS
showList :: [ParseWarning] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621681844505"><span class="annot"><span class="annottext">rnf :: ParseWarning -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensWarning"><span class="hs-identifier hs-type">OverlappingTokensWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MisplacedAttributes"><span class="hs-identifier hs-type">MisplacedAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844506"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844506"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844506"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownPolarity"><span class="hs-identifier hs-type">UnknownPolarity</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844507"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844507"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844507"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownAttribute"><span class="hs-identifier hs-type">UnknownAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844508"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844508"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844508"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-type">UnsupportedAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844509"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844509"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844509"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-type">MultipleAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844510"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844510"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844510"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-type">MismatchedBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844511"><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844511"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenBracket -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844511"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarningName"><span class="hs-identifier hs-type">parseWarningName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Warnings.html#WarningName"><span class="hs-identifier hs-type">WarningName</span></a></span><span>
</span><span id="line-242"></span><span id="parseWarningName"><span class="annot"><span class="annottext">parseWarningName :: ParseWarning -&gt; WarningName
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarningName"><span class="hs-identifier hs-var hs-var">parseWarningName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensWarning"><span class="hs-identifier hs-type">OverlappingTokensWarning</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#OverlappingTokensWarning_"><span class="hs-identifier hs-var">OverlappingTokensWarning_</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MisplacedAttributes"><span class="hs-identifier hs-type">MisplacedAttributes</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#MisplacedAttributes_"><span class="hs-identifier hs-var">MisplacedAttributes_</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownPolarity"><span class="hs-identifier hs-type">UnknownPolarity</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#UnknownPolarity_"><span class="hs-identifier hs-var">UnknownPolarity_</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownAttribute"><span class="hs-identifier hs-type">UnknownAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#UnknownAttribute_"><span class="hs-identifier hs-var">UnknownAttribute_</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-type">UnsupportedAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#UnsupportedAttribute_"><span class="hs-identifier hs-var">UnsupportedAttribute_</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-type">MultipleAttributes</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#MultipleAttributes_"><span class="hs-identifier hs-var">MultipleAttributes_</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-type">MismatchedBrackets</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarningName
</span><a href="Agda.Interaction.Options.Warnings.html#MismatchedBrackets_"><span class="hs-identifier hs-var">MismatchedBrackets_</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><span class="hs-comment">-- | The result of parsing something.</span></span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="ParseResult"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-var">ParseResult</span></a></span></span><span> </span><span id="local-6989586621681843922"><span class="annot"><a href="#local-6989586621681843922"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ParseOk"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-var">ParseOk</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843922"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ParseFailed"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFailed"><span class="hs-identifier hs-var">ParseFailed</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681844523"><span id="local-6989586621681844530"><span id="local-6989586621681844534"><span class="annot"><span class="annottext">LexState -&gt; ParseResult a -&gt; ShowS
[ParseResult a] -&gt; ShowS
ParseResult a -&gt; String
(LexState -&gt; ParseResult a -&gt; ShowS)
-&gt; (ParseResult a -&gt; String)
-&gt; ([ParseResult a] -&gt; ShowS)
-&gt; Show (ParseResult a)
forall a. Show a =&gt; LexState -&gt; ParseResult a -&gt; ShowS
forall a. Show a =&gt; [ParseResult a] -&gt; ShowS
forall a. Show a =&gt; ParseResult a -&gt; String
forall a.
(LexState -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; LexState -&gt; ParseResult a -&gt; ShowS
showsPrec :: LexState -&gt; ParseResult a -&gt; ShowS
$cshow :: forall a. Show a =&gt; ParseResult a -&gt; String
show :: ParseResult a -&gt; String
$cshowList :: forall a. Show a =&gt; [ParseResult a] -&gt; ShowS
showList :: [ParseResult a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><span class="hs-comment">-- | Old interface to parser.</span></span><span>
</span><span id="line-258"></span><span id="local-6989586621681843917"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#unP"><span class="hs-identifier hs-type">unP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843917"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843917"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-259"></span><span id="unP"><span class="annot"><span class="annottext">unP :: forall a. Parser a -&gt; ParseState -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#unP"><span class="hs-identifier hs-var hs-var">unP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621681844537"><span class="annot"><span class="annottext">StateT ParseState (Either ParseError) a
</span><a href="#local-6989586621681844537"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681844538"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844538"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StateT ParseState (Either ParseError) a
-&gt; ParseState -&gt; Either ParseError (a, ParseState)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">StateT ParseState (Either ParseError) a
</span><a href="#local-6989586621681844537"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844538"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681844540"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621681844540"><span class="hs-identifier hs-var">err</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; ParseResult a
forall a. ParseError -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#ParseFailed"><span class="hs-identifier hs-var">ParseFailed</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621681844540"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681844541"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681844541"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844542"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844542"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; a -&gt; ParseResult a
forall a. ParseState -&gt; a -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-var">ParseOk</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844542"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681844541"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-comment">-- | Throw a parse error at the current position.</span></span><span>
</span><span id="line-264"></span><span id="local-6989586621681843923"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-type">parseError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843923"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-265"></span><span id="parseError"><span class="annot"><span class="annottext">parseError :: forall a. String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var hs-var">parseError</span></a></span></span><span> </span><span id="local-6989586621681844548"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844548"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621681844549"><span class="annot"><a href="#local-6989586621681844549"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser ParseState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#errPos"><span class="hs-identifier hs-var">errPos</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var">parseLastPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844549"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseSrcFile"><span class="hs-identifier hs-var">parseSrcFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844549"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#errInput"><span class="hs-identifier hs-var">errInput</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseInp"><span class="hs-identifier hs-var">parseInp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844549"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#errPrevToken"><span class="hs-identifier hs-var">errPrevToken</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePrevToken"><span class="hs-identifier hs-var">parsePrevToken</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844549"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#errMsg"><span class="hs-identifier hs-var">errMsg</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844548"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><span class="hs-comment">-- | Records a warning.</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-type">parseWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span id="parseWarning"><span class="annot"><span class="annottext">parseWarning :: ParseWarning -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-var hs-var">parseWarning</span></a></span></span><span> </span><span id="local-6989586621681844551"><span class="annot"><span class="annottext">ParseWarning
</span><a href="#local-6989586621681844551"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify'</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844553"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844553"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844553"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarnings"><span class="hs-identifier hs-var">parseWarnings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844551"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseWarnings"><span class="hs-identifier hs-var">parseWarnings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844553"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">{--------------------------------------------------------------------------
    Instances
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681844556"><span id="local-6989586621681844560"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621681844610"><span class="annot"><span class="annottext">pretty :: ParseError -&gt; Doc
</span><a href="#local-6989586621681844610"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621681844612"><span class="annot"><span class="annottext">Position
errPos :: ParseError -&gt; Position
errPos :: Position
</span><a href="Agda.Syntax.Parser.Monad.html#errPos"><span class="hs-identifier hs-var hs-var">errPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844613"><span class="annot"><span class="annottext">String
errMsg :: ParseError -&gt; String
errMsg :: String
</span><a href="Agda.Syntax.Parser.Monad.html#errMsg"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844614"><span class="annot"><span class="annottext">String
errPrevToken :: ParseError -&gt; String
errPrevToken :: String
</span><a href="Agda.Syntax.Parser.Monad.html#errPrevToken"><span class="hs-identifier hs-var hs-var">errPrevToken</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844615"><span class="annot"><span class="annottext">String
errInput :: ParseError -&gt; String
errInput :: String
</span><a href="Agda.Syntax.Parser.Monad.html#errInput"><span class="hs-identifier hs-var hs-var">errInput</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844612"><span class="hs-identifier hs-var">errPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844612"><span class="hs-identifier hs-var">errPos</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Agda.Syntax.Common.Pretty.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;error: [ParseError]&quot;</span></span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844613"><span class="hs-identifier hs-var">errMsg</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844613"><span class="hs-identifier hs-var">errMsg</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-288"></span><span>          </span><span class="hs-comment">-- Happy errors have no message, so we print the context instead</span><span>
</span><span id="line-289"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844614"><span class="hs-identifier hs-var">errPrevToken</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;ERROR&gt;&quot;</span></span><span>
</span><span id="line-290"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LexState -&gt; ShowS
forall a. LexState -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">LexState
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844615"><span class="hs-identifier hs-var">errInput</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;...&quot;</span></span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-type">OverlappingTokensError</span></a></span><span class="hs-special">{</span><span id="local-6989586621681844624"><span class="annot"><span class="annottext">Range
errRange :: ParseError -&gt; Range
errRange :: Range
</span><a href="Agda.Syntax.Parser.Monad.html#errRange"><span class="hs-identifier hs-var hs-var">errRange</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844624"><span class="hs-identifier hs-var">errRange</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844624"><span class="hs-identifier hs-var">errRange</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Agda.Syntax.Common.Pretty.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;error: [OverlappingTokensError]&quot;</span></span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Multi-line comment spans one or more literate text blocks.&quot;</span></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-type">InvalidExtensionError</span></a></span><span class="hs-special">{</span><span id="local-6989586621681844625"><span class="annot"><span class="annottext">RangeFile
errPath :: ParseError -&gt; RangeFile
errPath :: RangeFile
</span><a href="Agda.Syntax.Parser.Monad.html#errPath"><span class="hs-identifier hs-var hs-var">errPath</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681844626"><span class="annot"><span class="annottext">[String]
errValidExts :: ParseError -&gt; [String]
errValidExts :: [String]
</span><a href="Agda.Syntax.Parser.Monad.html#errValidExts"><span class="hs-identifier hs-var hs-var">errValidExts</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RangeFile -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844625"><span class="hs-identifier hs-var">errPath</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RangeFile -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844625"><span class="hs-identifier hs-var">errPath</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Agda.Syntax.Common.Pretty.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;error: [InvalidExtensionError]&quot;</span></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Unsupported extension.&quot;</span></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Supported extensions are:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-var">prettyList_</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621681844626"><span class="hs-identifier hs-var">errValidExts</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-type">ReadFileError</span></a></span><span class="hs-special">{</span><span id="local-6989586621681844628"><span class="annot"><span class="annottext">RangeFile
errPath :: ParseError -&gt; RangeFile
errPath :: RangeFile
</span><a href="Agda.Syntax.Parser.Monad.html#errPath"><span class="hs-identifier hs-var hs-var">errPath</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681844629"><span class="annot"><span class="annottext">IOError
errIOError :: ParseError -&gt; IOError
errIOError :: IOError
</span><a href="Agda.Syntax.Parser.Monad.html#errIOError"><span class="hs-identifier hs-var hs-var">errIOError</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Doc]] -&gt; [Doc]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Cannot read file&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">RangeFile -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844628"><span class="hs-identifier hs-var">errPath</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RangeFile -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681844628"><span class="hs-identifier hs-var">errPath</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Error:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOError -&gt; String
forall e. Exception e =&gt; e -&gt; String
</span><a href="Agda.Utils.IO.html#showIOException"><span class="hs-identifier hs-var">showIOException</span></a></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621681844629"><span class="hs-identifier hs-var">errIOError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621681844634"><span class="annot"><span class="annottext">getRange :: ParseError -&gt; Range
</span><a href="#local-6989586621681844634"><span class="hs-identifier hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span id="local-6989586621681844636"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621681844636"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621681844636"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errPos :: ParseError -&gt; Position
</span><a href="Agda.Syntax.Parser.Monad.html#errPos"><span class="hs-identifier hs-var">errPos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681844637"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844637"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Range
forall a b. Position' a -&gt; Position' b -&gt; Range' a
</span><a href="Agda.Syntax.Position.html#posToRange"><span class="hs-identifier hs-var">posToRange</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844637"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensError"><span class="hs-identifier hs-type">OverlappingTokensError</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621681844639"><span class="annot"><span class="annottext">Range
errRange :: ParseError -&gt; Range
errRange :: Range
</span><a href="Agda.Syntax.Parser.Monad.html#errRange"><span class="hs-identifier hs-var hs-var">errRange</span></a></span></span><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844639"><span class="hs-identifier hs-var">errRange</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#InvalidExtensionError"><span class="hs-identifier hs-type">InvalidExtensionError</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844640"><span class="hs-identifier hs-var">errPathRange</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ReadFileError"><span class="hs-identifier hs-type">ReadFileError</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844640"><span class="hs-identifier hs-var">errPathRange</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621681844640"><span class="annot"><span class="annottext">errPathRange :: Range
</span><a href="#local-6989586621681844640"><span class="hs-identifier hs-var hs-var">errPathRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Range
forall a b. Position' a -&gt; Position' b -&gt; Range' a
</span><a href="Agda.Syntax.Position.html#posToRange"><span class="hs-identifier hs-var">posToRange</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844641"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844641"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681844641"><span class="annot"><span class="annottext">p :: Position
</span><a href="#local-6989586621681844641"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RangeFile -&gt; Position
</span><a href="Agda.Syntax.Position.html#startPos"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe RangeFile -&gt; Position) -&gt; Maybe RangeFile -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RangeFile -&gt; Maybe RangeFile
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RangeFile -&gt; Maybe RangeFile) -&gt; RangeFile -&gt; Maybe RangeFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; RangeFile
</span><a href="Agda.Syntax.Parser.Monad.html#errPath"><span class="hs-identifier hs-var">errPath</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621681844636"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Does not include printing of the range.</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681844645"><span id="local-6989586621681844649"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621681844690"><span class="annot"><span class="annottext">pretty :: ParseWarning -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensWarning"><span class="hs-identifier hs-type">OverlappingTokensWarning</span></a></span><span> </span><span id="local-6989586621681844691"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844691"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Multi-line comment spans one or more literate text blocks.&quot;</span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MisplacedAttributes"><span class="hs-identifier hs-type">MisplacedAttributes</span></a></span><span> </span><span id="local-6989586621681844692"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844692"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844693"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844693"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844693"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownPolarity"><span class="hs-identifier hs-type">UnknownPolarity</span></a></span><span> </span><span id="local-6989586621681844694"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844694"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844695"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844695"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Replacing unknown polarity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844695"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;by&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#Mixed"><span class="hs-identifier hs-var">Mixed</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownAttribute"><span class="hs-identifier hs-type">UnknownAttribute</span></a></span><span> </span><span id="local-6989586621681844696"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844696"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844697"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844697"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Ignoring unknown attribute:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844697"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-type">UnsupportedAttribute</span></a></span><span> </span><span id="local-6989586621681844698"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844698"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844699"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844699"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844699"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-335"></span><span>          </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Attributes&quot;</span></span><span>
</span><span id="line-336"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681844701"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844701"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844701"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;attributes&quot;</span></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;are not supported here.&quot;</span></span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-type">MismatchedBrackets</span></a></span><span> </span><span id="local-6989586621681844702"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844702"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844703"><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844703"><span class="hs-identifier hs-var">brk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681844704"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844704"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844705"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844705"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681844706"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844706"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844703"><span class="hs-identifier hs-var">brk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-type">OpenIdiomBracket</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Idiom brackets&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\x2987&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\x2988&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-type">OpenIdiomBracket</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Idiom brackets&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(|&quot;</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;|)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-type">OpenDoubleBrace</span></a></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Double braces&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\x2983&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\x2984&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-type">OpenDoubleBrace</span></a></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Double braces&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;{{&quot;</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;}}&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844704"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; opened with `&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844705"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;` must be closed with `&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681844706"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;`.&quot;</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-type">MultipleAttributes</span></a></span><span> </span><span id="local-6989586621681844707"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844707"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621681844708"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844708"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Multiple&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681844708"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;attributes (ignored).&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseWarning"><span class="hs-identifier hs-type">ParseWarning</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621681844711"><span class="annot"><span class="annottext">getRange :: ParseWarning -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OverlappingTokensWarning"><span class="hs-identifier hs-type">OverlappingTokensWarning</span></a></span><span class="hs-special">{</span><span id="local-6989586621681844712"><span class="annot"><span class="annottext">Range
warnRange :: ParseWarning -&gt; Range
warnRange :: Range
</span><a href="Agda.Syntax.Parser.Monad.html#warnRange"><span class="hs-identifier hs-var hs-var">warnRange</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844712"><span class="hs-identifier hs-var">warnRange</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MisplacedAttributes"><span class="hs-identifier hs-type">MisplacedAttributes</span></a></span><span> </span><span id="local-6989586621681844713"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844713"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844713"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownPolarity"><span class="hs-identifier hs-type">UnknownPolarity</span></a></span><span> </span><span id="local-6989586621681844714"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844714"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844714"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnknownAttribute"><span class="hs-identifier hs-type">UnknownAttribute</span></a></span><span> </span><span id="local-6989586621681844715"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844715"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844715"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-type">UnsupportedAttribute</span></a></span><span> </span><span id="local-6989586621681844716"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844716"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844716"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-type">MultipleAttributes</span></a></span><span> </span><span id="local-6989586621681844717"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844717"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844717"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-type">MismatchedBrackets</span></a></span><span> </span><span id="local-6989586621681844718"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844718"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844718"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">{--------------------------------------------------------------------------
    Running the parser
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#initStatePos"><span class="hs-identifier hs-type">initStatePos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span>
</span><span id="line-367"></span><span id="initStatePos"><span class="annot"><span class="annottext">initStatePos :: Position -&gt; ParseFlags -&gt; String -&gt; [LexState] -&gt; ParseState
</span><a href="Agda.Syntax.Parser.Monad.html#initStatePos"><span class="hs-identifier hs-var hs-var">initStatePos</span></a></span></span><span> </span><span id="local-6989586621681844720"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844720"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621681844721"><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844721"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621681844722"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844722"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span id="local-6989586621681844723"><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844723"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#PState"><span class="hs-identifier hs-type">PState</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">parseSrcFile :: SrcFile
</span><a href="Agda.Syntax.Parser.Monad.html#parseSrcFile"><span class="hs-identifier hs-var">parseSrcFile</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; SrcFile
forall a. Position' a -&gt; a
</span><a href="Agda.Syntax.Position.html#srcFile"><span class="hs-identifier hs-var">srcFile</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844720"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-369"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parsePos :: PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parsePos"><span class="hs-identifier hs-var">parsePos</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844725"><span class="hs-identifier hs-var">pos'</span></a></span><span>
</span><span id="line-370"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseLastPos :: PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var">parseLastPos</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844725"><span class="hs-identifier hs-var">pos'</span></a></span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseInp :: String
</span><a href="Agda.Syntax.Parser.Monad.html#parseInp"><span class="hs-identifier hs-var">parseInp</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844722"><span class="hs-identifier hs-var">inp</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parsePrevChar :: Char
</span><a href="Agda.Syntax.Parser.Monad.html#parsePrevChar"><span class="hs-identifier hs-var">parsePrevChar</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parsePrevToken :: String
</span><a href="Agda.Syntax.Parser.Monad.html#parsePrevToken"><span class="hs-identifier hs-var">parsePrevToken</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-374"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseLexState :: [LexState]
</span><a href="Agda.Syntax.Parser.Monad.html#parseLexState"><span class="hs-identifier hs-var">parseLexState</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844723"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseLayout :: LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayout"><span class="hs-identifier hs-var">parseLayout</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- the first block will be from the top-level layout</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseLayStatus :: LayoutStatus
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayStatus"><span class="hs-identifier hs-var">parseLayStatus</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutStatus
</span><a href="Agda.Syntax.Parser.Monad.html#Confirmed"><span class="hs-identifier hs-var">Confirmed</span></a></span><span> </span><span class="hs-comment">-- for the to-be-determined column of the top-level layout</span><span>
</span><span id="line-377"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseLayKw :: Keyword
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayKw"><span class="hs-identifier hs-var">parseLayKw</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Keyword
</span><a href="Agda.Syntax.Parser.Tokens.html#KwMutual"><span class="hs-identifier hs-var">KwMutual</span></a></span><span>  </span><span class="hs-comment">-- Layout keyword for the top-level layout.</span><span>
</span><span id="line-378"></span><span>                                                </span><span class="hs-comment">-- Does not mean that the top-level block is a mutual block.</span><span>
</span><span id="line-379"></span><span>                                                </span><span class="hs-comment">-- Just for better errors on stray @constructor@ decls.</span><span>
</span><span id="line-380"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseFlags :: ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#parseFlags"><span class="hs-identifier hs-var">parseFlags</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844721"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-381"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseWarnings :: [ParseWarning]
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarnings"><span class="hs-identifier hs-var">parseWarnings</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseAttributes :: Attributes
</span><a href="Agda.Syntax.Parser.Monad.html#parseAttributes"><span class="hs-identifier hs-var">parseAttributes</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-383"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parseBrackets :: [OpenBracket]
</span><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var">parseBrackets</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-384"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621681844725"><span class="annot"><span class="annottext">pos' :: PositionWithoutFile
</span><a href="#local-6989586621681844725"><span class="hs-identifier hs-var hs-var">pos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844720"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#srcFile"><span class="hs-identifier hs-var">srcFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Constructs the initial state of the parser. The string argument</span><span>
</span><span id="line-389"></span><span class="hs-comment">--   is the input string, the file path is only there because it's part</span><span>
</span><span id="line-390"></span><span class="hs-comment">--   of a position.</span><span>
</span><span id="line-391"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#initState"><span class="hs-identifier hs-type">initState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#RangeFile"><span class="hs-identifier hs-type">RangeFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span>
</span><span id="line-393"></span><span id="initState"><span class="annot"><span class="annottext">initState :: Maybe RangeFile -&gt; ParseFlags -&gt; String -&gt; [LexState] -&gt; ParseState
</span><a href="Agda.Syntax.Parser.Monad.html#initState"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span id="local-6989586621681844726"><span class="annot"><span class="annottext">Maybe RangeFile
</span><a href="#local-6989586621681844726"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; ParseFlags -&gt; String -&gt; [LexState] -&gt; ParseState
</span><a href="Agda.Syntax.Parser.Monad.html#initStatePos"><span class="hs-identifier hs-var">initStatePos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe RangeFile -&gt; Position
</span><a href="Agda.Syntax.Position.html#startPos"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RangeFile
</span><a href="#local-6989586621681844726"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><span class="hs-comment">-- | The default flags.</span></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#defaultParseFlags"><span class="hs-identifier hs-type">defaultParseFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span>
</span><span id="line-397"></span><span id="defaultParseFlags"><span class="annot"><span class="annottext">defaultParseFlags :: ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#defaultParseFlags"><span class="hs-identifier hs-var hs-var">defaultParseFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">parseKeepComments :: Bool
</span><a href="Agda.Syntax.Parser.Monad.html#parseKeepComments"><span class="hs-identifier hs-var">parseKeepComments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | The most general way of parsing a string. The &quot;Agda.Syntax.Parser&quot; will define</span><span>
</span><span id="line-400"></span><span class="hs-comment">--   more specialised functions that supply the 'ParseFlags' and the</span><span>
</span><span id="line-401"></span><span class="hs-comment">--   'LexState'.</span><span>
</span><span id="line-402"></span><span id="local-6989586621681843968"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parse"><span class="hs-identifier hs-type">parse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843968"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-403"></span><span id="parse"><span class="annot"><span class="annottext">parse :: forall a.
ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parse"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621681844727"><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844727"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621681844728"><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844728"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621681844729"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844729"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681844730"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844730"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseFlags
-&gt; [LexState] -&gt; Parser a -&gt; SrcFile -&gt; String -&gt; ParseResult a
forall a.
ParseFlags
-&gt; [LexState] -&gt; Parser a -&gt; SrcFile -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parseFromSrc"><span class="hs-identifier hs-var">parseFromSrc</span></a></span><span> </span><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844727"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844728"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844729"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SrcFile
forall a. Maybe a
</span><span class="hs-identifier hs-var">Strict.Nothing</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844730"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><span class="hs-comment">-- | The even more general way of parsing a string.</span></span><span>
</span><span id="line-406"></span><span id="local-6989586621681843972"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePosString"><span class="hs-identifier hs-type">parsePosString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>                  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843972"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-408"></span><span id="parsePosString"><span class="annot"><span class="annottext">parsePosString :: forall a.
Position
-&gt; ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parsePosString"><span class="hs-identifier hs-var hs-var">parsePosString</span></a></span></span><span> </span><span id="local-6989586621681844732"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844732"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621681844733"><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844733"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621681844734"><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844734"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621681844735"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844735"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681844736"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844736"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParseState -&gt; ParseResult a
forall a. Parser a -&gt; ParseState -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#unP"><span class="hs-identifier hs-var">unP</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844735"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; ParseFlags -&gt; String -&gt; [LexState] -&gt; ParseState
</span><a href="Agda.Syntax.Parser.Monad.html#initStatePos"><span class="hs-identifier hs-var">initStatePos</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621681844732"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844733"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844736"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844734"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><span class="hs-comment">-- | Calls 'parsePosString' with 'Position' extracted from the Range.</span></span><span>
</span><span id="line-411"></span><span id="local-6989586621681843974"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseRangeString"><span class="hs-identifier hs-type">parseRangeString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843974"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-412"></span><span>                    </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843974"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-413"></span><span id="parseRangeString"><span class="annot"><span class="annottext">parseRangeString :: forall a.
Range
-&gt; ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parseRangeString"><span class="hs-identifier hs-var hs-var">parseRangeString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a
forall a.
Position
-&gt; ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parsePosString"><span class="hs-identifier hs-var">parsePosString</span></a></span><span> </span><span class="annot"><span class="annottext">(Position
 -&gt; ParseFlags -&gt; [LexState] -&gt; Parser a -&gt; String -&gt; ParseResult a)
-&gt; (Range -&gt; Position)
-&gt; Range
-&gt; ParseFlags
-&gt; [LexState]
-&gt; Parser a
-&gt; String
-&gt; ParseResult a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position -&gt; Position
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe RangeFile -&gt; Position
</span><a href="Agda.Syntax.Position.html#startPos"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RangeFile
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Position -&gt; Position)
-&gt; (Range -&gt; Maybe Position) -&gt; Range -&gt; Position
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe Position
forall a. Range' a -&gt; Maybe (Position' a)
</span><a href="Agda.Syntax.Position.html#rStart"><span class="hs-identifier hs-var">rStart</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Parses a string as if it were the contents of the given file</span><span>
</span><span id="line-416"></span><span class="hs-comment">--   Useful for integrating preprocessors.</span><span>
</span><span id="line-417"></span><span id="local-6989586621681843970"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseFromSrc"><span class="hs-identifier hs-type">parseFromSrc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#SrcFile"><span class="hs-identifier hs-type">SrcFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-418"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843970"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-419"></span><span id="parseFromSrc"><span class="annot"><span class="annottext">parseFromSrc :: forall a.
ParseFlags
-&gt; [LexState] -&gt; Parser a -&gt; SrcFile -&gt; String -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parseFromSrc"><span class="hs-identifier hs-var hs-var">parseFromSrc</span></a></span></span><span> </span><span id="local-6989586621681844742"><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844742"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621681844743"><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844743"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621681844744"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844744"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681844745"><span class="annot"><span class="annottext">SrcFile
</span><a href="#local-6989586621681844745"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621681844746"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844746"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParseState -&gt; ParseResult a
forall a. Parser a -&gt; ParseState -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#unP"><span class="hs-identifier hs-var">unP</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681844744"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe RangeFile -&gt; ParseFlags -&gt; String -&gt; [LexState] -&gt; ParseState
</span><a href="Agda.Syntax.Parser.Monad.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcFile -&gt; Maybe RangeFile
forall lazy strict. Strict lazy strict =&gt; strict -&gt; lazy
</span><span class="hs-identifier hs-var">Strict.toLazy</span></span><span> </span><span class="annot"><span class="annottext">SrcFile
</span><a href="#local-6989586621681844745"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseFlags
</span><a href="#local-6989586621681844742"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844746"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">[LexState]
</span><a href="#local-6989586621681844743"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">{--------------------------------------------------------------------------
    Manipulating the state
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setParsePos"><span class="hs-identifier hs-type">setParsePos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span id="setParsePos"><span class="annot"><span class="annottext">setParsePos :: PositionWithoutFile -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setParsePos"><span class="hs-identifier hs-var hs-var">setParsePos</span></a></span></span><span> </span><span id="local-6989586621681844748"><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844748"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844750"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844750"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844750"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePos"><span class="hs-identifier hs-var">parsePos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844748"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setLastPos"><span class="hs-identifier hs-type">setLastPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span id="setLastPos"><span class="annot"><span class="annottext">setLastPos :: PositionWithoutFile -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setLastPos"><span class="hs-identifier hs-var hs-var">setLastPos</span></a></span></span><span> </span><span id="local-6989586621681844751"><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844751"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844752"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844752"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844752"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var">parseLastPos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844751"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setPrevToken"><span class="hs-identifier hs-type">setPrevToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span id="setPrevToken"><span class="annot"><span class="annottext">setPrevToken :: String -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setPrevToken"><span class="hs-identifier hs-var hs-var">setPrevToken</span></a></span></span><span> </span><span id="local-6989586621681844753"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844753"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844754"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844754"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844754"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePrevToken"><span class="hs-identifier hs-var">parsePrevToken</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844753"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getLastPos"><span class="hs-identifier hs-type">getLastPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span>
</span><span id="line-436"></span><span id="getLastPos"><span class="annot"><span class="annottext">getLastPos :: Parser PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#getLastPos"><span class="hs-identifier hs-var hs-var">getLastPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; PositionWithoutFile) -&gt; Parser PositionWithoutFile
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var">parseLastPos</span></a></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="annot"><span class="hs-comment">-- | The parse interval is between the last position and the current position.</span></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getParseInterval"><span class="hs-identifier hs-type">getParseInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span>
</span><span id="line-440"></span><span id="getParseInterval"><span class="annot"><span class="annottext">getParseInterval :: Parser Interval
</span><a href="Agda.Syntax.Parser.Monad.html#getParseInterval"><span class="hs-identifier hs-var hs-var">getParseInterval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621681844757"><span class="annot"><a href="#local-6989586621681844757"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser ParseState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#posToInterval"><span class="hs-identifier hs-type">posToInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseSrcFile"><span class="hs-identifier hs-var">parseSrcFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844757"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLastPos"><span class="hs-identifier hs-var">parseLastPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844757"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parsePos"><span class="hs-identifier hs-var">parsePos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844757"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getLexState"><span class="hs-identifier hs-type">getLexState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-445"></span><span id="getLexState"><span class="annot"><span class="annottext">getLexState :: Parser [LexState]
</span><a href="Agda.Syntax.Parser.Monad.html#getLexState"><span class="hs-identifier hs-var hs-var">getLexState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; [LexState]) -&gt; Parser [LexState]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; [LexState]
</span><a href="Agda.Syntax.Parser.Monad.html#parseLexState"><span class="hs-identifier hs-var">parseLexState</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- UNUSED Liang-Ting Chen 2019-07-16</span><span>
</span><span id="line-448"></span><span class="hs-comment">--setLexState :: [LexState] -&gt; Parser ()</span><span>
</span><span id="line-449"></span><span class="hs-comment">--setLexState ls = modify $ \ s -&gt; s { parseLexState = ls }</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#modifyLexState"><span class="hs-identifier hs-type">modifyLexState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span id="modifyLexState"><span class="annot"><span class="annottext">modifyLexState :: ([LexState] -&gt; [LexState]) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyLexState"><span class="hs-identifier hs-var hs-var">modifyLexState</span></a></span></span><span> </span><span id="local-6989586621681844760"><span class="annot"><span class="annottext">[LexState] -&gt; [LexState]
</span><a href="#local-6989586621681844760"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681844761"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844761"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844761"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLexState"><span class="hs-identifier hs-var">parseLexState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844760"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLexState"><span class="hs-identifier hs-var">parseLexState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844761"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#pushLexState"><span class="hs-identifier hs-type">pushLexState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LexState"><span class="hs-identifier hs-type">LexState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span id="pushLexState"><span class="annot"><span class="annottext">pushLexState :: LexState -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#pushLexState"><span class="hs-identifier hs-var hs-var">pushLexState</span></a></span></span><span> </span><span id="local-6989586621681844762"><span class="annot"><span class="annottext">LexState
</span><a href="#local-6989586621681844762"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LexState] -&gt; [LexState]) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyLexState"><span class="hs-identifier hs-var">modifyLexState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LexState
</span><a href="#local-6989586621681844762"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">LexState -&gt; [LexState] -&gt; [LexState]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#popLexState"><span class="hs-identifier hs-type">popLexState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span id="popLexState"><span class="annot"><span class="annottext">popLexState :: Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#popLexState"><span class="hs-identifier hs-var hs-var">popLexState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LexState] -&gt; [LexState]) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyLexState"><span class="hs-identifier hs-var">modifyLexState</span></a></span><span> </span><span class="annot"><span class="annottext">(([LexState] -&gt; [LexState]) -&gt; Parser ())
-&gt; ([LexState] -&gt; [LexState]) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[LexState] -&gt; [LexState] -&gt; [LexState]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.List.html#tailWithDefault"><span class="hs-identifier hs-var">tailWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">[LexState]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getParseFlags"><span class="hs-identifier hs-type">getParseFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFlags"><span class="hs-identifier hs-type">ParseFlags</span></a></span><span>
</span><span id="line-461"></span><span id="getParseFlags"><span class="annot"><span class="annottext">getParseFlags :: Parser ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#getParseFlags"><span class="hs-identifier hs-var hs-var">getParseFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseFlags) -&gt; Parser ParseFlags
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#parseFlags"><span class="hs-identifier hs-var">parseFlags</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">-- | Fake a parse error at the specified position. Used, for instance, when</span><span>
</span><span id="line-465"></span><span class="hs-comment">--   lexing nested comments, which when failing will always fail at the end</span><span>
</span><span id="line-466"></span><span class="hs-comment">--   of the file. A more informative position is the beginning of the failing</span><span>
</span><span id="line-467"></span><span class="hs-comment">--   comment.</span><span>
</span><span id="line-468"></span><span id="local-6989586621681843991"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseErrorAt"><span class="hs-identifier hs-type">parseErrorAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843991"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-469"></span><span id="parseErrorAt"><span class="annot"><span class="annottext">parseErrorAt :: forall a. PositionWithoutFile -&gt; String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorAt"><span class="hs-identifier hs-var hs-var">parseErrorAt</span></a></span></span><span> </span><span id="local-6989586621681844765"><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844765"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681844766"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844766"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="annot"><span class="annottext">PositionWithoutFile -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setLastPos"><span class="hs-identifier hs-var">setLastPos</span></a></span><span> </span><span class="annot"><span class="annottext">PositionWithoutFile
</span><a href="#local-6989586621681844765"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-471"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Parser a
forall a. String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844766"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><span class="hs-comment">-- | Use 'parseErrorAt' or 'parseError' as appropriate.</span></span><span>
</span><span id="line-474"></span><span id="local-6989586621681843993"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-type">parseError'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#PositionWithoutFile"><span class="hs-identifier hs-type">PositionWithoutFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843993"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-475"></span><span id="parseError%27"><span class="annot"><span class="annottext">parseError' :: forall a. Maybe PositionWithoutFile -&gt; String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var hs-var">parseError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser a)
-&gt; (PositionWithoutFile -&gt; String -&gt; Parser a)
-&gt; Maybe PositionWithoutFile
-&gt; String
-&gt; Parser a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser a
forall a. String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">PositionWithoutFile -&gt; String -&gt; Parser a
forall a. PositionWithoutFile -&gt; String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorAt"><span class="hs-identifier hs-var">parseErrorAt</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><span class="hs-comment">-- | Report a parse error at the beginning of the given 'Range'.</span></span><span>
</span><span id="line-478"></span><span id="local-6989586621681843997"><span id="local-6989586621681843998"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-type">parseErrorRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843997"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681843997"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681843998"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-479"></span><span id="parseErrorRange"><span class="annot"><span class="annottext">parseErrorRange :: forall r a. HasRange r =&gt; r -&gt; String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var hs-var">parseErrorRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile -&gt; String -&gt; Parser a
forall a. Maybe PositionWithoutFile -&gt; String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe PositionWithoutFile -&gt; String -&gt; Parser a)
-&gt; (r -&gt; Maybe PositionWithoutFile) -&gt; r -&gt; String -&gt; Parser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; (r -&gt; Range) -&gt; r -&gt; Maybe PositionWithoutFile
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | For lexical errors we want to report the current position as the site of</span><span>
</span><span id="line-483"></span><span class="hs-comment">--   the error, whereas for parse errors the previous position is the one</span><span>
</span><span id="line-484"></span><span class="hs-comment">--   we're interested in (since this will be the position of the token we just</span><span>
</span><span id="line-485"></span><span class="hs-comment">--   lexed). This function does 'parseErrorAt' the current position.</span><span>
</span><span id="line-486"></span><span id="local-6989586621681844771"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#lexError"><span class="hs-identifier hs-type">lexError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844771"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-487"></span><span id="lexError"><span class="annot"><span class="annottext">lexError :: forall a. String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#lexError"><span class="hs-identifier hs-var hs-var">lexError</span></a></span></span><span> </span><span id="local-6989586621681844774"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681844774"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621681844775"><span class="annot"><a href="#local-6989586621681844775"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; PositionWithoutFile) -&gt; Parser PositionWithoutFile
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; PositionWithoutFile
</span><a href="Agda.Syntax.Parser.Monad.html#parsePos"><span class="hs-identifier hs-var">parsePos</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseErrorAt"><span class="hs-identifier hs-type">parseErrorAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844775"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844774"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">{--------------------------------------------------------------------------
    Layout
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span id="local-6989586621681844003"><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#getContext"><span class="hs-identifier hs-type">getContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseState"><span class="hs-identifier hs-type">ParseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681844003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-type">LayoutContext</span></a></span></span><span>
</span><span id="line-496"></span><span id="getContext"><span class="annot"><span class="annottext">getContext :: forall (m :: * -&gt; *). MonadState ParseState m =&gt; m LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#getContext"><span class="hs-identifier hs-var hs-var">getContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; LayoutContext) -&gt; m LayoutContext
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#parseLayout"><span class="hs-identifier hs-var">parseLayout</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#setContext"><span class="hs-identifier hs-type">setContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-type">LayoutContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span id="setContext"><span class="annot"><span class="annottext">setContext :: LayoutContext -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setContext"><span class="hs-identifier hs-var hs-var">setContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LayoutContext -&gt; LayoutContext) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyContext"><span class="hs-identifier hs-var">modifyContext</span></a></span><span> </span><span class="annot"><span class="annottext">((LayoutContext -&gt; LayoutContext) -&gt; Parser ())
-&gt; (LayoutContext -&gt; LayoutContext -&gt; LayoutContext)
-&gt; LayoutContext
-&gt; Parser ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayoutContext -&gt; LayoutContext -&gt; LayoutContext
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#modifyContext"><span class="hs-identifier hs-type">modifyContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-type">LayoutContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutContext"><span class="hs-identifier hs-type">LayoutContext</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span id="modifyContext"><span class="annot"><span class="annottext">modifyContext :: (LayoutContext -&gt; LayoutContext) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyContext"><span class="hs-identifier hs-var hs-var">modifyContext</span></a></span></span><span> </span><span id="local-6989586621681844778"><span class="annot"><span class="annottext">LayoutContext -&gt; LayoutContext
</span><a href="#local-6989586621681844778"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681844779"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844779"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844779"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLayout"><span class="hs-identifier hs-var">parseLayout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844778"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLayout"><span class="hs-identifier hs-var">parseLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844779"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="annot"><span class="hs-comment">-- | Return the current layout block.</span></span><span>
</span><span id="line-505"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#topBlock"><span class="hs-identifier hs-type">topBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutBlock"><span class="hs-identifier hs-type">LayoutBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span id="topBlock"><span class="annot"><span class="annottext">topBlock :: Parser (Maybe LayoutBlock)
</span><a href="Agda.Syntax.Parser.Monad.html#topBlock"><span class="hs-identifier hs-var hs-var">topBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutContext -&gt; Maybe LayoutBlock
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(LayoutContext -&gt; Maybe LayoutBlock)
-&gt; Parser LayoutContext -&gt; Parser (Maybe LayoutBlock)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser LayoutContext
forall (m :: * -&gt; *). MonadState ParseState m =&gt; m LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#popBlock"><span class="hs-identifier hs-type">popBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span id="popBlock"><span class="annot"><span class="annottext">popBlock :: Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#popBlock"><span class="hs-identifier hs-var hs-var">popBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621681844781"><span class="annot"><a href="#local-6989586621681844781"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser LayoutContext
forall (m :: * -&gt; *). MonadState ParseState m =&gt; m LayoutContext
</span><a href="Agda.Syntax.Parser.Monad.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-511"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681844781"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-512"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ()
forall a. String -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;There is no layout block to close at this point.&quot;</span></span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><span class="annottext">LayoutBlock
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681844782"><span class="annot"><span class="annottext">LayoutContext
</span><a href="#local-6989586621681844782"><span class="hs-identifier hs-var">ctx</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LayoutContext -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#setContext"><span class="hs-identifier hs-var">setContext</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutContext
</span><a href="#local-6989586621681844782"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#pushBlock"><span class="hs-identifier hs-type">pushBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#LayoutBlock"><span class="hs-identifier hs-type">LayoutBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span id="pushBlock"><span class="annot"><span class="annottext">pushBlock :: LayoutBlock -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#pushBlock"><span class="hs-identifier hs-var hs-var">pushBlock</span></a></span></span><span> </span><span id="local-6989586621681844783"><span class="annot"><span class="annottext">LayoutBlock
</span><a href="#local-6989586621681844783"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LayoutContext -&gt; LayoutContext) -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#modifyContext"><span class="hs-identifier hs-var">modifyContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LayoutBlock
</span><a href="#local-6989586621681844783"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutBlock -&gt; LayoutContext -&gt; LayoutContext
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><span class="hs-comment">-- | When we see a layout keyword, by default we expect a 'Tentative' block.</span></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#resetLayoutStatus"><span class="hs-identifier hs-type">resetLayoutStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span id="resetLayoutStatus"><span class="annot"><span class="annottext">resetLayoutStatus :: Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#resetLayoutStatus"><span class="hs-identifier hs-var hs-var">resetLayoutStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ParseState -&gt; ParseState) -&gt; Parser ())
-&gt; (ParseState -&gt; ParseState) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681844784"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844784"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844784"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseLayStatus"><span class="hs-identifier hs-var">parseLayStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Tentative"><span class="hs-identifier hs-type">Tentative</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-523"></span><span class="annot"><span class="hs-comment">-- * Brackets</span></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="annot"><span class="hs-comment">-- | Push the 'OpenBracket' state corresponding to an opening token.</span></span><span>
</span><span id="line-526"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#openBracket"><span class="hs-identifier hs-type">openBracket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>
</span><span id="line-527"></span><span id="openBracket"><span class="annot"><span class="annottext">openBracket :: Token -&gt; Parser Range
</span><a href="Agda.Syntax.Parser.Monad.html#openBracket"><span class="hs-identifier hs-var hs-var">openBracket</span></a></span></span><span> </span><span id="local-6989586621681844785"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621681844785"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621681844785"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokSymbol"><span class="hs-identifier hs-type">TokSymbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#SymOpenIdiomBracket"><span class="hs-identifier hs-type">SymOpenIdiomBracket</span></a></span><span> </span><span id="local-6989586621681844788"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844788"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621681844789"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844789"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Interval -&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall {f :: * -&gt; *} {t}.
(HasRange t, MonadState ParseState f) =&gt;
t -&gt; (t -&gt; OpenBracket) -&gt; f Range
</span><a href="#local-6989586621681844790"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844789"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">((Interval -&gt; OpenBracket) -&gt; Parser Range)
-&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Interval -&gt; OpenBracket
</span><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-var">OpenIdiomBracket</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844788"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokSymbol"><span class="hs-identifier hs-type">TokSymbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#SymDoubleOpenBrace"><span class="hs-identifier hs-type">SymDoubleOpenBrace</span></a></span><span>  </span><span id="local-6989586621681844792"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844792"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621681844793"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844793"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Interval -&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall {f :: * -&gt; *} {t}.
(HasRange t, MonadState ParseState f) =&gt;
t -&gt; (t -&gt; OpenBracket) -&gt; f Range
</span><a href="#local-6989586621681844790"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844793"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">((Interval -&gt; OpenBracket) -&gt; Parser Range)
-&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Interval -&gt; OpenBracket
</span><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-var">OpenDoubleBrace</span></a></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844792"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokQual"><span class="hs-identifier hs-type">TokQual</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#QualOpenIdiom"><span class="hs-identifier hs-type">QualOpenIdiom</span></a></span><span>       </span><span id="local-6989586621681844795"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844795"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Interval, String)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681844796"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844796"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Interval -&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall {f :: * -&gt; *} {t}.
(HasRange t, MonadState ParseState f) =&gt;
t -&gt; (t -&gt; OpenBracket) -&gt; f Range
</span><a href="#local-6989586621681844790"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844796"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">((Interval -&gt; OpenBracket) -&gt; Parser Range)
-&gt; (Interval -&gt; OpenBracket) -&gt; Parser Range
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Interval -&gt; OpenBracket
</span><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-var">OpenIdiomBracket</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844795"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-comment">-- These are the only tokens we call this for.</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Range
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681844790"><span class="annot"><span class="annottext">push :: t -&gt; (t -&gt; OpenBracket) -&gt; f Range
</span><a href="#local-6989586621681844790"><span class="hs-identifier hs-var hs-var">push</span></a></span></span><span> </span><span id="local-6989586621681844811"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681844811"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621681844812"><span class="annot"><span class="annottext">t -&gt; OpenBracket
</span><a href="#local-6989586621681844812"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681844811"><span class="hs-identifier hs-var">rng</span></a></span><span> </span><span class="annot"><span class="annottext">Range -&gt; f () -&gt; f Range
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; f ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844813"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844813"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844813"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var">parseBrackets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844812"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844811"><span class="hs-identifier hs-type">rng</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var">parseBrackets</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681844813"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | Pop an 'OpenBracket' from the parser state, and generate the</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- 'MismatchedBrackets' warning if the given 'Token' does not match what</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- was expected.</span><span>
</span><span id="line-540"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#closeBracket"><span class="hs-identifier hs-type">closeBracket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>
</span><span id="line-541"></span><span id="closeBracket"><span class="annot"><span class="annottext">closeBracket :: Token -&gt; Parser Range
</span><a href="Agda.Syntax.Parser.Monad.html#closeBracket"><span class="hs-identifier hs-var hs-var">closeBracket</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokSymbol"><span class="hs-identifier hs-type">TokSymbol</span></a></span><span> </span><span id="local-6989586621681844814"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621681844814"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621681844815"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844815"><span class="hs-identifier hs-var">ivl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621681844816"><span class="annot"><span class="annottext">rng :: Range
</span><a href="#local-6989586621681844816"><span class="hs-identifier hs-var hs-var">rng</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Interval -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681844815"><span class="hs-identifier hs-var">ivl</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span id="local-6989586621681844817"><span class="annot"><span class="annottext">match :: OpenBracket -&gt; Bool -&gt; [OpenBracket] -&gt; Parser Range
</span><a href="#local-6989586621681844817"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621681844818"><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844818"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681844819"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844819"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621681844820"><span class="annot"><span class="annottext">[OpenBracket]
</span><a href="#local-6989586621681844820"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844816"><span class="hs-identifier hs-var">rng</span></a></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Parser () -&gt; Parser Range
forall a b. a -&gt; Parser b -&gt; Parser a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenBracket -&gt; Bool
</span><a href="Agda.Syntax.Parser.Monad.html#openBracketUnicode"><span class="hs-identifier hs-var">openBracketUnicode</span></a></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844818"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844819"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseWarning -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseWarning -&gt; Parser ()) -&gt; ParseWarning -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; OpenBracket -&gt; ParseWarning
</span><a href="Agda.Syntax.Parser.Monad.html#MismatchedBrackets"><span class="hs-identifier hs-var">MismatchedBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681844816"><span class="hs-identifier hs-var">rng</span></a></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844818"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><span class="annottext">(ParseState -&gt; ParseState) -&gt; Parser ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681844822"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844822"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681844822"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var">parseBrackets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681844820"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-comment">-- Since Happy won't call the action if the rule doesn't match, and we</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-comment">-- call this function from the *parser*, this function is guaranteed</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-comment">-- to only run if the parser is expecting a closing delimiter of the</span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-comment">-- right type.</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><span class="annottext">(ParseState -&gt; [OpenBracket]) -&gt; Parser [OpenBracket]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">ParseState -&gt; [OpenBracket]
</span><a href="Agda.Syntax.Parser.Monad.html#parseBrackets"><span class="hs-identifier hs-var">parseBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">Parser [OpenBracket]
-&gt; ([OpenBracket] -&gt; Parser Range) -&gt; Parser Range
forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621681844823"><span class="annot"><span class="annottext">open :: OpenBracket
</span><a href="#local-6989586621681844823"><span class="hs-identifier hs-var">open</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenIdiomBracket"><span class="hs-identifier hs-type">OpenIdiomBracket</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681844824"><span class="annot"><span class="annottext">[OpenBracket]
</span><a href="#local-6989586621681844824"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-554"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#SymCloseIdiomBracket"><span class="hs-identifier hs-type">SymCloseIdiomBracket</span></a></span><span> </span><span id="local-6989586621681844826"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844826"><span class="hs-identifier hs-var">uC</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621681844814"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenBracket -&gt; Bool -&gt; [OpenBracket] -&gt; Parser Range
</span><a href="#local-6989586621681844817"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844823"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844826"><span class="hs-identifier hs-var">uC</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenBracket]
</span><a href="#local-6989586621681844824"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-555"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Range
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621681844827"><span class="annot"><span class="annottext">open :: OpenBracket
</span><a href="#local-6989586621681844827"><span class="hs-identifier hs-var">open</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#OpenDoubleBrace"><span class="hs-identifier hs-type">OpenDoubleBrace</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681844828"><span class="annot"><span class="annottext">[OpenBracket]
</span><a href="#local-6989586621681844828"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#SymDoubleCloseBrace"><span class="hs-identifier hs-type">SymDoubleCloseBrace</span></a></span><span>  </span><span id="local-6989586621681844830"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844830"><span class="hs-identifier hs-var">uC</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621681844814"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenBracket -&gt; Bool -&gt; [OpenBracket] -&gt; Parser Range
</span><a href="#local-6989586621681844817"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">OpenBracket
</span><a href="#local-6989586621681844827"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681844830"><span class="hs-identifier hs-var">uC</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenBracket]
</span><a href="#local-6989586621681844828"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Range
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Range
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- Only symbols can be closing delimiters.</span><span>
</span><span id="line-562"></span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#closeBracket"><span class="hs-identifier hs-var">closeBracket</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Range
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-563"></span></pre></body></html>