<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- {-# OPTIONS -fwarn-unused-binds #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-| The translation of abstract syntax to concrete syntax has two purposes.
    First it allows us to pretty print abstract syntax values without having to
    write a dedicated pretty printer, and second it serves as a sanity check
    for the concrete to abstract translation: translating from concrete to
    abstract and then back again should be (more or less) the identity.
-}</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html"><span class="hs-identifier">Agda.Syntax.Translation.AbstractToConcrete</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier">ToConcrete</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier">toConcreteCtx</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier">MonadAbsToCon</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcrete_"><span class="hs-identifier">abstractToConcrete_</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteCtx"><span class="hs-identifier">abstractToConcreteCtx</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteHiding"><span class="hs-identifier">abstractToConcreteHiding</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteQName"><span class="hs-identifier">abstractToConcreteQName</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteScope"><span class="hs-identifier">abstractToConcreteScope</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteTelescope"><span class="hs-identifier">abstractToConcreteTelescope</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteUnqualify"><span class="hs-identifier">abstractToConcreteUnqualify</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier">RangeAndPragma</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#noTakenNames"><span class="hs-identifier">noTakenNames</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runStateT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">sconcat</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html"><span class="hs-identifier">Agda.Syntax.Info</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html"><span class="hs-identifier">Agda.Syntax.Fixity</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html"><span class="hs-identifier">Agda.Syntax.Concrete</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html"><span class="hs-identifier">Agda.Syntax.Concrete.Pattern</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Glyph.html"><span class="hs-identifier">Agda.Syntax.Concrete.Glyph</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html"><span class="hs-identifier">Agda.Syntax.Abstract.Views</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Pattern.html"><span class="hs-identifier">Agda.Syntax.Abstract.Pattern</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.PatternSynonyms.html"><span class="hs-identifier">Agda.Syntax.Abstract.PatternSynonyms</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html"><span class="hs-identifier">Agda.Syntax.Scope.Base</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Monad.html"><span class="hs-identifier">Agda.Syntax.Scope.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Monad.html#tryResolveName"><span class="hs-identifier">tryResolveName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html"><span class="hs-identifier">Agda.TypeChecking.Monad.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier">getScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getAllPatternSyns"><span class="hs-identifier">getAllPatternSyns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Base</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Context</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Debug</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Builtin.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Builtin</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html"><span class="hs-identifier">Agda.TypeChecking.Monad.MetaVars</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Pure</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Trace.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Trace</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Signature</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html"><span class="hs-identifier">Agda.TypeChecking.Records</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Records.html#isRecord"><span class="hs-identifier">isRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier">prettyTCM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.AssocList.html"><span class="hs-identifier">Agda.Utils.AssocList</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AssocList</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Either.html"><span class="hs-identifier">Agda.Utils.Either</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier">List1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List2.html"><span class="hs-identifier">Agda.Utils.List2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List2.html#List2"><span class="hs-identifier">List2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Utils.List2.html#List2"><span class="hs-identifier">List2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html"><span class="hs-identifier">Agda.Syntax.Common.Aspect</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Asp</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Set1.html"><span class="hs-identifier">Agda.Utils.Set1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Set1.html#Set1"><span class="hs-identifier">Set1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Set1.html"><span class="hs-identifier">Agda.Utils.Set1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set1</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html"><span class="hs-identifier">Agda.Utils.Suffix</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">-- * The Interface</span></span><span>
</span><span id="line-95"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | Preconditions to run the AbstractToConcrete translation.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span id="MonadAbsToCon"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-var">MonadAbsToCon</span></a></span></span><span> </span><span id="local-6989586621682003535"><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.FileId.html#MonadFileId"><span class="hs-identifier hs-type">MonadFileId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#MonadInteractionPoints"><span class="hs-identifier hs-type">MonadInteractionPoints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadStConcreteNames"><span class="hs-identifier hs-type">MonadStConcreteNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-type">HasOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#Null"><span class="hs-identifier hs-type">Null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682003535"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621682002279"><span id="local-6989586621682002281"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteScope"><span class="hs-identifier hs-type">abstractToConcreteScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002281"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002281"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-113"></span><span id="abstractToConcreteScope"><span class="annot"><span class="annottext">abstractToConcreteScope :: forall a (m :: * -&gt; *).
(ToConcrete a, MonadAbsToCon m) =&gt;
ScopeInfo -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteScope"><span class="hs-identifier hs-var hs-var">abstractToConcreteScope</span></a></span></span><span> </span><span id="local-6989586621682003581"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682003581"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621682003582"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682003582"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT Env m (ConOfAbs a) -&gt; Env -&gt; m (ConOfAbs a)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; ReaderT Env m (ConOfAbs a)
forall (m :: * -&gt; *) a. AbsToConT m a -&gt; ReaderT Env m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unAbsToCon"><span class="hs-identifier hs-var">unAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; ReaderT Env m (ConOfAbs a))
-&gt; AbsToConT m (ConOfAbs a) -&gt; ReaderT Env m (ConOfAbs a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; AbsToConT m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682003582"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; m (ConOfAbs a)) -&gt; m Env -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; m Env
forall (m :: * -&gt; *). MonadAbsToCon m =&gt; ScopeInfo -&gt; m Env
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeEnv"><span class="hs-identifier hs-var">makeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682003581"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621682002341"><span id="local-6989586621682002342"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteCtx"><span class="hs-identifier hs-type">abstractToConcreteCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002342"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#Precedence"><span class="hs-identifier hs-type">Precedence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002342"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-117"></span><span id="abstractToConcreteCtx"><span class="annot"><span class="annottext">abstractToConcreteCtx :: forall a (m :: * -&gt; *).
(ToConcrete a, MonadAbsToCon m) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteCtx"><span class="hs-identifier hs-var hs-var">abstractToConcreteCtx</span></a></span></span><span> </span><span id="local-6989586621682003617"><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682003617"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621682003618"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682003618"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a))
-&gt; AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; AbsToConT m (ConOfAbs a) -&gt; AbsToConT m (ConOfAbs a)
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Precedence -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-var">withPrecedence</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682003617"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; AbsToConT m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682003618"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621682002350"><span id="local-6989586621682002351"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcrete_"><span class="hs-identifier hs-type">abstractToConcrete_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002351"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002350"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002351"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-121"></span><span id="abstractToConcrete_"><span class="annot"><span class="annottext">abstractToConcrete_ :: forall a (m :: * -&gt; *).
(ToConcrete a, MonadAbsToCon m) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcrete_"><span class="hs-identifier hs-var hs-var">abstractToConcrete_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a))
-&gt; (a -&gt; AbsToConT m (ConOfAbs a)) -&gt; a -&gt; m (ConOfAbs a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; AbsToConT m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621682002357"><span id="local-6989586621682002358"><span id="local-6989586621682002359"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteHiding"><span class="hs-identifier hs-type">abstractToConcreteHiding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensHiding"><span class="hs-identifier hs-type">LensHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002357"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002358"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002359"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002357"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002358"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002359"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002358"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-125"></span><span id="abstractToConcreteHiding"><span class="annot"><span class="annottext">abstractToConcreteHiding :: forall i a (m :: * -&gt; *).
(LensHiding i, ToConcrete a, MonadAbsToCon m) =&gt;
i -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteHiding"><span class="hs-identifier hs-var hs-var">abstractToConcreteHiding</span></a></span></span><span> </span><span id="local-6989586621682003682"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621682003682"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a))
-&gt; (a -&gt; AbsToConT m (ConOfAbs a)) -&gt; a -&gt; m (ConOfAbs a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; a -&gt; AbsToConT m (ConOfAbs a)
forall (m :: * -&gt; *) h a.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteHiding"><span class="hs-identifier hs-var">toConcreteHiding</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621682003682"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621682002366"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteTelescope"><span class="hs-identifier hs-type">abstractToConcreteTelescope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002366"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Telescope"><span class="hs-identifier hs-type">A.Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002366"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypedBinding"><span class="hs-identifier hs-type">C.TypedBinding</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-129"></span><span id="abstractToConcreteTelescope"><span class="annot"><span class="annottext">abstractToConcreteTelescope :: forall (m :: * -&gt; *).
MonadAbsToCon m =&gt;
Telescope -&gt; m [Maybe TypedBinding]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteTelescope"><span class="hs-identifier hs-var hs-var">abstractToConcreteTelescope</span></a></span></span><span> </span><span id="local-6989586621682003717"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682003717"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m [Maybe TypedBinding] -&gt; m [Maybe TypedBinding]
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m [Maybe TypedBinding] -&gt; m [Maybe TypedBinding])
-&gt; AbsToConT m [Maybe TypedBinding] -&gt; m [Maybe TypedBinding]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope
-&gt; (ConOfAbs Telescope -&gt; AbsToConT m [Maybe TypedBinding])
-&gt; AbsToConT m [Maybe TypedBinding]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Telescope -&gt; (ConOfAbs Telescope -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682003717"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe TypedBinding] -&gt; AbsToConT m [Maybe TypedBinding]
ConOfAbs Telescope -&gt; AbsToConT m [Maybe TypedBinding]
forall a. a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621682002377"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteQName"><span class="hs-identifier hs-type">abstractToConcreteQName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002377"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#AllowAmbiguousNames"><span class="hs-identifier hs-type">AllowAmbiguousNames</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002377"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-133"></span><span id="abstractToConcreteQName"><span class="annot"><span class="annottext">abstractToConcreteQName :: forall (m :: * -&gt; *).
MonadAbsToCon m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteQName"><span class="hs-identifier hs-var hs-var">abstractToConcreteQName</span></a></span></span><span> </span><span id="local-6989586621682003746"><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682003746"><span class="hs-identifier hs-var">amb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m QName -&gt; m QName
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m QName -&gt; m QName)
-&gt; (QName -&gt; AbsToConT m QName) -&gt; QName -&gt; m QName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; AbsToConT m QName
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682003746"><span class="hs-identifier hs-var">amb</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621682003748"><span id="local-6989586621682003749"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteUnqualify"><span class="hs-identifier hs-type">abstractToConcreteUnqualify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003748"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003749"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003748"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003749"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003748"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-137"></span><span id="abstractToConcreteUnqualify"><span class="annot"><span class="annottext">abstractToConcreteUnqualify :: forall a (m :: * -&gt; *).
(ToConcrete a, MonadAbsToCon m) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcreteUnqualify"><span class="hs-identifier hs-var hs-var">abstractToConcreteUnqualify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var">runAbsToCon</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; m (ConOfAbs a))
-&gt; (a -&gt; AbsToConT m (ConOfAbs a)) -&gt; a -&gt; m (ConOfAbs a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AbsToConT m (ConOfAbs a) -&gt; AbsToConT m (ConOfAbs a)
forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#doUnqualifyOutOfScopeNames"><span class="hs-identifier hs-var">doUnqualifyOutOfScopeNames</span></a></span><span> </span><span class="annot"><span class="annottext">(AbsToConT m (ConOfAbs a) -&gt; AbsToConT m (ConOfAbs a))
-&gt; (a -&gt; AbsToConT m (ConOfAbs a)) -&gt; a -&gt; AbsToConT m (ConOfAbs a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; AbsToConT m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">-- * The Monad for the implementation</span></span><span>
</span><span id="line-141"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">type</span><span> </span><span id="MonadToConcrete"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-var">MonadToConcrete</span></a></span></span><span> </span><span id="local-6989586621682003781"><span class="annot"><a href="#local-6989586621682003781"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.FileId.html#MonadFileId"><span class="hs-identifier hs-type">MonadFileId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003781"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003781"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003781"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">newtype</span><span> </span><span id="AbsToConT"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-var">AbsToConT</span></a></span></span><span> </span><span id="local-6989586621682002329"><span class="annot"><a href="#local-6989586621682002329"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682002330"><span class="annot"><a href="#local-6989586621682002330"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AbsToCon"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToCon"><span class="hs-identifier hs-var">AbsToCon</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unAbsToCon"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. AbsToConT m a -&gt; ReaderT Env m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unAbsToCon"><span class="hs-identifier hs-var hs-var">unAbsToCon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002329"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002330"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682003785"><span id="local-6989586621682003790"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b)
-&gt; (forall a b. a -&gt; AbsToConT m b -&gt; AbsToConT m a)
-&gt; Functor (AbsToConT m)
forall a b. a -&gt; AbsToConT m b -&gt; AbsToConT m a
forall a b. (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; AbsToConT m b -&gt; AbsToConT m a
forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
fmap :: forall a b. (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
$c&lt;$ :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; AbsToConT m b -&gt; AbsToConT m a
&lt;$ :: forall a b. a -&gt; AbsToConT m b -&gt; AbsToConT m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003801"><span id="local-6989586621682003806"><span id="local-6989586621682003810"><span id="local-6989586621682003814"><span id="local-6989586621682003818"><span class="annot"><span class="annottext">Functor (AbsToConT m)
Functor (AbsToConT m) =&gt;
(forall a. a -&gt; AbsToConT m a)
-&gt; (forall a b.
    AbsToConT m (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m c)
-&gt; (forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b)
-&gt; (forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m a)
-&gt; Applicative (AbsToConT m)
forall a. a -&gt; AbsToConT m a
forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m a
forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
forall a b. AbsToConT m (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (m :: * -&gt; *). Applicative m =&gt; Functor (AbsToConT m)
forall (m :: * -&gt; *) a. Applicative m =&gt; a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m a
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; c) -&gt; AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m c
$cpure :: forall (m :: * -&gt; *) a. Applicative m =&gt; a -&gt; AbsToConT m a
pure :: forall a. a -&gt; AbsToConT m a
$c&lt;*&gt; :: forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
&lt;*&gt; :: forall a b. AbsToConT m (a -&gt; b) -&gt; AbsToConT m a -&gt; AbsToConT m b
$cliftA2 :: forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; c) -&gt; AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m c
$c*&gt; :: forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
*&gt; :: forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
$c&lt;* :: forall (m :: * -&gt; *) a b.
Applicative m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m a
&lt;* :: forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003831"><span id="local-6989586621682003836"><span id="local-6989586621682003840"><span class="annot"><span class="annottext">Applicative (AbsToConT m)
Applicative (AbsToConT m) =&gt;
(forall a b.
 AbsToConT m a -&gt; (a -&gt; AbsToConT m b) -&gt; AbsToConT m b)
-&gt; (forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b)
-&gt; (forall a. a -&gt; AbsToConT m a)
-&gt; Monad (AbsToConT m)
forall a. a -&gt; AbsToConT m a
forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
forall a b. AbsToConT m a -&gt; (a -&gt; AbsToConT m b) -&gt; AbsToConT m b
forall (m :: * -&gt; *). Monad m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
AbsToConT m a -&gt; (a -&gt; AbsToConT m b) -&gt; AbsToConT m b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
AbsToConT m a -&gt; (a -&gt; AbsToConT m b) -&gt; AbsToConT m b
&gt;&gt;= :: forall a b. AbsToConT m a -&gt; (a -&gt; AbsToConT m b) -&gt; AbsToConT m b
$c&gt;&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
&gt;&gt; :: forall a b. AbsToConT m a -&gt; AbsToConT m b -&gt; AbsToConT m b
$creturn :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; AbsToConT m a
return :: forall a. a -&gt; AbsToConT m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003849"><span id="local-6989586621682003854"><span id="local-6989586621682003858"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003876"><span class="annot"><span class="annottext">Monad (AbsToConT m)
Functor (AbsToConT m)
Applicative (AbsToConT m)
(Functor (AbsToConT m), Applicative (AbsToConT m),
 Monad (AbsToConT m)) =&gt;
(SomeBuiltin -&gt; AbsToConT m (Maybe (Builtin PrimFun)))
-&gt; HasBuiltins (AbsToConT m)
SomeBuiltin -&gt; AbsToConT m (Maybe (Builtin PrimFun))
forall (m :: * -&gt; *).
(Functor m, Applicative m, Monad m) =&gt;
(SomeBuiltin -&gt; m (Maybe (Builtin PrimFun))) -&gt; HasBuiltins m
forall (m :: * -&gt; *). HasBuiltins m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *). HasBuiltins m =&gt; Functor (AbsToConT m)
forall (m :: * -&gt; *). HasBuiltins m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *).
HasBuiltins m =&gt;
SomeBuiltin -&gt; AbsToConT m (Maybe (Builtin PrimFun))
$cgetBuiltinThing :: forall (m :: * -&gt; *).
HasBuiltins m =&gt;
SomeBuiltin -&gt; AbsToConT m (Maybe (Builtin PrimFun))
getBuiltinThing :: SomeBuiltin -&gt; AbsToConT m (Maybe (Builtin PrimFun))
</span><a href="Agda.TypeChecking.Monad.Builtin.html#HasBuiltins"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasBuiltins</span></a></span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003905"><span id="local-6989586621682003913"><span id="local-6989586621682003920"><span class="annot"><span class="annottext">Functor (AbsToConT m)
Applicative (AbsToConT m)
HasOptions (AbsToConT m)
MonadTCEnv (AbsToConT m)
MonadDebug (AbsToConT m)
(Functor (AbsToConT m), Applicative (AbsToConT m),
 HasOptions (AbsToConT m), MonadDebug (AbsToConT m),
 MonadTCEnv (AbsToConT m)) =&gt;
(HasCallStack =&gt; QName -&gt; AbsToConT m Definition)
-&gt; (HasCallStack =&gt;
    QName -&gt; AbsToConT m (Either SigError Definition))
-&gt; (QName -&gt; AbsToConT m RewriteRules)
-&gt; HasConstInfo (AbsToConT m)
HasCallStack =&gt; QName -&gt; AbsToConT m (Either SigError Definition)
HasCallStack =&gt; QName -&gt; AbsToConT m Definition
QName -&gt; AbsToConT m RewriteRules
forall (m :: * -&gt; *).
(Functor m, Applicative m, HasOptions m, MonadDebug m,
 MonadTCEnv m) =&gt;
(HasCallStack =&gt; QName -&gt; m Definition)
-&gt; (HasCallStack =&gt; QName -&gt; m (Either SigError Definition))
-&gt; (QName -&gt; m RewriteRules)
-&gt; HasConstInfo m
forall (m :: * -&gt; *). HasConstInfo m =&gt; Functor (AbsToConT m)
forall (m :: * -&gt; *). HasConstInfo m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *). HasConstInfo m =&gt; HasOptions (AbsToConT m)
forall (m :: * -&gt; *). HasConstInfo m =&gt; MonadTCEnv (AbsToConT m)
forall (m :: * -&gt; *). HasConstInfo m =&gt; MonadDebug (AbsToConT m)
forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; AbsToConT m (Either SigError Definition)
forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; AbsToConT m Definition
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; AbsToConT m RewriteRules
$cgetConstInfo :: forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; AbsToConT m Definition
getConstInfo :: HasCallStack =&gt; QName -&gt; AbsToConT m Definition
$cgetConstInfo' :: forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; AbsToConT m (Either SigError Definition)
getConstInfo' :: HasCallStack =&gt; QName -&gt; AbsToConT m (Either SigError Definition)
$cgetRewriteRulesFor :: forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; AbsToConT m RewriteRules
getRewriteRulesFor :: QName -&gt; AbsToConT m RewriteRules
</span><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasConstInfo</span></a></span></span></span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003944"><span id="local-6989586621682003949"><span class="annot"><span class="annottext">Monad (AbsToConT m)
Functor (AbsToConT m)
Applicative (AbsToConT m)
AbsToConT m PragmaOptions
AbsToConT m CommandLineOptions
(Functor (AbsToConT m), Applicative (AbsToConT m),
 Monad (AbsToConT m)) =&gt;
AbsToConT m PragmaOptions
-&gt; AbsToConT m CommandLineOptions -&gt; HasOptions (AbsToConT m)
forall (m :: * -&gt; *).
(Functor m, Applicative m, Monad m) =&gt;
m PragmaOptions -&gt; m CommandLineOptions -&gt; HasOptions m
forall (m :: * -&gt; *). HasOptions m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *). HasOptions m =&gt; Functor (AbsToConT m)
forall (m :: * -&gt; *). HasOptions m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *). HasOptions m =&gt; AbsToConT m PragmaOptions
forall (m :: * -&gt; *).
HasOptions m =&gt;
AbsToConT m CommandLineOptions
$cpragmaOptions :: forall (m :: * -&gt; *). HasOptions m =&gt; AbsToConT m PragmaOptions
pragmaOptions :: AbsToConT m PragmaOptions
$ccommandLineOptions :: forall (m :: * -&gt; *).
HasOptions m =&gt;
AbsToConT m CommandLineOptions
commandLineOptions :: AbsToConT m CommandLineOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasOptions</span></a></span></span></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003963"><span id="local-6989586621682003968"><span id="local-6989586621682003972"><span id="local-6989586621682003976"><span class="annot"><span class="annottext">MonadTCEnv (AbsToConT m)
MonadTCEnv (AbsToConT m) =&gt;
(forall a. Name -&gt; Dom Type -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; (forall a.
    IsAxiom
    -&gt; Origin
    -&gt; Name
    -&gt; Term
    -&gt; Dom Type
    -&gt; AbsToConT m a
    -&gt; AbsToConT m a)
-&gt; (forall a.
    Substitution
    -&gt; (Context -&gt; Context) -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; (forall a.
    Range -&gt; ArgName -&gt; (Name -&gt; AbsToConT m a) -&gt; AbsToConT m a)
-&gt; MonadAddContext (AbsToConT m)
forall a.
Range -&gt; ArgName -&gt; (Name -&gt; AbsToConT m a) -&gt; AbsToConT m a
forall a. Name -&gt; Dom Type -&gt; AbsToConT m a -&gt; AbsToConT m a
forall a.
Substitution
-&gt; (Context -&gt; Context) -&gt; AbsToConT m a -&gt; AbsToConT m a
forall a.
IsAxiom
-&gt; Origin
-&gt; Name
-&gt; Term
-&gt; Dom Type
-&gt; AbsToConT m a
-&gt; AbsToConT m a
forall (m :: * -&gt; *).
MonadTCEnv m =&gt;
(forall a. Name -&gt; Dom Type -&gt; m a -&gt; m a)
-&gt; (forall a.
    IsAxiom -&gt; Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; m a -&gt; m a)
-&gt; (forall a. Substitution -&gt; (Context -&gt; Context) -&gt; m a -&gt; m a)
-&gt; (forall a. Range -&gt; ArgName -&gt; (Name -&gt; m a) -&gt; m a)
-&gt; MonadAddContext m
forall (m :: * -&gt; *). MonadAddContext m =&gt; MonadTCEnv (AbsToConT m)
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Range -&gt; ArgName -&gt; (Name -&gt; AbsToConT m a) -&gt; AbsToConT m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Name -&gt; Dom Type -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Substitution
-&gt; (Context -&gt; Context) -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
IsAxiom
-&gt; Origin
-&gt; Name
-&gt; Term
-&gt; Dom Type
-&gt; AbsToConT m a
-&gt; AbsToConT m a
$caddCtx :: forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Name -&gt; Dom Type -&gt; AbsToConT m a -&gt; AbsToConT m a
addCtx :: forall a. Name -&gt; Dom Type -&gt; AbsToConT m a -&gt; AbsToConT m a
$caddLetBinding' :: forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
IsAxiom
-&gt; Origin
-&gt; Name
-&gt; Term
-&gt; Dom Type
-&gt; AbsToConT m a
-&gt; AbsToConT m a
addLetBinding' :: forall a.
IsAxiom
-&gt; Origin
-&gt; Name
-&gt; Term
-&gt; Dom Type
-&gt; AbsToConT m a
-&gt; AbsToConT m a
$cupdateContext :: forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Substitution
-&gt; (Context -&gt; Context) -&gt; AbsToConT m a -&gt; AbsToConT m a
updateContext :: forall a.
Substitution
-&gt; (Context -&gt; Context) -&gt; AbsToConT m a -&gt; AbsToConT m a
$cwithFreshName :: forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Range -&gt; ArgName -&gt; (Name -&gt; AbsToConT m a) -&gt; AbsToConT m a
withFreshName :: forall a.
Range -&gt; ArgName -&gt; (Name -&gt; AbsToConT m a) -&gt; AbsToConT m a
</span><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadAddContext</span></a></span></span></span></span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682003997"><span id="local-6989586621682004002"><span id="local-6989586621682004006"><span id="local-6989586621682004010"><span id="local-6989586621682004014"><span id="local-6989586621682004018"><span id="local-6989586621682004022"><span class="annot"><span class="annottext">Monad (AbsToConT m)
Functor (AbsToConT m)
Applicative (AbsToConT m)
AbsToConT m Bool
AbsToConT m Verbosity
AbsToConT m ProfileOptions
(Functor (AbsToConT m), Applicative (AbsToConT m),
 Monad (AbsToConT m)) =&gt;
(ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; AbsToConT m Doc)
-&gt; (forall a.
    ArgName -&gt; VerboseLevel -&gt; Doc -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; (forall a.
    ArgName
    -&gt; VerboseLevel -&gt; ArgName -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; AbsToConT m Verbosity
-&gt; AbsToConT m ProfileOptions
-&gt; AbsToConT m Bool
-&gt; (forall a. AbsToConT m a -&gt; AbsToConT m a)
-&gt; MonadDebug (AbsToConT m)
ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; AbsToConT m Doc
forall a.
ArgName
-&gt; VerboseLevel -&gt; ArgName -&gt; AbsToConT m a -&gt; AbsToConT m a
forall a.
ArgName -&gt; VerboseLevel -&gt; Doc -&gt; AbsToConT m a -&gt; AbsToConT m a
forall a. AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *).
(Functor m, Applicative m, Monad m) =&gt;
(ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; m Doc)
-&gt; (forall a. ArgName -&gt; VerboseLevel -&gt; Doc -&gt; m a -&gt; m a)
-&gt; (forall a. ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m a -&gt; m a)
-&gt; m Verbosity
-&gt; m ProfileOptions
-&gt; m Bool
-&gt; (forall a. m a -&gt; m a)
-&gt; MonadDebug m
forall (m :: * -&gt; *). MonadDebug m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *). MonadDebug m =&gt; Functor (AbsToConT m)
forall (m :: * -&gt; *). MonadDebug m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m Bool
forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m Verbosity
forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m ProfileOptions
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; AbsToConT m Doc
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
ArgName
-&gt; VerboseLevel -&gt; ArgName -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; Doc -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
AbsToConT m a -&gt; AbsToConT m a
$cformatDebugMessage :: forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; AbsToConT m Doc
formatDebugMessage :: ArgName -&gt; VerboseLevel -&gt; TCM Doc -&gt; AbsToConT m Doc
$ctraceDebugMessage :: forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; Doc -&gt; AbsToConT m a -&gt; AbsToConT m a
traceDebugMessage :: forall a.
ArgName -&gt; VerboseLevel -&gt; Doc -&gt; AbsToConT m a -&gt; AbsToConT m a
$cverboseBracket :: forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
ArgName
-&gt; VerboseLevel -&gt; ArgName -&gt; AbsToConT m a -&gt; AbsToConT m a
verboseBracket :: forall a.
ArgName
-&gt; VerboseLevel -&gt; ArgName -&gt; AbsToConT m a -&gt; AbsToConT m a
$cgetVerbosity :: forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m Verbosity
getVerbosity :: AbsToConT m Verbosity
$cgetProfileOptions :: forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m ProfileOptions
getProfileOptions :: AbsToConT m ProfileOptions
$cisDebugPrinting :: forall (m :: * -&gt; *). MonadDebug m =&gt; AbsToConT m Bool
isDebugPrinting :: AbsToConT m Bool
$cnowDebugPrinting :: forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
AbsToConT m a -&gt; AbsToConT m a
nowDebugPrinting :: forall a. AbsToConT m a -&gt; AbsToConT m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadDebug</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004041"><span id="local-6989586621682004049"><span class="annot"><span class="annottext">Monad (AbsToConT m)
Monad (AbsToConT m) =&gt;
(HasCallStack =&gt; FileId -&gt; AbsToConT m File)
-&gt; (File -&gt; AbsToConT m FileId) -&gt; MonadFileId (AbsToConT m)
HasCallStack =&gt; FileId -&gt; AbsToConT m File
File -&gt; AbsToConT m FileId
forall (m :: * -&gt; *).
Monad m =&gt;
(HasCallStack =&gt; FileId -&gt; m File)
-&gt; (File -&gt; m FileId) -&gt; MonadFileId m
forall (m :: * -&gt; *). MonadFileId m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *).
(MonadFileId m, HasCallStack) =&gt;
FileId -&gt; AbsToConT m File
forall (m :: * -&gt; *). MonadFileId m =&gt; File -&gt; AbsToConT m FileId
$cfileFromId :: forall (m :: * -&gt; *).
(MonadFileId m, HasCallStack) =&gt;
FileId -&gt; AbsToConT m File
fileFromId :: HasCallStack =&gt; FileId -&gt; AbsToConT m File
$cidFromFile :: forall (m :: * -&gt; *). MonadFileId m =&gt; File -&gt; AbsToConT m FileId
idFromFile :: File -&gt; AbsToConT m FileId
</span><a href="Agda.Utils.FileId.html#MonadFileId"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadFileId</span></a></span></span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004064"><span id="local-6989586621682004069"><span class="annot"><span class="annottext">MonadTCEnv (AbsToConT m)
ReadTCState (AbsToConT m)
AbsToConT m InteractionId
(MonadTCEnv (AbsToConT m), ReadTCState (AbsToConT m)) =&gt;
AbsToConT m InteractionId
-&gt; ((InteractionPoints -&gt; InteractionPoints) -&gt; AbsToConT m ())
-&gt; MonadInteractionPoints (AbsToConT m)
(InteractionPoints -&gt; InteractionPoints) -&gt; AbsToConT m ()
forall (m :: * -&gt; *).
(MonadTCEnv m, ReadTCState m) =&gt;
m InteractionId
-&gt; ((InteractionPoints -&gt; InteractionPoints) -&gt; m ())
-&gt; MonadInteractionPoints m
forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
MonadTCEnv (AbsToConT m)
forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
ReadTCState (AbsToConT m)
forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
AbsToConT m InteractionId
forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
(InteractionPoints -&gt; InteractionPoints) -&gt; AbsToConT m ()
$cfreshInteractionId :: forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
AbsToConT m InteractionId
freshInteractionId :: AbsToConT m InteractionId
$cmodifyInteractionPoints :: forall (m :: * -&gt; *).
MonadInteractionPoints m =&gt;
(InteractionPoints -&gt; InteractionPoints) -&gt; AbsToConT m ()
modifyInteractionPoints :: (InteractionPoints -&gt; InteractionPoints) -&gt; AbsToConT m ()
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#MonadInteractionPoints"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadInteractionPoints</span></a></span></span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004091"><span class="annot"><span class="annottext">Applicative (AbsToConT m)
HasOptions (AbsToConT m)
MonadTCEnv (AbsToConT m)
ReadTCState (AbsToConT m)
(Applicative (AbsToConT m), MonadTCEnv (AbsToConT m),
 ReadTCState (AbsToConT m), HasOptions (AbsToConT m)) =&gt;
(forall a. ReduceM a -&gt; AbsToConT m a) -&gt; MonadReduce (AbsToConT m)
forall a. ReduceM a -&gt; AbsToConT m a
forall (m :: * -&gt; *).
(Applicative m, MonadTCEnv m, ReadTCState m, HasOptions m) =&gt;
(forall a. ReduceM a -&gt; m a) -&gt; MonadReduce m
forall (m :: * -&gt; *). MonadReduce m =&gt; Applicative (AbsToConT m)
forall (m :: * -&gt; *). MonadReduce m =&gt; HasOptions (AbsToConT m)
forall (m :: * -&gt; *). MonadReduce m =&gt; MonadTCEnv (AbsToConT m)
forall (m :: * -&gt; *). MonadReduce m =&gt; ReadTCState (AbsToConT m)
forall (m :: * -&gt; *) a. MonadReduce m =&gt; ReduceM a -&gt; AbsToConT m a
$cliftReduce :: forall (m :: * -&gt; *) a. MonadReduce m =&gt; ReduceM a -&gt; AbsToConT m a
liftReduce :: forall a. ReduceM a -&gt; AbsToConT m a
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadReduce</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004107"><span id="local-6989586621682004112"><span id="local-6989586621682004116"><span class="annot"><span class="annottext">Monad (AbsToConT m)
AbsToConT m ConcreteNames
Monad (AbsToConT m) =&gt;
(forall a. StateT ConcreteNames (AbsToConT m) a -&gt; AbsToConT m a)
-&gt; AbsToConT m ConcreteNames
-&gt; ((ConcreteNames -&gt; ConcreteNames) -&gt; AbsToConT m ())
-&gt; MonadStConcreteNames (AbsToConT m)
(ConcreteNames -&gt; ConcreteNames) -&gt; AbsToConT m ()
forall a. StateT ConcreteNames (AbsToConT m) a -&gt; AbsToConT m a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. StateT ConcreteNames m a -&gt; m a)
-&gt; m ConcreteNames
-&gt; ((ConcreteNames -&gt; ConcreteNames) -&gt; m ())
-&gt; MonadStConcreteNames m
forall (m :: * -&gt; *). MonadStConcreteNames m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
AbsToConT m ConcreteNames
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
(ConcreteNames -&gt; ConcreteNames) -&gt; AbsToConT m ()
forall (m :: * -&gt; *) a.
MonadStConcreteNames m =&gt;
StateT ConcreteNames (AbsToConT m) a -&gt; AbsToConT m a
$crunStConcreteNames :: forall (m :: * -&gt; *) a.
MonadStConcreteNames m =&gt;
StateT ConcreteNames (AbsToConT m) a -&gt; AbsToConT m a
runStConcreteNames :: forall a. StateT ConcreteNames (AbsToConT m) a -&gt; AbsToConT m a
$cuseConcreteNames :: forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
AbsToConT m ConcreteNames
useConcreteNames :: AbsToConT m ConcreteNames
$cmodifyConcreteNames :: forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
(ConcreteNames -&gt; ConcreteNames) -&gt; AbsToConT m ()
modifyConcreteNames :: (ConcreteNames -&gt; ConcreteNames) -&gt; AbsToConT m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadStConcreteNames"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadStConcreteNames</span></a></span></span></span></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004129"><span id="local-6989586621682004134"><span class="annot"><span class="annottext">Monad (AbsToConT m)
AbsToConT m TCEnv
Monad (AbsToConT m) =&gt;
AbsToConT m TCEnv
-&gt; (forall a. (TCEnv -&gt; TCEnv) -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; MonadTCEnv (AbsToConT m)
forall a. (TCEnv -&gt; TCEnv) -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *).
Monad m =&gt;
m TCEnv
-&gt; (forall a. (TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a) -&gt; MonadTCEnv m
forall (m :: * -&gt; *). MonadTCEnv m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *). MonadTCEnv m =&gt; AbsToConT m TCEnv
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; AbsToConT m a -&gt; AbsToConT m a
$caskTC :: forall (m :: * -&gt; *). MonadTCEnv m =&gt; AbsToConT m TCEnv
askTC :: AbsToConT m TCEnv
$clocalTC :: forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; AbsToConT m a -&gt; AbsToConT m a
localTC :: forall a. (TCEnv -&gt; TCEnv) -&gt; AbsToConT m a -&gt; AbsToConT m a
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTCEnv</span></a></span></span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MonadFileId (AbsToConT m)
MonadTCEnv (AbsToConT m)
MonadReduce (AbsToConT m)
ReadTCState (AbsToConT m)
HasBuiltins (AbsToConT m)
MonadAddContext (AbsToConT m)
MonadDebug (AbsToConT m)
HasConstInfo (AbsToConT m)
(HasBuiltins (AbsToConT m), HasConstInfo (AbsToConT m),
 MonadAddContext (AbsToConT m), MonadDebug (AbsToConT m),
 MonadFileId (AbsToConT m), MonadReduce (AbsToConT m),
 MonadTCEnv (AbsToConT m), ReadTCState (AbsToConT m)) =&gt;
PureTCM (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
MonadFileId (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
MonadTCEnv (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
MonadReduce (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
ReadTCState (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
HasBuiltins (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
MonadAddContext (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
MonadDebug (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadFileId m,
 MonadReduce m) =&gt;
HasConstInfo (AbsToConT m)
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadDebug m,
 MonadFileId m, MonadReduce m, MonadTCEnv m, ReadTCState m) =&gt;
PureTCM m
</span><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PureTCM</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004171"><span id="local-6989586621682004176"><span id="local-6989586621682004180"><span id="local-6989586621682004184"><span class="annot"><span class="annottext">Monad (AbsToConT m)
AbsToConT m SessionState
AbsToConT m TCState
Monad (AbsToConT m) =&gt;
AbsToConT m TCState
-&gt; (forall a b.
    Lens' TCState a -&gt; (a -&gt; a) -&gt; AbsToConT m b -&gt; AbsToConT m b)
-&gt; AbsToConT m SessionState
-&gt; (forall a.
    (TCState -&gt; TCState) -&gt; AbsToConT m a -&gt; AbsToConT m a)
-&gt; ReadTCState (AbsToConT m)
forall a. (TCState -&gt; TCState) -&gt; AbsToConT m a -&gt; AbsToConT m a
forall a b.
Lens' TCState a -&gt; (a -&gt; a) -&gt; AbsToConT m b -&gt; AbsToConT m b
forall (m :: * -&gt; *).
Monad m =&gt;
m TCState
-&gt; (forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b)
-&gt; m SessionState
-&gt; (forall a. (TCState -&gt; TCState) -&gt; m a -&gt; m a)
-&gt; ReadTCState m
forall (m :: * -&gt; *). ReadTCState m =&gt; Monad (AbsToConT m)
forall (m :: * -&gt; *). ReadTCState m =&gt; AbsToConT m SessionState
forall (m :: * -&gt; *). ReadTCState m =&gt; AbsToConT m TCState
forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
(TCState -&gt; TCState) -&gt; AbsToConT m a -&gt; AbsToConT m a
forall (m :: * -&gt; *) a b.
ReadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; AbsToConT m b -&gt; AbsToConT m b
$cgetTCState :: forall (m :: * -&gt; *). ReadTCState m =&gt; AbsToConT m TCState
getTCState :: AbsToConT m TCState
$clocallyTCState :: forall (m :: * -&gt; *) a b.
ReadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; AbsToConT m b -&gt; AbsToConT m b
locallyTCState :: forall a b.
Lens' TCState a -&gt; (a -&gt; a) -&gt; AbsToConT m b -&gt; AbsToConT m b
$cgetSessionState :: forall (m :: * -&gt; *). ReadTCState m =&gt; AbsToConT m SessionState
getSessionState :: AbsToConT m SessionState
$cwithTCState :: forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
(TCState -&gt; TCState) -&gt; AbsToConT m a -&gt; AbsToConT m a
withTCState :: forall a. (TCState -&gt; TCState) -&gt; AbsToConT m a -&gt; AbsToConT m a
</span><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ReadTCState</span></a></span></span></span></span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621682002324"><span id="local-6989586621682004198"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-type">AbsToConT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002324"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-167"></span><span id="local-6989586621682002323"><span id="local-6989586621682004208"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682002323"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-type">AbsToConT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-168"></span><span id="local-6989586621682002322"><span id="local-6989586621682004216"><span id="local-6989586621682004221"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682002322"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#Null"><span class="hs-identifier hs-type">Null</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002322"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#Null"><span class="hs-identifier hs-type">Null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-type">AbsToConT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002322"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-169"></span><span id="local-6989586621682002321"><span id="local-6989586621682004229"><span id="local-6989586621682004236"><span id="local-6989586621682004241"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682002321"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-type">AbsToConT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002321"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621682002346"><span id="local-6989586621682002347"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-type">runAbsToCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002346"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#AbsToConT"><span class="hs-identifier hs-type">AbsToConT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002346"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002347"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002346"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002347"><span class="hs-identifier hs-type">c</span></a></span></span></span><span>
</span><span id="line-172"></span><span id="runAbsToCon"><span class="annot"><span class="annottext">runAbsToCon :: forall (m :: * -&gt; *) c. MonadAbsToCon m =&gt; AbsToConT m c -&gt; m c
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#runAbsToCon"><span class="hs-identifier hs-var hs-var">runAbsToCon</span></a></span></span><span> </span><span id="local-6989586621682004279"><span class="annot"><span class="annottext">AbsToConT m c
</span><a href="#local-6989586621682004279"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621682004280"><span class="annot"><a href="#local-6989586621682004280"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m ScopeInfo
forall (m :: * -&gt; *). ReadTCState m =&gt; m ScopeInfo
</span><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-var">getScope</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#verboseBracket"><span class="hs-identifier hs-type">verboseBracket</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-string">&quot;runAbsToCon&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-type">hsep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;entering AbsToCon with scope:&quot;</span></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-type">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">text</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682004280"><span class="hs-identifier hs-type">scope</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-type">^.</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#scopeLocals"><span class="hs-identifier hs-type">scopeLocals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621682004292"><span class="annot"><a href="#local-6989586621682004292"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unAbsToCon"><span class="hs-identifier hs-var">unAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004279"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeEnv"><span class="hs-identifier hs-type">makeEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004280"><span class="hs-identifier hs-type">scope</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;leaving AbsToCon&quot;</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682004292"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-184"></span><span class="annot"><span class="hs-comment">-- * The Environment</span></span><span>
</span><span id="line-185"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">data</span><span> </span><span id="Env"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Env"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="takenVarNames"><span class="annot"><span class="annottext">Env -&gt; Set Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var hs-var">takenVarNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-comment">-- ^ Abstract names currently in scope.</span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-comment">--   Unlike the 'ScopeInfo', this includes names for hidden arguments</span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-comment">--   inserted by the system.</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="takenDefNames"><span class="annot"><span class="annottext">Env -&gt; Set NameParts
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenDefNames"><span class="hs-identifier hs-var hs-var">takenDefNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">C.NameParts</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Concrete names of all definitions in scope.</span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="currentScope"><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var hs-var">currentScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="builtins"><span class="annot"><span class="annottext">Env -&gt; Map BuiltinId QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#builtins"><span class="hs-identifier hs-var hs-var">builtins</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#BuiltinId"><span class="hs-identifier hs-type">BuiltinId</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Certain builtins (like `fromNat`) have special printing.</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="preserveIIds"><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveIIds"><span class="hs-identifier hs-var hs-var">preserveIIds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Preserve interaction point ids?</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="foldPatternSynonyms"><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#foldPatternSynonyms"><span class="hs-identifier hs-var hs-var">foldPatternSynonyms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unqualifyOutOfScopeNames"><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unqualifyOutOfScopeNames"><span class="hs-identifier hs-var hs-var">unqualifyOutOfScopeNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Print out-of-scope names unqualified (`a` instead of `A.B.a`).</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621682002340"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeEnv"><span class="hs-identifier hs-type">makeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadAbsToCon"><span class="hs-identifier hs-type">MonadAbsToCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002340"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002340"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span><span>
</span><span id="line-205"></span><span id="makeEnv"><span class="annot"><span class="annottext">makeEnv :: forall (m :: * -&gt; *). MonadAbsToCon m =&gt; ScopeInfo -&gt; m Env
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeEnv"><span class="hs-identifier hs-var hs-var">makeEnv</span></a></span></span><span> </span><span id="local-6989586621682004346"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682004346"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-comment">-- zero and suc doesn't have to be in scope for natural number literals to work</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682004350"><span class="annot"><span class="annottext">noScopeCheck :: BuiltinId -&gt; Bool
</span><a href="#local-6989586621682004350"><span class="hs-identifier hs-var hs-var hs-var">noScopeCheck</span></a></span></span><span> </span><span id="local-6989586621682004351"><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004351"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004351"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; [BuiltinId] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinZero"><span class="hs-identifier hs-var">builtinZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinSuc"><span class="hs-identifier hs-var">builtinSuc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>      </span><span id="local-6989586621682004355"><span class="annot"><span class="annottext">name :: Term -&gt; Maybe QName
</span><a href="#local-6989586621682004355"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">I.Def</span></a></span><span> </span><span id="local-6989586621682004357"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004357"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004357"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><a href="#local-6989586621682004355"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">I.Con</span></a></span><span> </span><span id="local-6989586621682004359"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682004359"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">I.conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621682004359"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><a href="#local-6989586621682004355"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-211"></span><span>      </span><span id="local-6989586621682004361"><span class="annot"><span class="annottext">builtin :: BuiltinId -&gt; m [(BuiltinId, QName)]
</span><a href="#local-6989586621682004361"><span class="hs-identifier hs-var hs-var hs-var">builtin</span></a></span></span><span> </span><span id="local-6989586621682004362"><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004362"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; m (Maybe Term)
forall (m :: * -&gt; *). HasBuiltins m =&gt; BuiltinId -&gt; m (Maybe Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getBuiltin%27"><span class="hs-identifier hs-var">getBuiltin'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004362"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe Term)
-&gt; (Maybe Term -&gt; m [(BuiltinId, QName)]) -&gt; m [(BuiltinId, QName)]
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004364"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682004364"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004365"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004365"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe QName
</span><a href="#local-6989586621682004355"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621682004364"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>                 </span><span class="annot"><span class="annottext">BuiltinId -&gt; Bool
</span><a href="#local-6989586621682004350"><span class="hs-identifier hs-var">noScopeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004362"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ScopeInfo -&gt; Bool
</span><a href="Agda.Syntax.Scope.Base.html#isNameInScope"><span class="hs-identifier hs-var">isNameInScope</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004365"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682004346"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(BuiltinId, QName)] -&gt; m [(BuiltinId, QName)]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682004362"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004365"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="annottext">Maybe Term
</span><span class="hs-identifier">_</span></span><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(BuiltinId, QName)] -&gt; m [(BuiltinId, QName)]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621682004368"><span class="annot"><a href="#local-6989586621682004368"><span class="hs-identifier hs-var">ctxVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m [Name]
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m [Name]
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextNames%27"><span class="hs-identifier hs-var">getContextNames'</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621682004370"><span class="annot"><a href="#local-6989586621682004370"><span class="hs-identifier hs-var">letVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.keys</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#asksTC"><span class="hs-identifier hs-type">asksTC</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#envLetBindings"><span class="hs-identifier hs-var">envLetBindings</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682004375"><span class="annot"><a href="#local-6989586621682004375"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682004368"><span class="hs-identifier hs-var">ctxVars</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682004370"><span class="hs-identifier hs-var">letVars</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- pick concrete names for in-scope names now so we don't</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- accidentally shadow them</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682004346"><span class="hs-identifier hs-type">scope</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-type">^.</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#scopeLocals"><span class="hs-identifier hs-type">scopeLocals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682004379"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004379"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004380"><span class="annot"><span class="annottext">LocalVar
</span><a href="#local-6989586621682004380"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; m ()
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
Name -&gt; Name -&gt; m ()
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-var">pickConcreteName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalVar -&gt; Name
</span><a href="Agda.Syntax.Scope.Base.html#localVar"><span class="hs-identifier hs-var">localVar</span></a></span><span> </span><span class="annot"><span class="annottext">LocalVar
</span><a href="#local-6989586621682004380"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004379"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621682004383"><span class="annot"><a href="#local-6989586621682004383"><span class="hs-identifier hs-var">builtinList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682004361"><span class="hs-identifier hs-type">builtin</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFromNat"><span class="hs-identifier hs-type">builtinFromNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFromString"><span class="hs-identifier hs-type">builtinFromString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinFromNeg"><span class="hs-identifier hs-type">builtinFromNeg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinZero"><span class="hs-identifier hs-type">builtinZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#builtinSuc"><span class="hs-identifier hs-type">builtinSuc</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621682004389"><span class="annot"><a href="#local-6989586621682004389"><span class="hs-identifier hs-var">foldPatSyns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optPrintPatternSynonyms"><span class="hs-identifier hs-type">optPrintPatternSynonyms</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.fromList</span></span><span> </span><span class="annot"><a href="#local-6989586621682004375"><span class="hs-identifier hs-type">vars</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenDefNames"><span class="hs-identifier hs-var">takenDefNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682004392"><span class="hs-identifier hs-type">defs</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682004346"><span class="hs-identifier hs-type">scope</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#builtins"><span class="hs-identifier hs-var">builtins</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.fromListWith</span></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004383"><span class="hs-identifier hs-type">builtinList</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveIIds"><span class="hs-identifier hs-var">preserveIIds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#foldPatternSynonyms"><span class="hs-identifier hs-var">foldPatternSynonyms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682004389"><span class="hs-identifier hs-type">foldPatSyns</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unqualifyOutOfScopeNames"><span class="hs-identifier hs-var">unqualifyOutOfScopeNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621682004392"><span class="annot"><span class="annottext">defs :: Set NameParts
</span><a href="#local-6989586621682004392"><span class="hs-identifier hs-var hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NameParts] -&gt; Set NameParts
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([NameParts] -&gt; Set NameParts) -&gt; [NameParts] -&gt; Set NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, List1 AbstractName) -&gt; NameParts)
-&gt; [(Name, List1 AbstractName)] -&gt; [NameParts]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="#local-6989586621682004395"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameParts)
-&gt; ((Name, List1 AbstractName) -&gt; Name)
-&gt; (Name, List1 AbstractName)
-&gt; NameParts
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, List1 AbstractName) -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Name, List1 AbstractName)] -&gt; [NameParts])
-&gt; [(Name, List1 AbstractName)] -&gt; [NameParts]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">((Name, List1 AbstractName) -&gt; Bool)
-&gt; [(Name, List1 AbstractName)] -&gt; [(Name, List1 AbstractName)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; List1 AbstractName -&gt; Bool)
-&gt; (Name, List1 AbstractName) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; List1 AbstractName -&gt; Bool
forall {t :: * -&gt; *}. Foldable t =&gt; Name -&gt; t AbstractName -&gt; Bool
</span><a href="#local-6989586621682004397"><span class="hs-identifier hs-var">usefulDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Name, List1 AbstractName)] -&gt; [(Name, List1 AbstractName)])
-&gt; [(Name, List1 AbstractName)] -&gt; [(Name, List1 AbstractName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">Map Name (List1 AbstractName) -&gt; [(Name, List1 AbstractName)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map Name (List1 AbstractName) -&gt; [(Name, List1 AbstractName)])
-&gt; Map Name (List1 AbstractName) -&gt; [(Name, List1 AbstractName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; Map Name (List1 AbstractName)
</span><a href="Agda.Syntax.Scope.Base.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">(NameSpace -&gt; Map Name (List1 AbstractName))
-&gt; NameSpace -&gt; Map Name (List1 AbstractName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; NameSpace
</span><a href="Agda.Syntax.Scope.Base.html#everythingInScope"><span class="hs-identifier hs-var">everythingInScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682004346"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- Jesper, 2018-12-10: It's fine to shadow generalizable names as</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- they will never show up directly in printed terms.</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621682004404"><span class="annot"><span class="annottext">notGeneralizeName :: AbstractName -&gt; Bool
</span><a href="#local-6989586621682004404"><span class="hs-identifier hs-var hs-var">notGeneralizeName</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AbsName"><span class="hs-identifier hs-type">AbsName</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">anameKind :: AbstractName -&gt; KindOfName
</span><a href="Agda.Syntax.Abstract.Name.html#anameKind"><span class="hs-identifier hs-var">anameKind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682004407"><span class="annot"><span class="annottext">KindOfName
</span><a href="#local-6989586621682004407"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindOfName
</span><a href="#local-6989586621682004407"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName -&gt; KindOfName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Abstract.Name.html#GeneralizeName"><span class="hs-identifier hs-var">GeneralizeName</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><a href="#local-6989586621682004407"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName -&gt; KindOfName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Abstract.Name.html#DisallowedGeneralizeName"><span class="hs-identifier hs-var">DisallowedGeneralizeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621682004397"><span class="annot"><span class="annottext">usefulDef :: Name -&gt; t AbstractName -&gt; Bool
</span><a href="#local-6989586621682004397"><span class="hs-identifier hs-var hs-var">usefulDef</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">C.NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">t AbstractName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="#local-6989586621682004397"><span class="hs-identifier hs-var">usefulDef</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621682004415"><span class="annot"><span class="annottext">t AbstractName
</span><a href="#local-6989586621682004415"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AbstractName -&gt; Bool) -&gt; t AbstractName -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; Bool
</span><a href="#local-6989586621682004404"><span class="hs-identifier hs-var">notGeneralizeName</span></a></span><span> </span><span class="annot"><span class="annottext">t AbstractName
</span><a href="#local-6989586621682004415"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621682004395"><span class="annot"><span class="annottext">nameParts :: Name -&gt; NameParts
</span><a href="#local-6989586621682004395"><span class="hs-identifier hs-var hs-var">nameParts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">C.NoName</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621682004395"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682004419"><span class="annot"><span class="annottext">NameParts
nameNameParts :: NameParts
nameNameParts :: Name -&gt; NameParts
</span><a href="#local-6989586621682004419"><span class="hs-identifier hs-var hs-var">nameNameParts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682004419"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><span class="hs-comment">-- | Bind a concrete name to an abstract in the translation environment.</span></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addBinding"><span class="hs-identifier hs-type">addBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-253"></span><span id="addBinding"><span class="annot"><span class="annottext">addBinding :: Name -&gt; Name -&gt; Env -&gt; Env
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addBinding"><span class="hs-identifier hs-var hs-var">addBinding</span></a></span></span><span> </span><span id="local-6989586621682004422"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004422"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682004423"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004423"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004424"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004424"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004424"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621682004423"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004424"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">`updateScopeLocals`</span></span><span> </span><span class="annot"><span class="hs-identifier">currentScope</span></span><span> </span><span class="annot"><span class="hs-identifier">e</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><a href="Agda.Utils.AssocList.html#insert"><span class="hs-identifier hs-type">AssocList.insert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004422"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#LocalVar"><span class="hs-identifier hs-type">LocalVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004423"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">-- * Service functions</span></span><span>
</span><span id="line-261"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span id="local-6989586621682002666"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentPrecedence"><span class="hs-identifier hs-type">currentPrecedence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002666"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002666"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span></span><span>
</span><span id="line-264"></span><span id="currentPrecedence"><span class="annot"><span class="annottext">currentPrecedence :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; m PrecedenceStack
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentPrecedence"><span class="hs-identifier hs-var hs-var">currentPrecedence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; PrecedenceStack) -&gt; m PrecedenceStack
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; PrecedenceStack) -&gt; m PrecedenceStack)
-&gt; (Env -&gt; PrecedenceStack) -&gt; m PrecedenceStack
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeInfo -&gt; Lens' ScopeInfo PrecedenceStack -&gt; PrecedenceStack
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; f PrecedenceStack) -&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo PrecedenceStack
</span><a href="Agda.Syntax.Scope.Base.html#scopePrecedence"><span class="hs-identifier hs-var">scopePrecedence</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; PrecedenceStack)
-&gt; (Env -&gt; ScopeInfo) -&gt; Env -&gt; PrecedenceStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621682004438"><span id="local-6989586621682004439"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveInteractionIds"><span class="hs-identifier hs-type">preserveInteractionIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004438"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004438"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004438"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004439"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-267"></span><span id="preserveInteractionIds"><span class="annot"><span class="annottext">preserveInteractionIds :: forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveInteractionIds"><span class="hs-identifier hs-var hs-var">preserveInteractionIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682004444"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004444"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004444"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveIIds"><span class="hs-identifier hs-var">preserveIIds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621682002676"><span id="local-6989586621682002677"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#localPrecedenceStack"><span class="hs-identifier hs-type">localPrecedenceStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002676"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002676"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002677"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002676"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002677"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-271"></span><span id="localPrecedenceStack"><span class="annot"><span class="annottext">localPrecedenceStack :: forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#localPrecedenceStack"><span class="hs-identifier hs-var hs-var">localPrecedenceStack</span></a></span></span><span> </span><span id="local-6989586621682004449"><span class="annot"><span class="annottext">PrecedenceStack -&gt; PrecedenceStack
</span><a href="#local-6989586621682004449"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682004450"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004450"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004450"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-type">over</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#scopePrecedence"><span class="hs-identifier hs-type">scopePrecedence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004449"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004450"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span id="local-6989586621682002684"><span id="local-6989586621682002685"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence%27"><span class="hs-identifier hs-type">withPrecedence'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002685"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-275"></span><span id="withPrecedence%27"><span class="annot"><span class="annottext">withPrecedence' :: forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
PrecedenceStack -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence%27"><span class="hs-identifier hs-var hs-var">withPrecedence'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#localPrecedenceStack"><span class="hs-identifier hs-var">localPrecedenceStack</span></a></span><span> </span><span class="annot"><span class="annottext">((PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a)
-&gt; (PrecedenceStack -&gt; PrecedenceStack -&gt; PrecedenceStack)
-&gt; PrecedenceStack
-&gt; m a
-&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; PrecedenceStack -&gt; PrecedenceStack
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621682002348"><span id="local-6989586621682002349"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-type">withPrecedence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002348"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#Precedence"><span class="hs-identifier hs-type">Precedence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002348"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002348"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002349"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-278"></span><span id="withPrecedence"><span class="annot"><span class="annottext">withPrecedence :: forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Precedence -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-var hs-var">withPrecedence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#localPrecedenceStack"><span class="hs-identifier hs-var">localPrecedenceStack</span></a></span><span> </span><span class="annot"><span class="annottext">((PrecedenceStack -&gt; PrecedenceStack) -&gt; m a -&gt; m a)
-&gt; (Precedence -&gt; PrecedenceStack -&gt; PrecedenceStack)
-&gt; Precedence
-&gt; m a
-&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; PrecedenceStack -&gt; PrecedenceStack
</span><a href="Agda.Syntax.Fixity.html#pushPrecedence"><span class="hs-identifier hs-var">pushPrecedence</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span id="local-6989586621682002692"><span id="local-6989586621682002693"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withScope"><span class="hs-identifier hs-type">withScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002692"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002692"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002692"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002693"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-281"></span><span id="withScope"><span class="annot"><span class="annottext">withScope :: forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
ScopeInfo -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withScope"><span class="hs-identifier hs-var hs-var">withScope</span></a></span></span><span> </span><span id="local-6989586621682004465"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682004465"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682004466"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004466"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004466"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682004465"><span class="hs-identifier hs-type">scope</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621682004467"><span id="local-6989586621682004468"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#noTakenNames"><span class="hs-identifier hs-type">noTakenNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004467"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004467"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004467"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004468"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-284"></span><span id="noTakenNames"><span class="annot"><span class="annottext">noTakenNames :: forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#noTakenNames"><span class="hs-identifier hs-var hs-var">noTakenNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682004472"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004472"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004472"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.empty</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621682004474"><span id="local-6989586621682004475"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#dontFoldPatternSynonyms"><span class="hs-identifier hs-type">dontFoldPatternSynonyms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004474"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004474"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004474"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004475"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-287"></span><span id="dontFoldPatternSynonyms"><span class="annot"><span class="annottext">dontFoldPatternSynonyms :: forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#dontFoldPatternSynonyms"><span class="hs-identifier hs-var hs-var">dontFoldPatternSynonyms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682004480"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004480"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004480"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#foldPatternSynonyms"><span class="hs-identifier hs-var">foldPatternSynonyms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621682002385"><span id="local-6989586621682002386"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#doUnqualifyOutOfScopeNames"><span class="hs-identifier hs-type">doUnqualifyOutOfScopeNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002385"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002385"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002385"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002386"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-290"></span><span id="doUnqualifyOutOfScopeNames"><span class="annot"><span class="annottext">doUnqualifyOutOfScopeNames :: forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#doUnqualifyOutOfScopeNames"><span class="hs-identifier hs-var hs-var">doUnqualifyOutOfScopeNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682004484"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004484"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682004484"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unqualifyOutOfScopeNames"><span class="hs-identifier hs-var">unqualifyOutOfScopeNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- | Get a function to check if a name refers to a particular builtin function.</span></span><span>
</span><span id="line-293"></span><span id="local-6989586621682002703"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isBuiltinFun"><span class="hs-identifier hs-type">isBuiltinFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002703"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002703"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#BuiltinId"><span class="hs-identifier hs-type">BuiltinId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-294"></span><span id="isBuiltinFun"><span class="annot"><span class="annottext">isBuiltinFun :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
m (QName -&gt; BuiltinId -&gt; Bool)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isBuiltinFun"><span class="hs-identifier hs-var hs-var">isBuiltinFun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; QName -&gt; BuiltinId -&gt; Bool)
-&gt; m (QName -&gt; BuiltinId -&gt; Bool)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; QName -&gt; BuiltinId -&gt; Bool)
 -&gt; m (QName -&gt; BuiltinId -&gt; Bool))
-&gt; (Env -&gt; QName -&gt; BuiltinId -&gt; Bool)
-&gt; m (QName -&gt; BuiltinId -&gt; Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map BuiltinId QName -&gt; QName -&gt; BuiltinId -&gt; Bool
forall {k} {a}. (Ord k, Eq a) =&gt; Map k a -&gt; a -&gt; k -&gt; Bool
</span><a href="#local-6989586621682004492"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">(Map BuiltinId QName -&gt; QName -&gt; BuiltinId -&gt; Bool)
-&gt; (Env -&gt; Map BuiltinId QName)
-&gt; Env
-&gt; QName
-&gt; BuiltinId
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Map BuiltinId QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#builtins"><span class="hs-identifier hs-var">builtins</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682004492"><span class="annot"><span class="annottext">is :: Map k a -&gt; a -&gt; k -&gt; Bool
</span><a href="#local-6989586621682004492"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682004502"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682004502"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682004503"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682004503"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682004504"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682004504"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682004503"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; Maybe a
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682004504"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682004502"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">-- | Resolve a concrete name. If illegally ambiguous fail with the ambiguous names.</span></span><span>
</span><span id="line-298"></span><span id="local-6989586621682002711"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName"><span class="hs-identifier hs-type">resolveName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002711"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#KindsOfNames"><span class="hs-identifier hs-type">KindsOfNames</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Set1.html#Set1"><span class="hs-identifier hs-type">Set1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002711"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#NameResolutionError"><span class="hs-identifier hs-type">NameResolutionError</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ResolvedName"><span class="hs-identifier hs-type">ResolvedName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-299"></span><span id="resolveName"><span class="annot"><span class="annottext">resolveName :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
KindsOfNames
-&gt; Maybe (Set1 Name)
-&gt; QName
-&gt; m (Either NameResolutionError ResolvedName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName"><span class="hs-identifier hs-var hs-var">resolveName</span></a></span></span><span> </span><span id="local-6989586621682004521"><span class="annot"><span class="annottext">KindsOfNames
</span><a href="#local-6989586621682004521"><span class="hs-identifier hs-var">kinds</span></a></span></span><span> </span><span id="local-6989586621682004522"><span class="annot"><span class="annottext">Maybe (Set1 Name)
</span><a href="#local-6989586621682004522"><span class="hs-identifier hs-var">candidates</span></a></span></span><span> </span><span id="local-6989586621682004523"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004523"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT NameResolutionError m ResolvedName
-&gt; m (Either NameResolutionError ResolvedName)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT NameResolutionError m ResolvedName
 -&gt; m (Either NameResolutionError ResolvedName))
-&gt; ExceptT NameResolutionError m ResolvedName
-&gt; m (Either NameResolutionError ResolvedName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KindsOfNames
-&gt; Maybe (Set1 Name)
-&gt; QName
-&gt; ExceptT NameResolutionError m ResolvedName
forall (m :: * -&gt; *).
(ReadTCState m, HasBuiltins m, MonadError NameResolutionError m) =&gt;
KindsOfNames -&gt; Maybe (Set1 Name) -&gt; QName -&gt; m ResolvedName
</span><a href="Agda.Syntax.Scope.Monad.html#tryResolveName"><span class="hs-identifier hs-var">tryResolveName</span></a></span><span> </span><span class="annot"><span class="annottext">KindsOfNames
</span><a href="#local-6989586621682004521"><span class="hs-identifier hs-var">kinds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Set1 Name)
</span><a href="#local-6989586621682004522"><span class="hs-identifier hs-var">candidates</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004523"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><span class="hs-comment">-- | Treat illegally ambiguous names as UnknownNames.</span></span><span>
</span><span id="line-302"></span><span id="local-6989586621682002728"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName_"><span class="hs-identifier hs-type">resolveName_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002728"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002728"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ResolvedName"><span class="hs-identifier hs-type">ResolvedName</span></a></span></span><span>
</span><span id="line-303"></span><span id="resolveName_"><span class="annot"><span class="annottext">resolveName_ :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; Name -&gt; m ResolvedName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName_"><span class="hs-identifier hs-var hs-var">resolveName_</span></a></span></span><span> </span><span id="local-6989586621682004532"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004532"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682004533"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004533"><span class="hs-identifier hs-var">cand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NameResolutionError -&gt; ResolvedName)
-&gt; Either NameResolutionError ResolvedName -&gt; ResolvedName
forall a b. (a -&gt; b) -&gt; Either a b -&gt; b
</span><a href="Agda.Utils.Either.html#fromRight"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedName -&gt; NameResolutionError -&gt; ResolvedName
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ResolvedName
</span><a href="Agda.Syntax.Scope.Base.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either NameResolutionError ResolvedName -&gt; ResolvedName)
-&gt; m (Either NameResolutionError ResolvedName) -&gt; m ResolvedName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">KindsOfNames
-&gt; Maybe (Set1 Name)
-&gt; QName
-&gt; m (Either NameResolutionError ResolvedName)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
KindsOfNames
-&gt; Maybe (Set1 Name)
-&gt; QName
-&gt; m (Either NameResolutionError ResolvedName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName"><span class="hs-identifier hs-var">resolveName</span></a></span><span> </span><span class="annot"><span class="annottext">KindsOfNames
</span><a href="Agda.Syntax.Scope.Base.html#allKindsOfNames"><span class="hs-identifier hs-var">allKindsOfNames</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set1 Name -&gt; Maybe (Set1 Name)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Set1 Name -&gt; Maybe (Set1 Name)) -&gt; Set1 Name -&gt; Maybe (Set1 Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004533"><span class="hs-identifier hs-var">cand</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004532"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">-- ** Dealing with names</span></span><span>
</span><span id="line-307"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Names in abstract syntax are fully qualified, but the concrete syntax</span><span>
</span><span id="line-310"></span><span class="hs-comment">--   requires non-qualified names in places. In theory (if all scopes are</span><span>
</span><span id="line-311"></span><span class="hs-comment">--   correct), we should get a non-qualified name when translating back to a</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   concrete name, but I suspect the scope isn't always perfect. In these</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   cases we just throw away the qualified part. It's just for pretty printing</span><span>
</span><span id="line-314"></span><span class="hs-comment">--   anyway...</span><span>
</span><span id="line-315"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-type">unsafeQNameToName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span>
</span><span id="line-316"></span><span id="unsafeQNameToName"><span class="annot"><span class="annottext">unsafeQNameToName :: QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var hs-var">unsafeQNameToName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">C.unqualify</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Like 'isRecordConstructor' but does not throw IMPOSSIBLE if the</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- name is not in scope.</span><span>
</span><span id="line-320"></span><span id="local-6989586621682002734"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isExistingRecordConstructor"><span class="hs-identifier hs-type">isExistingRecordConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002734"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002734"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#RecordData"><span class="hs-identifier hs-type">RecordData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-321"></span><span id="isExistingRecordConstructor"><span class="annot"><span class="annottext">isExistingRecordConstructor :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (Maybe (QName, RecordData))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isExistingRecordConstructor"><span class="hs-identifier hs-var hs-var">isExistingRecordConstructor</span></a></span></span><span> </span><span id="local-6989586621682004563"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004563"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (Either SigError Definition)
forall (m :: * -&gt; *).
(HasConstInfo m, HasCallStack) =&gt;
QName -&gt; m (Either SigError Definition)
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo%27"><span class="hs-identifier hs-var">getConstInfo'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004563"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either SigError Definition)
-&gt; (Either SigError Definition -&gt; m (Maybe (QName, RecordData)))
-&gt; m (Maybe (QName, RecordData))
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#SigUnknown"><span class="hs-identifier hs-type">SigUnknown</span></a></span><span> </span><span id="local-6989586621682004565"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682004565"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData) -&gt; m (Maybe (QName, RecordData))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">SigError
</span><a href="Agda.TypeChecking.Monad.Signature.html#SigCubicalNotErasure"><span class="hs-identifier hs-var">SigCubicalNotErasure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData) -&gt; m (Maybe (QName, RecordData))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">SigError
</span><a href="Agda.TypeChecking.Monad.Signature.html#SigAbstract"><span class="hs-identifier hs-var">SigAbstract</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData) -&gt; m (Maybe (QName, RecordData))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682004568"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682004568"><span class="hs-identifier hs-var">def</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Defn) -&gt; Definition -&gt; Defn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621682004568"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">I.Constructor</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conData :: Defn -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#conData"><span class="hs-identifier hs-var">conData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682004572"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004572"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RecordData -&gt; (QName, RecordData))
-&gt; Maybe RecordData -&gt; Maybe (QName, RecordData)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004572"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe RecordData -&gt; Maybe (QName, RecordData))
-&gt; m (Maybe RecordData) -&gt; m (Maybe (QName, RecordData))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (Maybe RecordData)
forall (m :: * -&gt; *).
(HasCallStack, HasConstInfo m) =&gt;
QName -&gt; m (Maybe RecordData)
</span><a href="Agda.TypeChecking.Records.html#isRecord"><span class="hs-identifier hs-var">isRecord</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004572"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData) -&gt; m (Maybe (QName, RecordData))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, RecordData)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span id="local-6989586621682002382"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-type">lookupQName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002382"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#AllowAmbiguousNames"><span class="hs-identifier hs-type">AllowAmbiguousNames</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002382"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span></span><span>
</span><span id="line-331"></span><span id="lookupQName"><span class="annot"><span class="annottext">lookupQName :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var hs-var">lookupQName</span></a></span></span><span> </span><span id="local-6989586621682004620"><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682004620"><span class="hs-identifier hs-var">ambCon</span></a></span></span><span> </span><span id="local-6989586621682004621"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004621"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004622"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682004622"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe ArgName
</span><a href="Agda.TypeChecking.Monad.Base.html#getGeneralizedFieldName"><span class="hs-identifier hs-var">getGeneralizedFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004621"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">C.Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">C.InScope</span></a></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; Name) -&gt; NameParts -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-var">C.stringNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682004622"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span id="local-6989586621682004628"><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682004628"><span class="hs-identifier hs-var">ambCon</span></a></span></span><span> </span><span id="local-6989586621682004629"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe (QName, RecordData)) -&gt; m (Maybe (QName, RecordData))
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Signature.html#ignoreAbstractMode"><span class="hs-identifier hs-var">ignoreAbstractMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; m (Maybe (QName, RecordData))
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (Maybe (QName, RecordData))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isExistingRecordConstructor"><span class="hs-identifier hs-var">isExistingRecordConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Maybe (QName, RecordData))
-&gt; (Maybe (QName, RecordData) -&gt; m QName) -&gt; m QName
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-comment">-- If the QName is the internal name of a record with no named</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-comment">-- constructor, we should first concretise the name *of the record*,</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-comment">-- since that will *actually* be in scope through a concrete QName.</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682004631"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004631"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682004632"><span class="annot"><span class="annottext">RecordData
</span><a href="#local-6989586621682004632"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecordData -&gt; Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#_recNamedCon"><span class="hs-identifier hs-var">_recNamedCon</span></a></span><span> </span><span class="annot"><span class="annottext">RecordData
</span><a href="#local-6989586621682004632"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;scope.inverse&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;inverse lookup of record constructor &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ArgName
forall a. Pretty a =&gt; a -&gt; ArgName
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621682004635"><span class="annot"><a href="#local-6989586621682004635"><span class="hs-identifier hs-var">recr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; m QName
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682004628"><span class="hs-identifier hs-var">ambCon</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004631"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682004635"><span class="hs-identifier hs-type">recr</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#qualify"><span class="hs-operator hs-type">`C.qualify`</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#simpleName"><span class="hs-identifier hs-type">simpleName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;constructor&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="annottext">Maybe (QName, RecordData)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621682004638"><span class="annot"><a href="#local-6989586621682004638"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; [QName]) -&gt; m [QName]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; ScopeInfo -&gt; [QName]
</span><a href="Agda.Syntax.Scope.Base.html#inverseScopeLookupName%27"><span class="hs-identifier hs-var">inverseScopeLookupName'</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="#local-6989586621682004628"><span class="hs-identifier hs-var">ambCon</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; [QName]) -&gt; (Env -&gt; ScopeInfo) -&gt; Env -&gt; [QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scope.inverse&quot;</span></span><span> </span><span class="annot"><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="hs-string">&quot;inverse looking up abstract name &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004629"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; yields &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004638"><span class="hs-identifier hs-type">ys</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621682004640"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004638"><span class="hs-identifier hs-type">ys</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-comment">-- Found concrete name: check that it is not shadowed by a local</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621682004640"><span class="annot"><span class="annottext">loop :: [QName] -&gt; m QName
</span><a href="#local-6989586621682004640"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682004641"><span class="annot"><span class="annottext">qy :: QName
</span><a href="#local-6989586621682004641"><span class="hs-identifier hs-var">qy</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004641"><span class="hs-identifier hs-var">qy</span></a></span><span> </span><span class="hs-comment">-- local names cannot be qualified</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="#local-6989586621682004640"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682004643"><span class="annot"><span class="annottext">qy :: QName
</span><a href="#local-6989586621682004643"><span class="hs-identifier hs-var">qy</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span id="local-6989586621682004644"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004644"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682004645"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682004645"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m (Maybe Name)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m (Maybe Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupNameInScope"><span class="hs-identifier hs-var">lookupNameInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004644"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe Name) -&gt; (Maybe Name -&gt; m QName) -&gt; m QName
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004647"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004647"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004647"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; m QName
</span><a href="#local-6989586621682004640"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682004645"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004643"><span class="hs-identifier hs-var">qy</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-comment">-- Found no concrete name:</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621682004640"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameToConcrete"><span class="hs-identifier hs-var">qnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-comment">-- The name is qualified: in this case, we are likely dealing with a parameterised</span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-comment">-- module, and the unqualified name might actually be in scope (see #3209).</span><span>
</span><span id="line-359"></span><span>      </span><span class="hs-comment">-- To make case splitting more useful in that situation, we unqualify the name</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-comment">-- if we are generating clauses for a case split.</span><span>
</span><span id="line-361"></span><span>      </span><span id="local-6989586621682004651"><span class="annot"><span class="annottext">qy :: QName
</span><a href="#local-6989586621682004651"><span class="hs-identifier hs-var">qy</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>          </span><span id="local-6989586621682004652"><span class="annot"><a href="#local-6989586621682004652"><span class="hs-identifier hs-var">doUnqualify</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Bool) -&gt; m Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unqualifyOutOfScopeNames"><span class="hs-identifier hs-var">unqualifyOutOfScopeNames</span></a></span><span>
</span><span id="line-363"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setNotInScope"><span class="hs-identifier hs-type">setNotInScope</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682004652"><span class="hs-identifier hs-type">doUnqualify</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-type">unqualify</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004651"><span class="hs-identifier hs-type">qy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682004651"><span class="hs-identifier hs-type">qy</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-comment">-- The name is unqualified: make up a new one</span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621682004654"><span class="annot"><span class="annottext">qy :: QName
</span><a href="#local-6989586621682004654"><span class="hs-identifier hs-var">qy</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; m Name -&gt; m QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#chooseName"><span class="hs-identifier hs-var">chooseName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004629"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span id="local-6989586621682002751"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupModule"><span class="hs-identifier hs-type">lookupModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">A.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span></span><span>
</span><span id="line-368"></span><span id="lookupModule"><span class="annot"><span class="annottext">lookupModule :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; ModuleName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupModule"><span class="hs-identifier hs-var hs-var">lookupModule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#MName"><span class="hs-identifier hs-type">A.MName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m QName) -&gt; QName -&gt; m QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleName"><span class="hs-identifier hs-var">C.simpleName</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;-1&quot;</span></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-comment">-- Andreas, 2016-10-10 it can happen that we have an empty module name</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-comment">-- for instance when we query the current module inside the</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-comment">-- frontmatter or module telescope of the top level module.</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-comment">-- In this case, we print it as an invalid module name.</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-comment">-- (Should only affect debug printing.)</span><span>
</span><span id="line-374"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupModule"><span class="hs-identifier hs-var">lookupModule</span></a></span><span> </span><span id="local-6989586621682004667"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682004667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621682004668"><span class="annot"><a href="#local-6989586621682004668"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; ScopeInfo) -&gt; m ScopeInfo
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#inverseScopeLookupModule"><span class="hs-identifier hs-type">inverseScopeLookupModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004667"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004668"><span class="hs-identifier hs-type">scope</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682004670"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004670"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682004670"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m QName) -&gt; QName -&gt; m QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToConcrete"><span class="hs-identifier hs-var">mnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682004667"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-379"></span><span>                </span><span class="hs-comment">-- this is what happens for names that are not in scope (private names)</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Is this concrete name currently in use by a particular abstract</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   name in the current scope?</span><span>
</span><span id="line-383"></span><span id="local-6989586621682002748"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupNameInScope"><span class="hs-identifier hs-type">lookupNameInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002748"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002748"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-384"></span><span id="lookupNameInScope"><span class="annot"><span class="annottext">lookupNameInScope :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m (Maybe Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupNameInScope"><span class="hs-identifier hs-var hs-var">lookupNameInScope</span></a></span></span><span> </span><span id="local-6989586621682004677"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004677"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; Maybe Name) -&gt; m (Maybe Name)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocalVar -&gt; Name) -&gt; Maybe LocalVar -&gt; Maybe Name
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LocalVar -&gt; Name
</span><a href="Agda.Syntax.Scope.Base.html#localVar"><span class="hs-identifier hs-var">localVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe LocalVar -&gt; Maybe Name)
-&gt; ([(Name, LocalVar)] -&gt; Maybe LocalVar)
-&gt; [(Name, LocalVar)]
-&gt; Maybe Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [(Name, LocalVar)] -&gt; Maybe LocalVar
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004677"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Name, LocalVar)] -&gt; Maybe Name)
-&gt; (Env -&gt; [(Name, LocalVar)]) -&gt; Env -&gt; Maybe Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeInfo
-&gt; Lens' ScopeInfo [(Name, LocalVar)] -&gt; [(Name, LocalVar)]
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, LocalVar)] -&gt; f [(Name, LocalVar)])
-&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo [(Name, LocalVar)]
</span><a href="Agda.Syntax.Scope.Base.html#scopeLocals"><span class="hs-identifier hs-var">scopeLocals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; [(Name, LocalVar)])
-&gt; (Env -&gt; ScopeInfo) -&gt; Env -&gt; [(Name, LocalVar)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Have we already committed to a specific concrete name for this</span><span>
</span><span id="line-388"></span><span class="hs-comment">--   abstract name? If yes, return the concrete name(s).</span><span>
</span><span id="line-389"></span><span id="local-6989586621682002758"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#hasConcreteNames"><span class="hs-identifier hs-type">hasConcreteNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadStConcreteNames"><span class="hs-identifier hs-type">MonadStConcreteNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002758"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002758"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-390"></span><span id="hasConcreteNames"><span class="annot"><span class="annottext">hasConcreteNames :: forall (m :: * -&gt; *). MonadStConcreteNames m =&gt; Name -&gt; m [Name]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#hasConcreteNames"><span class="hs-identifier hs-var hs-var">hasConcreteNames</span></a></span></span><span> </span><span id="local-6989586621682004693"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004693"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; (List1 Name -&gt; [Name]) -&gt; Maybe (List1 Name) -&gt; [Name]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">List1 Name -&gt; [Item (List1 Name)]
List1 Name -&gt; [Name]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (List1 Name) -&gt; [Name])
-&gt; (ConcreteNames -&gt; Maybe (List1 Name)) -&gt; ConcreteNames -&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteNames -&gt; Maybe (List1 Name)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004693"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(ConcreteNames -&gt; [Name]) -&gt; m ConcreteNames -&gt; m [Name]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ConcreteNames
forall (m :: * -&gt; *). MonadStConcreteNames m =&gt; m ConcreteNames
</span><a href="Agda.TypeChecking.Monad.Base.html#useConcreteNames"><span class="hs-identifier hs-var">useConcreteNames</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- | Commit to a specific concrete name for printing the given</span><span>
</span><span id="line-393"></span><span class="hs-comment">--   abstract name. If the abstract name already has associated</span><span>
</span><span id="line-394"></span><span class="hs-comment">---  concrete name(s), the new name is only used when all previous</span><span>
</span><span id="line-395"></span><span class="hs-comment">---  names are shadowed. Precondition: the abstract name should be in</span><span>
</span><span id="line-396"></span><span class="hs-comment">--   scope.</span><span>
</span><span id="line-397"></span><span id="local-6989586621682002636"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-type">pickConcreteName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadStConcreteNames"><span class="hs-identifier hs-type">MonadStConcreteNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002636"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002636"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-398"></span><span id="pickConcreteName"><span class="annot"><span class="annottext">pickConcreteName :: forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
Name -&gt; Name -&gt; m ()
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-var hs-var">pickConcreteName</span></a></span></span><span> </span><span id="local-6989586621682004701"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004701"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004702"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004702"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteNames -&gt; ConcreteNames) -&gt; m ()
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
(ConcreteNames -&gt; ConcreteNames) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyConcreteNames"><span class="hs-identifier hs-var">modifyConcreteNames</span></a></span><span> </span><span class="annot"><span class="annottext">((ConcreteNames -&gt; ConcreteNames) -&gt; m ())
-&gt; (ConcreteNames -&gt; ConcreteNames) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Maybe (List1 Name) -&gt; Maybe (List1 Name))
 -&gt; Name -&gt; ConcreteNames -&gt; ConcreteNames)
-&gt; Name
-&gt; (Maybe (List1 Name) -&gt; Maybe (List1 Name))
-&gt; ConcreteNames
-&gt; ConcreteNames
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (List1 Name) -&gt; Maybe (List1 Name))
-&gt; Name -&gt; ConcreteNames -&gt; ConcreteNames
forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.alter</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004701"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (List1 Name) -&gt; Maybe (List1 Name))
 -&gt; ConcreteNames -&gt; ConcreteNames)
-&gt; (Maybe (List1 Name) -&gt; Maybe (List1 Name))
-&gt; ConcreteNames
-&gt; ConcreteNames
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 Name -&gt; Maybe (List1 Name)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(List1 Name -&gt; Maybe (List1 Name))
-&gt; (Maybe (List1 Name) -&gt; List1 Name)
-&gt; Maybe (List1 Name)
-&gt; Maybe (List1 Name)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">Maybe (List1 Name)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; List1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004702"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004705"><span class="annot"><span class="annottext">List1 Name
</span><a href="#local-6989586621682004705"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Name -&gt; List1 Name
forall a. [a] -&gt; a -&gt; List1 a
</span><a href="Agda.Utils.List1.html#snoc"><span class="hs-identifier hs-var">List1.snoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 Name -&gt; [Item (List1 Name)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 Name
</span><a href="#local-6989586621682004705"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004702"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><span class="hs-comment">-- | For the given abstract name, return the names that could shadow it.</span></span><span>
</span><span id="line-403"></span><span id="local-6989586621682002774"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#shadowingNames"><span class="hs-identifier hs-type">shadowingNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002774"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-405"></span><span id="shadowingNames"><span class="annot"><span class="annottext">shadowingNames :: forall (m :: * -&gt; *). ReadTCState m =&gt; Name -&gt; m (Set ArgName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#shadowingNames"><span class="hs-identifier hs-var hs-var">shadowingNames</span></a></span></span><span> </span><span id="local-6989586621682004716"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004716"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Set1 ArgName) -&gt; Set ArgName
forall a. Maybe (Set1 a) -&gt; Set a
</span><a href="Agda.Utils.Set1.html#toSet%27"><span class="hs-identifier hs-var">Set1.toSet'</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Set1 ArgName) -&gt; Set ArgName)
-&gt; (Map Name (Set1 ArgName) -&gt; Maybe (Set1 ArgName))
-&gt; Map Name (Set1 ArgName)
-&gt; Set ArgName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name (Set1 ArgName) -&gt; Maybe (Set1 ArgName)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004716"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Name (Set1 ArgName) -&gt; Set ArgName)
-&gt; m (Map Name (Set1 ArgName)) -&gt; m (Set ArgName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCState (Map Name (Set1 ArgName))
-&gt; m (Map Name (Set1 ArgName))
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Name (Set1 ArgName) -&gt; f (Map Name (Set1 ArgName)))
-&gt; TCState -&gt; f TCState
Lens' TCState (Map Name (Set1 ArgName))
</span><a href="Agda.TypeChecking.Monad.Base.html#stShadowingNames"><span class="hs-identifier hs-var">stShadowingNames</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span id="local-6989586621682004722"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-type">toConcreteName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682004722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span></span><span>
</span><span id="line-408"></span><span id="toConcreteName"><span class="annot"><span class="annottext">toConcreteName :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var hs-var">toConcreteName</span></a></span></span><span> </span><span id="local-6989586621682004742"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004742"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682004743"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004743"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004742"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004743"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004743"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-409"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var">toConcreteName</span></a></span><span> </span><span id="local-6989586621682004746"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004746"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m [Name]
forall (m :: * -&gt; *). MonadStConcreteNames m =&gt; Name -&gt; m [Name]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#hasConcreteNames"><span class="hs-identifier hs-var">hasConcreteNames</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004746"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m [Name] -&gt; ([Name] -&gt; m Name) -&gt; m Name
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; m Name
</span><a href="#local-6989586621682004747"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-comment">-- case: we already have picked some name(s) for x</span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621682004747"><span class="annot"><span class="annottext">loop :: [Name] -&gt; m Name
</span><a href="#local-6989586621682004747"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682004748"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004748"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682004749"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682004749"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Name -&gt; m Name -&gt; m Name
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; m Bool
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; Name -&gt; m Bool
</span><a href="#local-6989586621682004751"><span class="hs-identifier hs-var">isGoodName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004746"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004748"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; m Name
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004748"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; m Name
</span><a href="#local-6989586621682004747"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682004749"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-comment">-- case: we haven't picked a concrete name yet, or all previously</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-comment">-- picked names are shadowed, so we pick a new name now</span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><a href="#local-6989586621682004747"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>      </span><span id="local-6989586621682004752"><span class="annot"><a href="#local-6989586621682004752"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#chooseName"><span class="hs-identifier hs-var">chooseName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004746"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-type">pickConcreteName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004746"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004752"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682004752"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-comment">-- Is 'y' a good concrete name for abstract name 'x'?</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621682002785"><span class="annot"><a href="#local-6989586621682004751"><span class="hs-identifier hs-type">isGoodName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002785"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002785"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621682004751"><span class="annot"><span class="annottext">isGoodName :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; Name -&gt; m Bool
</span><a href="#local-6989586621682004751"><span class="hs-identifier hs-var hs-var">isGoodName</span></a></span></span><span> </span><span id="local-6989586621682004773"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004773"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004774"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004774"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621682004775"><span class="annot"><a href="#local-6989586621682004775"><span class="hs-identifier hs-var">zs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; [Name]) -&gt; m [Name]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; [Name]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Name -&gt; [Name]) -&gt; (Env -&gt; Set Name) -&gt; Env -&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Set Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="Agda.Utils.Monad.html#forallM"><span class="hs-identifier hs-type">forallM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004775"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682004778"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004778"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004773"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004778"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-var">`or2M`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">notElem</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004774"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Bool) -&gt; m [Name] -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m [Name]
forall (m :: * -&gt; *). MonadStConcreteNames m =&gt; Name -&gt; m [Name]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#hasConcreteNames"><span class="hs-identifier hs-var">hasConcreteNames</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004778"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | Choose a new unshadowed name for the given abstract name</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | NOTE: See @withName@ in @Agda.Syntax.Translation.ReflectedToAbstract@ for similar logic.</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- | NOTE: See @freshConcreteName@ in @Agda.Syntax.Scope.Monad@ also for similar logic.</span><span>
</span><span id="line-431"></span><span id="local-6989586621682002750"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#chooseName"><span class="hs-identifier hs-type">chooseName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span></span><span>
</span><span id="line-432"></span><span id="chooseName"><span class="annot"><span class="annottext">chooseName :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#chooseName"><span class="hs-identifier hs-var hs-var">chooseName</span></a></span></span><span> </span><span id="local-6989586621682004828"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m (Maybe Name)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m (Maybe Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupNameInScope"><span class="hs-identifier hs-var">lookupNameInScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Maybe Name) -&gt; (Maybe Name -&gt; m Name) -&gt; m Name
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-comment">-- If the name is currently in scope, we do not rename it</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682004829"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004829"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004829"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;toConcrete.bindName&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;name &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ArgName
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">C.nameToRawName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot; already in scope, so not renaming&quot;</span></span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Name) -&gt; Name -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-comment">-- Otherwise we pick a name that does not shadow other names</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621682004830"><span class="annot"><a href="#local-6989586621682004830"><span class="hs-identifier hs-var">takenDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Set NameParts) -&gt; m (Set NameParts)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Set NameParts
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenDefNames"><span class="hs-identifier hs-var">takenDefNames</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621682004831"><span class="annot"><a href="#local-6989586621682004831"><span class="hs-identifier hs-var">taken</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682004832"><span class="hs-identifier hs-type">takenNames</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621682004833"><span class="annot"><a href="#local-6989586621682004833"><span class="hs-identifier hs-var">toAvoid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#shadowingNames"><span class="hs-identifier hs-type">shadowingNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004828"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span id="local-6989586621682004834"><span class="annot"><a href="#local-6989586621682004834"><span class="hs-identifier hs-var">glyphMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optUseUnicode"><span class="hs-identifier hs-type">optUseUnicode</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682004836"><span class="annot"><a href="#local-6989586621682004836"><span class="hs-identifier hs-var hs-var">freshNameMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="#local-6989586621682004834"><span class="hs-identifier hs-var">glyphMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-445"></span><span>          </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="Agda.Syntax.Concrete.Glyph.html#UnicodeOk"><span class="hs-identifier hs-var">UnicodeOk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="Agda.Syntax.Concrete.Name.html#UnicodeSubscript"><span class="hs-identifier hs-var">A.UnicodeSubscript</span></a></span><span>
</span><span id="line-446"></span><span>          </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="Agda.Syntax.Concrete.Glyph.html#AsciiOnly"><span class="hs-identifier hs-var">AsciiOnly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="Agda.Syntax.Concrete.Name.html#AsciiCounter"><span class="hs-identifier hs-var">A.AsciiCounter</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621682004841"><span class="annot"><a href="#local-6989586621682004841"><span class="hs-identifier hs-var hs-var">shouldAvoid</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">C.NoName</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><a href="#local-6989586621682004841"><span class="hs-identifier hs-var">shouldAvoid</span></a></span><span> </span><span id="local-6989586621682004842"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621682004842"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682004843"><span class="annot"><span class="annottext">NameParts
nameNameParts :: Name -&gt; NameParts
nameNameParts :: NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var hs-var">nameNameParts</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682004844"><span class="annot"><span class="annottext">raw :: ArgName
</span><a href="#local-6989586621682004844"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ArgName
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004842"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-451"></span><span>          </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682004843"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; Set NameParts -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set NameParts
</span><a href="#local-6989586621682004830"><span class="hs-identifier hs-var">takenDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-452"></span><span>          </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682004844"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Set ArgName -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set ArgName
</span><a href="#local-6989586621682004831"><span class="hs-identifier hs-var">taken</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-453"></span><span>          </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682004844"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Set ArgName -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set ArgName
</span><a href="#local-6989586621682004833"><span class="hs-identifier hs-var">toAvoid</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>        </span><span id="local-6989586621682004846"><span class="annot"><a href="#local-6989586621682004846"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreshNameMode -&gt; (Name -&gt; Bool) -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#firstNonTakenName"><span class="hs-identifier hs-var">firstNonTakenName</span></a></span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621682004836"><span class="hs-identifier hs-var">freshNameMode</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621682004841"><span class="hs-identifier hs-var">shouldAvoid</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004828"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete.bindName&quot;</span></span><span> </span><span class="annot"><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;picking concrete name for:&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004828"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;names already taken:      &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;+&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-type">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621682004831"><span class="hs-identifier hs-type">taken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;names to avoid:           &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;+&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-type">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621682004833"><span class="hs-identifier hs-type">toAvoid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;concrete name chosen:     &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004846"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682004846"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621682002796"><span class="annot"><a href="#local-6989586621682004832"><span class="hs-identifier hs-type">takenNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621682004832"><span class="annot"><span class="annottext">takenNames :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; m (Set ArgName)
</span><a href="#local-6989586621682004832"><span class="hs-identifier hs-var hs-var">takenNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621682004873"><span class="annot"><a href="#local-6989586621682004873"><span class="hs-identifier hs-var">ys0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Name]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Name -&gt; [Name]) -&gt; m (Set Name) -&gt; m [Name]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Set Name) -&gt; m (Set Name)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Set Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#takenVarNames"><span class="hs-identifier hs-var">takenVarNames</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete.bindName&quot;</span></span><span> </span><span class="annot"><span class="hs-number">90</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;abstract names of local vars: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;+&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-type">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682004873"><span class="hs-identifier hs-type">ys0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Set.fromList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#hasConcreteNames"><span class="hs-identifier hs-type">hasConcreteNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004873"><span class="hs-identifier hs-type">ys0</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="annot"><span class="hs-comment">-- | Add a abstract name to the scope and produce an available concrete version of it.</span></span><span>
</span><span id="line-473"></span><span id="local-6989586621682002802"><span id="local-6989586621682002803"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName"><span class="hs-identifier hs-type">bindName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002803"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-474"></span><span id="bindName"><span class="annot"><span class="annottext">bindName :: forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Name -&gt; (Name -&gt; m a) -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName"><span class="hs-identifier hs-var hs-var">bindName</span></a></span></span><span> </span><span id="local-6989586621682004889"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004889"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004890"><span class="annot"><span class="annottext">Name -&gt; m a
</span><a href="#local-6989586621682004890"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621682004891"><span class="annot"><a href="#local-6989586621682004891"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var">toConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004889"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete.bindName&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;adding &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004889"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; to the scope under concrete name &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">C.nameToRawName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004891"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addBinding"><span class="hs-identifier hs-type">addBinding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004891"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004889"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682004890"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004891"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="annot"><span class="hs-comment">-- | Like 'bindName', but do not care whether name is already taken.</span></span><span>
</span><span id="line-480"></span><span id="local-6989586621682002806"><span id="local-6989586621682002807"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName%27"><span class="hs-identifier hs-type">bindName'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002806"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002806"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002806"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002807"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-481"></span><span id="bindName%27"><span class="annot"><span class="annottext">bindName' :: forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; Name -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName%27"><span class="hs-identifier hs-var hs-var">bindName'</span></a></span></span><span> </span><span id="local-6989586621682004911"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004911"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004912"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682004912"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;toConcrete.bindName&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;adding &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ArgName
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">C.nameToRawName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004911"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot; to the scope with forced name&quot;</span></span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; m ()
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
Name -&gt; Name -&gt; m ()
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-var">pickConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004911"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004913"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; (m a -&gt; m a) -&gt; m a -&gt; m a
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; m a -&gt; m a
forall a. (Env -&gt; Env) -&gt; m a -&gt; m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">((Env -&gt; Env) -&gt; m a -&gt; m a) -&gt; (Env -&gt; Env) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Env -&gt; Env
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addBinding"><span class="hs-identifier hs-var">addBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004913"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004911"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682004912"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682004913"><span class="annot"><span class="annottext">y :: Name
</span><a href="#local-6989586621682004913"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004911"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-488"></span><span class="annot"><span class="hs-comment">-- ** Dealing with precedences</span></span><span>
</span><span id="line-489"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">-- | General bracketing function.</span></span><span>
</span><span id="line-492"></span><span id="local-6989586621682002813"><span id="local-6989586621682002814"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket%27"><span class="hs-identifier hs-type">bracket'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002813"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002814"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002814"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ The bracketing function.</span></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Should we bracket things which have the given precedence?</span></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002814"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002813"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002814"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-499"></span><span id="bracket%27"><span class="annot"><span class="annottext">bracket' :: forall (m :: * -&gt; *) e.
MonadToConcrete m =&gt;
(e -&gt; e) -&gt; (PrecedenceStack -&gt; Bool) -&gt; e -&gt; m e
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket%27"><span class="hs-identifier hs-var hs-var">bracket'</span></a></span></span><span> </span><span id="local-6989586621682004922"><span class="annot"><span class="annottext">e -&gt; e
</span><a href="#local-6989586621682004922"><span class="hs-identifier hs-var">paren</span></a></span></span><span> </span><span id="local-6989586621682004923"><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="#local-6989586621682004923"><span class="hs-identifier hs-var">needParen</span></a></span></span><span> </span><span id="local-6989586621682004924"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682004924"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621682004925"><span class="annot"><a href="#local-6989586621682004925"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m PrecedenceStack
forall (m :: * -&gt; *). MonadToConcrete m =&gt; m PrecedenceStack
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentPrecedence"><span class="hs-identifier hs-var">currentPrecedence</span></a></span><span>
</span><span id="line-501"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682004923"><span class="hs-identifier hs-type">needParen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004925"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682004922"><span class="hs-identifier hs-type">paren</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004924"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682004924"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="annot"><span class="hs-comment">-- | Expression bracketing</span></span><span>
</span><span id="line-504"></span><span id="local-6989586621682002817"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-type">bracket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span></span><span>
</span><span id="line-505"></span><span id="bracket"><span class="annot"><span class="annottext">bracket :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var hs-var">bracket</span></a></span></span><span> </span><span id="local-6989586621682004934"><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="#local-6989586621682004934"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span id="local-6989586621682004935"><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682004935"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621682004936"><span class="annot"><a href="#local-6989586621682004936"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682004935"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket%27"><span class="hs-identifier hs-type">bracket'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-type">Paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004936"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682004934"><span class="hs-identifier hs-type">par</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004936"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="annot"><span class="hs-comment">-- | Pattern bracketing</span></span><span>
</span><span id="line-510"></span><span id="local-6989586621682002821"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracketP_"><span class="hs-identifier hs-type">bracketP_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span></span><span>
</span><span id="line-511"></span><span id="bracketP_"><span class="annot"><span class="annottext">bracketP_ :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracketP_"><span class="hs-identifier hs-var hs-var">bracketP_</span></a></span></span><span> </span><span id="local-6989586621682004947"><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="#local-6989586621682004947"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span id="local-6989586621682004948"><span class="annot"><span class="annottext">m Pattern
</span><a href="#local-6989586621682004948"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span id="local-6989586621682004949"><span class="annot"><a href="#local-6989586621682004949"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Pattern
</span><a href="#local-6989586621682004948"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket%27"><span class="hs-identifier hs-type">bracket'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-type">ParenP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004949"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682004947"><span class="hs-identifier hs-type">par</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682004949"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | Applications where the argument is a lambda without parentheses need</span><span>
</span><span id="line-516"></span><span class="hs-comment">--   parens more often than other applications.</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isLambda"><span class="hs-identifier hs-type">isLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-518"></span><span id="isLambda"><span class="annot"><span class="annottext">isLambda :: NamedArg Expr -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isLambda"><span class="hs-identifier hs-var hs-var">isLambda</span></a></span></span><span> </span><span id="local-6989586621682004952"><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682004952"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#notVisible"><span class="hs-identifier hs-var">notVisible</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682004952"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a></span><span> </span><span id="local-6989586621682004954"><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682004954"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Agda.Syntax.Abstract.Views.html#unScope"><span class="hs-identifier hs-var">unScope</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; Expr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Expr
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682004954"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lam"><span class="hs-identifier hs-type">A.Lam</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdLam"><span class="hs-identifier hs-type">A.AbsurdLam</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ExtendedLam"><span class="hs-identifier hs-type">A.ExtendedLam</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-527"></span><span class="annot"><span class="hs-comment">-- ** Dealing with infix declarations</span></span><span>
</span><span id="line-528"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-comment">-- | If a name is defined with a fixity that differs from the default, we have</span><span>
</span><span id="line-531"></span><span class="hs-comment">--   to generate a fixity declaration for that name.</span><span>
</span><span id="line-532"></span><span id="local-6989586621682002826"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-type">withInfixDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002826"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefInfo"><span class="hs-identifier hs-type">DefInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002826"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002826"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-533"></span><span id="withInfixDecl"><span class="annot"><span class="annottext">withInfixDecl :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; Name -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-var hs-var">withInfixDecl</span></a></span></span><span> </span><span id="local-6989586621682004969"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004969"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682004970"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004970"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682004971"><span class="annot"><span class="annottext">m [Declaration]
</span><a href="#local-6989586621682004971"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682004972"><span class="hs-identifier hs-var">fixDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682004973"><span class="hs-identifier hs-var">synDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [Declaration]
</span><a href="#local-6989586621682004971"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621682004972"><span class="annot"><span class="annottext">fixDecl :: [Declaration]
</span><a href="#local-6989586621682004972"><span class="hs-identifier hs-var hs-var">fixDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; List1 Name -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Infix"><span class="hs-identifier hs-var">C.Infix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity' -&gt; Fixity
</span><a href="Agda.Syntax.Common.html#theFixity"><span class="hs-identifier hs-var">theFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity' -&gt; Fixity) -&gt; Fixity' -&gt; Fixity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Fixity'
forall t. DefInfo' t -&gt; Fixity'
</span><a href="Agda.Syntax.Info.html#defFixity"><span class="hs-identifier hs-var">defFixity</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004969"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 Name -&gt; Declaration) -&gt; List1 Name -&gt; Declaration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; List1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004970"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-536"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Fixity
</span><a href="Agda.Syntax.Common.html#theFixity"><span class="hs-identifier hs-var">theFixity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; Fixity'
forall t. DefInfo' t -&gt; Fixity'
</span><a href="Agda.Syntax.Info.html#defFixity"><span class="hs-identifier hs-var">defFixity</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004969"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; Fixity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="Agda.Syntax.Common.html#noFixity"><span class="hs-identifier hs-var">noFixity</span></a></span><span>
</span><span id="line-537"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>  </span><span id="local-6989586621682004973"><span class="annot"><span class="annottext">synDecl :: [Declaration]
</span><a href="#local-6989586621682004973"><span class="hs-identifier hs-var hs-var">synDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Notation -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Syntax"><span class="hs-identifier hs-var">C.Syntax</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682004970"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Notation -&gt; Declaration) -&gt; Notation -&gt; Declaration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Notation
</span><a href="Agda.Syntax.Common.html#theNotation"><span class="hs-identifier hs-var">theNotation</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity' -&gt; Notation) -&gt; Fixity' -&gt; Notation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Fixity'
forall t. DefInfo' t -&gt; Fixity'
</span><a href="Agda.Syntax.Info.html#defFixity"><span class="hs-identifier hs-var">defFixity</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004969"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-541"></span><span class="annot"><span class="hs-comment">-- ** Dealing with private definitions</span></span><span>
</span><span id="line-542"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="annot"><span class="hs-comment">-- | Add @abstract@, @private@, @instance@ modifiers.</span></span><span>
</span><span id="line-545"></span><span id="local-6989586621682002835"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-type">withAbstractPrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002835"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefInfo"><span class="hs-identifier hs-type">DefInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002835"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002835"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-546"></span><span id="withAbstractPrivate"><span class="annot"><span class="annottext">withAbstractPrivate :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var hs-var">withAbstractPrivate</span></a></span></span><span> </span><span id="local-6989586621682004986"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004986"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682004987"><span class="annot"><span class="annottext">m [Declaration]
</span><a href="#local-6989586621682004987"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="annottext">Access -&gt; [Declaration] -&gt; [Declaration]
</span><a href="#local-6989586621682004988"><span class="hs-identifier hs-var">priv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; Access
forall t. DefInfo' t -&gt; Access
</span><a href="Agda.Syntax.Info.html#defAccess"><span class="hs-identifier hs-var">defAccess</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004986"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>      </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; ([Declaration] -&gt; [Declaration])
-&gt; [Declaration]
-&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IsAbstract -&gt; [Declaration] -&gt; [Declaration]
</span><a href="#local-6989586621682004990"><span class="hs-identifier hs-var">abst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; IsAbstract
forall t. DefInfo' t -&gt; IsAbstract
</span><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">A.defAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004986"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; ([Declaration] -&gt; [Declaration])
-&gt; [Declaration]
-&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe KwRange -&gt; [Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-var">addInstanceB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; IsInstance
forall t. DefInfo' t -&gt; IsInstance
</span><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">A.defInstance</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682004986"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InstanceDef"><span class="hs-identifier hs-type">InstanceDef</span></a></span><span> </span><span id="local-6989586621682004995"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682004995"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Maybe KwRange
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682004995"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe KwRange
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [Declaration]
</span><a href="#local-6989586621682004987"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-552"></span><span>        </span><span id="local-6989586621682004988"><span class="annot"><span class="annottext">priv :: Access -&gt; [Declaration] -&gt; [Declaration]
</span><a href="#local-6989586621682004988"><span class="hs-identifier hs-var hs-var">priv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#PrivateAccess"><span class="hs-identifier hs-type">PrivateAccess</span></a></span><span> </span><span id="local-6989586621682004998"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682004998"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>                         </span><span id="local-6989586621682005000"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005000"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Origin -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Private"><span class="hs-identifier hs-var">C.Private</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682004998"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005000"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-554"></span><span>        </span><span class="annot"><a href="#local-6989586621682004988"><span class="hs-identifier hs-var">priv</span></a></span><span> </span><span class="annot"><span class="annottext">Access
</span><span class="hs-identifier">_</span></span><span>           </span><span id="local-6989586621682005002"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005002"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005002"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621682004990"><span class="annot"><span class="annottext">abst :: IsAbstract -&gt; [Declaration] -&gt; [Declaration]
</span><a href="#local-6989586621682004990"><span class="hs-identifier hs-var hs-var">abst</span></a></span></span><span> </span><span class="annot"><span class="annottext">IsAbstract
</span><a href="Agda.Syntax.Common.html#AbstractDef"><span class="hs-identifier hs-var">AbstractDef</span></a></span><span> </span><span id="local-6989586621682005006"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005006"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Abstract"><span class="hs-identifier hs-var">C.Abstract</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005006"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-556"></span><span>        </span><span class="annot"><a href="#local-6989586621682004990"><span class="hs-identifier hs-var">abst</span></a></span><span> </span><span class="annot"><span class="annottext">IsAbstract
</span><a href="Agda.Syntax.Common.html#ConcreteDef"><span class="hs-identifier hs-var">ConcreteDef</span></a></span><span> </span><span id="local-6989586621682005009"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005009"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005009"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-type">addInstanceB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.KeywordRange.html#KwRange"><span class="hs-identifier hs-type">KwRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span id="addInstanceB"><span class="annot"><span class="annottext">addInstanceB :: Maybe KwRange -&gt; [Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-var hs-var">addInstanceB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682005010"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682005010"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005011"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005011"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#InstanceB"><span class="hs-identifier hs-var">C.InstanceB</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682005010"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005011"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-var">addInstanceB</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe KwRange
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621682005013"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005013"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682005013"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-563"></span><span class="annot"><span class="hs-comment">-- * The To Concrete Class</span></span><span>
</span><span id="line-564"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-keyword">class</span><span> </span><span id="ToConcrete"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-var">ToConcrete</span></a></span></span><span> </span><span id="local-6989586621682002335"><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span id="local-6989586621682002335"><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-568"></span><span>    </span><span id="toConcrete"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682002336"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002336"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002336"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-569"></span><span>    </span><span id="bindToConcrete"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682002373"><span id="local-6989586621682002374"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002373"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002373"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002374"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002373"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002374"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-comment">-- Christian Sattler, 2017-08-05:</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-comment">-- These default implementations are not valid semantically (at least</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-comment">-- the second one). Perhaps they (it) should be removed.</span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621682005015"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var">toConcrete</span></a></span><span>     </span><span id="local-6989586621682005022"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005022"><span class="hs-identifier hs-var">x</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m (ConOfAbs a)) -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005022"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a -&gt; m (ConOfAbs a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span></span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621682005023"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var">bindToConcrete</span></a></span><span> </span><span id="local-6989586621682005030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005030"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682005031"><span class="annot"><span class="annottext">ConOfAbs a -&gt; m b
</span><a href="#local-6989586621682005031"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConOfAbs a -&gt; m b
</span><a href="#local-6989586621682005031"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a -&gt; m b) -&gt; m (ConOfAbs a) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005030"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-pragma hs-type">toConcrete</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-pragma hs-type">bindToConcrete</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="annot"><span class="hs-comment">-- | Translate something in a context of the given precedence.</span></span><span>
</span><span id="line-580"></span><span id="local-6989586621682002847"><span id="local-6989586621682002848"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#Precedence"><span class="hs-identifier hs-type">Precedence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-581"></span><span id="toConcreteCtx"><span class="annot"><span class="annottext">toConcreteCtx :: forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var hs-var">toConcreteCtx</span></a></span></span><span> </span><span id="local-6989586621682005037"><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682005037"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682005038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005038"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Precedence -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-var">withPrecedence</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682005037"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ConOfAbs a) -&gt; m (ConOfAbs a))
-&gt; m (ConOfAbs a) -&gt; m (ConOfAbs a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005038"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="annot"><span class="hs-comment">-- | Translate something in a context of the given precedence.</span></span><span>
</span><span id="line-584"></span><span id="local-6989586621682002851"><span id="local-6989586621682002852"><span id="local-6989586621682002853"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteCtx"><span class="hs-identifier hs-type">bindToConcreteCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002851"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#Precedence"><span class="hs-identifier hs-type">Precedence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002851"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002853"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002851"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002853"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-585"></span><span id="bindToConcreteCtx"><span class="annot"><span class="annottext">bindToConcreteCtx :: forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteCtx"><span class="hs-identifier hs-var hs-var">bindToConcreteCtx</span></a></span></span><span> </span><span id="local-6989586621682005045"><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682005045"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682005046"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682005047"><span class="annot"><span class="annottext">ConOfAbs a -&gt; m b
</span><a href="#local-6989586621682005047"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Precedence -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-var">withPrecedence</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682005045"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(m b -&gt; m b) -&gt; m b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005046"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a -&gt; m b
</span><a href="#local-6989586621682005047"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="annot"><span class="hs-comment">-- | Translate something in the top context.</span></span><span>
</span><span id="line-588"></span><span id="local-6989586621682002857"><span id="local-6989586621682002858"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-589"></span><span id="toConcreteTop"><span class="annot"><span class="annottext">toConcreteTop :: forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var hs-var">toConcreteTop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#TopCtx"><span class="hs-identifier hs-var">TopCtx</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="annot"><span class="hs-comment">-- | Translate something in the top context.</span></span><span>
</span><span id="line-592"></span><span id="local-6989586621682002861"><span id="local-6989586621682002862"><span id="local-6989586621682002863"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteTop"><span class="hs-identifier hs-type">bindToConcreteTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002861"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002861"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002863"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002861"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002863"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-593"></span><span id="bindToConcreteTop"><span class="annot"><span class="annottext">bindToConcreteTop :: forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteTop"><span class="hs-identifier hs-var hs-var">bindToConcreteTop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteCtx"><span class="hs-identifier hs-var">bindToConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#TopCtx"><span class="hs-identifier hs-var">TopCtx</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="annot"><span class="hs-comment">-- | Translate something in a context indicated by 'Hiding' info.</span></span><span>
</span><span id="line-596"></span><span id="local-6989586621682002363"><span id="local-6989586621682002364"><span id="local-6989586621682002365"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteHiding"><span class="hs-identifier hs-type">toConcreteHiding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002363"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensHiding"><span class="hs-identifier hs-type">LensHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002364"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002365"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002364"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002365"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002363"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002365"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-597"></span><span id="toConcreteHiding"><span class="annot"><span class="annottext">toConcreteHiding :: forall (m :: * -&gt; *) h a.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteHiding"><span class="hs-identifier hs-var hs-var">toConcreteHiding</span></a></span></span><span> </span><span id="local-6989586621682005069"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621682005069"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">h -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621682005069"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-var">NotHidden</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#Hidden"><span class="hs-identifier hs-var">Hidden</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Instance"><span class="hs-identifier hs-type">Instance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="annot"><span class="hs-comment">-- | Translate something in a context indicated by 'Hiding' info.</span></span><span>
</span><span id="line-604"></span><span id="local-6989586621682002872"><span id="local-6989586621682002873"><span id="local-6989586621682002874"><span id="local-6989586621682002875"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteHiding"><span class="hs-identifier hs-type">bindToConcreteHiding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensHiding"><span class="hs-identifier hs-type">LensHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002873"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002873"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002874"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002874"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002875"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682002872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002875"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-605"></span><span id="bindToConcreteHiding"><span class="annot"><span class="annottext">bindToConcreteHiding :: forall (m :: * -&gt; *) h a b.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteHiding"><span class="hs-identifier hs-var hs-var">bindToConcreteHiding</span></a></span></span><span> </span><span id="local-6989586621682005085"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621682005085"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">h -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621682005085"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-607"></span><span>    </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-var">NotHidden</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span>
</span><span id="line-608"></span><span>    </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#Hidden"><span class="hs-identifier hs-var">Hidden</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteTop"><span class="hs-identifier hs-var">bindToConcreteTop</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Instance"><span class="hs-identifier hs-type">Instance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteTop"><span class="hs-identifier hs-var">bindToConcreteTop</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- Base type instances ------------------------------------------------------</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005088"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>  </span><span id="local-6989586621682005099"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; () -&gt; m (ConOfAbs ())
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
() -&gt; m (ConOfAbs ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005102"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-619"></span><span>  </span><span id="local-6989586621682005112"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Bool -&gt; m (ConOfAbs Bool)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
Bool -&gt; m (ConOfAbs Bool)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005115"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-623"></span><span>  </span><span id="local-6989586621682005125"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Char -&gt; m (ConOfAbs Char)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; m Char
Char -&gt; m (ConOfAbs Char)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005128"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span>
</span><span id="line-627"></span><span>  </span><span id="local-6989586621682005138"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Name -&gt; m (ConOfAbs Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
Name -&gt; m (ConOfAbs Name)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">-- Functors ---------------------------------------------------------------</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002371"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002371"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682002371"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682002371"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002371"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621682005149"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; [a] -&gt; m (ConOfAbs [a])
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a)) -&gt; [a] -&gt; m [ConOfAbs a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621682005154"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[a] -&gt; (ConOfAbs [a] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621682005155"><span class="annot"><span class="annottext">ConOfAbs [a] -&gt; m b
</span><a href="#local-6989586621682005155"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConOfAbs [a] -&gt; m b
</span><a href="#local-6989586621682005155"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-636"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005156"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682005157"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682005157"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005158"><span class="annot"><span class="annottext">ConOfAbs [a] -&gt; m b
</span><a href="#local-6989586621682005158"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty a -&gt; (ConOfAbs (NonEmpty a) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
NonEmpty a -&gt; (ConOfAbs (NonEmpty a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005156"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; NonEmpty a
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682005157"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (NonEmpty a) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (NonEmpty a) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005159"><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005159"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621682005160"><span class="annot"><span class="annottext">[ConOfAbs a]
</span><a href="#local-6989586621682005160"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs [a] -&gt; m b
</span><a href="#local-6989586621682005158"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005159"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">ConOfAbs a -&gt; [ConOfAbs a] -&gt; [ConOfAbs a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ConOfAbs a]
</span><a href="#local-6989586621682005160"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002891"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>    </span><span id="local-6989586621682005172"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
List1 a -&gt; m (ConOfAbs (List1 a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a)) -&gt; List1 a -&gt; m (NonEmpty (ConOfAbs a))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">-- Andreas, 2017-04-11, Issue #2543</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-comment">-- The naive `thread'ing does not work as we have to undo</span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-comment">-- changes to the Precedence.</span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-comment">-- bindToConcrete = thread bindToConcrete</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621682005183"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
List1 a -&gt; (ConOfAbs (List1 a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005184"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005184"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621682005185"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682005185"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005186"><span class="annot"><span class="annottext">ConOfAbs (List1 a) -&gt; m b
</span><a href="#local-6989586621682005186"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>      </span><span id="local-6989586621682005187"><span class="annot"><a href="#local-6989586621682005187"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m PrecedenceStack
forall (m :: * -&gt; *). MonadToConcrete m =&gt; m PrecedenceStack
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentPrecedence"><span class="hs-identifier hs-var">currentPrecedence</span></a></span><span>  </span><span class="hs-comment">-- save precedence</span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005184"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682005188"><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005188"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
PrecedenceStack -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence%27"><span class="hs-identifier hs-var">withPrecedence'</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack
</span><a href="#local-6989586621682005187"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(m b -&gt; m b) -&gt; m b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- reset precedence</span><span>
</span><span id="line-650"></span><span>          </span><span class="annot"><span class="annottext">[a] -&gt; (ConOfAbs [a] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[a] -&gt; (ConOfAbs [a] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682005185"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [a] -&gt; m b) -&gt; m b) -&gt; (ConOfAbs [a] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682005189"><span class="annot"><span class="annottext">ConOfAbs [a]
</span><a href="#local-6989586621682005189"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-651"></span><span>            </span><span class="annot"><span class="annottext">ConOfAbs (List1 a) -&gt; m b
</span><a href="#local-6989586621682005186"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005188"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a -&gt; [ConOfAbs a] -&gt; NonEmpty (ConOfAbs a)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[ConOfAbs a]
ConOfAbs [a]
</span><a href="#local-6989586621682005189"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002899"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682002899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682002899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621682005203"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Maybe a -&gt; m (ConOfAbs (Maybe a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a)) -&gt; Maybe a -&gt; m (Maybe (ConOfAbs a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621682005208"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Maybe a -&gt; (ConOfAbs (Maybe a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682005209"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005209"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005210"><span class="annot"><span class="annottext">ConOfAbs (Maybe a) -&gt; m b
</span><a href="#local-6989586621682005210"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005209"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ConOfAbs a) -&gt; m b
ConOfAbs (Maybe a) -&gt; m b
</span><a href="#local-6989586621682005210"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs a -&gt; Maybe (ConOfAbs a)) -&gt; ConOfAbs a -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a -&gt; Maybe (ConOfAbs a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-657"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621682005211"><span class="annot"><span class="annottext">ConOfAbs (Maybe a) -&gt; m b
</span><a href="#local-6989586621682005211"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (Maybe a) -&gt; m b
</span><a href="#local-6989586621682005211"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ConOfAbs a)
ConOfAbs (Maybe a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">-- Bifunctors etc. --------------------------------------------------------</span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002908"><span id="local-6989586621682002909"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002908"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002909"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621682002908"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002909"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621682002908"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002909"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002908"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002909"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621682005226"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Either a1 a2 -&gt; m (ConOfAbs (Either a1 a2))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a1 -&gt; m (ConOfAbs a1))
-&gt; (a2 -&gt; m (ConOfAbs a2))
-&gt; Either a1 a2
-&gt; m (Either (ConOfAbs a1) (ConOfAbs a2))
forall (f :: * -&gt; *) a c b d.
Functor f =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; Either a b -&gt; f (Either c d)
</span><a href="Agda.Utils.Either.html#traverseEither"><span class="hs-identifier hs-var">traverseEither</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; m (ConOfAbs a1)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a1 -&gt; m (ConOfAbs a1)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a2 -&gt; m (ConOfAbs a2)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a2 -&gt; m (ConOfAbs a2)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621682005233"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Either a1 a2 -&gt; (ConOfAbs (Either a1 a2) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682005234"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005234"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005235"><span class="annot"><span class="annottext">ConOfAbs (Either a1 a2) -&gt; m b
</span><a href="#local-6989586621682005235"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>        </span><span class="annot"><span class="annottext">a1 -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a1 -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005234"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a1 -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682005236"><span class="annot"><span class="annottext">ConOfAbs a1
</span><a href="#local-6989586621682005236"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">ConOfAbs (Either a1 a2) -&gt; m b
</span><a href="#local-6989586621682005235"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConOfAbs a1 -&gt; Either (ConOfAbs a1) (ConOfAbs a2)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a1
</span><a href="#local-6989586621682005236"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682005237"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005237"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005238"><span class="annot"><span class="annottext">ConOfAbs (Either a1 a2) -&gt; m b
</span><a href="#local-6989586621682005238"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-669"></span><span>        </span><span class="annot"><span class="annottext">a2 -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a2 -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005237"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a2 -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682005239"><span class="annot"><span class="annottext">ConOfAbs a2
</span><a href="#local-6989586621682005239"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-670"></span><span>        </span><span class="annot"><span class="annottext">ConOfAbs (Either a1 a2) -&gt; m b
</span><a href="#local-6989586621682005238"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConOfAbs a2 -&gt; Either (ConOfAbs a1) (ConOfAbs a2)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a2
</span><a href="#local-6989586621682005239"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002922"><span id="local-6989586621682002923"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002922"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002923"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002922"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682002923"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002922"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682002923"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002922"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002923"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>    </span><span id="local-6989586621682005253"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(a1, a2) -&gt; m (ConOfAbs (a1, a2))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005254"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005254"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005255"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005255"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a1 -&gt; ConOfAbs a2 -&gt; (ConOfAbs a1, ConOfAbs a2))
-&gt; m (ConOfAbs a1)
-&gt; m (ConOfAbs a2)
-&gt; m (ConOfAbs a1, ConOfAbs a2)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a1 -&gt; m (ConOfAbs a1)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a1 -&gt; m (ConOfAbs a1)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005254"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a2 -&gt; m (ConOfAbs a2)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a2 -&gt; m (ConOfAbs a2)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005255"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621682005262"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
(a1, a2) -&gt; (ConOfAbs (a1, a2) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005263"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005263"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005264"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005264"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005265"><span class="annot"><span class="annottext">ConOfAbs (a1, a2) -&gt; m b
</span><a href="#local-6989586621682005265"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-677"></span><span>        </span><span class="annot"><span class="annottext">a1 -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a1 -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005263"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a1 -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a1 -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682005266"><span class="annot"><span class="annottext">ConOfAbs a1
</span><a href="#local-6989586621682005266"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-678"></span><span>        </span><span class="annot"><span class="annottext">a2 -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a2 -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005264"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a2 -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a2 -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682005267"><span class="annot"><span class="annottext">ConOfAbs a2
</span><a href="#local-6989586621682005267"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>        </span><span class="annot"><span class="annottext">ConOfAbs (a1, a2) -&gt; m b
</span><a href="#local-6989586621682005265"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConOfAbs a1
</span><a href="#local-6989586621682005266"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ConOfAbs a2
</span><a href="#local-6989586621682005267"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002934"><span id="local-6989586621682002935"><span id="local-6989586621682002936"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002934"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002935"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002936"><span class="hs-identifier hs-type">a3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002934"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682002935"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682002936"><span class="hs-identifier hs-type">a3</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682002934"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682002935"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682002936"><span class="hs-identifier hs-type">a3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002934"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002935"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002936"><span class="hs-identifier hs-type">a3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621682005282"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(a1, a2, a3) -&gt; m (ConOfAbs (a1, a2, a3))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005283"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005283"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005284"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005284"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005285"><span class="annot"><span class="annottext">a3
</span><a href="#local-6989586621682005285"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a1, (ConOfAbs a2, ConOfAbs a3))
-&gt; (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3)
forall {a} {b} {c}. (a, (b, c)) -&gt; (a, b, c)
</span><a href="#local-6989586621682005286"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a1, (ConOfAbs a2, ConOfAbs a3))
 -&gt; (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3))
-&gt; m (ConOfAbs a1, (ConOfAbs a2, ConOfAbs a3))
-&gt; m (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a1, (a2, a3)) -&gt; m (ConOfAbs (a1, (a2, a3)))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(a1, (a2, a3)) -&gt; m (ConOfAbs (a1, (a2, a3)))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005283"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005284"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a3
</span><a href="#local-6989586621682005285"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-686"></span><span>            </span><span id="local-6989586621682005286"><span class="annot"><span class="annottext">reorder :: (a, (b, c)) -&gt; (a, b, c)
</span><a href="#local-6989586621682005286"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005287"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005287"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621682005288"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682005288"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005289"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682005289"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005287"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682005288"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682005289"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621682005294"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
(a1, a2, a3) -&gt; (ConOfAbs (a1, a2, a3) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005295"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005295"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005296"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005296"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005297"><span class="annot"><span class="annottext">a3
</span><a href="#local-6989586621682005297"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005298"><span class="annot"><span class="annottext">ConOfAbs (a1, a2, a3) -&gt; m b
</span><a href="#local-6989586621682005298"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a1, (a2, a3)) -&gt; (ConOfAbs (a1, (a2, a3)) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
(a1, (a2, a3)) -&gt; (ConOfAbs (a1, (a2, a3)) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682005295"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682005296"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a3
</span><a href="#local-6989586621682005297"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (a1, (a2, a3)) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (a1, (a2, a3)) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a1, ConOfAbs a2, ConOfAbs a3) -&gt; m b
ConOfAbs (a1, a2, a3) -&gt; m b
</span><a href="#local-6989586621682005298"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a1, ConOfAbs a2, ConOfAbs a3) -&gt; m b)
-&gt; (ConOfAbs (a1, (a2, a3))
    -&gt; (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3))
-&gt; ConOfAbs (a1, (a2, a3))
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a1, (ConOfAbs a2, ConOfAbs a3))
-&gt; (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3)
ConOfAbs (a1, (a2, a3)) -&gt; (ConOfAbs a1, ConOfAbs a2, ConOfAbs a3)
forall {a} {b} {c}. (a, (b, c)) -&gt; (a, b, c)
</span><a href="#local-6989586621682005299"><span class="hs-identifier hs-var">reorder</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>            </span><span id="local-6989586621682005299"><span class="annot"><span class="annottext">reorder :: (a, (b, c)) -&gt; (a, b, c)
</span><a href="#local-6989586621682005299"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682005300"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005300"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621682005301"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682005301"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682005302"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682005302"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005300"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682005301"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682005302"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-comment">-- Decorations ------------------------------------------------------------</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002947"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span>    </span><span id="local-6989586621682005316"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Arg a -&gt; m (ConOfAbs (Arg a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682005318"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005318"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005319"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005319"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; ConOfAbs a -&gt; Arg (ConOfAbs a)
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005318"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a -&gt; Arg (ConOfAbs a))
-&gt; m (ConOfAbs a) -&gt; m (Arg (ConOfAbs a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) h a.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteHiding"><span class="hs-identifier hs-var">toConcreteHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005318"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005319"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621682005324"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Arg a -&gt; (ConOfAbs (Arg a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682005325"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005325"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682005326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005326"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005327"><span class="annot"><span class="annottext">ConOfAbs (Arg a) -&gt; m b
</span><a href="#local-6989586621682005327"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><span class="annottext">ArgInfo -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) h a b.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteHiding"><span class="hs-identifier hs-var">bindToConcreteHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005325"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005326"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg (ConOfAbs a) -&gt; m b
ConOfAbs (Arg a) -&gt; m b
</span><a href="#local-6989586621682005327"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs a -&gt; Arg (ConOfAbs a)) -&gt; ConOfAbs a -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; ConOfAbs a -&gt; Arg (ConOfAbs a)
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682005325"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002955"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span>  </span><span id="local-6989586621682005341"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
WithHiding a -&gt; m (ConOfAbs (WithHiding a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span id="local-6989586621682005343"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005343"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682005344"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005344"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; ConOfAbs a -&gt; WithHiding (ConOfAbs a)
forall a. Hiding -&gt; a -&gt; WithHiding a
</span><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-var">WithHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005343"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs a -&gt; WithHiding (ConOfAbs a))
-&gt; m (ConOfAbs a) -&gt; m (WithHiding (ConOfAbs a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) h a.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteHiding"><span class="hs-identifier hs-var">toConcreteHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005343"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005344"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span id="local-6989586621682005349"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
WithHiding a -&gt; (ConOfAbs (WithHiding a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span id="local-6989586621682005350"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005350"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682005351"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005351"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005352"><span class="annot"><span class="annottext">ConOfAbs (WithHiding a) -&gt; m b
</span><a href="#local-6989586621682005352"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) h a b.
(MonadToConcrete m, LensHiding h, ToConcrete a) =&gt;
h -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteHiding"><span class="hs-identifier hs-var">bindToConcreteHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005350"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005351"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682005353"><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005353"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><span class="annottext">ConOfAbs (WithHiding a) -&gt; m b
</span><a href="#local-6989586621682005352"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs (WithHiding a) -&gt; m b) -&gt; ConOfAbs (WithHiding a) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; ConOfAbs a -&gt; WithHiding (ConOfAbs a)
forall a. Hiding -&gt; a -&gt; WithHiding a
</span><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-var">WithHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005350"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682005353"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002962"><span id="local-6989586621682002963"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002963"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-710"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002963"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002963"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>    </span><span id="local-6989586621682005367"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Named name a -&gt; m (ConOfAbs (Named name a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a))
-&gt; Named name a -&gt; m (Named name (ConOfAbs a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Named name a -&gt; f (Named name b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621682005371"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Named name a -&gt; (ConOfAbs (Named name a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621682005373"><span class="annot"><span class="annottext">Maybe name
</span><a href="#local-6989586621682005373"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682005374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005374"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005375"><span class="annot"><span class="annottext">ConOfAbs (Named name a) -&gt; m b
</span><a href="#local-6989586621682005375"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005374"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Named name (ConOfAbs a) -&gt; m b
ConOfAbs (Named name a) -&gt; m b
</span><a href="#local-6989586621682005375"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Named name (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs a -&gt; Named name (ConOfAbs a)) -&gt; ConOfAbs a -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe name -&gt; ConOfAbs a -&gt; Named name (ConOfAbs a)
forall name a. Maybe name -&gt; a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe name
</span><a href="#local-6989586621682005373"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002972"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621682005389"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Ranged a -&gt; m (ConOfAbs (Ranged a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a)) -&gt; Ranged a -&gt; m (Ranged (ConOfAbs a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Ranged a -&gt; f (Ranged b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span id="local-6989586621682005393"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Ranged a -&gt; (ConOfAbs (Ranged a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span id="local-6989586621682005395"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682005395"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682005396"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005396"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005397"><span class="annot"><span class="annottext">ConOfAbs (Ranged a) -&gt; m b
</span><a href="#local-6989586621682005397"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005396"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ranged (ConOfAbs a) -&gt; m b
ConOfAbs (Ranged a) -&gt; m b
</span><a href="#local-6989586621682005397"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Ranged (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs a -&gt; Ranged (ConOfAbs a)) -&gt; ConOfAbs a -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; ConOfAbs a -&gt; Ranged (ConOfAbs a)
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682005395"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">-- Christian Sattler, 2017-08-05, fixing #2669</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- Both methods of ToConcrete (FieldAssignment' a) need</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- to be implemented, each in terms of the corresponding one of ToConcrete a.</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- This mirrors the instance ToConcrete (Ranged a).</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- The default implementations of ToConcrete are not valid semantically.</span><span>
</span><span id="line-724"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002979"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002979"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment%27"><span class="hs-identifier hs-type">FieldAssignment'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002979"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-725"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment%27"><span class="hs-identifier hs-type">FieldAssignment'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002979"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment%27"><span class="hs-identifier hs-type">FieldAssignment'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002979"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>    </span><span id="local-6989586621682005411"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
FieldAssignment' a -&gt; m (ConOfAbs (FieldAssignment' a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a))
-&gt; FieldAssignment' a -&gt; m (FieldAssignment' (ConOfAbs a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; FieldAssignment' a -&gt; f (FieldAssignment' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621682005415"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
FieldAssignment' a -&gt; (ConOfAbs (FieldAssignment' a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment"><span class="hs-identifier hs-type">FieldAssignment</span></a></span><span> </span><span id="local-6989586621682005417"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005417"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682005418"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005418"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005419"><span class="annot"><span class="annottext">ConOfAbs (FieldAssignment' a) -&gt; m b
</span><a href="#local-6989586621682005419"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005418"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldAssignment' (ConOfAbs a) -&gt; m b
ConOfAbs (FieldAssignment' a) -&gt; m b
</span><a href="#local-6989586621682005419"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldAssignment' (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs a -&gt; FieldAssignment' (ConOfAbs a))
-&gt; ConOfAbs a
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConOfAbs a -&gt; FieldAssignment' (ConOfAbs a)
forall a. Name -&gt; a -&gt; FieldAssignment' a
</span><a href="Agda.Syntax.Concrete.html#FieldAssignment"><span class="hs-identifier hs-var">FieldAssignment</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005417"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span class="hs-comment">-- Newtypes ---------------------------------------------------------------</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- Deriving this requires UndecidableInstances,</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- as TacticAttribute' is not larger than its expansion (Maybe . Ranged).</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- (Also the derived instance produce a type error.)</span><span>
</span><span id="line-736"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682002986"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute%27"><span class="hs-identifier hs-type">TacticAttribute'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute%27"><span class="hs-identifier hs-type">TacticAttribute'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute%27"><span class="hs-identifier hs-type">TacticAttribute'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682002986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>  </span><span id="local-6989586621682005433"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
TacticAttribute' a -&gt; m (ConOfAbs (TacticAttribute' a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a))
-&gt; TacticAttribute' a -&gt; m (TacticAttribute' (ConOfAbs a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; TacticAttribute' a -&gt; f (TacticAttribute' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span>
</span><span id="line-739"></span><span>  </span><span id="local-6989586621682005438"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
TacticAttribute' a -&gt; (ConOfAbs (TacticAttribute' a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute"><span class="hs-identifier hs-type">TacticAttribute</span></a></span><span> </span><span id="local-6989586621682005440"><span class="annot"><span class="annottext">Maybe (Ranged a)
</span><a href="#local-6989586621682005440"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005441"><span class="annot"><span class="annottext">ConOfAbs (TacticAttribute' a) -&gt; m b
</span><a href="#local-6989586621682005441"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged a) -&gt; (ConOfAbs (Maybe (Ranged a)) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Maybe (Ranged a) -&gt; (ConOfAbs (Maybe (Ranged a)) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged a)
</span><a href="#local-6989586621682005440"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (Maybe (Ranged a)) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (Maybe (Ranged a)) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TacticAttribute' (ConOfAbs a) -&gt; m b
ConOfAbs (TacticAttribute' a) -&gt; m b
</span><a href="#local-6989586621682005441"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(TacticAttribute' (ConOfAbs a) -&gt; m b)
-&gt; (ConOfAbs (Maybe (Ranged a)) -&gt; TacticAttribute' (ConOfAbs a))
-&gt; ConOfAbs (Maybe (Ranged a))
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged (ConOfAbs a)) -&gt; TacticAttribute' (ConOfAbs a)
ConOfAbs (Maybe (Ranged a)) -&gt; TacticAttribute' (ConOfAbs a)
forall a. Maybe (Ranged a) -&gt; TacticAttribute' a
</span><a href="Agda.Syntax.Concrete.html#TacticAttribute"><span class="hs-identifier hs-var">TacticAttribute</span></a></span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="hs-comment">-- Names ------------------------------------------------------------------</span><span>
</span><span id="line-742"></span><span>
</span><span id="line-743"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span>  </span><span id="local-6989586621682005447"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Name -&gt; m (ConOfAbs Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
Name -&gt; m (ConOfAbs Name)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var">toConcreteName</span></a></span><span>
</span><span id="line-747"></span><span>  </span><span id="local-6989586621682005450"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Name -&gt; (ConOfAbs Name -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span id="local-6989586621682005451"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005451"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (Name -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Name -&gt; (Name -&gt; m a) -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName"><span class="hs-identifier hs-var">bindName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005451"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-748"></span><span>
</span><span id="line-749"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">BindName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">BindName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#BoundName"><span class="hs-identifier hs-type">C.BoundName</span></a></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span>  </span><span id="local-6989586621682005461"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
BindName -&gt; m (ConOfAbs BindName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; BoundName) -&gt; m Name -&gt; m BoundName
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; BoundName
</span><a href="Agda.Syntax.Concrete.html#mkBoundName_"><span class="hs-identifier hs-var">C.mkBoundName_</span></a></span><span> </span><span class="annot"><span class="annottext">(m Name -&gt; m BoundName)
-&gt; (BindName -&gt; m Name) -&gt; BindName -&gt; m BoundName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var">toConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Name) -&gt; (BindName -&gt; Name) -&gt; BindName -&gt; m Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span>
</span><span id="line-753"></span><span>  </span><span id="local-6989586621682005466"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindName -&gt; (ConOfAbs BindName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span id="local-6989586621682005467"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682005467"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (Name -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Name -&gt; (Name -&gt; m a) -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName"><span class="hs-identifier hs-var">bindName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682005467"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Name -&gt; m b) -&gt; m b)
-&gt; ((BoundName -&gt; m b) -&gt; Name -&gt; m b) -&gt; (BoundName -&gt; m b) -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BoundName -&gt; m b) -&gt; (Name -&gt; BoundName) -&gt; Name -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; BoundName
</span><a href="Agda.Syntax.Concrete.html#mkBoundName_"><span class="hs-identifier hs-var">C.mkBoundName_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005470"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621682005477"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; m QName
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="Agda.Syntax.Scope.Base.html#AmbiguousConProjs"><span class="hs-identifier hs-var">AmbiguousConProjs</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005481"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">A.ModuleName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">A.ModuleName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span>
</span><span id="line-762"></span><span>  </span><span id="local-6989586621682005488"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m QName
ModuleName -&gt; m (ConOfAbs ModuleName)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; ModuleName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupModule"><span class="hs-identifier hs-var">lookupModule</span></a></span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005491"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AbstractName"><span class="hs-identifier hs-type">AbstractName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-765"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AbstractName"><span class="hs-identifier hs-type">AbstractName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span id="local-6989586621682005499"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AbstractName -&gt; m (ConOfAbs AbstractName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m QName)
-&gt; (AbstractName -&gt; QName) -&gt; AbstractName -&gt; m QName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#anameName"><span class="hs-identifier hs-var">anameName</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="annot"><span class="hs-comment">-- | Assumes name is not 'UnknownName'.</span></span><span>
</span><span id="line-769"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005503"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ResolvedName"><span class="hs-identifier hs-type">ResolvedName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ResolvedName"><span class="hs-identifier hs-type">ResolvedName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>  </span><span id="local-6989586621682005526"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ResolvedName -&gt; m (ConOfAbs ResolvedName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-773"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span id="local-6989586621682005528"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005528"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">BindingSource
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; m Name -&gt; m QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m (ConOfAbs Name)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Name -&gt; m (ConOfAbs Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005528"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-774"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#DefinedName"><span class="hs-identifier hs-type">DefinedName</span></a></span><span> </span><span class="annot"><span class="annottext">Access
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682005530"><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682005530"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682005531"><span class="annot"><span class="annottext">Suffix
</span><a href="#local-6989586621682005531"><span class="hs-identifier hs-var">s</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Suffix -&gt; m QName -&gt; m QName
forall (m :: * -&gt; *). HasOptions m =&gt; Suffix -&gt; m QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete"><span class="hs-identifier hs-var">addSuffixConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Suffix
</span><a href="#local-6989586621682005531"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(m QName -&gt; m QName) -&gt; m QName -&gt; m QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; m (ConOfAbs AbstractName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AbstractName -&gt; m (ConOfAbs AbstractName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682005530"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-775"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621682005534"><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005534"><span class="hs-identifier hs-var">xs</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; m (ConOfAbs AbstractName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AbstractName -&gt; m (ConOfAbs AbstractName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 AbstractName -&gt; AbstractName
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005534"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ConstructorName"><span class="hs-identifier hs-type">ConstructorName</span></a></span><span> </span><span class="annot"><span class="annottext">Set1 Induction
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682005537"><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005537"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; m (ConOfAbs AbstractName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AbstractName -&gt; m (ConOfAbs AbstractName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 AbstractName -&gt; AbstractName
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005537"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#PatternSynResName"><span class="hs-identifier hs-type">PatternSynResName</span></a></span><span> </span><span id="local-6989586621682005539"><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005539"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; m (ConOfAbs AbstractName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AbstractName -&gt; m (ConOfAbs AbstractName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 AbstractName -&gt; AbstractName
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">List1 AbstractName
</span><a href="#local-6989586621682005539"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><span class="annottext">ResolvedName
</span><a href="Agda.Syntax.Scope.Base.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m QName
m (ConOfAbs ResolvedName)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span id="local-6989586621682003007"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete"><span class="hs-identifier hs-type">addSuffixConcrete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-type">HasOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Suffix"><span class="hs-identifier hs-type">A.Suffix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span></span><span>
</span><span id="line-781"></span><span id="addSuffixConcrete"><span class="annot"><span class="annottext">addSuffixConcrete :: forall (m :: * -&gt; *). HasOptions m =&gt; Suffix -&gt; m QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete"><span class="hs-identifier hs-var hs-var">addSuffixConcrete</span></a></span></span><span> </span><span class="annot"><span class="annottext">Suffix
</span><a href="Agda.Syntax.Abstract.Name.html#NoSuffix"><span class="hs-identifier hs-var">A.NoSuffix</span></a></span><span> </span><span id="local-6989586621682005548"><span class="annot"><span class="annottext">m QName
</span><a href="#local-6989586621682005548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m QName
</span><a href="#local-6989586621682005548"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-782"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete"><span class="hs-identifier hs-var">addSuffixConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Suffix"><span class="hs-identifier hs-type">A.Suffix</span></a></span><span> </span><span id="local-6989586621682005550"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005550"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682005551"><span class="annot"><span class="annottext">m QName
</span><a href="#local-6989586621682005551"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>  </span><span id="local-6989586621682005552"><span class="annot"><a href="#local-6989586621682005552"><span class="hs-identifier hs-var">glyphMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; UnicodeOrAscii
</span><a href="Agda.Interaction.Options.Base.html#optUseUnicode"><span class="hs-identifier hs-var">optUseUnicode</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; UnicodeOrAscii)
-&gt; m PragmaOptions -&gt; m UnicodeOrAscii
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete%27"><span class="hs-identifier hs-type">addSuffixConcrete'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005552"><span class="hs-identifier hs-type">glyphMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005550"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682005551"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete%27"><span class="hs-identifier hs-type">addSuffixConcrete'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Glyph.html#UnicodeOrAscii"><span class="hs-identifier hs-type">UnicodeOrAscii</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span>
</span><span id="line-787"></span><span id="addSuffixConcrete%27"><span class="annot"><span class="annottext">addSuffixConcrete' :: UnicodeOrAscii -&gt; Integer -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete%27"><span class="hs-identifier hs-var hs-var">addSuffixConcrete'</span></a></span></span><span> </span><span id="local-6989586621682005554"><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="#local-6989586621682005554"><span class="hs-identifier hs-var">glyphMode</span></a></span></span><span> </span><span id="local-6989586621682005555"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005555"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' QName (Maybe Suffix) -&gt; LensSet QName (Maybe Suffix)
forall o i. Lens' o i -&gt; LensSet o i
</span><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; f Name) -&gt; QName -&gt; f QName
Lens' QName Name
</span><a href="Agda.Syntax.Concrete.Name.html#lensQNameName"><span class="hs-identifier hs-var">C.lensQNameName</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; f Name) -&gt; QName -&gt; f QName)
-&gt; ((Maybe Suffix -&gt; f (Maybe Suffix)) -&gt; Name -&gt; f Name)
-&gt; (Maybe Suffix -&gt; f (Maybe Suffix))
-&gt; QName
-&gt; f QName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Suffix -&gt; f (Maybe Suffix)) -&gt; Name -&gt; f Name
Lens' Name (Maybe Suffix)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffix"><span class="hs-identifier hs-var">nameSuffix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Suffix
</span><a href="#local-6989586621682005562"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-789"></span><span>    </span><span id="local-6989586621682005562"><span class="annot"><span class="annottext">suffix :: Maybe Suffix
</span><a href="#local-6989586621682005562"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Suffix -&gt; Maybe Suffix
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Suffix -&gt; Maybe Suffix) -&gt; Suffix -&gt; Maybe Suffix
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="#local-6989586621682005554"><span class="hs-identifier hs-var">glyphMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-790"></span><span>      </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="Agda.Syntax.Concrete.Glyph.html#UnicodeOk"><span class="hs-identifier hs-var">UnicodeOk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Suffix
</span><a href="Agda.Utils.Suffix.html#Subscript"><span class="hs-identifier hs-var">Subscript</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Suffix) -&gt; Integer -&gt; Suffix
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005555"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="annot"><span class="annottext">UnicodeOrAscii
</span><a href="Agda.Syntax.Concrete.Glyph.html#AsciiOnly"><span class="hs-identifier hs-var">AsciiOnly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Suffix
</span><a href="Agda.Utils.Suffix.html#Index"><span class="hs-identifier hs-var">Index</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Suffix) -&gt; Integer -&gt; Suffix
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005555"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- Expression instance ----------------------------------------------------</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-keyword">class</span><span> </span><span id="NameAspects"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NameAspects"><span class="hs-identifier hs-var">NameAspects</span></a></span></span><span> </span><span id="local-6989586621682003019"><span class="annot"><a href="#local-6989586621682003019"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-comment">-- | Wrap the given 'Asp.NameKind' into an 'Asp.Aspects' which</span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-comment">-- contains extra information generically derived (e.g. binding site)</span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-comment">-- from the name.</span><span>
</span><span id="line-799"></span><span>  </span><span id="nameAspects"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-type">nameAspects</span></a></span></span><span>
</span><span id="line-800"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Is this an operator part?</span></span><span>
</span><span id="line-801"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#NameKind"><span class="hs-identifier hs-type">Asp.NameKind</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Specific syntax-highlighting information</span></span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003019"><span class="hs-identifier hs-type">a</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ The name</span></span><span>
</span><span id="line-803"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Aspects"><span class="hs-identifier hs-type">Asp.Aspects</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NameAspects"><span class="hs-identifier hs-type">NameAspects</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-806"></span><span>  </span><span id="local-6989586621682005573"><span class="annot"><span class="annottext">nameAspects :: Bool -&gt; NameKind -&gt; Name -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var hs-var hs-var">nameAspects</span></a></span></span><span> </span><span id="local-6989586621682005574"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005574"><span class="hs-identifier hs-var">opp</span></a></span></span><span> </span><span id="local-6989586621682005575"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005575"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682005576"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005576"><span class="hs-identifier hs-var">qn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Aspects
forall a. HasRange a =&gt; a -&gt; Aspects
</span><a href="Agda.Syntax.Common.Aspect.html#rangeDefinitionSite"><span class="hs-identifier hs-var">Asp.rangeDefinitionSite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Range
forall a. HasNameBindingSite a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Abstract.Name.html#nameBindingSite"><span class="hs-identifier hs-var">nameBindingSite</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005576"><span class="hs-identifier hs-var">qn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#tokenBased"><span class="hs-identifier hs-var">Asp.tokenBased</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#NotOnlyTokenBased"><span class="hs-identifier hs-type">Asp.NotOnlyTokenBased</span></a></span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#aspect"><span class="hs-identifier hs-var">Asp.aspect</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Name"><span class="hs-identifier hs-type">Asp.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682005575"><span class="hs-identifier hs-type">nk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682005574"><span class="hs-identifier hs-type">opp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NameAspects"><span class="hs-identifier hs-type">NameAspects</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-812"></span><span>  </span><span id="local-6989586621682005586"><span class="annot"><span class="annottext">nameAspects :: Bool -&gt; NameKind -&gt; QName -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var hs-var hs-var">nameAspects</span></a></span></span><span> </span><span id="local-6989586621682005587"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005587"><span class="hs-identifier hs-var">opp</span></a></span></span><span> </span><span id="local-6989586621682005588"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005588"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NameKind -&gt; Name -&gt; Aspects
forall a. NameAspects a =&gt; Bool -&gt; NameKind -&gt; a -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var">nameAspects</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005587"><span class="hs-identifier hs-var">opp</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005588"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Aspects) -&gt; (QName -&gt; Name) -&gt; QName -&gt; Aspects
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><span class="hs-comment">-- | Only adds a binding site if the name is unambiguous.</span></span><span>
</span><span id="line-815"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NameAspects"><span class="hs-identifier hs-type">NameAspects</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AmbiguousQName"><span class="hs-identifier hs-type">A.AmbiguousQName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-816"></span><span>  </span><span id="local-6989586621682005594"><span class="annot"><span class="annottext">nameAspects :: Bool -&gt; NameKind -&gt; AmbiguousQName -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var hs-var hs-var">nameAspects</span></a></span></span><span> </span><span id="local-6989586621682005595"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005595"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682005596"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005596"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682005597"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005597"><span class="hs-identifier hs-var">amb</span></a></span></span><span>
</span><span id="line-817"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682005598"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005598"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; Maybe QName
</span><a href="Agda.Syntax.Abstract.Name.html#getUnambiguous"><span class="hs-identifier hs-var">A.getUnambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005597"><span class="hs-identifier hs-var">amb</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NameKind -&gt; Name -&gt; Aspects
forall a. NameAspects a =&gt; Bool -&gt; NameKind -&gt; a -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var">nameAspects</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005595"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005596"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005598"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var">nameAspects</span></a></span><span> </span><span id="local-6989586621682005600"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682005600"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682005601"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005601"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682005602"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005602"><span class="hs-identifier hs-var">amb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Aspects
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-820"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#tokenBased"><span class="hs-identifier hs-var">Asp.tokenBased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#NotOnlyTokenBased"><span class="hs-identifier hs-type">Asp.NotOnlyTokenBased</span></a></span><span>
</span><span id="line-821"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#aspect"><span class="hs-identifier hs-var">Asp.aspect</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Name"><span class="hs-identifier hs-type">Asp.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682005601"><span class="hs-identifier hs-type">nk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span id="local-6989586621682003026"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-type">knownIdent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NameAspects"><span class="hs-identifier hs-type">NameAspects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#NameKind"><span class="hs-identifier hs-type">Asp.NameKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span></span><span>
</span><span id="line-825"></span><span id="knownIdent"><span class="annot"><span class="annottext">knownIdent :: forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var hs-var">knownIdent</span></a></span></span><span> </span><span id="local-6989586621682005606"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005606"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682005607"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005607"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682005608"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005608"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Aspects -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#KnownIdent"><span class="hs-identifier hs-var">C.KnownIdent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; NameKind -&gt; a -&gt; Aspects
forall a. NameAspects a =&gt; Bool -&gt; NameKind -&gt; a -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var">nameAspects</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682005606"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682005607"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005608"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682005612"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span>    </span><span id="local-6989586621682005888"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682005890"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005890"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; Name -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Bound"><span class="hs-identifier hs-var">Asp.Bound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005890"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; (Name -&gt; QName) -&gt; Name -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span>      </span><span class="annot"><span class="annottext">(Name -&gt; Expr) -&gt; m Name -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m (ConOfAbs Name)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Name -&gt; m (ConOfAbs Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682005890"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Def%27"><span class="hs-identifier hs-type">Def'</span></a></span><span> </span><span id="local-6989586621682005893"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005893"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682005894"><span class="annot"><span class="annottext">Suffix
</span><a href="#local-6989586621682005894"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; Name -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Function"><span class="hs-identifier hs-var">Asp.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005893"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Suffix -&gt; m QName -&gt; m QName
forall (m :: * -&gt; *). HasOptions m =&gt; Suffix -&gt; m QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addSuffixConcrete"><span class="hs-identifier hs-var">addSuffixConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Suffix
</span><a href="#local-6989586621682005894"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005893"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjPrefix"><span class="hs-identifier hs-var">ProjPrefix</span></a></span><span> </span><span id="local-6989586621682005898"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005898"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; AmbiguousQName -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Field"><span class="hs-identifier hs-var">Asp.Field</span></a></span><span>    </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005898"><span class="hs-identifier hs-var">p</span></a></span><span>             </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005898"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span>          </span><span id="local-6989586621682005901"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005901"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Dot"><span class="hs-identifier hs-var">C.Dot</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; (QName -&gt; Expr) -&gt; QName -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; AmbiguousQName -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Field"><span class="hs-identifier hs-var">Asp.Field</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005901"><span class="hs-identifier hs-var">p</span></a></span><span>  </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005901"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Macro"><span class="hs-identifier hs-type">A.Macro</span></a></span><span> </span><span id="local-6989586621682005904"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005904"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; Name -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Macro"><span class="hs-identifier hs-var">Asp.Macro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005904"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005904"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSyn"><span class="hs-identifier hs-type">A.PatternSyn</span></a></span><span> </span><span id="local-6989586621682005907"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005907"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; AmbiguousQName -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction -&gt; NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Constructor"><span class="hs-identifier hs-var">Asp.Constructor</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005907"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005907"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Highlighted"><span class="hs-identifier hs-type">A.Highlighted</span></a></span><span> </span><span id="local-6989586621682005911"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682005911"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682005912"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005912"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Aspects -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Highlighted"><span class="hs-identifier hs-var">C.Highlighted</span></a></span><span> </span><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682005911"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005912"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span id="local-6989586621682005914"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682005914"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621682005916"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005916"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-var">tryToRecoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005914"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-839"></span><span>      </span><span class="annot"><span class="annottext">NameKind -&gt; AmbiguousQName -&gt; QName -&gt; Expr
forall a. NameAspects a =&gt; NameKind -&gt; a -&gt; QName -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#knownIdent"><span class="hs-identifier hs-var">knownIdent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction -&gt; NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Constructor"><span class="hs-identifier hs-var">Asp.Constructor</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005916"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; m QName -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682005916"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>        </span><span class="hs-comment">-- for names we have to use the name from the info, since the abstract</span><span>
</span><span id="line-842"></span><span>        </span><span class="hs-comment">-- name has been resolved to a fully qualified name (except for</span><span>
</span><span id="line-843"></span><span>        </span><span class="hs-comment">-- variables)</span><span>
</span><span id="line-844"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span id="local-6989586621682005918"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682005918"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span> </span><span id="local-6989586621682005920"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005920"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span> </span><span id="local-6989586621682005922"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005922"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-var">tryToRecoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005918"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-845"></span><span>      </span><span id="local-6989586621682005923"><span class="annot"><a href="#local-6989586621682005923"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; m QName
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="Agda.Syntax.Scope.Base.html#AmbiguousNothing"><span class="hs-identifier hs-var">AmbiguousNothing</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005922"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-846"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682005925"><span class="annot"><a href="#local-6989586621682005925"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005920"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-847"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-type">bracket</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-type">appBrackets</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-848"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#App"><span class="hs-identifier hs-type">C.App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005925"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Quote"><span class="hs-identifier hs-type">C.Quote</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005925"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-type">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">C.Ident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005923"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span id="local-6989586621682005931"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682005931"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span> </span><span id="local-6989586621682005932"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005932"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005933"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682005933"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-var">tryToRecoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005931"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Literal -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Lit"><span class="hs-identifier hs-var">C.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005932"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682005933"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span>    </span><span class="hs-comment">-- Andreas, 2014-05-17  We print question marks with their</span><span>
</span><span id="line-852"></span><span>    </span><span class="hs-comment">-- interaction id, in case @metaNumber /= Nothing@</span><span>
</span><span id="line-853"></span><span>    </span><span class="hs-comment">-- Ulf, 2017-09-20  ... or @preserveIIds == True@.</span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#QuestionMark"><span class="hs-identifier hs-type">A.QuestionMark</span></a></span><span> </span><span id="local-6989586621682005936"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621682005936"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005937"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621682005937"><span class="hs-identifier hs-var">ii</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-855"></span><span>      </span><span id="local-6989586621682005938"><span class="annot"><a href="#local-6989586621682005938"><span class="hs-identifier hs-var">preserve</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Bool) -&gt; m Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#preserveIIds"><span class="hs-identifier hs-var">preserveIIds</span></a></span><span>
</span><span id="line-856"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuestionMark"><span class="hs-identifier hs-type">C.QuestionMark</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005936"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-857"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Common.html#interactionId"><span class="hs-identifier hs-var">interactionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005937"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#guard"><span class="hs-identifier hs-type">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682005938"><span class="hs-identifier hs-type">preserve</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#metaNumber"><span class="hs-identifier hs-var">metaNumber</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005936"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Underscore"><span class="hs-identifier hs-type">A.Underscore</span></a></span><span> </span><span id="local-6989586621682005945"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621682005945"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-860"></span><span>      </span><span class="annot"><span class="annottext">Range -&gt; Maybe ArgName -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-var">C.Underscore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621682005945"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ArgName -&gt; Expr) -&gt; m (Maybe ArgName) -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-861"></span><span>      </span><span class="annot"><span class="annottext">(NamedMeta -&gt; m ArgName) -&gt; Maybe NamedMeta -&gt; m (Maybe ArgName)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; ArgName
forall a. Doc a -&gt; ArgName
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ArgName) -&gt; (NamedMeta -&gt; m Doc) -&gt; NamedMeta -&gt; m ArgName
forall (m :: * -&gt; *) b c a.
Functor m =&gt;
(b -&gt; c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="Agda.Utils.Functor.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NamedMeta -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; NamedMeta -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; MetaId -&gt; NamedMeta
</span><a href="Agda.TypeChecking.Monad.Base.Types.html#NamedMeta"><span class="hs-identifier hs-var">NamedMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaInfo -&gt; ArgName
</span><a href="Agda.Syntax.Info.html#metaNameSuggestion"><span class="hs-identifier hs-var">metaNameSuggestion</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621682005945"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; NamedMeta) -&gt; Maybe MetaId -&gt; Maybe NamedMeta
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetaInfo -&gt; Maybe MetaId
</span><a href="Agda.Syntax.Info.html#metaNumber"><span class="hs-identifier hs-var">metaNumber</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621682005945"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Dot"><span class="hs-identifier hs-type">A.Dot</span></a></span><span> </span><span id="local-6989586621682005951"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005951"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005952"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005952"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-865"></span><span>      </span><span class="annot"><span class="annottext">KwRange -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Dot"><span class="hs-identifier hs-var">C.Dot</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005952"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span id="local-6989586621682005953"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682005953"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#App"><span class="hs-identifier hs-type">A.App</span></a></span><span> </span><span id="local-6989586621682005955"><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682005955"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005956"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005956"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621682005957"><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682005957"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-868"></span><span>      </span><span id="local-6989586621682005958"><span class="annot"><a href="#local-6989586621682005958"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (QName -&gt; BuiltinId -&gt; Bool)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
m (QName -&gt; BuiltinId -&gt; Bool)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isBuiltinFun"><span class="hs-identifier hs-var">isBuiltinFun</span></a></span><span>
</span><span id="line-869"></span><span>      </span><span class="hs-comment">-- Special printing of desugared overloaded literals:</span><span>
</span><span id="line-870"></span><span>      </span><span class="hs-comment">--  fromNat 4        --&gt; 4</span><span>
</span><span id="line-871"></span><span>      </span><span class="hs-comment">--  fromNeg 4        --&gt; -4</span><span>
</span><span id="line-872"></span><span>      </span><span class="hs-comment">--  fromString &quot;foo&quot; --&gt; &quot;foo&quot;</span><span>
</span><span id="line-873"></span><span>      </span><span class="hs-comment">-- Only when the corresponding conversion function is in scope and was</span><span>
</span><span id="line-874"></span><span>      </span><span class="hs-comment">-- inserted by the system.</span><span>
</span><span id="line-875"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-type">getHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005956"><span class="hs-identifier hs-type">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-type">namedArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005957"><span class="hs-identifier hs-type">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-876"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-type">HdDef</span></a></span><span> </span><span id="local-6989586621682005961"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005961"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682005962"><span class="annot"><span class="annottext">l :: Expr
</span><a href="#local-6989586621682005962"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(BuiltinId -&gt; Bool) -&gt; [BuiltinId] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; BuiltinId -&gt; Bool
</span><a href="#local-6989586621682005958"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005961"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinFromNat"><span class="hs-identifier hs-var">builtinFromNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinFromString"><span class="hs-identifier hs-var">builtinFromString</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682005957"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-878"></span><span>            </span><span class="annot"><span class="annottext">AppInfo -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682005955"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Origin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005962"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-879"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-type">HdDef</span></a></span><span> </span><span id="local-6989586621682005967"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005967"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span> </span><span id="local-6989586621682005968"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005968"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span> </span><span id="local-6989586621682005970"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005970"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682005967"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; BuiltinId -&gt; Bool
</span><a href="#local-6989586621682005958"><span class="hs-operator hs-var">`is`</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinFromNeg"><span class="hs-identifier hs-var">builtinFromNeg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682005957"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-881"></span><span>            </span><span class="annot"><span class="annottext">AppInfo -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682005955"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Origin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Literal -&gt; Expr
</span><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-var">A.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005968"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-var">LitNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682005970"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>        </span><span class="annot"><span class="annottext">(Maybe Hd, Expr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-883"></span><span>          </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-var">tryToRecoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005953"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-884"></span><span>          </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpApp"><span class="hs-identifier hs-var">tryToRecoverOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005953"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-885"></span><span>          </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverNatural"><span class="hs-identifier hs-var">tryToRecoverNatural</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005953"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-886"></span><span>          </span><span class="hs-comment">-- or fallback to App</span><span>
</span><span id="line-887"></span><span>          </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets%27"><span class="hs-identifier hs-var">appBrackets'</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PrecedenceStack -&gt; Bool)
-&gt; Bool -&gt; PrecedenceStack -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParenPreference -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#preferParenless"><span class="hs-identifier hs-var">preferParenless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppInfo -&gt; ParenPreference
</span><a href="Agda.Syntax.Info.html#appParens"><span class="hs-identifier hs-var">appParens</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682005955"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682005957"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>          </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682005977"><span class="annot"><a href="#local-6989586621682005977"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#FunctionCtx"><span class="hs-identifier hs-var">FunctionCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005956"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-889"></span><span>               </span><span id="local-6989586621682005979"><span class="annot"><a href="#local-6989586621682005979"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#ArgumentCtx"><span class="hs-identifier hs-type">ArgumentCtx</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#appParens"><span class="hs-identifier hs-var">appParens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005955"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682005957"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-890"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#App"><span class="hs-identifier hs-type">C.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005955"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682005977"><span class="hs-identifier hs-type">e1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005979"><span class="hs-identifier hs-type">e2'</span></a></span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithApp"><span class="hs-identifier hs-type">A.WithApp</span></a></span><span> </span><span id="local-6989586621682005982"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005982"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005983"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005983"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682005984"><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621682005984"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-893"></span><span>      </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#withAppBrackets"><span class="hs-identifier hs-var">withAppBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-894"></span><span>        </span><span id="local-6989586621682005986"><span class="annot"><a href="#local-6989586621682005986"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#WithFunCtx"><span class="hs-identifier hs-var">WithFunCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005983"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-895"></span><span>        </span><span id="local-6989586621682005988"><span class="annot"><a href="#local-6989586621682005988"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#WithArgCtx"><span class="hs-identifier hs-type">WithArgCtx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682005984"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-896"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithApp"><span class="hs-identifier hs-type">C.WithApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005982"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682005986"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682005988"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdLam"><span class="hs-identifier hs-type">A.AbsurdLam</span></a></span><span> </span><span id="local-6989586621682005991"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005991"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682005992"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005992"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-899"></span><span>      </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#lamBrackets"><span class="hs-identifier hs-var">lamBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Hiding -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#AbsurdLam"><span class="hs-identifier hs-var">C.AbsurdLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005991"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682005992"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-900"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span id="local-6989586621682005995"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682005995"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lam"><span class="hs-identifier hs-type">A.Lam</span></a></span><span> </span><span id="local-6989586621682005996"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005996"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">LamBinding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-901"></span><span>      </span><span class="annot"><span class="annottext">Expr -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpApp"><span class="hs-identifier hs-var">tryToRecoverOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005995"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>   </span><span class="hs-comment">-- recover sections</span><span>
</span><span id="line-902"></span><span>        </span><span class="annot"><span class="annottext">[LamBinding] -&gt; (ConOfAbs [LamBinding] -&gt; m Expr) -&gt; m Expr
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[LamBinding] -&gt; (ConOfAbs [LamBinding] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LamBinding -&gt; LamBinding) -&gt; [LamBinding] -&gt; [LamBinding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; LamBinding
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-var">makeDomainFree</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682005998"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [LamBinding] -&gt; m Expr) -&gt; m Expr)
-&gt; (ConOfAbs [LamBinding] -&gt; m Expr) -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682005999"><span class="annot"><span class="annottext">ConOfAbs [LamBinding]
</span><a href="#local-6989586621682005999"><span class="hs-identifier hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-903"></span><span>          </span><span class="annot"><span class="annottext">[LamBinding] -&gt; m Expr -&gt; (List1 LamBinding -&gt; m Expr) -&gt; m Expr
forall a b. [a] -&gt; b -&gt; (List1 a -&gt; b) -&gt; b
</span><a href="Agda.Utils.List1.html#ifNull"><span class="hs-identifier hs-var">List1.ifNull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe LamBinding] -&gt; [LamBinding]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe LamBinding]
ConOfAbs [LamBinding]
</span><a href="#local-6989586621682005999"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>            </span><span class="hs-comment">{-then-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006002"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>            </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="annottext">((List1 LamBinding -&gt; m Expr) -&gt; m Expr)
-&gt; (List1 LamBinding -&gt; m Expr) -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006003"><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621682006003"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#lamBrackets"><span class="hs-identifier hs-var">lamBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-906"></span><span>              </span><span class="annot"><span class="annottext">Range -&gt; List1 LamBinding -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Lam"><span class="hs-identifier hs-var">C.Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682005996"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621682006003"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006002"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-907"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-908"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682005998"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682005998"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006002"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006002"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682005995"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-909"></span><span>          </span><span class="hs-comment">-- #3238 GA: We drop the hidden lambda abstractions which have</span><span>
</span><span id="line-910"></span><span>          </span><span class="hs-comment">-- been inserted by the machine rather than the user. This means</span><span>
</span><span id="line-911"></span><span>          </span><span class="hs-comment">-- that the result of lamView may actually be an empty list of</span><span>
</span><span id="line-912"></span><span>          </span><span class="hs-comment">-- binders.</span><span>
</span><span id="line-913"></span><span>          </span><span class="annot"><a href="#local-6989586621682006005"><span class="hs-identifier hs-type">lamView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LamBinding"><span class="hs-identifier hs-type">A.LamBinding</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>          </span><span id="local-6989586621682006005"><span class="annot"><span class="annottext">lamView :: Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var hs-var">lamView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lam"><span class="hs-identifier hs-type">A.Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006006"><span class="annot"><span class="annottext">b :: LamBinding
</span><a href="#local-6989586621682006006"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFree"><span class="hs-identifier hs-type">A.DomainFree</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006008"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006008"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006009"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006009"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Bool
forall a. (LensHiding a, LensOrigin a) =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isInsertedHidden"><span class="hs-identifier hs-var">isInsertedHidden</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006008"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006009"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-916"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006009"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-917"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682006011"><span class="annot"><span class="annottext">bs :: [LamBinding]
</span><a href="#local-6989586621682006011"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFree"><span class="hs-identifier hs-type">A.DomainFree</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006012"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006012"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006006"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">LamBinding -&gt; [LamBinding] -&gt; [LamBinding]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006011"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006012"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>              </span><span class="annot"><span class="annottext">([LamBinding], Expr)
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006006"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006009"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>          </span><span class="annot"><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lam"><span class="hs-identifier hs-type">A.Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006013"><span class="annot"><span class="annottext">b :: LamBinding
</span><a href="#local-6989586621682006013"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#TLet"><span class="hs-identifier hs-type">A.TLet</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006016"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006016"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006016"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-920"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682006017"><span class="annot"><span class="annottext">bs :: [LamBinding]
</span><a href="#local-6989586621682006017"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBinding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006018"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006018"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006013"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">LamBinding -&gt; [LamBinding] -&gt; [LamBinding]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006017"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006018"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>            </span><span class="annot"><span class="annottext">([LamBinding], Expr)
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006013"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006016"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>          </span><span class="annot"><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lam"><span class="hs-identifier hs-type">A.Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#TBind"><span class="hs-identifier hs-type">A.TBind</span></a></span><span> </span><span id="local-6989586621682006020"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006020"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682006021"><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006021"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682006022"><span class="annot"><span class="annottext">List1 (NamedArg Binder)
</span><a href="#local-6989586621682006022"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682006023"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006023"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006024"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006024"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-923"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(NamedArg Binder -&gt; Bool)
-&gt; List1 (NamedArg Binder) -&gt; [NamedArg Binder]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (NamedArg Binder -&gt; Bool) -&gt; NamedArg Binder -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Bool
forall a. (LensHiding a, LensOrigin a) =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isInsertedHidden"><span class="hs-identifier hs-var">isInsertedHidden</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Binder)
</span><a href="#local-6989586621682006022"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-924"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006024"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-925"></span><span>              </span><span id="local-6989586621682006026"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006026"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682006027"><span class="annot"><span class="annottext">[NamedArg Binder]
</span><a href="#local-6989586621682006027"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006028"><span class="annot"><span class="annottext">b :: LamBinding
</span><a href="#local-6989586621682006028"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedBinding -&gt; LamBinding
</span><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-var">A.DomainFull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range
-&gt; TypedBindingInfo
-&gt; List1 (NamedArg Binder)
-&gt; Expr
-&gt; TypedBinding
</span><a href="Agda.Syntax.Abstract.html#TBind"><span class="hs-identifier hs-var">A.TBind</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006020"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006021"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006026"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; [NamedArg Binder] -&gt; List1 (NamedArg Binder)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg Binder]
</span><a href="#local-6989586621682006027"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006023"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-926"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ([LamBinding], Expr)
</span><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006024"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-927"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621682006029"><span class="annot"><span class="annottext">bs :: [LamBinding]
</span><a href="#local-6989586621682006029"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBinding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006030"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006030"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006028"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">LamBinding -&gt; [LamBinding] -&gt; [LamBinding]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006029"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006030"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>                  </span><span class="annot"><span class="annottext">([LamBinding], Expr)
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006028"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006024"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>          </span><span class="annot"><a href="#local-6989586621682006005"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span id="local-6989586621682006031"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006031"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006031"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ExtendedLam"><span class="hs-identifier hs-type">A.ExtendedLam</span></a></span><span> </span><span id="local-6989586621682006032"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006032"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006033"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682006033"><span class="hs-identifier hs-var">di</span></a></span></span><span> </span><span id="local-6989586621682006034"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006034"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682006035"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006035"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span id="local-6989586621682006036"><span class="annot"><span class="annottext">List1 Clause
</span><a href="#local-6989586621682006036"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-931"></span><span>        </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#lamBrackets"><span class="hs-identifier hs-var">lamBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-932"></span><span>          </span><span id="local-6989586621682006037"><span class="annot"><a href="#local-6989586621682006037"><span class="hs-identifier hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (NonEmpty Declaration) -&gt; NonEmpty Declaration
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (NonEmpty Declaration) -&gt; NonEmpty Declaration)
-&gt; m (NonEmpty (NonEmpty Declaration)) -&gt; m (NonEmpty Declaration)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">List1 Clause -&gt; m (ConOfAbs (List1 Clause))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
List1 Clause -&gt; m (ConOfAbs (List1 Clause))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Clause
</span><a href="#local-6989586621682006036"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-933"></span><span>          </span><span id="local-6989586621682006038"><span class="annot"><a href="#local-6989586621682006038"><span class="hs-identifier hs-var">puns</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optHiddenArgumentPuns"><span class="hs-identifier hs-type">optHiddenArgumentPuns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-type">pragmaOptions</span></a></span><span>
</span><span id="line-934"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- If --hidden-argument-puns is active, then {x} is</span><span>
</span><span id="line-935"></span><span>              </span><span class="hs-comment">-- replaced by {(x)} and &#10627;&#160;x&#160;&#10628; by &#10627;&#160;(x)&#160;&#10628;.</span><span>
</span><span id="line-936"></span><span>              </span><span id="local-6989586621682006040"><span class="annot"><a href="#local-6989586621682006040"><span class="hs-identifier hs-var hs-var">noPun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621682006041"><span class="annot"><span class="annottext">p :: Pattern
</span><a href="#local-6989586621682006041"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">C.IdentP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682006038"><span class="hs-identifier hs-var">puns</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-937"></span><span>                </span><span class="annot"><span class="annottext">Maybe NamedName -&gt; Pattern -&gt; Named_ Pattern
forall name a. Maybe name -&gt; a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-var">C.ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006041"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span>              </span><span class="annot"><a href="#local-6989586621682006040"><span class="hs-identifier hs-var">noPun</span></a></span><span> </span><span id="local-6989586621682006043"><span class="annot"><span class="annottext">Named_ Pattern
</span><a href="#local-6989586621682006043"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Named_ Pattern
</span><a href="#local-6989586621682006043"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span>              </span><span id="local-6989586621682006044"><span class="annot"><a href="#local-6989586621682006044"><span class="hs-identifier hs-var hs-var">namedPat</span></a></span></span><span> </span><span id="local-6989586621682006045"><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006045"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006045"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-941"></span><span>                 </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-var">NotHidden</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Pattern
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006045"><span class="hs-identifier hs-var">np</span></a></span><span>
</span><span id="line-942"></span><span>                 </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#Hidden"><span class="hs-identifier hs-var">Hidden</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named_ Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#HiddenP"><span class="hs-identifier hs-var">C.HiddenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Named_ Pattern -&gt; Named_ Pattern
</span><a href="#local-6989586621682006040"><span class="hs-identifier hs-var">noPun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Named_ Pattern
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006045"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-943"></span><span>                 </span><span class="annot"><a href="Agda.Syntax.Common.html#Instance"><span class="hs-identifier hs-type">Instance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named_ Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#InstanceP"><span class="hs-identifier hs-var">C.InstanceP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Named_ Pattern -&gt; Named_ Pattern
</span><a href="#local-6989586621682006040"><span class="hs-identifier hs-var">noPun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Named_ Pattern
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006045"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>              </span><span class="hs-comment">-- we know all lhs are of the form `.extlam p1 p2 ... pn`,</span><span>
</span><span id="line-945"></span><span>              </span><span class="hs-comment">-- with the name .extlam leftmost. It is our mission to remove it.</span><span>
</span><span id="line-946"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682003085"><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-type">removeApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003085"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003085"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-947"></span><span>              </span><span id="local-6989586621682006049"><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-var hs-var">removeApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">C.RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List2.html#List2"><span class="hs-identifier hs-type">List2</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006069"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006069"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682006070"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621682006070"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; m [Pattern]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; m [Pattern]) -&gt; [Pattern] -&gt; m [Pattern]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006069"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; [Pattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621682006070"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-948"></span><span>              </span><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">C.AppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">C.IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006072"><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006072"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; m [Pattern]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Pattern
</span><a href="#local-6989586621682006044"><span class="hs-identifier hs-var">namedPat</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006072"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span>              </span><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">C.AppP</span></a></span><span> </span><span id="local-6989586621682006073"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006073"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682006074"><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006074"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m [Pattern]
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Pattern -&gt; m [Pattern]
</span><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006073"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m [Pattern] -&gt; ([Pattern] -&gt; [Pattern]) -&gt; m [Pattern]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pattern] -&gt; [Pattern] -&gt; [Pattern]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; Pattern
</span><a href="#local-6989586621682006044"><span class="hs-identifier hs-var">namedPat</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682006074"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>              </span><span class="hs-comment">-- Andreas, 2018-06-18, issue #3136</span><span>
</span><span id="line-951"></span><span>              </span><span class="hs-comment">-- Empty pattern list also allowed in extended lambda,</span><span>
</span><span id="line-952"></span><span>              </span><span class="hs-comment">-- thus, we might face the unapplied .extendedlambda identifier.</span><span>
</span><span id="line-953"></span><span>              </span><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span id="local-6989586621682006076"><span class="annot"><span class="annottext">x :: Pattern
</span><a href="#local-6989586621682006076"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">C.IdentP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; m [Pattern]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span>              </span><span class="annot"><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span id="local-6989586621682006077"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006077"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-956"></span><span>                </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;extendedlambda&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;abstractToConcrete removeApp p = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006077"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-957"></span><span>                </span><span class="annot"><span class="annottext">[Pattern] -&gt; m [Pattern]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006077"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- __IMPOSSIBLE__</span><span>
</span><span id="line-958"></span><span>                  </span><span class="hs-comment">-- Andreas, this is actually not impossible,</span><span>
</span><span id="line-959"></span><span>                  </span><span class="hs-comment">-- my strictification exposed this sleeping bug</span><span>
</span><span id="line-960"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006229"><span class="annot"><a href="#local-6989586621682006229"><span class="hs-identifier hs-var hs-var">decl2clause</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FunClause"><span class="hs-identifier hs-type">C.FunClause</span></a></span><span> </span><span id="local-6989586621682006231"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006231"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span> </span><span id="local-6989586621682006233"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006233"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006234"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006234"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">WhereClause' [Declaration]
</span><a href="Agda.Syntax.Concrete.html#NoWhere"><span class="hs-identifier hs-var">C.NoWhere</span></a></span><span> </span><span id="local-6989586621682006236"><span class="annot"><span class="annottext">Catchall
</span><a href="#local-6989586621682006236"><span class="hs-identifier hs-var">ca</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-961"></span><span>                </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;extendedlambda&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;abstractToConcrete extended lambda pattern p = &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006233"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-962"></span><span>                </span><span id="local-6989586621682006237"><span class="annot"><a href="#local-6989586621682006237"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m [Pattern]
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Pattern -&gt; m [Pattern]
</span><a href="#local-6989586621682006049"><span class="hs-identifier hs-var">removeApp</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006233"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-963"></span><span>                </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;extendedlambda&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;abstractToConcrete extended lambda patterns ps = &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006237"><span class="hs-identifier hs-type">ps</span></a></span><span>
</span><span id="line-964"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006237"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006234"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006236"><span class="hs-identifier hs-type">ca</span></a></span><span>
</span><span id="line-965"></span><span>              </span><span class="annot"><a href="#local-6989586621682006229"><span class="hs-identifier hs-var">decl2clause</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m LamClause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-966"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ExtendedLam"><span class="hs-identifier hs-type">C.ExtendedLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006032"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006034"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span>
</span><span id="line-967"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682006229"><span class="hs-identifier hs-type">decl2clause</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006037"><span class="hs-identifier hs-type">decls</span></a></span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pi"><span class="hs-identifier hs-type">A.Pi</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006241"><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006241"><span class="hs-identifier hs-var">tel1</span></a></span></span><span> </span><span id="local-6989586621682006242"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006242"><span class="hs-identifier hs-var">e0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-970"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682006243"><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006243"><span class="hs-identifier hs-var">tel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006244"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006244"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding -&gt; Expr -&gt; (NonEmpty TypedBinding, Expr)
</span><a href="#local-6989586621682006245"><span class="hs-identifier hs-var">piTel1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006241"><span class="hs-identifier hs-var">tel1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006242"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-971"></span><span>      </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#piBrackets"><span class="hs-identifier hs-var">piBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-972"></span><span>         </span><span class="annot"><span class="annottext">NonEmpty TypedBinding
-&gt; (ConOfAbs (NonEmpty TypedBinding) -&gt; m Expr) -&gt; m Expr
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
NonEmpty TypedBinding
-&gt; (ConOfAbs (NonEmpty TypedBinding) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006243"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (NonEmpty TypedBinding) -&gt; m Expr) -&gt; m Expr)
-&gt; (ConOfAbs (NonEmpty TypedBinding) -&gt; m Expr) -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006247"><span class="annot"><span class="annottext">ConOfAbs (NonEmpty TypedBinding)
</span><a href="#local-6989586621682006247"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-973"></span><span>           </span><span class="annot"><span class="annottext">Telescope -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#makePi"><span class="hs-identifier hs-var">C.makePi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 (Maybe TypedBinding) -&gt; Telescope
forall a. List1 (Maybe a) -&gt; [a]
</span><a href="Agda.Utils.List1.html#catMaybes"><span class="hs-identifier hs-var">List1.catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (Maybe TypedBinding)
ConOfAbs (NonEmpty TypedBinding)
</span><a href="#local-6989586621682006247"><span class="hs-identifier hs-var">tel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006244"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-974"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-975"></span><span>        </span><span id="local-6989586621682006245"><span class="annot"><span class="annottext">piTel1 :: NonEmpty TypedBinding -&gt; Expr -&gt; (NonEmpty TypedBinding, Expr)
</span><a href="#local-6989586621682006245"><span class="hs-identifier hs-var hs-var">piTel1</span></a></span></span><span> </span><span id="local-6989586621682006254"><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006254"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682006255"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006255"><span class="hs-identifier hs-var">e</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; NonEmpty TypedBinding)
-&gt; (Telescope, Expr) -&gt; (NonEmpty TypedBinding, Expr)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty TypedBinding -&gt; Telescope -&gt; NonEmpty TypedBinding
forall a. NonEmpty a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">List1.appendList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006254"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Telescope, Expr) -&gt; (NonEmpty TypedBinding, Expr))
-&gt; (Telescope, Expr) -&gt; (NonEmpty TypedBinding, Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; (Telescope, Expr)
</span><a href="#local-6989586621682006257"><span class="hs-identifier hs-var">piTel</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006255"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-976"></span><span>        </span><span id="local-6989586621682006257"><span class="annot"><span class="annottext">piTel :: Expr -&gt; (Telescope, Expr)
</span><a href="#local-6989586621682006257"><span class="hs-identifier hs-var hs-var">piTel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pi"><span class="hs-identifier hs-type">A.Pi</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006258"><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006258"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682006259"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006259"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty TypedBinding -&gt; Telescope)
-&gt; (NonEmpty TypedBinding, Expr) -&gt; (Telescope, Expr)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding -&gt; [Item (NonEmpty TypedBinding)]
NonEmpty TypedBinding -&gt; Telescope
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">((NonEmpty TypedBinding, Expr) -&gt; (Telescope, Expr))
-&gt; (NonEmpty TypedBinding, Expr) -&gt; (Telescope, Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding -&gt; Expr -&gt; (NonEmpty TypedBinding, Expr)
</span><a href="#local-6989586621682006245"><span class="hs-identifier hs-var">piTel1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TypedBinding
</span><a href="#local-6989586621682006258"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006259"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-977"></span><span>        </span><span class="annot"><a href="#local-6989586621682006257"><span class="hs-identifier hs-var">piTel</span></a></span><span> </span><span id="local-6989586621682006260"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006260"><span class="hs-identifier hs-var">e</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006260"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Generalized"><span class="hs-identifier hs-type">A.Generalized</span></a></span><span> </span><span class="annot"><span class="annottext">Set1 QName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006262"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006262"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Generalized"><span class="hs-identifier hs-var">C.Generalized</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006262"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Fun"><span class="hs-identifier hs-type">A.Fun</span></a></span><span> </span><span id="local-6989586621682006265"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006265"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006266"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006266"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682006267"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006267"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-982"></span><span>        </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#piBrackets"><span class="hs-identifier hs-var">piBrackets</span></a></span><span>
</span><span id="line-983"></span><span>        </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682006268"><span class="annot"><a href="#local-6989586621682006268"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Arg Expr -&gt; m (ConOfAbs (Arg Expr))
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="#local-6989586621682006269"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006266"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-984"></span><span>             </span><span id="local-6989586621682006270"><span class="annot"><a href="#local-6989586621682006270"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006267"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-985"></span><span>             </span><span class="hs-comment">-- NOTE We set relevance to Relevant in arginfo because we wrap</span><span>
</span><span id="line-986"></span><span>             </span><span class="hs-comment">-- with C.Dot or C.DoubleDot using addRel instead.</span><span>
</span><span id="line-987"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006271"><span class="annot"><a href="#local-6989586621682006271"><span class="hs-identifier hs-var hs-var">dom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Arg Expr -&gt; Arg Expr
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#relevant"><span class="hs-identifier hs-var">relevant</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Expr -&gt; Arg Expr) -&gt; Arg Expr -&gt; Arg Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Arg Expr -&gt; Arg Expr
forall a. LensModality a =&gt; Modality -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setModality"><span class="hs-identifier hs-var">setModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg Expr -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006268"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Arg Expr -&gt; Arg Expr) -&gt; Arg Expr -&gt; Arg Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Arg Expr
forall a. a -&gt; Arg a
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Arg Expr) -&gt; Expr -&gt; Arg Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg Expr -&gt; Expr -&gt; Expr
forall {a}. LensRelevance a =&gt; a -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621682006277"><span class="hs-identifier hs-var">addRel</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006268"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; Expr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg Expr -&gt; Expr
</span><a href="#local-6989586621682006278"><span class="hs-identifier hs-var">mkArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006268"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-988"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Fun"><span class="hs-identifier hs-type">C.Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006265"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006271"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006270"><span class="hs-identifier hs-type">b'</span></a></span><span>
</span><span id="line-989"></span><span>             </span><span class="hs-comment">-- Andreas, 2018-06-14, issue #2513</span><span>
</span><span id="line-990"></span><span>             </span><span class="hs-comment">-- TODO: print attributes</span><span>
</span><span id="line-991"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-992"></span><span>            </span><span id="local-6989586621682006269"><span class="annot"><span class="annottext">ctx :: Precedence
</span><a href="#local-6989586621682006269"><span class="hs-identifier hs-var hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Arg Expr -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isRelevant"><span class="hs-identifier hs-var">isRelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006266"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#FunctionSpaceDomainCtx"><span class="hs-identifier hs-var">FunctionSpaceDomainCtx</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#DotPatternCtx"><span class="hs-identifier hs-var">DotPatternCtx</span></a></span><span>
</span><span id="line-993"></span><span>            </span><span id="local-6989586621682006277"><span class="annot"><span class="annottext">addRel :: a -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621682006277"><span class="hs-identifier hs-var hs-var">addRel</span></a></span></span><span> </span><span id="local-6989586621682006287"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006287"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682006288"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006288"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-994"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006287"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-995"></span><span>                </span><span class="annot"><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-type">Irrelevant</span></a></span><span>      </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Dot"><span class="hs-identifier hs-var">C.Dot</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006288"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-996"></span><span>                </span><span class="annot"><a href="Agda.Syntax.Common.html#ShapeIrrelevant"><span class="hs-identifier hs-type">ShapeIrrelevant</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#DoubleDot"><span class="hs-identifier hs-var">C.DoubleDot</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006288"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-997"></span><span>                </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-type">Relevant</span></a></span><span>        </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006288"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-998"></span><span>            </span><span id="local-6989586621682006278"><span class="annot"><span class="annottext">mkArg :: Arg Expr -&gt; Expr
</span><a href="#local-6989586621682006278"><span class="hs-identifier hs-var hs-var">mkArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682006297"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006297"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682006298"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006297"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-999"></span><span>                                          </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#Hidden"><span class="hs-identifier hs-var">Hidden</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named_ Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#HiddenArg"><span class="hs-identifier hs-var">HiddenArg</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Named_ Expr
forall a name. a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#unnamed"><span class="hs-identifier hs-var">unnamed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>                                          </span><span class="annot"><a href="Agda.Syntax.Common.html#Instance"><span class="hs-identifier hs-type">Instance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Named_ Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#InstanceArg"><span class="hs-identifier hs-var">InstanceArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Named_ Expr
forall a name. a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#unnamed"><span class="hs-identifier hs-var">unnamed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span>                                          </span><span class="annot"><span class="annottext">Hiding
</span><a href="Agda.Syntax.Common.html#NotHidden"><span class="hs-identifier hs-var">NotHidden</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006298"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Let"><span class="hs-identifier hs-type">A.Let</span></a></span><span> </span><span id="local-6989586621682006303"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006303"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006304"><span class="annot"><span class="annottext">List1 LetBinding
</span><a href="#local-6989586621682006304"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621682006305"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006305"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1004"></span><span>        </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#lamBrackets"><span class="hs-identifier hs-var">lamBrackets</span></a></span><span>
</span><span id="line-1005"></span><span>        </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 LetBinding
-&gt; (ConOfAbs (List1 LetBinding) -&gt; m Expr) -&gt; m Expr
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
List1 LetBinding -&gt; (ConOfAbs (List1 LetBinding) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 LetBinding
</span><a href="#local-6989586621682006304"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (List1 LetBinding) -&gt; m Expr) -&gt; m Expr)
-&gt; (ConOfAbs (List1 LetBinding) -&gt; m Expr) -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682006306"><span class="annot"><span class="annottext">ConOfAbs (List1 LetBinding)
</span><a href="#local-6989586621682006306"><span class="hs-identifier hs-var">ds'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1006"></span><span>             </span><span id="local-6989586621682006307"><span class="annot"><a href="#local-6989586621682006307"><span class="hs-identifier hs-var">e'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006305"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1007"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#mkLet"><span class="hs-identifier hs-type">C.mkLet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006303"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><a href="#local-6989586621682006306"><span class="hs-identifier hs-type">ds'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006307"><span class="hs-identifier hs-type">e'</span></a></span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Rec"><span class="hs-identifier hs-type">A.Rec</span></a></span><span> </span><span id="local-6989586621682006310"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006310"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682006311"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006311"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006312"><span class="annot"><span class="annottext">RecordAssigns
</span><a href="#local-6989586621682006312"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1010"></span><span>      </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-var">appBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1011"></span><span>        </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; RecordAssignments -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Rec"><span class="hs-identifier hs-var">C.Rec</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006310"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006311"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RecordAssignments -&gt; Expr)
-&gt; ([Either FieldAssignment QName] -&gt; RecordAssignments)
-&gt; [Either FieldAssignment QName]
-&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Either FieldAssignment QName -&gt; RecordAssignment)
-&gt; [Either FieldAssignment QName] -&gt; RecordAssignments
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName -&gt; ModuleAssignment)
-&gt; Either FieldAssignment QName -&gt; RecordAssignment
forall a b.
(a -&gt; b) -&gt; Either FieldAssignment a -&gt; Either FieldAssignment b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682006314"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006314"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Expr] -&gt; ImportDirective -&gt; ModuleAssignment
</span><a href="Agda.Syntax.Concrete.html#ModuleAssignment"><span class="hs-identifier hs-var">ModuleAssignment</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006314"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ImportDirective
forall n m. ImportDirective' n m
</span><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-var">defaultImportDir</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Either FieldAssignment QName] -&gt; Expr)
-&gt; m [Either FieldAssignment QName] -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RecordAssigns -&gt; m (ConOfAbs RecordAssigns)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">RecordAssigns
</span><a href="#local-6989586621682006312"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecUpdate"><span class="hs-identifier hs-type">A.RecUpdate</span></a></span><span> </span><span id="local-6989586621682006318"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006318"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682006319"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006319"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006320"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006320"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682006321"><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006321"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1014"></span><span>      </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-var">appBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1015"></span><span>        </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; Expr -&gt; [FieldAssignment] -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#RecUpdate"><span class="hs-identifier hs-var">C.RecUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006318"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006319"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; [FieldAssignment] -&gt; Expr)
-&gt; m Expr -&gt; m ([FieldAssignment] -&gt; Expr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006320"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">m ([FieldAssignment] -&gt; Expr) -&gt; m [FieldAssignment] -&gt; m Expr
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Assigns -&gt; m (ConOfAbs Assigns)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006321"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecWhere"><span class="hs-identifier hs-type">A.RecWhere</span></a></span><span> </span><span id="local-6989586621682006324"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006324"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682006325"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006325"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006326"><span class="annot"><span class="annottext">[LetBinding]
</span><a href="#local-6989586621682006326"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682006327"><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006327"><span class="hs-identifier hs-var">ass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-var">appBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">(m Expr -&gt; m Expr) -&gt; m Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1018"></span><span>      </span><span class="hs-comment">-- InternalToAbstract generates FieldAssignments of the following</span><span>
</span><span id="line-1019"></span><span>      </span><span class="hs-comment">-- form to associate the fresh 'A.Name's generated for the record</span><span>
</span><span id="line-1020"></span><span>      </span><span class="hs-comment">-- field bindings should be printed back without disambiguators</span><span>
</span><span id="line-1021"></span><span>      </span><span class="annot"><span class="annottext">Assigns -&gt; (Assign -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">Fold.for_</span></span><span> </span><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006327"><span class="hs-identifier hs-var">ass</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1022"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment"><span class="hs-identifier hs-type">FieldAssignment</span></a></span><span> </span><span id="local-6989586621682006329"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006329"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">A.Var</span></a></span><span> </span><span id="local-6989586621682006330"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006330"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; m ()
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
Name -&gt; Name -&gt; m ()
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-var">pickConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006330"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006329"><span class="hs-identifier hs-var">cn</span></a></span><span>
</span><span id="line-1023"></span><span>        </span><span class="annot"><span class="annottext">Assign
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>      </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; [Declaration] -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#RecWhere"><span class="hs-identifier hs-var">C.RecWhere</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006324"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006325"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; Expr)
-&gt; ([[Declaration]] -&gt; [Declaration]) -&gt; [[Declaration]] -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Declaration]] -&gt; [Declaration]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Declaration]] -&gt; [Declaration])
-&gt; ([[Declaration]] -&gt; [[Declaration]])
-&gt; [[Declaration]]
-&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Declaration]] -&gt; [[Declaration]]
[[Declaration]] -&gt; [Item [[Declaration]]]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">([[Declaration]] -&gt; Expr) -&gt; m [[Declaration]] -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[LetBinding] -&gt; m (ConOfAbs [LetBinding])
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[LetBinding] -&gt; m (ConOfAbs [LetBinding])
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[LetBinding]
</span><a href="#local-6989586621682006326"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecUpdateWhere"><span class="hs-identifier hs-type">A.RecUpdateWhere</span></a></span><span> </span><span id="local-6989586621682006333"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682006333"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682006334"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006334"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006335"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006335"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621682006336"><span class="annot"><span class="annottext">[LetBinding]
</span><a href="#local-6989586621682006336"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682006337"><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006337"><span class="hs-identifier hs-var">ass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-var">appBrackets</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1027"></span><span>      </span><span class="hs-comment">-- InternalToAbstract generates FieldAssignments of the following</span><span>
</span><span id="line-1028"></span><span>      </span><span class="hs-comment">-- form to associate the fresh 'A.Name's generated for the record</span><span>
</span><span id="line-1029"></span><span>      </span><span class="hs-comment">-- field bindings should be printed back without disambiguators</span><span>
</span><span id="line-1030"></span><span>      </span><span class="annot"><span class="annottext">Assigns -&gt; (Assign -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">Fold.for_</span></span><span> </span><span class="annot"><span class="annottext">Assigns
</span><a href="#local-6989586621682006337"><span class="hs-identifier hs-var">ass</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1031"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldAssignment"><span class="hs-identifier hs-type">FieldAssignment</span></a></span><span> </span><span id="local-6989586621682006338"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006338"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">A.Var</span></a></span><span> </span><span id="local-6989586621682006339"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006339"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; m ()
forall (m :: * -&gt; *).
MonadStConcreteNames m =&gt;
Name -&gt; Name -&gt; m ()
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#pickConcreteName"><span class="hs-identifier hs-var">pickConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006339"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006338"><span class="hs-identifier hs-var">cn</span></a></span><span>
</span><span id="line-1032"></span><span>        </span><span class="annot"><span class="annottext">Assign
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>      </span><span id="local-6989586621682006340"><span class="annot"><a href="#local-6989586621682006340"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006335"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecUpdateWhere"><span class="hs-identifier hs-type">C.RecUpdateWhere</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006333"><span class="hs-identifier hs-type">kwr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006334"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006340"><span class="hs-identifier hs-type">e0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">List1.toList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006336"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-1035"></span><span>
</span><span id="line-1036"></span><span>    </span><span class="hs-comment">-- Annotated 'leftovers' from the scope-checker</span><span>
</span><span id="line-1037"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedExpr"><span class="hs-identifier hs-type">A.ScopedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006343"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006343"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006343"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1038"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Qualified"><span class="hs-identifier hs-type">A.Qualified</span></a></span><span>  </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006345"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006345"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006345"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span>    </span><span class="hs-comment">-- Reflection keywords:</span><span>
</span><span id="line-1041"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Quote"><span class="hs-identifier hs-type">A.Quote</span></a></span><span> </span><span id="local-6989586621682006347"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006347"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Quote"><span class="hs-identifier hs-var">C.Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006347"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#QuoteTerm"><span class="hs-identifier hs-type">A.QuoteTerm</span></a></span><span> </span><span id="local-6989586621682006349"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006349"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#QuoteTerm"><span class="hs-identifier hs-var">C.QuoteTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006349"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Unquote"><span class="hs-identifier hs-type">A.Unquote</span></a></span><span> </span><span id="local-6989586621682006352"><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006352"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Unquote"><span class="hs-identifier hs-var">C.Unquote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><a href="#local-6989586621682006352"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span>    </span><span class="hs-comment">-- Andreas, 2012-04-02: TODO!  print DontCare as irrAxiom</span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-comment">-- Andreas, 2010-10-05 print irrelevant things as ordinary things</span><span>
</span><span id="line-1047"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DontCare"><span class="hs-identifier hs-type">A.DontCare</span></a></span><span> </span><span id="local-6989586621682006355"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006355"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Dot"><span class="hs-identifier hs-var">C.Dot</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; (Expr -&gt; Expr) -&gt; Expr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-var">C.Paren</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006356"><span class="hs-identifier hs-var">r</span></a></span><span>  </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; m Expr -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006355"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1048"></span><span>       </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682006356"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621682006356"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006355"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-type">makeDomainFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LamBinding"><span class="hs-identifier hs-type">A.LamBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LamBinding"><span class="hs-identifier hs-type">A.LamBinding</span></a></span><span>
</span><span id="line-1051"></span><span id="makeDomainFree"><span class="annot"><span class="annottext">makeDomainFree :: LamBinding -&gt; LamBinding
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-var hs-var">makeDomainFree</span></a></span></span><span> </span><span id="local-6989586621682006357"><span class="annot"><span class="annottext">b :: LamBinding
</span><a href="#local-6989586621682006357"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#TBind"><span class="hs-identifier hs-type">A.TBind</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006358"><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006358"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682006359"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006359"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006360"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006360"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1052"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Agda.Syntax.Abstract.Views.html#unScope"><span class="hs-identifier hs-var">unScope</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006360"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1053"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Underscore"><span class="hs-identifier hs-type">A.Underscore</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#MetaInfo"><span class="hs-identifier hs-type">A.MetaInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">metaNumber :: MetaInfo -&gt; Maybe MetaId
</span><a href="Agda.Syntax.Info.html#metaNumber"><span class="hs-identifier hs-var">metaNumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MetaId
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1054"></span><span>      </span><span class="annot"><span class="annottext">TacticAttribute -&gt; NamedArg Binder -&gt; LamBinding
</span><a href="Agda.Syntax.Abstract.html#DomainFree"><span class="hs-identifier hs-var">A.DomainFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedBindingInfo -&gt; TacticAttribute
</span><a href="Agda.Syntax.Abstract.html#tbTacticAttr"><span class="hs-identifier hs-var">tbTacticAttr</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006358"><span class="hs-identifier hs-var">tac</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006359"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1055"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006357"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1056"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-var">makeDomainFree</span></a></span><span> </span><span id="local-6989586621682006363"><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006363"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LamBinding
</span><a href="#local-6989586621682006363"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- Binder instances -------------------------------------------------------</span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- If there is no label we set it to the bound name, to make renaming the bound</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- name safe.</span><span>
</span><span id="line-1063"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#forceNameIfHidden"><span class="hs-identifier hs-type">forceNameIfHidden</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Binder"><span class="hs-identifier hs-type">A.Binder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Binder"><span class="hs-identifier hs-type">A.Binder</span></a></span><span>
</span><span id="line-1064"></span><span id="forceNameIfHidden"><span class="annot"><span class="annottext">forceNameIfHidden :: NamedArg Binder -&gt; NamedArg Binder
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#forceNameIfHidden"><span class="hs-identifier hs-var hs-var">forceNameIfHidden</span></a></span></span><span> </span><span id="local-6989586621682006365"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-1065"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe NamedName -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe NamedName -&gt; Bool) -&gt; Maybe NamedName -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Maybe (NameOf (NamedArg Binder))
forall a. LensNamed a =&gt; a -&gt; Maybe (NameOf a)
</span><a href="Agda.Syntax.Common.html#getNameOf"><span class="hs-identifier hs-var">getNameOf</span></a></span><span>  </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1066"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1067"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NameOf (NamedArg Binder))
-&gt; NamedArg Binder -&gt; NamedArg Binder
forall a. LensNamed a =&gt; Maybe (NameOf a) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setNameOf"><span class="hs-identifier hs-var">setNameOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedName -&gt; Maybe NamedName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">NamedName
</span><a href="#local-6989586621682006368"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1068"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1069"></span><span>    </span><span id="local-6989586621682006368"><span class="annot"><span class="annottext">name :: NamedName
</span><a href="#local-6989586621682006368"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Ranged ArgName -&gt; NamedName
forall a. Origin -&gt; a -&gt; WithOrigin a
</span><a href="Agda.Syntax.Common.html#WithOrigin"><span class="hs-identifier hs-var">WithOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span>
</span><span id="line-1070"></span><span>         </span><span class="annot"><span class="annottext">(Ranged ArgName -&gt; NamedName) -&gt; Ranged ArgName -&gt; NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; ArgName -&gt; Ranged ArgName
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>         </span><span class="annot"><span class="annottext">(ArgName -&gt; Ranged ArgName) -&gt; ArgName -&gt; Ranged ArgName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ArgName
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ArgName) -&gt; Name -&gt; ArgName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span>
</span><span id="line-1072"></span><span>         </span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">(BindName -&gt; Name) -&gt; BindName -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; BindName
forall a. Binder' a -&gt; a
</span><a href="Agda.Syntax.Abstract.html#binderName"><span class="hs-identifier hs-var">A.binderName</span></a></span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; BindName) -&gt; Binder -&gt; BindName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Binder
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006365"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682003135"><span id="local-6989586621682006373"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003135"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Binder%27"><span class="hs-identifier hs-type">A.Binder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003135"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1075"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Binder%27"><span class="hs-identifier hs-type">A.Binder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003135"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder%27"><span class="hs-identifier hs-type">C.Binder'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003135"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span>  </span><span id="local-6989586621682006386"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Binder' a -&gt; (ConOfAbs (Binder' a) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Binder"><span class="hs-identifier hs-type">A.Binder</span></a></span><span> </span><span id="local-6989586621682006388"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621682006388"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682006389"><span class="annot"><span class="annottext">BinderNameOrigin
</span><a href="#local-6989586621682006389"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621682006390"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006390"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006391"><span class="annot"><span class="annottext">ConOfAbs (Binder' a) -&gt; m b
</span><a href="#local-6989586621682006391"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1078"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006390"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m b) -&gt; m b) -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006392"><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682006392"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1079"></span><span>    </span><span class="annot"><span class="annottext">Maybe Pattern -&gt; (ConOfAbs (Maybe Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Maybe Pattern -&gt; (ConOfAbs (Maybe Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621682006388"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (Maybe Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (Maybe Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006393"><span class="annot"><span class="annottext">ConOfAbs (Maybe Pattern)
</span><a href="#local-6989586621682006393"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1080"></span><span>    </span><span class="annot"><span class="annottext">ConOfAbs (Binder' a) -&gt; m b
</span><a href="#local-6989586621682006391"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs (Binder' a) -&gt; m b) -&gt; ConOfAbs (Binder' a) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
-&gt; BinderNameOrigin -&gt; ConOfAbs a -&gt; Binder' (ConOfAbs a)
forall a. Maybe Pattern -&gt; BinderNameOrigin -&gt; a -&gt; Binder' a
</span><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-var">C.Binder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
ConOfAbs (Maybe Pattern)
</span><a href="#local-6989586621682006393"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><a href="#local-6989586621682006389"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">ConOfAbs a
</span><a href="#local-6989586621682006392"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006396"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LamBinding"><span class="hs-identifier hs-type">A.LamBinding</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1083"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LamBinding"><span class="hs-identifier hs-type">A.LamBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamBinding"><span class="hs-identifier hs-type">C.LamBinding</span></a></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span>    </span><span id="local-6989586621682006422"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
LamBinding -&gt; (ConOfAbs LamBinding -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFree"><span class="hs-identifier hs-type">A.DomainFree</span></a></span><span> </span><span id="local-6989586621682006423"><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621682006423"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682006424"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682006424"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006425"><span class="annot"><span class="annottext">ConOfAbs LamBinding -&gt; m b
</span><a href="#local-6989586621682006425"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1086"></span><span>      </span><span id="local-6989586621682006426"><span class="annot"><a href="#local-6989586621682006426"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; TacticAttribute -&gt; m (TacticAttribute' Expr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; TacticAttribute' a -&gt; f (TacticAttribute' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621682006423"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1087"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006427"><span class="annot"><a href="#local-6989586621682006427"><span class="hs-identifier hs-var hs-var">setTac</span></a></span></span><span> </span><span id="local-6989586621682006428"><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621682006428"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621682006428"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#bnameTactic"><span class="hs-identifier hs-var">bnameTactic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682006426"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1088"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#forceNameIfHidden"><span class="hs-identifier hs-type">forceNameIfHidden</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006424"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1089"></span><span>        </span><span class="annot"><a href="#local-6989586621682006425"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DomainFree"><span class="hs-identifier hs-type">C.DomainFree</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-type">updateNamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="#local-6989586621682006427"><span class="hs-identifier hs-type">setTac</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFull"><span class="hs-identifier hs-type">A.DomainFull</span></a></span><span> </span><span id="local-6989586621682006432"><span class="annot"><span class="annottext">TypedBinding
</span><a href="#local-6989586621682006432"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006433"><span class="annot"><span class="annottext">ConOfAbs LamBinding -&gt; m b
</span><a href="#local-6989586621682006433"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedBinding -&gt; (ConOfAbs TypedBinding -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
TypedBinding -&gt; (ConOfAbs TypedBinding -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBinding
</span><a href="#local-6989586621682006432"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs TypedBinding -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs TypedBinding -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe LamBinding -&gt; m b
ConOfAbs LamBinding -&gt; m b
</span><a href="#local-6989586621682006433"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe LamBinding -&gt; m b)
-&gt; (ConOfAbs TypedBinding -&gt; Maybe LamBinding)
-&gt; ConOfAbs TypedBinding
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TypedBinding -&gt; LamBinding)
-&gt; Maybe TypedBinding -&gt; Maybe LamBinding
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">TypedBinding -&gt; LamBinding
forall a. a -&gt; LamBinding' a
</span><a href="Agda.Syntax.Concrete.html#DomainFull"><span class="hs-identifier hs-var">C.DomainFull</span></a></span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006436"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#TypedBinding"><span class="hs-identifier hs-type">A.TypedBinding</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1093"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#TypedBinding"><span class="hs-identifier hs-type">A.TypedBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypedBinding"><span class="hs-identifier hs-type">C.TypedBinding</span></a></span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span>    </span><span id="local-6989586621682006468"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
TypedBinding -&gt; (ConOfAbs TypedBinding -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#TBind"><span class="hs-identifier hs-type">A.TBind</span></a></span><span> </span><span id="local-6989586621682006469"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006469"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682006470"><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006470"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682006471"><span class="annot"><span class="annottext">List1 (NamedArg Binder)
</span><a href="#local-6989586621682006471"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682006472"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006472"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006473"><span class="annot"><span class="annottext">ConOfAbs TypedBinding -&gt; m b
</span><a href="#local-6989586621682006473"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1096"></span><span>        </span><span id="local-6989586621682006474"><span class="annot"><a href="#local-6989586621682006474"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; TacticAttribute -&gt; m (TacticAttribute' Expr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; TacticAttribute' a -&gt; f (TacticAttribute' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedBindingInfo -&gt; TacticAttribute
</span><a href="Agda.Syntax.Abstract.html#tbTacticAttr"><span class="hs-identifier hs-var">tbTacticAttr</span></a></span><span> </span><span class="annot"><span class="annottext">TypedBindingInfo
</span><a href="#local-6989586621682006470"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1097"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#forceNameIfHidden"><span class="hs-identifier hs-type">forceNameIfHidden</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006471"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006475"><span class="annot"><span class="annottext">ConOfAbs (List1 (NamedArg Binder))
</span><a href="#local-6989586621682006475"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1098"></span><span>          </span><span id="local-6989586621682006476"><span class="annot"><a href="#local-6989586621682006476"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006472"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1099"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006477"><span class="annot"><a href="#local-6989586621682006477"><span class="hs-identifier hs-var hs-var">setTac</span></a></span></span><span> </span><span id="local-6989586621682006478"><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621682006478"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621682006478"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#bnameTactic"><span class="hs-identifier hs-var">bnameTactic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682006474"><span class="hs-identifier hs-type">tac</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#bnameIsFinite"><span class="hs-identifier hs-var">C.bnameIsFinite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#tbFinite"><span class="hs-identifier hs-var">tbFinite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006470"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1100"></span><span>          </span><span class="annot"><a href="#local-6989586621682006473"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TBind"><span class="hs-identifier hs-type">C.TBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006469"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-type">updateNamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="#local-6989586621682006477"><span class="hs-identifier hs-type">setTac</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006475"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006476"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1101"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#TLet"><span class="hs-identifier hs-type">A.TLet</span></a></span><span> </span><span id="local-6989586621682006482"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006482"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682006483"><span class="annot"><span class="annottext">List1 LetBinding
</span><a href="#local-6989586621682006483"><span class="hs-identifier hs-var">lbs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006484"><span class="annot"><span class="annottext">ConOfAbs TypedBinding -&gt; m b
</span><a href="#local-6989586621682006484"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1102"></span><span>        </span><span class="annot"><span class="annottext">List1 LetBinding -&gt; (ConOfAbs (List1 LetBinding) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
List1 LetBinding -&gt; (ConOfAbs (List1 LetBinding) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 LetBinding
</span><a href="#local-6989586621682006483"><span class="hs-identifier hs-var">lbs</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (List1 LetBinding) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (List1 LetBinding) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006485"><span class="annot"><span class="annottext">ConOfAbs (List1 LetBinding)
</span><a href="#local-6989586621682006485"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1103"></span><span>        </span><span class="annot"><span class="annottext">ConOfAbs TypedBinding -&gt; m b
</span><a href="#local-6989586621682006484"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs TypedBinding -&gt; m b) -&gt; ConOfAbs TypedBinding -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Declaration] -&gt; Maybe TypedBinding
forall e. Range -&gt; [Declaration] -&gt; Maybe (TypedBinding' e)
</span><a href="Agda.Syntax.Concrete.html#mkTLet"><span class="hs-identifier hs-var">C.mkTLet</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006482"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; Maybe TypedBinding)
-&gt; [Declaration] -&gt; Maybe TypedBinding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty [Declaration] -&gt; [Declaration]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty [Declaration]
ConOfAbs (List1 LetBinding)
</span><a href="#local-6989586621682006485"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1104"></span><span>
</span><span id="line-1105"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006488"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetBinding"><span class="hs-identifier hs-type">A.LetBinding</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1106"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetBinding"><span class="hs-identifier hs-type">A.LetBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span>    </span><span id="local-6989586621682006551"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
LetBinding -&gt; (ConOfAbs LetBinding -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetBind"><span class="hs-identifier hs-type">A.LetBind</span></a></span><span> </span><span id="local-6989586621682006553"><span class="annot"><span class="annottext">LetInfo
</span><a href="#local-6989586621682006553"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006554"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006554"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682006555"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682006555"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006556"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006556"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682006557"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006557"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006558"><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006558"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1109"></span><span>      </span><span class="annot"><span class="annottext">BindName -&gt; (ConOfAbs BindName -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindName -&gt; (ConOfAbs BindName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682006555"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006559"><span class="annot"><span class="annottext">ConOfAbs BindName
</span><a href="#local-6989586621682006559"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1110"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1111"></span><span>          </span><span id="local-6989586621682006560"><span class="annot"><span class="annottext">keep :: Expr -&gt; Bool
</span><a href="#local-6989586621682006560"><span class="hs-identifier hs-var hs-var">keep</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-type">C.Underscore</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1112"></span><span>          </span><span class="annot"><a href="#local-6989586621682006560"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1113"></span><span>        </span><span class="annot"><span class="annottext">(Expr, RHS) -&gt; m (ConOfAbs (Expr, RHS))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(Expr, RHS) -&gt; m (ConOfAbs (Expr, RHS))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006556"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr -&gt; RHS
</span><a href="Agda.Syntax.Abstract.html#RHS"><span class="hs-identifier hs-var">A.RHS</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006557"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Expr, (RHS, [RewriteEqn], [WithExpr], [Declaration]))
-&gt; ((Expr, (RHS, [RewriteEqn], [WithExpr], [Declaration])) -&gt; m b)
-&gt; m b
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1114"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682006562"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006562"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682006563"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006563"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1115"></span><span>           </span><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006558"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs LetBinding -&gt; m b) -&gt; ConOfAbs LetBinding -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe KwRange -&gt; [Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-var">addInstanceB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isInstance"><span class="hs-identifier hs-var">isInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006554"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Maybe KwRange
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe KwRange
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration]) -&gt; [Declaration] -&gt; [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1116"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; TacticAttribute' Expr -&gt; Name -&gt; Expr -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-var">C.TypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006554"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute' Expr
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundName -&gt; Name
</span><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><span class="annottext">BoundName
ConOfAbs BindName
</span><a href="#local-6989586621682006559"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006562"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621682006560"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006562"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-1117"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ArgInfo
-&gt; LHS
-&gt; RHS
-&gt; WhereClause' [Declaration]
-&gt; Catchall
-&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#FunClause"><span class="hs-identifier hs-var">C.FunClause</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006554"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1118"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [RewriteEqn] -&gt; [WithExpr] -&gt; LHS
</span><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-var">C.LHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-var">C.IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pattern) -&gt; QName -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BoundName -&gt; Name
</span><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><span class="annottext">BoundName
ConOfAbs BindName
</span><a href="#local-6989586621682006559"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>                </span><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006563"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">WhereClause' [Declaration]
forall decls. WhereClause' decls
</span><a href="Agda.Syntax.Concrete.html#NoWhere"><span class="hs-identifier hs-var">C.NoWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Catchall
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-1120"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1121"></span><span>          </span><span class="annot"><span class="annottext">(Expr, (RHS, [RewriteEqn], [WithExpr], [Declaration]))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m b
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetAxiom"><span class="hs-identifier hs-type">A.LetAxiom</span></a></span><span> </span><span id="local-6989586621682006568"><span class="annot"><span class="annottext">LetInfo
</span><a href="#local-6989586621682006568"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006569"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006569"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682006570"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682006570"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006571"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006571"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006572"><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006572"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BindName -&gt; (ConOfAbs BindName -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindName -&gt; (ConOfAbs BindName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682006570"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682006573"><span class="annot"><span class="annottext">ConOfAbs BindName
</span><a href="#local-6989586621682006573"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1123"></span><span>      </span><span id="local-6989586621682006574"><span class="annot"><a href="#local-6989586621682006574"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006571"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1124"></span><span>      </span><span class="annot"><a href="#local-6989586621682006572"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#addInstanceB"><span class="hs-identifier hs-type">addInstanceB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#isInstance"><span class="hs-identifier hs-type">isInstance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006569"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1125"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-type">C.TypeSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006569"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006573"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006574"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1126"></span><span>    </span><span class="hs-comment">-- TODO: bind variables</span><span>
</span><span id="line-1127"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetPatBind"><span class="hs-identifier hs-type">LetPatBind</span></a></span><span> </span><span id="local-6989586621682006576"><span class="annot"><span class="annottext">LetInfo
</span><a href="#local-6989586621682006576"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006577"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006577"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621682006578"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006578"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682006579"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006579"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006580"><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006580"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1128"></span><span>        </span><span id="local-6989586621682006581"><span class="annot"><a href="#local-6989586621682006581"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006578"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1129"></span><span>        </span><span id="local-6989586621682006582"><span class="annot"><a href="#local-6989586621682006582"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006579"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1130"></span><span>        </span><span class="annot"><a href="#local-6989586621682006580"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#FunClause"><span class="hs-identifier hs-type">C.FunClause</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006577"><span class="hs-identifier hs-type">ai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006581"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-type">C.RHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006582"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#NoWhere"><span class="hs-identifier hs-type">NoWhere</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1131"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetApply"><span class="hs-identifier hs-type">LetApply</span></a></span><span> </span><span id="local-6989586621682006585"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682006585"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006586"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006586"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682006587"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006588"><span class="annot"><span class="annottext">ModuleApplication
</span><a href="#local-6989586621682006588"><span class="hs-identifier hs-var">modapp</span></a></span></span><span> </span><span class="annot"><span class="annottext">ScopeCopyInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006589"><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006589"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1132"></span><span>      </span><span id="local-6989586621682006590"><span class="annot"><a href="#local-6989586621682006590"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">unqualify</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006587"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1133"></span><span>      </span><span id="local-6989586621682006591"><span class="annot"><a href="#local-6989586621682006591"><span class="hs-identifier hs-var">modapp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006588"><span class="hs-identifier hs-type">modapp</span></a></span><span>
</span><span id="line-1134"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006592"><span class="annot"><a href="#local-6989586621682006592"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleApplication -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleApplication
</span><a href="#local-6989586621682006591"><span class="hs-identifier hs-var">modapp</span></a></span><span>
</span><span id="line-1135"></span><span>          </span><span id="local-6989586621682006593"><span class="annot"><a href="#local-6989586621682006593"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; OpenShortHand
</span><a href="Agda.Syntax.Info.html#minfoOpenShort"><span class="hs-identifier hs-var">minfoOpenShort</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682006585"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1136"></span><span>          </span><span id="local-6989586621682006595"><span class="annot"><a href="#local-6989586621682006595"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDirective -&gt; Maybe ImportDirective -&gt; ImportDirective
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
forall n m. ImportDirective' n m
</span><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-var">defaultImportDir</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#importDirRange"><span class="hs-identifier hs-var">importDirRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682006592"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">(Maybe ImportDirective -&gt; ImportDirective)
-&gt; Maybe ImportDirective -&gt; ImportDirective
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; Maybe ImportDirective
</span><a href="Agda.Syntax.Info.html#minfoDirective"><span class="hs-identifier hs-var">minfoDirective</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682006585"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1137"></span><span>      </span><span class="hs-comment">-- This is no use since toAbstract LetDefs is in localToAbstract.</span><span>
</span><span id="line-1138"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#openModule%27"><span class="hs-identifier hs-type">openModule'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006587"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006595"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1139"></span><span>        </span><span class="annot"><a href="#local-6989586621682006589"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ModuleMacro"><span class="hs-identifier hs-type">C.ModuleMacro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006585"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006586"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006590"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006591"><span class="hs-identifier hs-type">modapp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006593"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006595"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1140"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LetOpen"><span class="hs-identifier hs-type">LetOpen</span></a></span><span> </span><span id="local-6989586621682006603"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682006603"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006604"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006604"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006605"><span class="annot"><span class="annottext">ConOfAbs LetBinding -&gt; m b
</span><a href="#local-6989586621682006605"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1141"></span><span>      </span><span id="local-6989586621682006606"><span class="annot"><a href="#local-6989586621682006606"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006604"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1142"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006607"><span class="annot"><a href="#local-6989586621682006607"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDirective -&gt; Maybe ImportDirective -&gt; ImportDirective
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
forall n m. ImportDirective' n m
</span><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-var">defaultImportDir</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ImportDirective -&gt; ImportDirective)
-&gt; Maybe ImportDirective -&gt; ImportDirective
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; Maybe ImportDirective
</span><a href="Agda.Syntax.Info.html#minfoDirective"><span class="hs-identifier hs-var">minfoDirective</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682006603"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1143"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#openModule%27"><span class="hs-identifier hs-type">openModule'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006604"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006607"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#restrictPrivate"><span class="hs-identifier hs-type">restrictPrivate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1144"></span><span>            </span><span class="annot"><a href="#local-6989586621682006605"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Open"><span class="hs-identifier hs-type">C.Open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.KeywordRange.html#kwRange"><span class="hs-identifier hs-type">kwRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006603"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006606"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006607"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1145"></span><span>              </span><span class="hs-comment">-- Andreas, 2025-11-27, kwRange is a lie,</span><span>
</span><span id="line-1146"></span><span>              </span><span class="hs-comment">-- but we do not have the range of the @open@ keyword here.</span><span>
</span><span id="line-1147"></span><span>
</span><span id="line-1148"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006612"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WhereDeclarations"><span class="hs-identifier hs-type">A.WhereDeclarations</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1149"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WhereDeclarations"><span class="hs-identifier hs-type">A.WhereDeclarations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WhereClause"><span class="hs-identifier hs-type">WhereClause</span></a></span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span>  </span><span id="local-6989586621682006637"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
WhereDeclarations -&gt; (ConOfAbs WhereDeclarations -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#WhereDecls"><span class="hs-identifier hs-type">A.WhereDecls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Declaration
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006639"><span class="annot"><span class="annottext">ConOfAbs WhereDeclarations -&gt; m b
</span><a href="#local-6989586621682006639"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConOfAbs WhereDeclarations -&gt; m b
</span><a href="#local-6989586621682006639"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">WhereClause' [Declaration]
ConOfAbs WhereDeclarations
forall decls. WhereClause' decls
</span><a href="Agda.Syntax.Concrete.html#NoWhere"><span class="hs-identifier hs-var">C.NoWhere</span></a></span><span>
</span><span id="line-1152"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#WhereDecls"><span class="hs-identifier hs-type">A.WhereDecls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682006640"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006640"><span class="hs-identifier hs-var">am</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1153"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Section"><span class="hs-identifier hs-type">A.Section</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006642"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006642"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">GeneralizeTelescope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006643"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006643"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span>                 </span><span id="local-6989586621682006644"><span class="annot"><span class="annottext">ConOfAbs WhereDeclarations -&gt; m b
</span><a href="#local-6989586621682006644"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1155"></span><span>    </span><span id="local-6989586621682006645"><span class="annot"><a href="#local-6989586621682006645"><span class="hs-identifier hs-var">ds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-var">declsToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006643"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1156"></span><span>    </span><span id="local-6989586621682006647"><span class="annot"><a href="#local-6989586621682006647"><span class="hs-identifier hs-var">cm</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-type">unqualify</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupModule"><span class="hs-identifier hs-type">lookupModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006640"><span class="hs-identifier hs-type">am</span></a></span><span>
</span><span id="line-1157"></span><span>    </span><span class="hs-comment">-- Andreas, 2016-07-08 I put PublicAccess in the following SomeWhere</span><span>
</span><span id="line-1158"></span><span>    </span><span class="hs-comment">-- Should not really matter for printing...</span><span>
</span><span id="line-1159"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006648"><span class="annot"><a href="#local-6989586621682006648"><span class="hs-identifier hs-var hs-var">wh'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006647"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Erased -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isErased"><span class="hs-identifier hs-var">isErased</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006642"><span class="hs-identifier hs-var">erased</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Declaration] -&gt; WhereClause' [Declaration]
forall decls. Range -&gt; decls -&gt; WhereClause' decls
</span><a href="Agda.Syntax.Concrete.html#AnyWhere"><span class="hs-identifier hs-var">AnyWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006645"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-1161"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; Erased
-&gt; Name
-&gt; Access
-&gt; [Declaration]
-&gt; WhereClause' [Declaration]
forall decls.
Range -&gt; Erased -&gt; Name -&gt; Access -&gt; decls -&gt; WhereClause' decls
</span><a href="Agda.Syntax.Concrete.html#SomeWhere"><span class="hs-identifier hs-var">SomeWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006642"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006647"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">Access
</span><a href="Agda.Syntax.Common.html#PublicAccess"><span class="hs-identifier hs-var">PublicAccess</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006645"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-1162"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#openModule%27"><span class="hs-identifier hs-type">openModule'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006640"><span class="hs-identifier hs-type">am</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-type">defaultImportDir</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682006644"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006648"><span class="hs-identifier hs-type">wh'</span></a></span><span>
</span><span id="line-1163"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#WhereDecls"><span class="hs-identifier hs-type">A.WhereDecls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682006653"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006653"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682006654"><span class="annot"><span class="annottext">ConOfAbs WhereDeclarations -&gt; m b
</span><a href="#local-6989586621682006654"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1164"></span><span>    </span><span class="annot"><span class="annottext">WhereClause' [Declaration] -&gt; m b
ConOfAbs WhereDeclarations -&gt; m b
</span><a href="#local-6989586621682006654"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(WhereClause' [Declaration] -&gt; m b)
-&gt; ([Declaration] -&gt; WhereClause' [Declaration])
-&gt; [Declaration]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Declaration] -&gt; WhereClause' [Declaration]
forall decls. Range -&gt; decls -&gt; WhereClause' decls
</span><a href="Agda.Syntax.Concrete.html#AnyWhere"><span class="hs-identifier hs-var">AnyWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; m b) -&gt; m [Declaration] -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; m (ConOfAbs Declaration)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Declaration -&gt; m (ConOfAbs Declaration)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006653"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-type">mergeSigAndDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1167"></span><span id="mergeSigAndDef"><span class="annot"><span class="annottext">mergeSigAndDef :: [Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var hs-var">mergeSigAndDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordSig"><span class="hs-identifier hs-type">C.RecordSig</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006657"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006657"><span class="hs-identifier hs-var">er</span></a></span></span><span> </span><span id="local-6989586621682006658"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006658"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006659"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006659"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682006660"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006660"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordDef"><span class="hs-identifier hs-type">C.RecordDef</span></a></span><span> </span><span id="local-6989586621682006662"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006662"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682006663"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006663"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682006664"><span class="annot"><span class="annottext">[RecordDirective]
</span><a href="#local-6989586621682006664"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006665"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006665"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682006666"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006666"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006658"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006663"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; Erased
-&gt; Name
-&gt; [RecordDirective]
-&gt; [LamBinding]
-&gt; Expr
-&gt; [Declaration]
-&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Record"><span class="hs-identifier hs-var">C.Record</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006662"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006657"><span class="hs-identifier hs-var">er</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006663"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[RecordDirective]
</span><a href="#local-6989586621682006664"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006659"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006660"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006665"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration] -&gt; [Declaration]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006666"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#DataSig"><span class="hs-identifier hs-type">C.DataSig</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006669"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006669"><span class="hs-identifier hs-var">er</span></a></span></span><span> </span><span id="local-6989586621682006670"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006670"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006671"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006671"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682006672"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006672"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DataDef"><span class="hs-identifier hs-type">C.DataDef</span></a></span><span> </span><span id="local-6989586621682006674"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006674"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682006675"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006675"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006676"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006676"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682006677"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006677"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006670"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006675"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; Erased
-&gt; Name
-&gt; [LamBinding]
-&gt; Expr
-&gt; [Declaration]
-&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Data"><span class="hs-identifier hs-var">C.Data</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682006674"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682006669"><span class="hs-identifier hs-var">er</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682006675"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682006671"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006672"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006676"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration] -&gt; [Declaration]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006677"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1171"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682006679"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006679"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682006680"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006680"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006679"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration] -&gt; [Declaration]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006680"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1173"></span><span>
</span><span id="line-1174"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#openModule%27"><span class="hs-identifier hs-type">openModule'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">A.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ImportDirective"><span class="hs-identifier hs-type">C.ImportDirective</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-1175"></span><span id="openModule%27"><span class="annot"><span class="annottext">openModule' :: ModuleName -&gt; ImportDirective -&gt; (Scope -&gt; Scope) -&gt; Env -&gt; Env
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#openModule%27"><span class="hs-identifier hs-var hs-var">openModule'</span></a></span></span><span> </span><span id="local-6989586621682006681"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006681"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006682"><span class="annot"><span class="annottext">ImportDirective
</span><a href="#local-6989586621682006682"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621682006683"><span class="annot"><span class="annottext">Scope -&gt; Scope
</span><a href="#local-6989586621682006683"><span class="hs-identifier hs-var">restrict</span></a></span></span><span> </span><span id="local-6989586621682006684"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682006684"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682006684"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#scopeModules"><span class="hs-identifier hs-type">scopeModules</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006688"><span class="hs-identifier hs-type">mods'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006689"><span class="hs-identifier hs-type">sInfo</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1176"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682006689"><span class="annot"><span class="annottext">sInfo :: ScopeInfo
</span><a href="#local-6989586621682006689"><span class="hs-identifier hs-var hs-var">sInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; ScopeInfo
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621682006684"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1177"></span><span>        </span><span id="local-6989586621682006690"><span class="annot"><span class="annottext">amod :: ModuleName
</span><a href="#local-6989586621682006690"><span class="hs-identifier hs-var hs-var">amod</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682006689"><span class="hs-identifier hs-var">sInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; Lens' ScopeInfo ModuleName -&gt; ModuleName
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; f ModuleName) -&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo ModuleName
</span><a href="Agda.Syntax.Scope.Base.html#scopeCurrent"><span class="hs-identifier hs-var">scopeCurrent</span></a></span><span>
</span><span id="line-1178"></span><span>        </span><span id="local-6989586621682006694"><span class="annot"><span class="annottext">mods :: Map ModuleName Scope
</span><a href="#local-6989586621682006694"><span class="hs-identifier hs-var hs-var">mods</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682006689"><span class="hs-identifier hs-var">sInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
-&gt; Lens' ScopeInfo (Map ModuleName Scope) -&gt; Map ModuleName Scope
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ModuleName Scope -&gt; f (Map ModuleName Scope))
-&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo (Map ModuleName Scope)
</span><a href="Agda.Syntax.Scope.Base.html#scopeModules"><span class="hs-identifier hs-var">scopeModules</span></a></span><span>
</span><span id="line-1179"></span><span>        </span><span id="local-6989586621682006697"><span class="annot"><span class="annottext">news :: Scope
</span><a href="#local-6989586621682006697"><span class="hs-identifier hs-var hs-var">news</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpaceId -&gt; Scope -&gt; Scope
</span><a href="Agda.Syntax.Scope.Base.html#setScopeAccess"><span class="hs-identifier hs-var">setScopeAccess</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpaceId
</span><a href="Agda.Syntax.Scope.Base.html#PrivateNS"><span class="hs-identifier hs-var">PrivateNS</span></a></span><span>
</span><span id="line-1180"></span><span>                </span><span class="annot"><span class="annottext">(Scope -&gt; Scope) -&gt; Scope -&gt; Scope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective -&gt; Scope -&gt; Scope
</span><a href="Agda.Syntax.Scope.Base.html#applyImportDirective"><span class="hs-identifier hs-var">applyImportDirective</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><a href="#local-6989586621682006682"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-1181"></span><span>                </span><span class="annot"><span class="annottext">(Scope -&gt; Scope) -&gt; Scope -&gt; Scope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Scope -&gt; (Scope -&gt; Scope) -&gt; Maybe Scope -&gt; Scope
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Agda.Syntax.Scope.Base.html#emptyScope"><span class="hs-identifier hs-var">emptyScope</span></a></span><span> </span><span class="annot"><span class="annottext">Scope -&gt; Scope
</span><a href="#local-6989586621682006683"><span class="hs-identifier hs-var">restrict</span></a></span><span>
</span><span id="line-1182"></span><span>                </span><span class="annot"><span class="annottext">(Maybe Scope -&gt; Scope) -&gt; Maybe Scope -&gt; Scope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Map ModuleName Scope -&gt; Maybe Scope
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006681"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map ModuleName Scope
</span><a href="#local-6989586621682006694"><span class="hs-identifier hs-var">mods</span></a></span><span>
</span><span id="line-1183"></span><span>        </span><span id="local-6989586621682006688"><span class="annot"><span class="annottext">mods' :: Map ModuleName Scope
</span><a href="#local-6989586621682006688"><span class="hs-identifier hs-var hs-var">mods'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scope -&gt; Maybe Scope)
-&gt; ModuleName -&gt; Map ModuleName Scope -&gt; Map ModuleName Scope
forall k a. Ord k =&gt; (a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.update</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope -&gt; Maybe Scope
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Scope -&gt; Maybe Scope) -&gt; (Scope -&gt; Scope) -&gt; Scope -&gt; Maybe Scope
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope -&gt; Scope -&gt; Scope
</span><a href="Agda.Syntax.Scope.Base.html#mergeScope"><span class="hs-operator hs-var">`mergeScope`</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="#local-6989586621682006697"><span class="hs-identifier hs-var">news</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006690"><span class="hs-identifier hs-var">amod</span></a></span><span> </span><span class="annot"><span class="annottext">Map ModuleName Scope
</span><a href="#local-6989586621682006694"><span class="hs-identifier hs-var">mods</span></a></span><span>
</span><span id="line-1184"></span><span>
</span><span id="line-1185"></span><span>
</span><span id="line-1186"></span><span class="hs-comment">-- Declaration instances --------------------------------------------------</span><span>
</span><span id="line-1187"></span><span>
</span><span id="line-1188"></span><span id="local-6989586621682003181"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-type">declsToConcrete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003181"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003181"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1189"></span><span id="declsToConcrete"><span class="annot"><span class="annottext">declsToConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-var hs-var">declsToConcrete</span></a></span></span><span> </span><span id="local-6989586621682006713"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006713"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#mergeSigAndDef"><span class="hs-identifier hs-var">mergeSigAndDef</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; ([[Declaration]] -&gt; [Declaration])
-&gt; [[Declaration]]
-&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Declaration]] -&gt; [Declaration]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Declaration]] -&gt; [Declaration])
-&gt; m [[Declaration]] -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m (ConOfAbs [Declaration])
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m (ConOfAbs [Declaration])
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682006713"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1190"></span><span>
</span><span id="line-1191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006716"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RHS"><span class="hs-identifier hs-type">A.RHS</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1192"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RHS"><span class="hs-identifier hs-type">A.RHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-type">C.RHS</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">C.RewriteEqn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithExpr"><span class="hs-identifier hs-type">C.WithExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>
</span><span id="line-1194"></span><span>    </span><span id="local-6989586621682006782"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; RHS -&gt; m (ConOfAbs RHS)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RHS"><span class="hs-identifier hs-type">A.RHS</span></a></span><span> </span><span id="local-6989586621682006783"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006783"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682006784"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006784"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RHS, [RewriteEqn], [WithExpr], [Declaration])
-&gt; m (RHS, [RewriteEqn], [WithExpr], [Declaration])
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; RHS
forall e. e -&gt; RHS' e
</span><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-var">C.RHS</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006784"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RHS"><span class="hs-identifier hs-type">A.RHS</span></a></span><span> </span><span id="local-6989586621682006785"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006785"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1196"></span><span>      </span><span id="local-6989586621682006786"><span class="annot"><a href="#local-6989586621682006786"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006785"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1197"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-type">C.RHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006786"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">RHS
</span><a href="Agda.Syntax.Abstract.html#AbsurdRHS"><span class="hs-identifier hs-var">A.AbsurdRHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RHS, [RewriteEqn], [WithExpr], [Declaration])
-&gt; m (RHS, [RewriteEqn], [WithExpr], [Declaration])
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RHS
forall e. RHS' e
</span><a href="Agda.Syntax.Concrete.html#AbsurdRHS"><span class="hs-identifier hs-var">C.AbsurdRHS</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithRHS"><span class="hs-identifier hs-type">A.WithRHS</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006790"><span class="annot"><span class="annottext">List1 WithExpr
</span><a href="#local-6989586621682006790"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682006791"><span class="annot"><span class="annottext">List1 Clause
</span><a href="#local-6989586621682006791"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1200"></span><span>      </span><span id="local-6989586621682006792"><span class="annot"><a href="#local-6989586621682006792"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682006793"><span class="annot"><a href="#local-6989586621682006793"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">List1 WithExpr -&gt; m (ConOfAbs (List1 WithExpr))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
List1 WithExpr -&gt; m (ConOfAbs (List1 WithExpr))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 WithExpr
</span><a href="#local-6989586621682006790"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1201"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="annot"><a href="#local-6989586621682006793"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621682006795"><span class="annot"><span class="annottext">Maybe BindName
</span><a href="#local-6989586621682006795"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682006796"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682006796"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1202"></span><span>                 </span><span id="local-6989586621682006797"><span class="annot"><a href="#local-6989586621682006797"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BindName -&gt; m BoundName) -&gt; Maybe BindName -&gt; m (Maybe BoundName)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; m BoundName
BindName -&gt; m (ConOfAbs BindName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
BindName -&gt; m (ConOfAbs BindName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BindName
</span><a href="#local-6989586621682006795"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1203"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682006797"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006796"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1204"></span><span>      </span><span id="local-6989586621682006798"><span class="annot"><a href="#local-6989586621682006798"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#noTakenNames"><span class="hs-identifier hs-type">noTakenNames</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">sconcat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006791"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-1205"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#AbsurdRHS"><span class="hs-identifier hs-type">C.AbsurdRHS</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List1.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621682006792"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List1.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621682006798"><span class="hs-identifier hs-type">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1206"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RewriteRHS"><span class="hs-identifier hs-type">A.RewriteRHS</span></a></span><span> </span><span id="local-6989586621682006800"><span class="annot"><span class="annottext">[RewriteEqn]
</span><a href="#local-6989586621682006800"><span class="hs-identifier hs-var">xeqs</span></a></span></span><span> </span><span id="local-6989586621682006801"><span class="annot"><span class="annottext">[ProblemEq]
</span><a href="#local-6989586621682006801"><span class="hs-identifier hs-var">_spats</span></a></span></span><span> </span><span id="local-6989586621682006802"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006802"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682006803"><span class="annot"><span class="annottext">WhereDeclarations
</span><a href="#local-6989586621682006803"><span class="hs-identifier hs-var">wh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1207"></span><span>      </span><span id="local-6989586621682006804"><span class="annot"><a href="#local-6989586621682006804"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m [Declaration]
-&gt; (Declaration -&gt; m [Declaration])
-&gt; Maybe Declaration
-&gt; m [Declaration]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; m [Declaration]
Declaration -&gt; m (ConOfAbs Declaration)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Declaration -&gt; m (ConOfAbs Declaration)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Declaration -&gt; m [Declaration])
-&gt; Maybe Declaration -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WhereDeclarations -&gt; Maybe Declaration
</span><a href="Agda.Syntax.Abstract.html#whereDecls"><span class="hs-identifier hs-var">A.whereDecls</span></a></span><span> </span><span class="annot"><span class="annottext">WhereDeclarations
</span><a href="#local-6989586621682006803"><span class="hs-identifier hs-var">wh</span></a></span><span>
</span><span id="line-1208"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682006806"><span class="annot"><a href="#local-6989586621682006806"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006807"><span class="annot"><a href="#local-6989586621682006807"><span class="hs-identifier hs-var">eqs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006808"><span class="annot"><a href="#local-6989586621682006808"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006809"><span class="annot"><a href="#local-6989586621682006809"><span class="hs-identifier hs-var">whs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006802"><span class="hs-identifier hs-type">rhs</span></a></span><span>
</span><span id="line-1209"></span><span>      </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-type">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006807"><span class="hs-identifier hs-type">eqs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1210"></span><span>      </span><span id="local-6989586621682006811"><span class="annot"><a href="#local-6989586621682006811"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006800"><span class="hs-identifier hs-type">xeqs</span></a></span><span>
</span><span id="line-1211"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682006806"><span class="hs-identifier hs-type">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682006811"><span class="hs-identifier hs-type">eqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682006808"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682006804"><span class="hs-identifier hs-type">wh</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682006809"><span class="hs-identifier hs-type">whs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682003195"><span id="local-6989586621682003196"><span id="local-6989586621682003197"><span id="local-6989586621682006816"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003195"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#RewriteEqn%27"><span class="hs-identifier hs-type">RewriteEqn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003197"><span class="hs-identifier hs-type">qn</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">A.BindName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003195"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#RewriteEqn%27"><span class="hs-identifier hs-type">RewriteEqn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003197"><span class="hs-identifier hs-type">qn</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">A.BindName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003195"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#RewriteEqn%27"><span class="hs-identifier hs-type">RewriteEqn'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003195"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span>  </span><span id="local-6989586621682006851"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RewriteEqn' qn BindName p a
-&gt; m (ConOfAbs (RewriteEqn' qn BindName p a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1217"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Rewrite"><span class="hs-identifier hs-type">Rewrite</span></a></span><span> </span><span id="local-6989586621682006853"><span class="annot"><span class="annottext">List1 (qn, a)
</span><a href="#local-6989586621682006853"><span class="hs-identifier hs-var">es</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 ((), ConOfAbs a)
-&gt; RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a)
forall qn nm p e. List1 (qn, e) -&gt; RewriteEqn' qn nm p e
</span><a href="Agda.Syntax.Common.html#Rewrite"><span class="hs-identifier hs-var">Rewrite</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 ((), ConOfAbs a)
 -&gt; RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a))
-&gt; m (List1 ((), ConOfAbs a))
-&gt; m (RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((qn, a) -&gt; m ((), ConOfAbs a))
-&gt; List1 (qn, a) -&gt; m (List1 ((), ConOfAbs a))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((), a) -&gt; m ((), ConOfAbs a)
((), a) -&gt; m (ConOfAbs ((), a))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
((), a) -&gt; m (ConOfAbs ((), a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(((), a) -&gt; m ((), ConOfAbs a))
-&gt; ((qn, a) -&gt; ((), a)) -&gt; (qn, a) -&gt; m ((), ConOfAbs a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">qn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006854"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006854"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006854"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List1 (qn, a)
</span><a href="#local-6989586621682006853"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1218"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Invert"><span class="hs-identifier hs-type">Invert</span></a></span><span> </span><span id="local-6989586621682006856"><span class="annot"><span class="annottext">qn
</span><a href="#local-6989586621682006856"><span class="hs-identifier hs-var">qn</span></a></span></span><span> </span><span id="local-6989586621682006857"><span class="annot"><span class="annottext">List1 (Named BindName (p, a))
</span><a href="#local-6989586621682006857"><span class="hs-identifier hs-var">pes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(List1 (Named Name (ConOfAbs p, ConOfAbs a))
 -&gt; ConOfAbs (RewriteEqn' qn BindName p a))
-&gt; m (List1 (Named Name (ConOfAbs p, ConOfAbs a)))
-&gt; m (ConOfAbs (RewriteEqn' qn BindName p a))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
-&gt; List1 (Named Name (ConOfAbs p, ConOfAbs a))
-&gt; RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a)
forall qn nm p e.
qn -&gt; List1 (Named nm (p, e)) -&gt; RewriteEqn' qn nm p e
</span><a href="Agda.Syntax.Common.html#Invert"><span class="hs-identifier hs-var">Invert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (List1 (Named Name (ConOfAbs p, ConOfAbs a)))
 -&gt; m (ConOfAbs (RewriteEqn' qn BindName p a)))
-&gt; m (List1 (Named Name (ConOfAbs p, ConOfAbs a)))
-&gt; m (ConOfAbs (RewriteEqn' qn BindName p a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 (Named BindName (p, a))
-&gt; (Named BindName (p, a)
    -&gt; m (Named Name (ConOfAbs p, ConOfAbs a)))
-&gt; m (List1 (Named Name (ConOfAbs p, ConOfAbs a)))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">List1 (Named BindName (p, a))
</span><a href="#local-6989586621682006857"><span class="hs-identifier hs-var">pes</span></a></span><span> </span><span class="annot"><span class="annottext">((Named BindName (p, a) -&gt; m (Named Name (ConOfAbs p, ConOfAbs a)))
 -&gt; m (List1 (Named Name (ConOfAbs p, ConOfAbs a))))
-&gt; (Named BindName (p, a)
    -&gt; m (Named Name (ConOfAbs p, ConOfAbs a)))
-&gt; m (List1 (Named Name (ConOfAbs p, ConOfAbs a)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621682006858"><span class="annot"><span class="annottext">Maybe BindName
</span><a href="#local-6989586621682006858"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682006859"><span class="annot"><span class="annottext">(p, a)
</span><a href="#local-6989586621682006859"><span class="hs-identifier hs-var">pe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1219"></span><span>      </span><span id="local-6989586621682006860"><span class="annot"><a href="#local-6989586621682006860"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(p, a) -&gt; m (ConOfAbs (p, a))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(p, a) -&gt; m (ConOfAbs (p, a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(p, a)
</span><a href="#local-6989586621682006859"><span class="hs-identifier hs-var">pe</span></a></span><span>
</span><span id="line-1220"></span><span>      </span><span id="local-6989586621682006861"><span class="annot"><a href="#local-6989586621682006861"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006858"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-1221"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006861"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006860"><span class="hs-identifier hs-type">pe</span></a></span><span>
</span><span id="line-1222"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#LeftLet"><span class="hs-identifier hs-type">LeftLet</span></a></span><span> </span><span id="local-6989586621682006863"><span class="annot"><span class="annottext">List1 (p, a)
</span><a href="#local-6989586621682006863"><span class="hs-identifier hs-var">pes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 (ConOfAbs p, ConOfAbs a)
-&gt; RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a)
forall qn nm p e. List1 (p, e) -&gt; RewriteEqn' qn nm p e
</span><a href="Agda.Syntax.Common.html#LeftLet"><span class="hs-identifier hs-var">LeftLet</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 (ConOfAbs p, ConOfAbs a)
 -&gt; RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a))
-&gt; m (List1 (ConOfAbs p, ConOfAbs a))
-&gt; m (RewriteEqn' () Name (ConOfAbs p) (ConOfAbs a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((p, a) -&gt; m (ConOfAbs p, ConOfAbs a))
-&gt; List1 (p, a) -&gt; m (List1 (ConOfAbs p, ConOfAbs a))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(p, a) -&gt; m (ConOfAbs p, ConOfAbs a)
(p, a) -&gt; m (ConOfAbs (p, a))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(p, a) -&gt; m (ConOfAbs (p, a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (p, a)
</span><a href="#local-6989586621682006863"><span class="hs-identifier hs-var">pes</span></a></span><span>
</span><span id="line-1223"></span><span>
</span><span id="line-1224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006866"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Constructor"><span class="hs-identifier hs-type">A.Constructor</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Constructor"><span class="hs-identifier hs-type">A.Constructor</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span>  </span><span id="local-6989586621682006897"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Constr Declaration -&gt; m (ConOfAbs (Constr Declaration))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">A.ScopedDecl</span></a></span><span> </span><span id="local-6989586621682006900"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682006900"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682006901"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006901"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1228"></span><span>    </span><span class="annot"><span class="annottext">ScopeInfo
-&gt; m (ConOfAbs (Constr Declaration))
-&gt; m (ConOfAbs (Constr Declaration))
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
ScopeInfo -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withScope"><span class="hs-identifier hs-var">withScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682006900"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ConOfAbs (Constr Declaration))
 -&gt; m (ConOfAbs (Constr Declaration)))
-&gt; m (ConOfAbs (Constr Declaration))
-&gt; m (ConOfAbs (Constr Declaration))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Constr Declaration -&gt; m (ConOfAbs (Constr Declaration))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Constr Declaration -&gt; m (ConOfAbs (Constr Declaration))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Declaration -&gt; Constr Declaration
forall a. a -&gt; Constr a
</span><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006901"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Axiom"><span class="hs-identifier hs-type">A.Axiom</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006903"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682006903"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682006904"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682006904"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe PragmaPolarities
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621682006905"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006905"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682006906"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682006906"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1230"></span><span>    </span><span id="local-6989586621682006907"><span class="annot"><a href="#local-6989586621682006907"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006905"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1231"></span><span>    </span><span id="local-6989586621682006908"><span class="annot"><a href="#local-6989586621682006908"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006906"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1232"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-type">C.TypeSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006904"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006907"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006908"><span class="hs-identifier hs-type">t'</span></a></span><span>
</span><span id="line-1233"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Axiom"><span class="hs-identifier hs-type">A.Axiom</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">PragmaPolarities
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Declaration
m (ConOfAbs (Constr Declaration))
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1234"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span id="local-6989586621682006909"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006909"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration] -&gt; Declaration
forall a. a -&gt; [a] -&gt; a
</span><a href="Agda.Utils.List.html#headWithDefault"><span class="hs-identifier hs-var">headWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; Declaration) -&gt; m [Declaration] -&gt; m Declaration
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; m (ConOfAbs Declaration)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Declaration -&gt; m (ConOfAbs Declaration)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621682006909"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682003056"><span id="local-6989586621682006915"><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003056"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Clause%27"><span class="hs-identifier hs-type">A.Clause'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003056"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1237"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Clause%27"><span class="hs-identifier hs-type">A.Clause'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003056"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span>
</span><span id="line-1238"></span><span>
</span><span id="line-1239"></span><span>  </span><span id="local-6989586621682006933"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Clause' a -&gt; m (ConOfAbs (Clause' a))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Clause"><span class="hs-identifier hs-type">A.Clause</span></a></span><span> </span><span id="local-6989586621682006935"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006935"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ProblemEq]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682006936"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006936"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682006937"><span class="annot"><span class="annottext">WhereDeclarations
</span><a href="#local-6989586621682006937"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span id="local-6989586621682006938"><span class="annot"><span class="annottext">Catchall
</span><a href="#local-6989586621682006938"><span class="hs-identifier hs-var">catchall</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1240"></span><span>      </span><span class="annot"><span class="annottext">a
-&gt; (ConOfAbs a -&gt; m (ConOfAbs (Clause' a)))
-&gt; m (ConOfAbs (Clause' a))
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682006935"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs a -&gt; m (ConOfAbs (Clause' a)))
 -&gt; m (ConOfAbs (Clause' a)))
-&gt; (ConOfAbs a -&gt; m (ConOfAbs (Clause' a)))
-&gt; m (ConOfAbs (Clause' a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1241"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span> </span><span id="local-6989586621682006939"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682006939"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1242"></span><span>            </span><span class="annot"><span class="annottext">WhereDeclarations
-&gt; (ConOfAbs WhereDeclarations -&gt; m (ConOfAbs (Clause' a)))
-&gt; m (ConOfAbs (Clause' a))
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
WhereDeclarations -&gt; (ConOfAbs WhereDeclarations -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">WhereDeclarations
</span><a href="#local-6989586621682006937"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs WhereDeclarations -&gt; m (ConOfAbs (Clause' a)))
 -&gt; m (ConOfAbs (Clause' a)))
-&gt; (ConOfAbs WhereDeclarations -&gt; m (ConOfAbs (Clause' a)))
-&gt; m (ConOfAbs (Clause' a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006940"><span class="annot"><span class="annottext">ConOfAbs WhereDeclarations
</span><a href="#local-6989586621682006940"><span class="hs-identifier hs-var">wh'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1243"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621682006941"><span class="annot"><a href="#local-6989586621682006941"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006942"><span class="annot"><a href="#local-6989586621682006942"><span class="hs-identifier hs-var">eqs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006943"><span class="annot"><a href="#local-6989586621682006943"><span class="hs-identifier hs-var">with</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682006944"><span class="annot"><a href="#local-6989586621682006944"><span class="hs-identifier hs-var">wcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RHS -&gt; m (ConOfAbs RHS)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-var">toConcreteTop</span></a></span><span> </span><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621682006936"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1244"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#FunClause"><span class="hs-identifier hs-type">FunClause</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-type">defaultArgInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006939"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006942"><span class="hs-identifier hs-type">eqs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006943"><span class="hs-identifier hs-type">with</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006941"><span class="hs-identifier hs-type">rhs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006940"><span class="hs-identifier hs-type">wh'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006938"><span class="hs-identifier hs-type">catchall</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621682006944"><span class="hs-identifier hs-type">wcs</span></a></span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006948"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ModuleApplication"><span class="hs-identifier hs-type">A.ModuleApplication</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1247"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ModuleApplication"><span class="hs-identifier hs-type">A.ModuleApplication</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ModuleApplication"><span class="hs-identifier hs-type">C.ModuleApplication</span></a></span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span>  </span><span id="local-6989586621682006980"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleApplication -&gt; m (ConOfAbs ModuleApplication)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#SectionApp"><span class="hs-identifier hs-type">A.SectionApp</span></a></span><span> </span><span id="local-6989586621682006982"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682006982"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621682006983"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006983"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682006984"><span class="annot"><span class="annottext">[NamedArg Expr]
</span><a href="#local-6989586621682006984"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1250"></span><span>    </span><span id="local-6989586621682006985"><span class="annot"><a href="#local-6989586621682006985"><span class="hs-identifier hs-var">y</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; ModuleName -&gt; m (ConOfAbs ModuleName)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#FunctionCtx"><span class="hs-identifier hs-var">FunctionCtx</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006983"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1251"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006982"><span class="hs-identifier hs-type">tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682006986"><span class="annot"><span class="annottext">ConOfAbs Telescope
</span><a href="#local-6989586621682006986"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1252"></span><span>      </span><span id="local-6989586621682006987"><span class="annot"><a href="#local-6989586621682006987"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; [NamedArg Expr] -&gt; m (ConOfAbs [NamedArg Expr])
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#argumentCtx_"><span class="hs-identifier hs-var">argumentCtx_</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Expr]
</span><a href="#local-6989586621682006984"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1253"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682006989"><span class="annot"><a href="#local-6989586621682006989"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [NamedArg Expr] -&gt; Range
forall u t. (HasRange u, HasRange t) =&gt; u -&gt; t -&gt; Range
</span><a href="Agda.Syntax.Position.html#fuseRange"><span class="hs-identifier hs-var">fuseRange</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682006985"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Expr]
</span><a href="#local-6989586621682006987"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1254"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#SectionApp"><span class="hs-identifier hs-type">C.SectionApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006989"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682006986"><span class="hs-identifier hs-type">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006985"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#unNamedArg"><span class="hs-identifier hs-type">unNamedArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006987"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-1255"></span><span>
</span><span id="line-1256"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordModuleInstance"><span class="hs-identifier hs-type">A.RecordModuleInstance</span></a></span><span> </span><span id="local-6989586621682006994"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006994"><span class="hs-identifier hs-var">recm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1257"></span><span>    </span><span id="local-6989586621682006995"><span class="annot"><a href="#local-6989586621682006995"><span class="hs-identifier hs-var">recm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682006994"><span class="hs-identifier hs-var">recm</span></a></span><span>
</span><span id="line-1258"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordModuleInstance"><span class="hs-identifier hs-type">C.RecordModuleInstance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682006995"><span class="hs-identifier hs-type">recm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682006995"><span class="hs-identifier hs-type">recm</span></a></span><span>
</span><span id="line-1259"></span><span>
</span><span id="line-1260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682006999"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordDirectives"><span class="hs-identifier hs-type">A.RecordDirectives</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1261"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordDirectives"><span class="hs-identifier hs-type">A.RecordDirectives</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordDirective"><span class="hs-identifier hs-type">C.RecordDirective</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1262"></span><span>
</span><span id="line-1263"></span><span>  </span><span id="local-6989586621682007014"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RecordDirectives -&gt; m (ConOfAbs RecordDirectives)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span id="local-6989586621682007015"><span class="annot"><span class="annottext">RecordDirectives
</span><a href="#local-6989586621682007015"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecordDirectives -&gt; [RecordDirective]
</span><a href="Agda.Syntax.Concrete.html#ungatherRecordDirectives"><span class="hs-identifier hs-var">C.ungatherRecordDirectives</span></a></span><span> </span><span class="annot"><span class="annottext">(RecordDirectives -&gt; [RecordDirective])
-&gt; m RecordDirectives -&gt; m [RecordDirective]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RecordConName -&gt; m (Maybe (Name, IsInstance)))
-&gt; RecordDirectives -&gt; m RecordDirectives
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; RecordDirectives' a -&gt; f (RecordDirectives' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">RecordConName -&gt; m (Maybe (Name, IsInstance))
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RecordConName -&gt; m (Maybe (Name, IsInstance))
</span><a href="#local-6989586621682007017"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RecordDirectives
</span><a href="#local-6989586621682007015"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-1264"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1265"></span><span>      </span><span id="local-6989586621682003235"><span class="annot"><a href="#local-6989586621682007017"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003235"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordConName"><span class="hs-identifier hs-type">RecordConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003235"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">C.Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#IsInstance"><span class="hs-identifier hs-type">IsInstance</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1266"></span><span>      </span><span id="local-6989586621682007017"><span class="annot"><span class="annottext">f :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RecordConName -&gt; m (Maybe (Name, IsInstance))
</span><a href="#local-6989586621682007017"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#FreshRecCon"><span class="hs-identifier hs-type">FreshRecCon</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, IsInstance) -&gt; m (Maybe (Name, IsInstance))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Name, IsInstance)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1267"></span><span>      </span><span class="annot"><a href="#local-6989586621682007017"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#NamedRecCon"><span class="hs-identifier hs-type">NamedRecCon</span></a></span><span> </span><span id="local-6989586621682007029"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007029"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, IsInstance) -&gt; Maybe (Name, IsInstance)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Name, IsInstance) -&gt; Maybe (Name, IsInstance))
-&gt; (QName -&gt; (Name, IsInstance))
-&gt; QName
-&gt; Maybe (Name, IsInstance)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; (Name, IsInstance))
-&gt; (QName -&gt; Name) -&gt; QName -&gt; (Name, IsInstance)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">C.unqualify</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Maybe (Name, IsInstance))
-&gt; m QName -&gt; m (Maybe (Name, IsInstance))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007029"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-1268"></span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007032"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1271"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">C.Declaration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span>  </span><span id="local-6989586621682007253"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Declaration -&gt; m (ConOfAbs Declaration)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">ScopedDecl</span></a></span><span> </span><span id="local-6989586621682007254"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682007254"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621682007255"><span class="annot"><span class="annottext">NonEmpty Declaration
</span><a href="#local-6989586621682007255"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1274"></span><span>    </span><span class="annot"><span class="annottext">ScopeInfo -&gt; m (ConOfAbs Declaration) -&gt; m (ConOfAbs Declaration)
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
ScopeInfo -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withScope"><span class="hs-identifier hs-var">withScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682007254"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ConOfAbs Declaration) -&gt; m (ConOfAbs Declaration))
-&gt; m (ConOfAbs Declaration) -&gt; m (ConOfAbs Declaration)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-var">declsToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; m [Declaration])
-&gt; [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Declaration -&gt; [Item (NonEmpty Declaration)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Declaration
</span><a href="#local-6989586621682007255"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1275"></span><span>
</span><span id="line-1276"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Axiom"><span class="hs-identifier hs-type">A.Axiom</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682007256"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007256"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007257"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682007257"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682007258"><span class="annot"><span class="annottext">Maybe PragmaPolarities
</span><a href="#local-6989586621682007258"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span id="local-6989586621682007259"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007259"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007260"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007260"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1277"></span><span>    </span><span id="local-6989586621682007261"><span class="annot"><a href="#local-6989586621682007261"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007259"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1278"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-type">withAbstractPrivate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007256"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1279"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-type">withInfixDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007256"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007261"><span class="hs-identifier hs-type">x'</span></a></span><span>  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1280"></span><span>      </span><span id="local-6989586621682007262"><span class="annot"><a href="#local-6989586621682007262"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007260"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1281"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1282"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682007258"><span class="hs-identifier hs-type">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1283"></span><span>           </span><span class="annot"><span class="annottext">Maybe PragmaPolarities
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1284"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682007263"><span class="annot"><span class="annottext">PragmaPolarities
</span><a href="#local-6989586621682007263"><span class="hs-identifier hs-var">occs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pragma -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Pragma"><span class="hs-identifier hs-var">C.Pragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; [Ranged Occurrence] -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#PolarityPragma"><span class="hs-identifier hs-var">PolarityPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007261"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">([Ranged Occurrence] -&gt; Pragma) -&gt; [Ranged Occurrence] -&gt; Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PragmaPolarities -&gt; [Item PragmaPolarities]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">PragmaPolarities
</span><a href="#local-6989586621682007263"><span class="hs-identifier hs-var">occs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-1285"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Postulate"><span class="hs-identifier hs-type">C.Postulate</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-type">C.TypeSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007257"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007261"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007262"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1286"></span><span>
</span><span id="line-1287"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Generalize"><span class="hs-identifier hs-type">A.Generalize</span></a></span><span> </span><span id="local-6989586621682007268"><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621682007268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682007269"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007269"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007270"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682007270"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621682007271"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007271"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007272"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007272"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1288"></span><span>    </span><span id="local-6989586621682007273"><span class="annot"><a href="#local-6989586621682007273"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007271"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1289"></span><span>    </span><span id="local-6989586621682007274"><span class="annot"><a href="#local-6989586621682007274"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#defTactic"><span class="hs-identifier hs-var">defTactic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007269"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-type">withAbstractPrivate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007269"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1291"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-type">withInfixDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007269"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007273"><span class="hs-identifier hs-type">x'</span></a></span><span>  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1292"></span><span>      </span><span id="local-6989586621682007276"><span class="annot"><a href="#local-6989586621682007276"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007272"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1293"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Generalize"><span class="hs-identifier hs-type">C.Generalize</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-type">C.TypeSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007270"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007274"><span class="hs-identifier hs-type">tac</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007273"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Generalized"><span class="hs-identifier hs-type">C.Generalized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007276"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span> </span><span id="local-6989586621682007279"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007279"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007280"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007280"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007281"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682007281"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1296"></span><span>    </span><span id="local-6989586621682007282"><span class="annot"><a href="#local-6989586621682007282"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007280"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1297"></span><span>    </span><span id="local-6989586621682007283"><span class="annot"><a href="#local-6989586621682007283"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#defTactic"><span class="hs-identifier hs-var">defTactic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007279"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-type">withAbstractPrivate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007279"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1299"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-type">withInfixDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007279"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007282"><span class="hs-identifier hs-type">x'</span></a></span><span>  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1300"></span><span>      </span><span id="local-6989586621682007284"><span class="annot"><a href="#local-6989586621682007284"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007281"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1301"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#FieldSig"><span class="hs-identifier hs-type">C.FieldSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">A.defInstance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007279"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007283"><span class="hs-identifier hs-type">tac</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007282"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007284"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1302"></span><span>
</span><span id="line-1303"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Primitive"><span class="hs-identifier hs-type">A.Primitive</span></a></span><span> </span><span id="local-6989586621682007287"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007287"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007288"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007288"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007289"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621682007289"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1304"></span><span>    </span><span id="local-6989586621682007290"><span class="annot"><a href="#local-6989586621682007290"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007288"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1305"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-type">withAbstractPrivate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007287"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1306"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withInfixDecl"><span class="hs-identifier hs-type">withInfixDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007287"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007290"><span class="hs-identifier hs-type">x'</span></a></span><span>  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1307"></span><span>      </span><span id="local-6989586621682007291"><span class="annot"><a href="#local-6989586621682007291"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007289"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1308"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Primitive"><span class="hs-identifier hs-type">C.Primitive</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-type">C.TypeSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#argInfo"><span class="hs-identifier hs-var">argInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007291"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007290"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007291"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1309"></span><span>        </span><span class="hs-comment">-- Primitives are always relevant.</span><span>
</span><span id="line-1310"></span><span>
</span><span id="line-1311"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#FunDef"><span class="hs-identifier hs-type">A.FunDef</span></a></span><span> </span><span id="local-6989586621682007295"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007295"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682007296"><span class="annot"><span class="annottext">List1 Clause
</span><a href="#local-6989586621682007296"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1312"></span><span>    </span><span class="annot"><span class="annottext">DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var">withAbstractPrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007295"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(m [Declaration] -&gt; m [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Declaration -&gt; [Item (NonEmpty Declaration)]
NonEmpty Declaration -&gt; [Declaration]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Declaration -&gt; [Declaration])
-&gt; (NonEmpty (NonEmpty Declaration) -&gt; NonEmpty Declaration)
-&gt; NonEmpty (NonEmpty Declaration)
-&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (NonEmpty Declaration) -&gt; NonEmpty Declaration
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (NonEmpty Declaration) -&gt; [Declaration])
-&gt; m (NonEmpty (NonEmpty Declaration)) -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">List1 Clause -&gt; m (ConOfAbs (List1 Clause))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
List1 Clause -&gt; m (ConOfAbs (List1 Clause))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Clause
</span><a href="#local-6989586621682007296"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1313"></span><span>
</span><span id="line-1314"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataSig"><span class="hs-identifier hs-type">A.DataSig</span></a></span><span> </span><span id="local-6989586621682007298"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007298"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007299"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682007299"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682007300"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007300"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007301"><span class="annot"><span class="annottext">GeneralizeTelescope
</span><a href="#local-6989586621682007301"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682007302"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007302"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1315"></span><span>    </span><span class="annot"><span class="annottext">DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var">withAbstractPrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007298"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(m [Declaration] -&gt; m [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1316"></span><span>    </span><span class="annot"><span class="annottext">Telescope
-&gt; (ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Telescope -&gt; (ConOfAbs Telescope -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralizeTelescope -&gt; Telescope
</span><a href="Agda.Syntax.Abstract.html#generalizeTel"><span class="hs-identifier hs-var">A.generalizeTel</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralizeTelescope
</span><a href="#local-6989586621682007301"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration])
-&gt; (ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007304"><span class="annot"><span class="annottext">ConOfAbs Telescope
</span><a href="#local-6989586621682007304"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1317"></span><span>      </span><span id="local-6989586621682007305"><span class="annot"><a href="#local-6989586621682007305"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007300"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1318"></span><span>      </span><span id="local-6989586621682007306"><span class="annot"><a href="#local-6989586621682007306"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007302"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1319"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DataSig"><span class="hs-identifier hs-type">C.DataSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007298"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007299"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007305"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-1320"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DomainFull"><span class="hs-identifier hs-type">C.DomainFull</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682007304"><span class="hs-identifier hs-type">tel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007306"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1321"></span><span>
</span><span id="line-1322"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataDef"><span class="hs-identifier hs-type">A.DataDef</span></a></span><span> </span><span id="local-6989586621682007308"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007308"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007309"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007309"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007310"><span class="annot"><span class="annottext">PositivityCheck
</span><a href="#local-6989586621682007310"><span class="hs-identifier hs-var">_pc</span></a></span></span><span> </span><span id="local-6989586621682007311"><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621682007311"><span class="hs-identifier hs-var">_uc</span></a></span></span><span> </span><span id="local-6989586621682007312"><span class="annot"><span class="annottext">DataDefParams
</span><a href="#local-6989586621682007312"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682007313"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682007313"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1323"></span><span>    </span><span class="annot"><span class="annottext">DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var">withAbstractPrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007308"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(m [Declaration] -&gt; m [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1324"></span><span>    </span><span class="annot"><span class="annottext">[LamBinding]
-&gt; (ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[LamBinding] -&gt; (ConOfAbs [LamBinding] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LamBinding -&gt; LamBinding) -&gt; [LamBinding] -&gt; [LamBinding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; LamBinding
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-var">makeDomainFree</span></a></span><span> </span><span class="annot"><span class="annottext">([LamBinding] -&gt; [LamBinding]) -&gt; [LamBinding] -&gt; [LamBinding]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataDefParams -&gt; [LamBinding]
</span><a href="Agda.Syntax.Abstract.html#dataDefParams"><span class="hs-identifier hs-var">dataDefParams</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefParams
</span><a href="#local-6989586621682007312"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration])
-&gt; (ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007315"><span class="annot"><span class="annottext">ConOfAbs [LamBinding]
</span><a href="#local-6989586621682007315"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1325"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682007316"><span class="annot"><a href="#local-6989586621682007316"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682007317"><span class="annot"><a href="#local-6989586621682007317"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; (QName, [Declaration]) -&gt; (Name, [Declaration])
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">((QName, [Declaration]) -&gt; (Name, [Declaration]))
-&gt; m (QName, [Declaration]) -&gt; m (Name, [Declaration])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(QName, [Constr Declaration])
-&gt; m (ConOfAbs (QName, [Constr Declaration]))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(QName, [Constr Declaration])
-&gt; m (ConOfAbs (QName, [Constr Declaration]))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007309"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; Constr Declaration)
-&gt; [Declaration] -&gt; [Constr Declaration]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; Constr Declaration
forall a. a -&gt; Constr a
</span><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682007313"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1326"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DataDef"><span class="hs-identifier hs-type">C.DataDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007308"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007316"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682007315"><span class="hs-identifier hs-type">tel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007317"><span class="hs-identifier hs-type">cs'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1327"></span><span>
</span><span id="line-1328"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecSig"><span class="hs-identifier hs-type">A.RecSig</span></a></span><span> </span><span id="local-6989586621682007319"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007319"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007320"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682007320"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682007321"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007321"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007322"><span class="annot"><span class="annottext">GeneralizeTelescope
</span><a href="#local-6989586621682007322"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682007323"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007323"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1329"></span><span>    </span><span class="annot"><span class="annottext">DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var">withAbstractPrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007319"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(m [Declaration] -&gt; m [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1330"></span><span>    </span><span class="annot"><span class="annottext">Telescope
-&gt; (ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Telescope -&gt; (ConOfAbs Telescope -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralizeTelescope -&gt; Telescope
</span><a href="Agda.Syntax.Abstract.html#generalizeTel"><span class="hs-identifier hs-var">A.generalizeTel</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralizeTelescope
</span><a href="#local-6989586621682007322"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration])
-&gt; (ConOfAbs Telescope -&gt; m [Declaration]) -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007324"><span class="annot"><span class="annottext">ConOfAbs Telescope
</span><a href="#local-6989586621682007324"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1331"></span><span>      </span><span id="local-6989586621682007325"><span class="annot"><a href="#local-6989586621682007325"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007321"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1332"></span><span>      </span><span id="local-6989586621682007326"><span class="annot"><a href="#local-6989586621682007326"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteTop"><span class="hs-identifier hs-type">toConcreteTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007323"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1333"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordSig"><span class="hs-identifier hs-type">C.RecordSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007319"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007320"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007325"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-1334"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DomainFull"><span class="hs-identifier hs-type">C.DomainFull</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682007324"><span class="hs-identifier hs-type">tel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007326"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecDef"><span class="hs-identifier hs-type">A.RecDef</span></a></span><span>  </span><span id="local-6989586621682007328"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007328"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007329"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007329"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007330"><span class="annot"><span class="annottext">PositivityCheck
</span><a href="#local-6989586621682007330"><span class="hs-identifier hs-var">_pc</span></a></span></span><span> </span><span id="local-6989586621682007331"><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621682007331"><span class="hs-identifier hs-var">_uc</span></a></span></span><span> </span><span id="local-6989586621682007332"><span class="annot"><span class="annottext">RecordDirectives
</span><a href="#local-6989586621682007332"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621682007333"><span class="annot"><span class="annottext">DataDefParams
</span><a href="#local-6989586621682007333"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682007334"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007334"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682007335"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682007335"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1337"></span><span>    </span><span class="annot"><span class="annottext">DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
DefInfo -&gt; m [Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withAbstractPrivate"><span class="hs-identifier hs-var">withAbstractPrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621682007328"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(m [Declaration] -&gt; m [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1338"></span><span>    </span><span class="annot"><span class="annottext">[LamBinding]
-&gt; (ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[LamBinding] -&gt; (ConOfAbs [LamBinding] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LamBinding -&gt; LamBinding) -&gt; [LamBinding] -&gt; [LamBinding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; LamBinding
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#makeDomainFree"><span class="hs-identifier hs-var">makeDomainFree</span></a></span><span> </span><span class="annot"><span class="annottext">([LamBinding] -&gt; [LamBinding]) -&gt; [LamBinding] -&gt; [LamBinding]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataDefParams -&gt; [LamBinding]
</span><a href="Agda.Syntax.Abstract.html#dataDefParams"><span class="hs-identifier hs-var">dataDefParams</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefParams
</span><a href="#local-6989586621682007333"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration])
-&gt; (ConOfAbs [LamBinding] -&gt; m [Declaration]) -&gt; m [Declaration]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007336"><span class="annot"><span class="annottext">ConOfAbs [LamBinding]
</span><a href="#local-6989586621682007336"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1339"></span><span>      </span><span id="local-6989586621682007337"><span class="annot"><a href="#local-6989586621682007337"><span class="hs-identifier hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RecordDirectives -&gt; m (ConOfAbs RecordDirectives)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RecordDirectives -&gt; m (ConOfAbs RecordDirectives)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">RecordDirectives
</span><a href="#local-6989586621682007332"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-1340"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682007338"><span class="annot"><a href="#local-6989586621682007338"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682007339"><span class="annot"><a href="#local-6989586621682007339"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">first</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-type">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682007329"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007335"><span class="hs-identifier hs-type">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1341"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RecordDef"><span class="hs-identifier hs-type">C.RecordDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007328"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007338"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007337"><span class="hs-identifier hs-type">dirs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682007336"><span class="hs-identifier hs-type">tel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007339"><span class="hs-identifier hs-type">cs'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Mutual"><span class="hs-identifier hs-type">A.Mutual</span></a></span><span> </span><span id="local-6989586621682007341"><span class="annot"><span class="annottext">MutualInfo
</span><a href="#local-6989586621682007341"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007342"><span class="annot"><span class="annottext">NonEmpty Declaration
</span><a href="#local-6989586621682007342"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; [Declaration])
-&gt; ([Declaration] -&gt; Declaration) -&gt; [Declaration] -&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Mutual"><span class="hs-identifier hs-var">C.Mutual</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">([Declaration] -&gt; [Declaration])
-&gt; m [Declaration] -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-var">declsToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty Declaration -&gt; [Item (NonEmpty Declaration)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Declaration
</span><a href="#local-6989586621682007342"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1344"></span><span>
</span><span id="line-1345"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Section"><span class="hs-identifier hs-type">A.Section</span></a></span><span> </span><span id="local-6989586621682007344"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007344"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007345"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682007345"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682007346"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007346"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#GeneralizeTel"><span class="hs-identifier hs-type">A.GeneralizeTel</span></a></span><span> </span><span class="annot"><span class="annottext">Map QName Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682007348"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621682007348"><span class="hs-identifier hs-var">tel</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007349"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682007349"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1346"></span><span>    </span><span id="local-6989586621682007350"><span class="annot"><a href="#local-6989586621682007350"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007346"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1347"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007348"><span class="hs-identifier hs-type">tel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007351"><span class="annot"><span class="annottext">ConOfAbs Telescope
</span><a href="#local-6989586621682007351"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1348"></span><span>      </span><span id="local-6989586621682007352"><span class="annot"><a href="#local-6989586621682007352"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[Declaration] -&gt; m [Declaration]
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#declsToConcrete"><span class="hs-identifier hs-var">declsToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621682007349"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1349"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-type">C.Module</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007344"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007345"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007350"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621682007351"><span class="hs-identifier hs-type">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007352"><span class="hs-identifier hs-type">ds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Apply"><span class="hs-identifier hs-type">A.Apply</span></a></span><span> </span><span id="local-6989586621682007355"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007355"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007356"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621682007356"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621682007357"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007357"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007358"><span class="annot"><span class="annottext">ModuleApplication
</span><a href="#local-6989586621682007358"><span class="hs-identifier hs-var">modapp</span></a></span></span><span> </span><span class="annot"><span class="annottext">ScopeCopyInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1352"></span><span>    </span><span id="local-6989586621682007359"><span class="annot"><a href="#local-6989586621682007359"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#unsafeQNameToName"><span class="hs-identifier hs-var">unsafeQNameToName</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Name) -&gt; m QName -&gt; m Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007357"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1353"></span><span>    </span><span id="local-6989586621682007360"><span class="annot"><a href="#local-6989586621682007360"><span class="hs-identifier hs-var">modapp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007358"><span class="hs-identifier hs-type">modapp</span></a></span><span>
</span><span id="line-1354"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682007361"><span class="annot"><a href="#local-6989586621682007361"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleApplication -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleApplication
</span><a href="#local-6989586621682007360"><span class="hs-identifier hs-var">modapp</span></a></span><span>
</span><span id="line-1355"></span><span>        </span><span id="local-6989586621682007362"><span class="annot"><a href="#local-6989586621682007362"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; OpenShortHand
</span><a href="Agda.Syntax.Info.html#minfoOpenShort"><span class="hs-identifier hs-var">minfoOpenShort</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007355"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1356"></span><span>        </span><span id="local-6989586621682007363"><span class="annot"><a href="#local-6989586621682007363"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDirective -&gt; Maybe ImportDirective -&gt; ImportDirective
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
forall n m. ImportDirective' n m
</span><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-var">defaultImportDir</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#importDirRange"><span class="hs-identifier hs-var">importDirRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682007361"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">(Maybe ImportDirective -&gt; ImportDirective)
-&gt; Maybe ImportDirective -&gt; ImportDirective
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; Maybe ImportDirective
</span><a href="Agda.Syntax.Info.html#minfoDirective"><span class="hs-identifier hs-var">minfoDirective</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007355"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1357"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ModuleMacro"><span class="hs-identifier hs-type">C.ModuleMacro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007355"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007356"><span class="hs-identifier hs-type">erased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007359"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007360"><span class="hs-identifier hs-type">modapp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007362"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007363"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Import"><span class="hs-identifier hs-type">A.Import</span></a></span><span> </span><span id="local-6989586621682007365"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007365"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007366"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007366"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1360"></span><span>    </span><span id="local-6989586621682007367"><span class="annot"><a href="#local-6989586621682007367"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007366"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1361"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682007368"><span class="annot"><a href="#local-6989586621682007368"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; OpenShortHand
</span><a href="Agda.Syntax.Info.html#minfoOpenShort"><span class="hs-identifier hs-var">minfoOpenShort</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007365"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1362"></span><span>        </span><span id="local-6989586621682007369"><span class="annot"><a href="#local-6989586621682007369"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDirective -&gt; Maybe ImportDirective -&gt; ImportDirective
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
forall n m. ImportDirective' n m
</span><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-var">defaultImportDir</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ImportDirective -&gt; ImportDirective)
-&gt; Maybe ImportDirective -&gt; ImportDirective
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; Maybe ImportDirective
</span><a href="Agda.Syntax.Info.html#minfoDirective"><span class="hs-identifier hs-var">minfoDirective</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007365"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1363"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Import"><span class="hs-identifier hs-type">C.Import</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007368"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.KeywordRange.html#kwRange"><span class="hs-identifier hs-type">kwRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007365"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007367"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007369"><span class="hs-identifier hs-type">dir</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pragma"><span class="hs-identifier hs-type">A.Pragma</span></a></span><span> </span><span id="local-6989586621682007372"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007372"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007373"><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621682007373"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1366"></span><span>    </span><span id="local-6989586621682007374"><span class="annot"><a href="#local-6989586621682007374"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RangeAndPragma -&gt; m (ConOfAbs RangeAndPragma)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RangeAndPragma -&gt; m (ConOfAbs RangeAndPragma)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(RangeAndPragma -&gt; m (ConOfAbs RangeAndPragma))
-&gt; RangeAndPragma -&gt; m (ConOfAbs RangeAndPragma)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pragma -&gt; RangeAndPragma
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-var">RangeAndPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007372"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621682007373"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1367"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pragma"><span class="hs-identifier hs-type">C.Pragma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007374"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1368"></span><span>
</span><span id="line-1369"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Open"><span class="hs-identifier hs-type">A.Open</span></a></span><span> </span><span id="local-6989586621682007377"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682007377"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007378"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007378"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">ImportDirective
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1370"></span><span>    </span><span id="local-6989586621682007379"><span class="annot"><a href="#local-6989586621682007379"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (ConOfAbs ModuleName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ModuleName -&gt; m (ConOfAbs ModuleName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682007378"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1371"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Open"><span class="hs-identifier hs-type">C.Open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.KeywordRange.html#kwRange"><span class="hs-identifier hs-type">kwRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007377"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007379"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultImportDir"><span class="hs-identifier hs-type">defaultImportDir</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1372"></span><span>      </span><span class="hs-comment">-- Andreas, 2025-11-27, kwRange is a lie,</span><span>
</span><span id="line-1373"></span><span>      </span><span class="hs-comment">-- but we do not have the range of the @open@ keyword here.</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDef"><span class="hs-identifier hs-type">A.PatternSynDef</span></a></span><span> </span><span id="local-6989586621682007381"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007381"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007382"><span class="annot"><span class="annottext">[WithHiding BindName]
</span><a href="#local-6989586621682007382"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682007383"><span class="annot"><span class="annottext">Pattern' Void
</span><a href="#local-6989586621682007383"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007381"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m QName -&gt; (QName -&gt; m [Declaration]) -&gt; m [Declaration]
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1376"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span id="local-6989586621682007384"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007384"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[WithHiding Name]
-&gt; (ConOfAbs [WithHiding Name] -&gt; m [Declaration])
-&gt; m [Declaration]
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[WithHiding Name] -&gt; (ConOfAbs [WithHiding Name] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WithHiding BindName -&gt; WithHiding Name)
-&gt; [WithHiding BindName] -&gt; [WithHiding Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BindName -&gt; Name) -&gt; WithHiding BindName -&gt; WithHiding Name
forall a b. (a -&gt; b) -&gt; WithHiding a -&gt; WithHiding b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">A.unBind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithHiding BindName]
</span><a href="#local-6989586621682007382"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007385"><span class="annot"><span class="annottext">ConOfAbs [WithHiding Name]
</span><a href="#local-6989586621682007385"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1377"></span><span>      </span><span class="annot"><span class="annottext">Declaration -&gt; [Declaration]
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; [Declaration])
-&gt; (Pattern -&gt; Declaration) -&gt; Pattern -&gt; [Declaration]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; [WithHiding Name] -&gt; Pattern -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#PatternSyn"><span class="hs-identifier hs-var">C.PatternSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007384"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007384"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[WithHiding Name]
ConOfAbs [WithHiding Name]
</span><a href="#local-6989586621682007385"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; [Declaration]) -&gt; m Pattern -&gt; m [Declaration]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1378"></span><span>        </span><span class="annot"><span class="annottext">m Pattern -&gt; m Pattern
forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#dontFoldPatternSynonyms"><span class="hs-identifier hs-var">dontFoldPatternSynonyms</span></a></span><span> </span><span class="annot"><span class="annottext">(m Pattern -&gt; m Pattern) -&gt; m Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern' Void -&gt; Pattern
forall (f :: * -&gt; *) a. Functor f =&gt; f Void -&gt; f a
</span><span class="hs-identifier hs-var">vacuous</span></span><span> </span><span class="annot"><span class="annottext">Pattern' Void
</span><a href="#local-6989586621682007383"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1379"></span><span>    </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m [Declaration]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#UnquoteDecl"><span class="hs-identifier hs-type">A.UnquoteDecl</span></a></span><span> </span><span class="annot"><span class="annottext">MutualInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682007389"><span class="annot"><span class="annottext">[DefInfo]
</span><a href="#local-6989586621682007389"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007390"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007390"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682007391"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007391"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1382"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682007400"><span class="annot"><span class="annottext">unqual :: QName -&gt; m Name
</span><a href="#local-6989586621682007400"><span class="hs-identifier hs-var hs-var hs-var">unqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span id="local-6989586621682007401"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007401"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007401"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1383"></span><span>        </span><span class="annot"><a href="#local-6989586621682007400"><span class="hs-identifier hs-var">unqual</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1384"></span><span>    </span><span id="local-6989586621682007402"><span class="annot"><a href="#local-6989586621682007402"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m Name) -&gt; [QName] -&gt; m [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; m Name
forall {m :: * -&gt; *}. Monad m =&gt; QName -&gt; m Name
</span><a href="#local-6989586621682007400"><span class="hs-identifier hs-var">unqual</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m Name) -&gt; (QName -&gt; m QName) -&gt; QName -&gt; m Name
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007390"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1385"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-glyph">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#UnquoteDecl"><span class="hs-identifier hs-type">C.UnquoteDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007389"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007402"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007391"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1386"></span><span>
</span><span id="line-1387"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#UnquoteDef"><span class="hs-identifier hs-type">A.UnquoteDef</span></a></span><span> </span><span id="local-6989586621682007406"><span class="annot"><span class="annottext">[DefInfo]
</span><a href="#local-6989586621682007406"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007407"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007407"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682007408"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007408"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1388"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682007417"><span class="annot"><span class="annottext">unqual :: QName -&gt; m Name
</span><a href="#local-6989586621682007417"><span class="hs-identifier hs-var hs-var hs-var">unqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span id="local-6989586621682007418"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007418"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007418"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1389"></span><span>        </span><span class="annot"><a href="#local-6989586621682007417"><span class="hs-identifier hs-var">unqual</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1390"></span><span>    </span><span id="local-6989586621682007419"><span class="annot"><a href="#local-6989586621682007419"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m Name) -&gt; [QName] -&gt; m [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; m Name
forall {m :: * -&gt; *}. Monad m =&gt; QName -&gt; m Name
</span><a href="#local-6989586621682007417"><span class="hs-identifier hs-var">unqual</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m Name) -&gt; (QName -&gt; m QName) -&gt; QName -&gt; m Name
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007407"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1391"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-glyph">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#UnquoteDef"><span class="hs-identifier hs-type">C.UnquoteDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007406"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007419"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-type">toConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007408"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1392"></span><span>
</span><span id="line-1393"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#UnquoteData"><span class="hs-identifier hs-type">A.UnquoteData</span></a></span><span> </span><span id="local-6989586621682007422"><span class="annot"><span class="annottext">[DefInfo]
</span><a href="#local-6989586621682007422"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007423"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007423"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682007424"><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621682007424"><span class="hs-identifier hs-var">uc</span></a></span></span><span> </span><span id="local-6989586621682007425"><span class="annot"><span class="annottext">[DefInfo]
</span><a href="#local-6989586621682007425"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621682007426"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007426"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682007427"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007427"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [Declaration]
m (ConOfAbs Declaration)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1394"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#UnfoldingDecl"><span class="hs-identifier hs-type">A.UnfoldingDecl</span></a></span><span> </span><span id="local-6989586621682007429"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007429"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682007430"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007430"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; m [Declaration]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1395"></span><span>
</span><span id="line-1396"></span><span class="hs-keyword">data</span><span> </span><span id="RangeAndPragma"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-var">RangeAndPragma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RangeAndPragma"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-var">RangeAndPragma</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pragma"><span class="hs-identifier hs-type">A.Pragma</span></a></span><span>
</span><span id="line-1397"></span><span>
</span><span id="line-1398"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007433"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-type">RangeAndPragma</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1399"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-type">RangeAndPragma</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pragma"><span class="hs-identifier hs-type">C.Pragma</span></a></span><span>
</span><span id="line-1400"></span><span>
</span><span id="line-1401"></span><span>  </span><span id="local-6989586621682007489"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
RangeAndPragma -&gt; m (ConOfAbs RangeAndPragma)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#RangeAndPragma"><span class="hs-identifier hs-type">RangeAndPragma</span></a></span><span> </span><span id="local-6989586621682007490"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682007491"><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621682007491"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621682007491"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1402"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#OptionsPragma"><span class="hs-identifier hs-type">A.OptionsPragma</span></a></span><span> </span><span id="local-6989586621682007493"><span class="annot"><span class="annottext">[ArgName]
</span><a href="#local-6989586621682007493"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; m Pragma
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; m Pragma) -&gt; Pragma -&gt; m Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [ArgName] -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#OptionsPragma"><span class="hs-identifier hs-var">C.OptionsPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgName]
</span><a href="#local-6989586621682007493"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1403"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BuiltinPragma"><span class="hs-identifier hs-type">A.BuiltinPragma</span></a></span><span> </span><span id="local-6989586621682007496"><span class="annot"><span class="annottext">Ranged ArgName
</span><a href="#local-6989586621682007496"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682007497"><span class="annot"><span class="annottext">ResolvedName
</span><a href="#local-6989586621682007497"><span class="hs-identifier hs-var">x</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Ranged ArgName -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#BuiltinPragma"><span class="hs-identifier hs-var">C.BuiltinPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Ranged ArgName
</span><a href="#local-6989586621682007496"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedName -&gt; m (ConOfAbs ResolvedName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
ResolvedName -&gt; m (ConOfAbs ResolvedName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedName
</span><a href="#local-6989586621682007497"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1404"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BuiltinNoDefPragma"><span class="hs-identifier hs-type">A.BuiltinNoDefPragma</span></a></span><span> </span><span id="local-6989586621682007500"><span class="annot"><span class="annottext">Ranged ArgName
</span><a href="#local-6989586621682007500"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682007501"><span class="annot"><span class="annottext">KindOfName
</span><a href="#local-6989586621682007501"><span class="hs-identifier hs-var">_kind</span></a></span></span><span> </span><span id="local-6989586621682007502"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007502"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Ranged ArgName -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#BuiltinPragma"><span class="hs-identifier hs-var">C.BuiltinPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Ranged ArgName
</span><a href="#local-6989586621682007500"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007502"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1405"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RewritePragma"><span class="hs-identifier hs-type">A.RewritePragma</span></a></span><span> </span><span id="local-6989586621682007504"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007504"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span id="local-6989586621682007505"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007505"><span class="hs-identifier hs-var">x</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Range -&gt; [QName] -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#RewritePragma"><span class="hs-identifier hs-var">C.RewritePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007504"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; Pragma) -&gt; m [QName] -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; m (ConOfAbs [QName])
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
[QName] -&gt; m (ConOfAbs [QName])
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621682007505"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1406"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#CompilePragma"><span class="hs-identifier hs-type">A.CompilePragma</span></a></span><span> </span><span id="local-6989586621682007508"><span class="annot"><span class="annottext">Ranged BackendName
</span><a href="#local-6989586621682007508"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682007509"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007510"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621682007510"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1407"></span><span>      </span><span id="local-6989586621682007511"><span class="annot"><a href="#local-6989586621682007511"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007509"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1408"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#CompilePragma"><span class="hs-identifier hs-type">C.CompilePragma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007490"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007508"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007511"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007510"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-1409"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#StaticPragma"><span class="hs-identifier hs-type">A.StaticPragma</span></a></span><span> </span><span id="local-6989586621682007514"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007514"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#StaticPragma"><span class="hs-identifier hs-var">C.StaticPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007514"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1410"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#InjectivePragma"><span class="hs-identifier hs-type">A.InjectivePragma</span></a></span><span> </span><span id="local-6989586621682007517"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007517"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#InjectivePragma"><span class="hs-identifier hs-var">C.InjectivePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007517"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1411"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#InjectiveForInferencePragma"><span class="hs-identifier hs-type">A.InjectiveForInferencePragma</span></a></span><span> </span><span id="local-6989586621682007520"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007520"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#InjectiveForInferencePragma"><span class="hs-identifier hs-var">C.InjectiveForInferencePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007520"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1412"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#InlinePragma"><span class="hs-identifier hs-type">A.InlinePragma</span></a></span><span> </span><span id="local-6989586621682007523"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682007523"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682007524"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007524"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Bool -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#InlinePragma"><span class="hs-identifier hs-var">C.InlinePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682007523"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007524"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1413"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#NotProjectionLikePragma"><span class="hs-identifier hs-type">A.NotProjectionLikePragma</span></a></span><span> </span><span id="local-6989586621682007527"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007527"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#NotProjectionLikePragma"><span class="hs-identifier hs-var">C.NotProjectionLikePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007527"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1414"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#OverlapPragma"><span class="hs-identifier hs-type">A.OverlapPragma</span></a></span><span> </span><span id="local-6989586621682007530"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007530"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682007531"><span class="annot"><span class="annottext">OverlapMode
</span><a href="#local-6989586621682007531"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; [QName] -&gt; OverlapMode -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#OverlapPragma"><span class="hs-identifier hs-var">C.OverlapPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; OverlapMode -&gt; Pragma)
-&gt; m [QName] -&gt; m (OverlapMode -&gt; Pragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName -&gt; [QName]) -&gt; m QName -&gt; m [QName]
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007530"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (OverlapMode -&gt; Pragma) -&gt; m OverlapMode -&gt; m Pragma
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">OverlapMode -&gt; m OverlapMode
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OverlapMode
</span><a href="#local-6989586621682007531"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1415"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#EtaPragma"><span class="hs-identifier hs-type">A.EtaPragma</span></a></span><span> </span><span id="local-6989586621682007534"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007534"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#EtaPragma"><span class="hs-identifier hs-var">C.EtaPragma</span></a></span><span>    </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pragma) -&gt; m QName -&gt; m Pragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007534"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1416"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DisplayPragma"><span class="hs-identifier hs-type">A.DisplayPragma</span></a></span><span> </span><span id="local-6989586621682007537"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007537"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007538"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007538"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682007539"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007539"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1417"></span><span>      </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Expr -&gt; Pragma
</span><a href="Agda.Syntax.Concrete.html#DisplayPragma"><span class="hs-identifier hs-var">C.DisplayPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682007490"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Expr -&gt; Pragma) -&gt; m Pattern -&gt; m (Expr -&gt; Pragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-var">A.DefP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; PatInfo
</span><a href="Agda.Syntax.Info.html#PatRange"><span class="hs-identifier hs-var">PatRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; AmbiguousQName
</span><a href="Agda.Syntax.Abstract.Name.html#unambiguous"><span class="hs-identifier hs-var">unambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007537"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007538"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Expr -&gt; Pragma) -&gt; m Expr -&gt; m Pragma
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682007539"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1418"></span><span>
</span><span id="line-1419"></span><span class="hs-comment">-- Left hand sides --------------------------------------------------------</span><span>
</span><span id="line-1420"></span><span>
</span><span id="line-1421"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007545"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#SpineLHS"><span class="hs-identifier hs-type">A.SpineLHS</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1422"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#SpineLHS"><span class="hs-identifier hs-type">A.SpineLHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span>  </span><span id="local-6989586621682007556"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SpineLHS -&gt; (ConOfAbs SpineLHS -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span id="local-6989586621682007557"><span class="annot"><span class="annottext">SpineLHS
</span><a href="#local-6989586621682007557"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHS -&gt; (ConOfAbs LHS -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
LHS -&gt; (ConOfAbs LHS -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpineLHS -&gt; LHS
forall a b. LHSToSpine a b =&gt; b -&gt; a
</span><a href="Agda.Syntax.Abstract.Pattern.html#spineToLhs"><span class="hs-identifier hs-var">A.spineToLhs</span></a></span><span> </span><span class="annot"><span class="annottext">SpineLHS
</span><a href="#local-6989586621682007557"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHS"><span class="hs-identifier hs-type">A.LHS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1425"></span><span>
</span><span id="line-1426"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007560"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHS"><span class="hs-identifier hs-type">A.LHS</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1427"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHS"><span class="hs-identifier hs-type">A.LHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">C.LHS</span></a></span><span>
</span><span id="line-1428"></span><span>
</span><span id="line-1429"></span><span>    </span><span id="local-6989586621682007569"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
LHS -&gt; (ConOfAbs LHS -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHS"><span class="hs-identifier hs-type">A.LHS</span></a></span><span> </span><span id="local-6989586621682007571"><span class="annot"><span class="annottext">LHSInfo
</span><a href="#local-6989586621682007571"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007572"><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621682007572"><span class="hs-identifier hs-var">lhscore</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007573"><span class="annot"><span class="annottext">ConOfAbs LHS -&gt; m b
</span><a href="#local-6989586621682007573"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1430"></span><span>      </span><span class="annot"><span class="annottext">Precedence -&gt; LHSCore -&gt; (ConOfAbs LHSCore -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcreteCtx"><span class="hs-identifier hs-var">bindToConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#TopCtx"><span class="hs-identifier hs-var">TopCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LHSCore
</span><a href="#local-6989586621682007572"><span class="hs-identifier hs-var">lhscore</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs LHSCore -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs LHSCore -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007574"><span class="annot"><span class="annottext">ConOfAbs LHSCore
</span><a href="#local-6989586621682007574"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1431"></span><span>          </span><span class="annot"><span class="annottext">ConOfAbs LHS -&gt; m b
</span><a href="#local-6989586621682007573"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs LHS -&gt; m b) -&gt; ConOfAbs LHS -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [RewriteEqn] -&gt; [WithExpr] -&gt; LHS
</span><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-var">C.LHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpandedEllipsis -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.Pattern.html#reintroduceEllipsis"><span class="hs-identifier hs-var">reintroduceEllipsis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHSInfo -&gt; ExpandedEllipsis
</span><a href="Agda.Syntax.Info.html#lhsEllipsis"><span class="hs-identifier hs-var">lhsEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">LHSInfo
</span><a href="#local-6989586621682007571"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs LHSCore
</span><a href="#local-6989586621682007574"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1432"></span><span>
</span><span id="line-1433"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007578"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHSCore"><span class="hs-identifier hs-type">A.LHSCore</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1434"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LHSCore"><span class="hs-identifier hs-type">A.LHSCore</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span>
</span><span id="line-1435"></span><span>  </span><span id="local-6989586621682007586"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
LHSCore -&gt; (ConOfAbs LHSCore -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; (Pattern -&gt; m b) -&gt; m b
Pattern -&gt; (ConOfAbs Pattern -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Pattern -&gt; (ConOfAbs Pattern -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; (Pattern -&gt; m b) -&gt; m b)
-&gt; (LHSCore -&gt; Pattern) -&gt; LHSCore -&gt; (Pattern -&gt; m b) -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LHSCore -&gt; Pattern
</span><a href="Agda.Syntax.Abstract.Pattern.html#lhsCoreToPattern"><span class="hs-identifier hs-var">lhsCoreToPattern</span></a></span><span>
</span><span id="line-1436"></span><span>
</span><span id="line-1437"></span><span id="local-6989586621682003286"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#appBracketsArgs"><span class="hs-identifier hs-type">appBracketsArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682003286"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1438"></span><span id="appBracketsArgs"><span class="annot"><span class="annottext">appBracketsArgs :: forall arg. [arg] -&gt; PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#appBracketsArgs"><span class="hs-identifier hs-var hs-var">appBracketsArgs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="annot"><span class="annottext">PrecedenceStack
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1439"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#appBracketsArgs"><span class="hs-identifier hs-var">appBracketsArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">arg
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[arg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007589"><span class="annot"><span class="annottext">PrecedenceStack
</span><a href="#local-6989586621682007589"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-var">appBrackets</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack
</span><a href="#local-6989586621682007589"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1440"></span><span>
</span><span id="line-1441"></span><span class="hs-comment">-- Auxiliary wrappers for processing the bindings in patterns in the right order.</span><span>
</span><span id="line-1442"></span><span class="hs-keyword">newtype</span><span> </span><span id="UserPattern"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span></span><span> </span><span id="local-6989586621682003298"><span class="annot"><a href="#local-6989586621682003298"><span class="hs-identifier hs-type">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="UserPattern"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682003298"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1443"></span><span class="hs-keyword">newtype</span><span> </span><span id="SplitPattern"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span></span><span> </span><span id="local-6989586621682003308"><span class="annot"><a href="#local-6989586621682003308"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SplitPattern"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682003308"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1444"></span><span class="hs-keyword">newtype</span><span> </span><span id="BindingPattern"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPattern"><span class="hs-identifier hs-var">BindingPattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BindingPat"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1445"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreshenName"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-var">FreshenName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreshenName"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-var">FreshenName</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">BindName</span></a></span><span>
</span><span id="line-1446"></span><span>
</span><span id="line-1447"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007595"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-type">FreshenName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1448"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-type">FreshenName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span>
</span><span id="line-1449"></span><span>  </span><span id="local-6989586621682007604"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
FreshenName -&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-type">FreshenName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#BindName"><span class="hs-identifier hs-type">BindName</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">unBind :: BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682007606"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007607"><span class="annot"><span class="annottext">ConOfAbs FreshenName -&gt; m b
</span><a href="#local-6989586621682007607"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (ConOfAbs Name -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Name -&gt; (ConOfAbs Name -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ConOfAbs Name -&gt; m b) -&gt; m b) -&gt; (ConOfAbs Name -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007608"><span class="annot"><span class="annottext">ConOfAbs Name
</span><a href="#local-6989586621682007608"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs FreshenName -&gt; m b
</span><a href="#local-6989586621682007607"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682007608"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1450"></span><span>
</span><span id="line-1451"></span><span class="hs-comment">-- Pass 1: (Issue #2729)</span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- Takes care of binding the originally user-written pattern variables, but doesn't actually</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- translate anything to Concrete.</span><span>
</span><span id="line-1454"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007610"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1455"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1456"></span><span>
</span><span id="line-1457"></span><span>  </span><span id="local-6989586621682007654"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
UserPattern Pattern
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span id="local-6989586621682007655"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007656"><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1458"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;toConcrete.pat&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;binding pattern (pass 1)&quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1459"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1460"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-type">A.VarP</span></a></span><span> </span><span id="local-6989586621682007658"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007658"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1461"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682007659"><span class="annot"><span class="annottext">x :: Name
</span><a href="#local-6989586621682007659"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007658"><span class="hs-identifier hs-var">bx</span></a></span><span>
</span><span id="line-1462"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameInScope
forall a. LensInScope a =&gt; a -&gt; NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#isInScope"><span class="hs-identifier hs-var">isInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1463"></span><span>          </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; Name -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName%27"><span class="hs-identifier hs-var">bindName'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(m b -&gt; m b) -&gt; m b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs (UserPattern Pattern) -&gt; m b)
-&gt; ConOfAbs (UserPattern Pattern) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Pattern
forall e. BindName -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-var">A.VarP</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007658"><span class="hs-identifier hs-var">bx</span></a></span><span>
</span><span id="line-1464"></span><span>          </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#NotInScope"><span class="hs-identifier hs-var">C.NotInScope</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (Name -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Name -&gt; (Name -&gt; m a) -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName"><span class="hs-identifier hs-var">bindName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; m b) -&gt; m b) -&gt; (Name -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682007662"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007662"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1465"></span><span>                                </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(ConOfAbs (UserPattern Pattern) -&gt; m b)
-&gt; ConOfAbs (UserPattern Pattern) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Pattern
forall e. BindName -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-var">A.VarP</span></a></span><span> </span><span class="annot"><span class="annottext">(BindName -&gt; Pattern) -&gt; BindName -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; BindName
</span><a href="Agda.Syntax.Abstract.html#mkBindName"><span class="hs-identifier hs-var">mkBindName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; BindName) -&gt; Name -&gt; BindName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682007659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682007662"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1466"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WildP"><span class="hs-identifier hs-type">A.WildP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1467"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ProjP"><span class="hs-identifier hs-type">A.ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1468"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdP"><span class="hs-identifier hs-type">A.AbsurdP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1469"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LitP"><span class="hs-identifier hs-type">A.LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1470"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1471"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#EqualP"><span class="hs-identifier hs-type">A.EqualP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1472"></span><span>      </span><span class="hs-comment">-- Andreas, 2017-09-03, issue #2729:</span><span>
</span><span id="line-1473"></span><span>      </span><span class="hs-comment">-- Do not go into patterns generated by case-split here!</span><span>
</span><span id="line-1474"></span><span>      </span><span class="hs-comment">-- They are treated in a second pass.</span><span>
</span><span id="line-1475"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">A.ConP</span></a></span><span> </span><span id="local-6989586621682007671"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007671"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007672"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007672"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682007673"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007673"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1476"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; ConInfo
</span><a href="Agda.Syntax.Info.html#conPatOrigin"><span class="hs-identifier hs-var">conPatOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007671"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo -&gt; ConInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="Agda.Syntax.Common.html#ConOSplit"><span class="hs-identifier hs-var">ConOSplit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1477"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; UserPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [UserPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; UserPattern (NamedArg Pattern)
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007673"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [UserPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. ConPatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-var">A.ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007671"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007672"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1478"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-type">A.DefP</span></a></span><span> </span><span id="local-6989586621682007676"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007676"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007677"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007677"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007678"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007678"><span class="hs-identifier hs-var">args</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; UserPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [UserPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; UserPattern (NamedArg Pattern)
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007678"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [UserPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-var">A.DefP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007676"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007677"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1479"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-type">A.PatternSynP</span></a></span><span> </span><span id="local-6989586621682007680"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007680"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007681"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007681"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007682"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007682"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[UserPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; UserPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [UserPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; UserPattern (NamedArg Pattern)
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007682"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [UserPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [UserPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-var">A.PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007680"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007681"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1480"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-type">A.RecP</span></a></span><span> </span><span id="local-6989586621682007684"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007684"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682007685"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007685"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007686"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007686"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1481"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; ConInfo
</span><a href="Agda.Syntax.Info.html#conPatOrigin"><span class="hs-identifier hs-var">conPatOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007685"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo -&gt; ConInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="Agda.Syntax.Common.html#ConOSplit"><span class="hs-identifier hs-var">ConOSplit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1482"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' (UserPattern Pattern)]
-&gt; (ConOfAbs [FieldAssignment' (UserPattern Pattern)] -&gt; m b)
-&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[FieldAssignment' (UserPattern Pattern)]
-&gt; (ConOfAbs [FieldAssignment' (UserPattern Pattern)] -&gt; m b)
-&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldAssignment' Pattern
 -&gt; FieldAssignment' (UserPattern Pattern))
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' (UserPattern Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((FieldAssignment' Pattern
  -&gt; FieldAssignment' (UserPattern Pattern))
 -&gt; [FieldAssignment' Pattern]
 -&gt; [FieldAssignment' (UserPattern Pattern)])
-&gt; ((Pattern -&gt; UserPattern Pattern)
    -&gt; FieldAssignment' Pattern
    -&gt; FieldAssignment' (UserPattern Pattern))
-&gt; (Pattern -&gt; UserPattern Pattern)
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' (UserPattern Pattern)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; UserPattern Pattern)
-&gt; FieldAssignment' Pattern
-&gt; FieldAssignment' (UserPattern Pattern)
forall a b. (a -&gt; b) -&gt; FieldAssignment' a -&gt; FieldAssignment' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; UserPattern Pattern
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007686"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [FieldAssignment' (UserPattern Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' (UserPattern Pattern)] -&gt; m b)
-&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' (UserPattern Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [FieldAssignment' (UserPattern Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; ConPatInfo -&gt; [FieldAssignment' Pattern] -&gt; Pattern
forall e.
KwRange
-&gt; ConPatInfo -&gt; [FieldAssignment' (Pattern' e)] -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-var">A.RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007684"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007685"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1483"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-type">A.AsP</span></a></span><span> </span><span id="local-6989586621682007688"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007688"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007689"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007690"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007690"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a. MonadToConcrete m =&gt; Name -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindName%27"><span class="hs-identifier hs-var">bindName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007689"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m b -&gt; m b) -&gt; m b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1484"></span><span>                                </span><span class="annot"><span class="annottext">UserPattern Pattern
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
UserPattern Pattern
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; UserPattern Pattern
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007690"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007691"><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007691"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1485"></span><span>                                </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; BindName -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; BindName -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-var">A.AsP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007688"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007689"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007691"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1486"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-type">A.WithP</span></a></span><span> </span><span id="local-6989586621682007693"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007693"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007694"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007694"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserPattern Pattern
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
UserPattern Pattern
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; UserPattern Pattern
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007694"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (UserPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007656"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs (UserPattern Pattern) -&gt; Pattern)
-&gt; ConOfAbs (UserPattern Pattern)
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-var">A.WithP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007693"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007696"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1489"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1490"></span><span>
</span><span id="line-1491"></span><span>  </span><span id="local-6989586621682007711"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
UserPattern (NamedArg Pattern)
-&gt; (ConOfAbs (UserPattern (NamedArg Pattern)) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span id="local-6989586621682007712"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007712"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007713"><span class="annot"><span class="annottext">ConOfAbs (UserPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007713"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1492"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007712"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1493"></span><span>      </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#CaseSplit"><span class="hs-identifier hs-var">CaseSplit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (UserPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007713"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
ConOfAbs (UserPattern (NamedArg Pattern))
</span><a href="#local-6989586621682007712"><span class="hs-identifier hs-var">np</span></a></span><span>
</span><span id="line-1494"></span><span>      </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arg (Named NamedName (UserPattern Pattern))
-&gt; (ConOfAbs (Arg (Named NamedName (UserPattern Pattern))) -&gt; m b)
-&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Arg (Named NamedName (UserPattern Pattern))
-&gt; (ConOfAbs (Arg (Named NamedName (UserPattern Pattern))) -&gt; m b)
-&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Named NamedName (UserPattern Pattern))
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName (UserPattern Pattern))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; UserPattern Pattern)
-&gt; Named NamedName Pattern -&gt; Named NamedName (UserPattern Pattern)
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; UserPattern Pattern
forall a. a -&gt; UserPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-var">UserPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007712"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (Arg (Named NamedName (UserPattern Pattern))) -&gt; m b
ConOfAbs (UserPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007713"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-1495"></span><span>
</span><span id="line-1496"></span><span class="hs-comment">-- Pass 2a: locate case-split pattern.  Don't bind anything!</span><span>
</span><span id="line-1497"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007716"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1498"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1499"></span><span>
</span><span id="line-1500"></span><span>  </span><span id="local-6989586621682007763"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span id="local-6989586621682007764"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007765"><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1501"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;toConcrete.pat&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;binding pattern (pass 2a)&quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1502"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1503"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-type">A.VarP</span></a></span><span> </span><span id="local-6989586621682007766"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007766"><span class="hs-identifier hs-var">x</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1504"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WildP"><span class="hs-identifier hs-type">A.WildP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1505"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ProjP"><span class="hs-identifier hs-type">A.ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1506"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdP"><span class="hs-identifier hs-type">A.AbsurdP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1507"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LitP"><span class="hs-identifier hs-type">A.LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1508"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1509"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#EqualP"><span class="hs-identifier hs-type">A.EqualP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007764"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1510"></span><span>      </span><span class="hs-comment">-- Andreas, 2017-09-03, issue #2729:</span><span>
</span><span id="line-1511"></span><span>      </span><span class="hs-comment">-- For patterns generated by case-split here, switch to freshening &amp; binding.</span><span>
</span><span id="line-1512"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">A.ConP</span></a></span><span> </span><span id="local-6989586621682007767"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007767"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007768"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007768"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682007769"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007769"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1513"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; ConInfo
</span><a href="Agda.Syntax.Info.html#conPatOrigin"><span class="hs-identifier hs-var">conPatOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007767"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo -&gt; ConInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="Agda.Syntax.Common.html#ConOSplit"><span class="hs-identifier hs-var">ConOSplit</span></a></span><span>
</span><span id="line-1514"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; [NamedArg Pattern] -&gt; [Arg (Named NamedName BindingPattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
 -&gt; [NamedArg Pattern] -&gt; [Arg (Named NamedName BindingPattern)])
-&gt; ((Pattern -&gt; BindingPattern)
    -&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; (Pattern -&gt; BindingPattern)
-&gt; [NamedArg Pattern]
-&gt; [Arg (Named NamedName BindingPattern)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Named NamedName BindingPattern)
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern)
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named NamedName Pattern -&gt; Named NamedName BindingPattern)
 -&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; ((Pattern -&gt; BindingPattern)
    -&gt; Named NamedName Pattern -&gt; Named NamedName BindingPattern)
-&gt; (Pattern -&gt; BindingPattern)
-&gt; NamedArg Pattern
-&gt; Arg (Named NamedName BindingPattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; Named NamedName Pattern -&gt; Named NamedName BindingPattern
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007769"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; Pattern)
-&gt; ConOfAbs [Arg (Named NamedName BindingPattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. ConPatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-var">A.ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007767"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007768"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1515"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [SplitPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern)
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007769"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [SplitPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. ConPatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-var">A.ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007767"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007768"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1516"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-type">A.DefP</span></a></span><span> </span><span id="local-6989586621682007770"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007770"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007771"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007771"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007772"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007772"><span class="hs-identifier hs-var">args</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [SplitPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern)
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007772"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [SplitPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-var">A.DefP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007771"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1517"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-type">A.PatternSynP</span></a></span><span> </span><span id="local-6989586621682007773"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007773"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007774"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007774"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007775"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007775"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[SplitPattern (NamedArg Pattern)]
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern))
-&gt; [NamedArg Pattern] -&gt; [SplitPattern (NamedArg Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; SplitPattern (NamedArg Pattern)
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007775"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [SplitPattern (NamedArg Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [SplitPattern (NamedArg Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-var">A.PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007773"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007774"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1518"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-type">A.RecP</span></a></span><span> </span><span id="local-6989586621682007776"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007776"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682007777"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007777"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007778"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007778"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1519"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; ConInfo
</span><a href="Agda.Syntax.Info.html#conPatOrigin"><span class="hs-identifier hs-var">conPatOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007777"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo -&gt; ConInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="Agda.Syntax.Common.html#ConOSplit"><span class="hs-identifier hs-var">ConOSplit</span></a></span><span>
</span><span id="line-1520"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' BindingPattern]
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[FieldAssignment' BindingPattern]
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
-&gt; [FieldAssignment' Pattern] -&gt; [FieldAssignment' BindingPattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
 -&gt; [FieldAssignment' Pattern] -&gt; [FieldAssignment' BindingPattern])
-&gt; ((Pattern -&gt; BindingPattern)
    -&gt; FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
-&gt; (Pattern -&gt; BindingPattern)
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' BindingPattern]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern
forall a b. (a -&gt; b) -&gt; FieldAssignment' a -&gt; FieldAssignment' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007778"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; Pattern)
-&gt; ConOfAbs [FieldAssignment' BindingPattern]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; ConPatInfo -&gt; [FieldAssignment' Pattern] -&gt; Pattern
forall e.
KwRange
-&gt; ConPatInfo -&gt; [FieldAssignment' (Pattern' e)] -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-var">A.RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007776"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007777"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1521"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' (SplitPattern Pattern)]
-&gt; (ConOfAbs [FieldAssignment' (SplitPattern Pattern)] -&gt; m b)
-&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[FieldAssignment' (SplitPattern Pattern)]
-&gt; (ConOfAbs [FieldAssignment' (SplitPattern Pattern)] -&gt; m b)
-&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldAssignment' Pattern
 -&gt; FieldAssignment' (SplitPattern Pattern))
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' (SplitPattern Pattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((FieldAssignment' Pattern
  -&gt; FieldAssignment' (SplitPattern Pattern))
 -&gt; [FieldAssignment' Pattern]
 -&gt; [FieldAssignment' (SplitPattern Pattern)])
-&gt; ((Pattern -&gt; SplitPattern Pattern)
    -&gt; FieldAssignment' Pattern
    -&gt; FieldAssignment' (SplitPattern Pattern))
-&gt; (Pattern -&gt; SplitPattern Pattern)
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' (SplitPattern Pattern)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; SplitPattern Pattern)
-&gt; FieldAssignment' Pattern
-&gt; FieldAssignment' (SplitPattern Pattern)
forall a b. (a -&gt; b) -&gt; FieldAssignment' a -&gt; FieldAssignment' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; SplitPattern Pattern
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007778"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [FieldAssignment' (SplitPattern Pattern)] -&gt; m b)
 -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' (SplitPattern Pattern)] -&gt; m b)
-&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' (SplitPattern Pattern)] -&gt; Pattern)
-&gt; ConOfAbs [FieldAssignment' (SplitPattern Pattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; ConPatInfo -&gt; [FieldAssignment' Pattern] -&gt; Pattern
forall e.
KwRange
-&gt; ConPatInfo -&gt; [FieldAssignment' (Pattern' e)] -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-var">A.RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007776"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007777"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1522"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-type">A.AsP</span></a></span><span> </span><span id="local-6989586621682007779"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007779"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007780"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007780"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007781"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007781"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; SplitPattern Pattern
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007781"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">((ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007782"><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007782"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1523"></span><span>                                </span><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; BindName -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; BindName -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-var">A.AsP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007779"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007780"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007782"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-type">A.WithP</span></a></span><span> </span><span id="local-6989586621682007783"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007783"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007784"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007784"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; SplitPattern Pattern
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007784"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs (SplitPattern Pattern) -&gt; m b
</span><a href="#local-6989586621682007765"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; Pattern)
-&gt; ConOfAbs (SplitPattern Pattern)
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-var">A.WithP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007783"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007786"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1527"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1528"></span><span>  </span><span id="local-6989586621682007805"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SplitPattern (NamedArg Pattern)
-&gt; (ConOfAbs (SplitPattern (NamedArg Pattern)) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-type">SplitPattern</span></a></span><span> </span><span id="local-6989586621682007806"><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007806"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007807"><span class="annot"><span class="annottext">ConOfAbs (SplitPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007807"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1529"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007806"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1530"></span><span>      </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#CaseSplit"><span class="hs-identifier hs-var">CaseSplit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arg (Named NamedName BindingPattern)
-&gt; (ConOfAbs (Arg (Named NamedName BindingPattern)) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Arg (Named NamedName BindingPattern)
-&gt; (ConOfAbs (Arg (Named NamedName BindingPattern)) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Named NamedName BindingPattern)
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern)
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; Named NamedName Pattern -&gt; Named NamedName BindingPattern
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span>  </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007806"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (Arg (Named NamedName BindingPattern)) -&gt; m b
ConOfAbs (SplitPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007807"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-1531"></span><span>      </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arg (Named NamedName (SplitPattern Pattern))
-&gt; (ConOfAbs (Arg (Named NamedName (SplitPattern Pattern))) -&gt; m b)
-&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Arg (Named NamedName (SplitPattern Pattern))
-&gt; (ConOfAbs (Arg (Named NamedName (SplitPattern Pattern))) -&gt; m b)
-&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named NamedName Pattern -&gt; Named NamedName (SplitPattern Pattern))
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName (SplitPattern Pattern))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; SplitPattern Pattern)
-&gt; Named NamedName Pattern
-&gt; Named NamedName (SplitPattern Pattern)
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; SplitPattern Pattern
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedArg Pattern
</span><a href="#local-6989586621682007806"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConOfAbs (Arg (Named NamedName (SplitPattern Pattern))) -&gt; m b
ConOfAbs (SplitPattern (NamedArg Pattern)) -&gt; m b
</span><a href="#local-6989586621682007807"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- Pass 2b:</span><span>
</span><span id="line-1535"></span><span class="hs-comment">-- Takes care of freshening and binding pattern variables introduced by case split.</span><span>
</span><span id="line-1536"></span><span class="hs-comment">-- Still does not translate anything to Concrete.</span><span>
</span><span id="line-1537"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682007809"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPattern"><span class="hs-identifier hs-type">BindingPattern</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1538"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPattern"><span class="hs-identifier hs-type">BindingPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span>
</span><span id="line-1539"></span><span>  </span><span id="local-6989586621682007845"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindingPattern -&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-type">BindingPat</span></a></span><span> </span><span id="local-6989586621682007846"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682007847"><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1540"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;toConcrete.pat&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;binding pattern (pass 2b)&quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1541"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1542"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-type">A.VarP</span></a></span><span> </span><span id="local-6989586621682007848"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007848"><span class="hs-identifier hs-var">x</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreshenName -&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
FreshenName -&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName -&gt; FreshenName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-var">FreshenName</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007848"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs FreshenName -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs FreshenName -&gt; Pattern) -&gt; ConOfAbs FreshenName -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; Pattern
forall e. BindName -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-var">A.VarP</span></a></span><span> </span><span class="annot"><span class="annottext">(BindName -&gt; Pattern) -&gt; (Name -&gt; BindName) -&gt; Name -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; BindName
</span><a href="Agda.Syntax.Abstract.html#mkBindName"><span class="hs-identifier hs-var">mkBindName</span></a></span><span>
</span><span id="line-1543"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WildP"><span class="hs-identifier hs-type">A.WildP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1544"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ProjP"><span class="hs-identifier hs-type">A.ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1545"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdP"><span class="hs-identifier hs-type">A.AbsurdP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1546"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LitP"><span class="hs-identifier hs-type">A.LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1547"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1548"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#EqualP"><span class="hs-identifier hs-type">A.EqualP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007846"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1549"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">A.ConP</span></a></span><span> </span><span id="local-6989586621682007849"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007849"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007850"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007850"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682007851"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007851"><span class="hs-identifier hs-var">args</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; [NamedArg Pattern] -&gt; [Arg (Named NamedName BindingPattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern)
forall a b. (a -&gt; b) -&gt; NamedArg a -&gt; NamedArg b
</span><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-var">updateNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007851"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; Pattern)
-&gt; ConOfAbs [Arg (Named NamedName BindingPattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConPatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. ConPatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-var">A.ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007849"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007850"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1550"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-type">A.DefP</span></a></span><span> </span><span id="local-6989586621682007852"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007852"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007853"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007853"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007854"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007854"><span class="hs-identifier hs-var">args</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; [NamedArg Pattern] -&gt; [Arg (Named NamedName BindingPattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern)
forall a b. (a -&gt; b) -&gt; NamedArg a -&gt; NamedArg b
</span><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-var">updateNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007854"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; Pattern)
-&gt; ConOfAbs [Arg (Named NamedName BindingPattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-var">A.DefP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007852"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007853"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1551"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-type">A.PatternSynP</span></a></span><span> </span><span id="local-6989586621682007855"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007855"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007856"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007856"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682007857"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007857"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[Arg (Named NamedName BindingPattern)]
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern))
-&gt; [NamedArg Pattern] -&gt; [Arg (Named NamedName BindingPattern)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; NamedArg Pattern -&gt; Arg (Named NamedName BindingPattern)
forall a b. (a -&gt; b) -&gt; NamedArg a -&gt; NamedArg b
</span><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-var">updateNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007857"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [Arg (Named NamedName BindingPattern)] -&gt; Pattern)
-&gt; ConOfAbs [Arg (Named NamedName BindingPattern)]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-var">A.PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007855"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007856"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1552"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-type">A.RecP</span></a></span><span> </span><span id="local-6989586621682007858"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007858"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682007859"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007859"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007860"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007860"><span class="hs-identifier hs-var">args</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' BindingPattern]
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
[FieldAssignment' BindingPattern]
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
-&gt; [FieldAssignment' Pattern] -&gt; [FieldAssignment' BindingPattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
 -&gt; [FieldAssignment' Pattern] -&gt; [FieldAssignment' BindingPattern])
-&gt; ((Pattern -&gt; BindingPattern)
    -&gt; FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern)
-&gt; (Pattern -&gt; BindingPattern)
-&gt; [FieldAssignment' Pattern]
-&gt; [FieldAssignment' BindingPattern]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; BindingPattern)
-&gt; FieldAssignment' Pattern -&gt; FieldAssignment' BindingPattern
forall a b. (a -&gt; b) -&gt; FieldAssignment' a -&gt; FieldAssignment' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span>        </span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span>  </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682007860"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs [FieldAssignment' BindingPattern] -&gt; Pattern)
-&gt; ConOfAbs [FieldAssignment' BindingPattern]
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; ConPatInfo -&gt; [FieldAssignment' Pattern] -&gt; Pattern
forall e.
KwRange
-&gt; ConPatInfo -&gt; [FieldAssignment' (Pattern' e)] -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-var">A.RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682007858"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007859"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1553"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-type">A.AsP</span></a></span><span> </span><span id="local-6989586621682007861"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007861"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007862"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007863"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007863"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreshenName -&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
FreshenName -&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName -&gt; FreshenName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#FreshenName"><span class="hs-identifier hs-var">FreshenName</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007862"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs FreshenName -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs FreshenName -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007864"><span class="annot"><span class="annottext">ConOfAbs FreshenName
</span><a href="#local-6989586621682007864"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1554"></span><span>                                </span><span class="annot"><span class="annottext">BindingPattern -&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindingPattern -&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007863"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">((ConOfAbs BindingPattern -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007865"><span class="annot"><span class="annottext">ConOfAbs BindingPattern
</span><a href="#local-6989586621682007865"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1555"></span><span>                                </span><span class="annot"><span class="annottext">ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; BindName -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; BindName -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-var">A.AsP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007861"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; BindName
</span><a href="Agda.Syntax.Abstract.html#mkBindName"><span class="hs-identifier hs-var">mkBindName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
ConOfAbs FreshenName
</span><a href="#local-6989586621682007864"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs BindingPattern
</span><a href="#local-6989586621682007865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-type">A.WithP</span></a></span><span> </span><span id="local-6989586621682007866"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007866"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007867"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007867"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BindingPattern -&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
BindingPattern -&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; BindingPattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#BindingPat"><span class="hs-identifier hs-var">BindingPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007867"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs BindingPattern -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs BindingPattern -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs BindingPattern -&gt; m b
</span><a href="#local-6989586621682007847"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b)
-&gt; (ConOfAbs BindingPattern -&gt; Pattern)
-&gt; ConOfAbs BindingPattern
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Pattern -&gt; Pattern
forall e. PatInfo -&gt; Pattern' e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-var">A.WithP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007866"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1559"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span>  </span><span id="local-6989586621682007883"><span class="annot"><span class="annottext">bindToConcrete :: forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
Pattern -&gt; (ConOfAbs Pattern -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var hs-var hs-var">bindToConcrete</span></a></span></span><span> </span><span id="local-6989586621682007884"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007884"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682007885"><span class="annot"><span class="annottext">ConOfAbs Pattern -&gt; m b
</span><a href="#local-6989586621682007885"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1562"></span><span>    </span><span id="local-6989586621682007886"><span class="annot"><a href="#local-6989586621682007886"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m PrecedenceStack
forall (m :: * -&gt; *). MonadToConcrete m =&gt; m PrecedenceStack
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#currentPrecedence"><span class="hs-identifier hs-var">currentPrecedence</span></a></span><span>
</span><span id="line-1563"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-type">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#UserPattern"><span class="hs-identifier hs-type">UserPattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007884"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007887"><span class="annot"><span class="annottext">ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007887"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1564"></span><span>      </span><span class="annot"><span class="annottext">SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a (m :: * -&gt; *) b.
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; (ConOfAbs a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) b.
MonadToConcrete m =&gt;
SplitPattern Pattern
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bindToConcrete"><span class="hs-identifier hs-var">bindToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; SplitPattern Pattern
forall a. a -&gt; SplitPattern a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#SplitPattern"><span class="hs-identifier hs-var">SplitPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (UserPattern Pattern)
</span><a href="#local-6989586621682007887"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b)
-&gt; (ConOfAbs (SplitPattern Pattern) -&gt; m b) -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682007888"><span class="annot"><span class="annottext">ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007888"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1565"></span><span>        </span><span class="annot"><span class="annottext">Pattern -&gt; m b
ConOfAbs Pattern -&gt; m b
</span><a href="#local-6989586621682007885"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m b) -&gt; m Pattern -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">PrecedenceStack -&gt; m Pattern -&gt; m Pattern
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
PrecedenceStack -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence%27"><span class="hs-identifier hs-var">withPrecedence'</span></a></span><span> </span><span class="annot"><span class="annottext">PrecedenceStack
</span><a href="#local-6989586621682007886"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="annot"><span class="annottext">(m Pattern -&gt; m Pattern) -&gt; m Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
ConOfAbs (SplitPattern Pattern)
</span><a href="#local-6989586621682007888"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1566"></span><span>  </span><span id="local-6989586621682007969"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span id="local-6989586621682007970"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007970"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1567"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007970"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1568"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#VarP"><span class="hs-identifier hs-type">A.VarP</span></a></span><span> </span><span id="local-6989586621682007971"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007971"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1569"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-var">C.IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pattern) -&gt; (BoundName -&gt; QName) -&gt; BoundName -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; (BoundName -&gt; Name) -&gt; BoundName -&gt; QName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BoundName -&gt; Name
</span><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundName -&gt; Pattern) -&gt; m BoundName -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BindName -&gt; m (ConOfAbs BindName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
BindName -&gt; m (ConOfAbs BindName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007971"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1570"></span><span>
</span><span id="line-1571"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WildP"><span class="hs-identifier hs-type">A.WildP</span></a></span><span> </span><span id="local-6989586621682007972"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007972"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1572"></span><span>        </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-var">C.WildP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007972"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">A.ConP</span></a></span><span> </span><span id="local-6989586621682007974"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007974"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007975"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007975"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682007976"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007976"><span class="hs-identifier hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
</span><a href="#local-6989586621682007977"><span class="hs-identifier hs-var">tryOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007975"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConPatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. ConPatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-var">A.ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682007974"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007975"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007976"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1575"></span><span>
</span><span id="line-1576"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ProjP"><span class="hs-identifier hs-type">A.ProjP</span></a></span><span> </span><span id="local-6989586621682007978"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007978"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjPrefix"><span class="hs-identifier hs-var">ProjPrefix</span></a></span><span> </span><span id="local-6989586621682007979"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007979"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-var">C.IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pattern) -&gt; m QName -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007979"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1577"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ProjP"><span class="hs-identifier hs-type">A.ProjP</span></a></span><span> </span><span id="local-6989586621682007980"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007980"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span>          </span><span id="local-6989586621682007981"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007981"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; Expr -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-var">C.DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Pattern) -&gt; (QName -&gt; Expr) -&gt; QName -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-var">C.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pattern) -&gt; m QName -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007981"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1578"></span><span>
</span><span id="line-1579"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-type">A.DefP</span></a></span><span> </span><span id="local-6989586621682007983"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007983"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007984"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007984"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007985"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007985"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
</span><a href="#local-6989586621682007977"><span class="hs-identifier hs-var">tryOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007984"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-var">A.DefP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007983"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682007984"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682007985"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1580"></span><span>
</span><span id="line-1581"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AsP"><span class="hs-identifier hs-type">A.AsP</span></a></span><span> </span><span id="local-6989586621682007986"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007986"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007987"><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007987"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682007988"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007988"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1582"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682007989"><span class="annot"><a href="#local-6989586621682007989"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682007990"><span class="annot"><a href="#local-6989586621682007990"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence
-&gt; (BindName, Pattern) -&gt; m (ConOfAbs (BindName, Pattern))
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#argumentCtx_"><span class="hs-identifier hs-var">argumentCtx_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName
</span><a href="#local-6989586621682007987"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682007988"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1583"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AsP"><span class="hs-identifier hs-type">C.AsP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007986"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#boundName"><span class="hs-identifier hs-var">C.boundName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007989"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682007990"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdP"><span class="hs-identifier hs-type">A.AbsurdP</span></a></span><span> </span><span id="local-6989586621682007992"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007992"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1586"></span><span>        </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AbsurdP"><span class="hs-identifier hs-var">C.AbsurdP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007992"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1587"></span><span>
</span><span id="line-1588"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LitP"><span class="hs-identifier hs-type">A.LitP</span></a></span><span> </span><span id="local-6989586621682007994"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007994"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span> </span><span id="local-6989586621682007995"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007995"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1589"></span><span>        </span><span id="local-6989586621682007996"><span class="annot"><a href="#local-6989586621682007996"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames -&gt; QName -&gt; m QName
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
AllowAmbiguousNames -&gt; QName -&gt; m QName
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#lookupQName"><span class="hs-identifier hs-var">lookupQName</span></a></span><span> </span><span class="annot"><span class="annottext">AllowAmbiguousNames
</span><a href="Agda.Syntax.Scope.Base.html#AmbiguousNothing"><span class="hs-identifier hs-var">AmbiguousNothing</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682007995"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1590"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracketP_"><span class="hs-identifier hs-type">bracketP_</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#appBrackets"><span class="hs-identifier hs-type">appBrackets</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1591"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-type">C.AppP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#QuoteP"><span class="hs-identifier hs-type">C.QuoteP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682007994"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1592"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-type">defaultNamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">C.IdentP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621682007996"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#LitP"><span class="hs-identifier hs-type">A.LitP</span></a></span><span> </span><span id="local-6989586621682007998"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007998"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682007999"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682007999"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1594"></span><span>        </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Literal -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#LitP"><span class="hs-identifier hs-var">C.LitP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682007998"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682007999"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1595"></span><span>
</span><span id="line-1596"></span><span>      </span><span class="hs-comment">-- Andreas, 2018-06-19, issue #3130</span><span>
</span><span id="line-1597"></span><span>      </span><span class="hs-comment">-- Print .p as .(p) if p is a projection</span><span>
</span><span id="line-1598"></span><span>      </span><span class="hs-comment">-- to avoid confusion with projection pattern.</span><span>
</span><span id="line-1599"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span> </span><span id="local-6989586621682008001"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008001"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008002"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682008002"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Proj"><span class="hs-identifier hs-type">A.Proj</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; Expr -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-var">C.DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008003"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Pattern) -&gt; (Expr -&gt; Expr) -&gt; Expr -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-var">C.Paren</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008003"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Pattern) -&gt; m Expr -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#TopCtx"><span class="hs-identifier hs-var">TopCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008002"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1600"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682008003"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621682008003"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008001"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span>      </span><span class="hs-comment">-- gallais, 2019-02-12, issue #3491</span><span>
</span><span id="line-1603"></span><span>      </span><span class="hs-comment">-- Print .p as .(p) if p is a variable but there is a projection of the</span><span>
</span><span id="line-1604"></span><span>      </span><span class="hs-comment">-- same name in scope.</span><span>
</span><span id="line-1605"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span> </span><span id="local-6989586621682008004"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008004"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008005"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621682008005"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">A.Var</span></a></span><span> </span><span id="local-6989586621682008006"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008006"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1606"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008007"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621682008007"><span class="hs-identifier hs-var hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008004"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1607"></span><span>        </span><span class="hs-comment">-- Erase @v@ to a concrete name and resolve it back to check whether</span><span>
</span><span id="line-1608"></span><span>        </span><span class="hs-comment">-- we have a conflicting field name.</span><span>
</span><span id="line-1609"></span><span>        </span><span id="local-6989586621682008008"><span class="annot"><a href="#local-6989586621682008008"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *). MonadToConcrete m =&gt; Name -&gt; m Name
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteName"><span class="hs-identifier hs-var">toConcreteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008006"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1610"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName"><span class="hs-identifier hs-type">resolveName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#someKindsOfNames"><span class="hs-identifier hs-type">someKindsOfNames</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#FldName"><span class="hs-identifier hs-type">FldName</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008008"><span class="hs-identifier hs-type">cn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-1611"></span><span>          </span><span class="hs-comment">-- If we do then we print .(v) rather than .v</span><span>
</span><span id="line-1612"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1613"></span><span>            </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;print.dotted&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m ()) -&gt; ArgName -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;Wrapping ambiguous name &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ArgName
forall a. Pretty a =&gt; a -&gt; ArgName
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008006"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span>            </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; Expr -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-var">C.DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008007"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Pattern) -&gt; (Expr -&gt; Expr) -&gt; Expr -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-var">C.Paren</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008007"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Pattern) -&gt; m Expr -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Expr -&gt; m (ConOfAbs Expr)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Expr
</span><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-var">A.Var</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008006"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">ResolvedName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Expr -&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
PatInfo -&gt; Expr -&gt; m Pattern
</span><a href="#local-6989586621682008011"><span class="hs-identifier hs-var">printDotDefault</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008004"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008005"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1616"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">NameResolutionError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Pattern
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1617"></span><span>
</span><span id="line-1618"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DotP"><span class="hs-identifier hs-type">A.DotP</span></a></span><span> </span><span id="local-6989586621682008012"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008012"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008013"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008013"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Expr -&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
PatInfo -&gt; Expr -&gt; m Pattern
</span><a href="#local-6989586621682008011"><span class="hs-identifier hs-var">printDotDefault</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008012"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008013"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1619"></span><span>
</span><span id="line-1620"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#EqualP"><span class="hs-identifier hs-type">A.EqualP</span></a></span><span> </span><span id="local-6989586621682008014"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008014"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008015"><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><a href="#local-6989586621682008015"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1621"></span><span>        </span><span class="annot"><span class="annottext">Range -&gt; List1 (Expr, Expr) -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#EqualP"><span class="hs-identifier hs-var">C.EqualP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008014"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 (Expr, Expr) -&gt; Pattern)
-&gt; m (List1 (Expr, Expr)) -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr) -&gt; m (ConOfAbs (List1 (Expr, Expr)))
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
List1 (Expr, Expr) -&gt; m (ConOfAbs (List1 (Expr, Expr)))
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (Expr, Expr)
</span><a href="#local-6989586621682008015"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1622"></span><span>
</span><span id="line-1623"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-type">A.PatternSynP</span></a></span><span> </span><span id="local-6989586621682008017"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008017"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008018"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008018"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008019"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008019"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
</span><a href="#local-6989586621682007977"><span class="hs-identifier hs-var">tryOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008018"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; [NamedArg Pattern] -&gt; Pattern
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-var">A.PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008017"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008018"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008019"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1624"></span><span>
</span><span id="line-1625"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecP"><span class="hs-identifier hs-type">A.RecP</span></a></span><span> </span><span id="local-6989586621682008020"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682008020"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span id="local-6989586621682008021"><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682008021"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008022"><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682008022"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1626"></span><span>        </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; [FieldAssignment' Pattern] -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#RecP"><span class="hs-identifier hs-var">C.RecP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621682008020"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConPatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><a href="#local-6989586621682008021"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FieldAssignment' Pattern] -&gt; Pattern)
-&gt; m [FieldAssignment' Pattern] -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FieldAssignment' Pattern -&gt; m (FieldAssignment' Pattern))
-&gt; [FieldAssignment' Pattern] -&gt; m [FieldAssignment' Pattern]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern)
-&gt; FieldAssignment' Pattern -&gt; m (FieldAssignment' Pattern)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; FieldAssignment' a -&gt; f (FieldAssignment' b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
Pattern -&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (ConOfAbs Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldAssignment' Pattern]
</span><a href="#local-6989586621682008022"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#WithP"><span class="hs-identifier hs-type">A.WithP</span></a></span><span> </span><span id="local-6989586621682008024"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008024"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008025"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008025"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#WithP"><span class="hs-identifier hs-var">C.WithP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008024"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; m Pattern -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Pattern -&gt; m (ConOfAbs Pattern)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#WithArgCtx"><span class="hs-identifier hs-var">WithArgCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008025"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1629"></span><span>
</span><span id="line-1630"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span>    </span><span id="local-6989586621682003319"><span class="annot"><a href="#local-6989586621682008011"><span class="hs-identifier hs-type">printDotDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#PatInfo"><span class="hs-identifier hs-type">PatInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span></span><span>
</span><span id="line-1633"></span><span>    </span><span id="local-6989586621682008011"><span class="annot"><span class="annottext">printDotDefault :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
PatInfo -&gt; Expr -&gt; m Pattern
</span><a href="#local-6989586621682008011"><span class="hs-identifier hs-var hs-var">printDotDefault</span></a></span></span><span> </span><span id="local-6989586621682008037"><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008037"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682008038"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008038"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1634"></span><span>      </span><span id="local-6989586621682008039"><span class="annot"><a href="#local-6989586621682008039"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; Expr -&gt; m (ConOfAbs Expr)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#DotPatternCtx"><span class="hs-identifier hs-var">DotPatternCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008038"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1635"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008040"><span class="annot"><a href="#local-6989586621682008040"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="#local-6989586621682008037"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1636"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682008039"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1637"></span><span>        </span><span class="hs-comment">-- Andreas, 2016-02-04 print ._ pattern as _ pattern,</span><span>
</span><span id="line-1638"></span><span>        </span><span class="hs-comment">-- following the fusing of WildP and ImplicitP.</span><span>
</span><span id="line-1639"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-type">C.Underscore</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-var">C.WildP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008040"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1640"></span><span>        </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; Range -&gt; Expr -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-var">C.DotP</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008040"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008039"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1641"></span><span>
</span><span id="line-1642"></span><span>    </span><span id="local-6989586621682003318"><span class="annot"><a href="#local-6989586621682007977"><span class="hs-identifier hs-type">tryOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003318"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Patterns"><span class="hs-identifier hs-type">A.Patterns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Patterns"><span class="hs-identifier hs-type">A.Patterns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003318"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span></span><span>
</span><span id="line-1643"></span><span>    </span><span id="local-6989586621682007977"><span class="annot"><span class="annottext">tryOp :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName
-&gt; ([NamedArg Pattern] -&gt; Pattern)
-&gt; [NamedArg Pattern]
-&gt; m Pattern
</span><a href="#local-6989586621682007977"><span class="hs-identifier hs-var hs-var">tryOp</span></a></span></span><span> </span><span id="local-6989586621682008088"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008088"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008089"><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Pattern
</span><a href="#local-6989586621682008089"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682008090"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008090"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1644"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-02-04, Issue #1792</span><span>
</span><span id="line-1645"></span><span>      </span><span class="hs-comment">-- To prevent failing of tryToRecoverOpAppP for overapplied operators,</span><span>
</span><span id="line-1646"></span><span>      </span><span class="hs-comment">-- we take off the exceeding arguments first</span><span>
</span><span id="line-1647"></span><span>      </span><span class="hs-comment">-- and apply them pointwise with C.AppP later.</span><span>
</span><span id="line-1648"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008091"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008091"><span class="hs-identifier hs-var hs-var">args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008092"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008092"><span class="hs-identifier hs-var hs-var">args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; [NamedArg Pattern] -&gt; ([NamedArg Pattern], [NamedArg Pattern])
forall a. VerboseLevel -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; VerboseLevel
forall a. NumHoles a =&gt; a -&gt; VerboseLevel
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008088"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008090"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1649"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008095"><span class="annot"><span class="annottext">funCtx :: m (Maybe Pattern) -&gt; m (Maybe Pattern)
</span><a href="#local-6989586621682008095"><span class="hs-identifier hs-var hs-var">funCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (m (Maybe Pattern) -&gt; m (Maybe Pattern))
-&gt; m (Maybe Pattern)
-&gt; m (Maybe Pattern)
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008092"><span class="hs-identifier hs-var">args2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precedence -&gt; m (Maybe Pattern) -&gt; m (Maybe Pattern)
forall (m :: * -&gt; *) a.
MonadToConcrete m =&gt;
Precedence -&gt; m a -&gt; m a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#withPrecedence"><span class="hs-identifier hs-var">withPrecedence</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#FunctionCtx"><span class="hs-identifier hs-var">FunctionCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>      </span><span class="annot"><span class="annottext">Pattern -&gt; m Pattern -&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSynP"><span class="hs-identifier hs-var">tryToRecoverPatternSynP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Pattern
</span><a href="#local-6989586621682008089"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008090"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Pattern -&gt; m Pattern) -&gt; m Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (Maybe Pattern) -&gt; m (Maybe Pattern)
</span><a href="#local-6989586621682008095"><span class="hs-identifier hs-var">funCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; m (Maybe Pattern)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (Maybe Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpAppP"><span class="hs-identifier hs-var">tryToRecoverOpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m (Maybe Pattern)) -&gt; Pattern -&gt; m (Maybe Pattern)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Pattern
</span><a href="#local-6989586621682008089"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008091"><span class="hs-identifier hs-var">args1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Maybe Pattern) -&gt; (Maybe Pattern -&gt; m Pattern) -&gt; m Pattern
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1651"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682008098"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008098"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Pattern -&gt; m Pattern
forall {arg} {m :: * -&gt; *}.
(ConOfAbs arg ~ Arg (Named_ Pattern), MonadFresh NameId m,
 MonadInteractionPoints m, MonadStConcreteNames m, PureTCM m,
 IsString (m Doc), Null (m Doc), Semigroup (m Doc),
 MonadReader Env m, ToConcrete arg) =&gt;
[arg] -&gt; Pattern -&gt; m Pattern
</span><a href="#local-6989586621682008099"><span class="hs-identifier hs-var">applyTo</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008092"><span class="hs-identifier hs-var">args2</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008098"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1652"></span><span>        </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern] -&gt; Pattern -&gt; m Pattern
forall {arg} {m :: * -&gt; *}.
(ConOfAbs arg ~ Arg (Named_ Pattern), MonadFresh NameId m,
 MonadInteractionPoints m, MonadStConcreteNames m, PureTCM m,
 IsString (m Doc), Null (m Doc), Semigroup (m Doc),
 MonadReader Env m, ToConcrete arg) =&gt;
[arg] -&gt; Pattern -&gt; m Pattern
</span><a href="#local-6989586621682008099"><span class="hs-identifier hs-var">applyTo</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008090"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; m Pattern) -&gt; (QName -&gt; Pattern) -&gt; QName -&gt; m Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-var">C.IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; m Pattern) -&gt; m QName -&gt; m Pattern
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008088"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1653"></span><span>    </span><span class="hs-comment">-- Note: applyTo [] c = return c</span><span>
</span><span id="line-1654"></span><span>    </span><span id="local-6989586621682008099"><span class="annot"><span class="annottext">applyTo :: [arg] -&gt; Pattern -&gt; m Pattern
</span><a href="#local-6989586621682008099"><span class="hs-identifier hs-var hs-var">applyTo</span></a></span></span><span> </span><span id="local-6989586621682008243"><span class="annot"><span class="annottext">[arg]
</span><a href="#local-6989586621682008243"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682008244"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008244"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracketP_"><span class="hs-identifier hs-var">bracketP_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[arg] -&gt; PrecedenceStack -&gt; Bool
forall arg. [arg] -&gt; PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#appBracketsArgs"><span class="hs-identifier hs-var">appBracketsArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[arg]
</span><a href="#local-6989586621682008243"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Pattern -&gt; m Pattern) -&gt; m Pattern -&gt; m Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1655"></span><span>      </span><span class="annot"><span class="annottext">(Pattern -&gt; Arg (Named_ Pattern) -&gt; Pattern)
-&gt; Pattern -&gt; [Arg (Named_ Pattern)] -&gt; Pattern
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Arg (Named_ Pattern) -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#AppP"><span class="hs-identifier hs-var">C.AppP</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008244"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg (Named_ Pattern)] -&gt; Pattern)
-&gt; m [Arg (Named_ Pattern)] -&gt; m Pattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1656"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern)))
-&gt; [Arg (Named_ Pattern)] -&gt; m [Arg (Named_ Pattern)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
</span><a href="#local-6989586621682008246"><span class="hs-identifier hs-var">avoidPun</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg (Named_ Pattern)] -&gt; m [Arg (Named_ Pattern)])
-&gt; m [Arg (Named_ Pattern)] -&gt; m [Arg (Named_ Pattern)]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; [arg] -&gt; m (ConOfAbs [arg])
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#argumentCtx_"><span class="hs-identifier hs-var">argumentCtx_</span></a></span><span> </span><span class="annot"><span class="annottext">[arg]
</span><a href="#local-6989586621682008243"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1657"></span><span>
</span><span id="line-1658"></span><span>    </span><span class="hs-comment">-- If --hidden-argument-puns is active, then {x} is replaced by</span><span>
</span><span id="line-1659"></span><span>    </span><span class="hs-comment">-- {(x)} and &#10627;&#160;x&#160;&#10628; by &#10627;&#160;(x)&#160;&#10628;.</span><span>
</span><span id="line-1660"></span><span>    </span><span id="local-6989586621682003331"><span class="annot"><a href="#local-6989586621682008246"><span class="hs-identifier hs-type">avoidPun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003331"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003331"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1661"></span><span>    </span><span id="local-6989586621682008246"><span class="annot"><span class="annottext">avoidPun :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
</span><a href="#local-6989586621682008246"><span class="hs-identifier hs-var hs-var">avoidPun</span></a></span></span><span> </span><span id="local-6989586621682008259"><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682008259"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1662"></span><span>      </span><span class="annot"><span class="annottext">m Bool
-&gt; m (Arg (Named_ Pattern))
-&gt; m (Arg (Named_ Pattern))
-&gt; m (Arg (Named_ Pattern))
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optHiddenArgumentPuns"><span class="hs-identifier hs-var">optHiddenArgumentPuns</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; m PragmaOptions -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern)))
-&gt; Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682008259"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1664"></span><span>             </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621682008260"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682008260"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621682008261"><span class="annot"><span class="annottext">x :: Pattern
</span><a href="#local-6989586621682008261"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">C.IdentP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#notVisible"><span class="hs-identifier hs-var">notVisible</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682008260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1665"></span><span>               </span><span class="annot"><span class="annottext">ArgInfo -&gt; Named_ Pattern -&gt; Arg (Named_ Pattern)
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621682008260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NamedName -&gt; Pattern -&gt; Named_ Pattern
forall name a. Maybe name -&gt; a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#ParenP"><span class="hs-identifier hs-var">C.ParenP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008261"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1666"></span><span>             </span><span id="local-6989586621682008262"><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682008262"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682008262"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1667"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg (Named_ Pattern) -&gt; m (Arg (Named_ Pattern))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ Pattern)
</span><a href="#local-6989586621682008259"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1668"></span><span>
</span><span id="line-1669"></span><span class="hs-comment">-- Helpers for recovering natural number literals</span><span>
</span><span id="line-1670"></span><span>
</span><span id="line-1671"></span><span id="local-6989586621682008263"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverNatural"><span class="hs-identifier hs-type">tryToRecoverNatural</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008263"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682008263"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682008263"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span></span><span>
</span><span id="line-1672"></span><span id="tryToRecoverNatural"><span class="annot"><span class="annottext">tryToRecoverNatural :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverNatural"><span class="hs-identifier hs-var hs-var">tryToRecoverNatural</span></a></span></span><span> </span><span id="local-6989586621682008270"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008270"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682008271"><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008271"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1673"></span><span>  </span><span id="local-6989586621682008272"><span class="annot"><a href="#local-6989586621682008272"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (QName -&gt; BuiltinId -&gt; Bool)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
m (QName -&gt; BuiltinId -&gt; Bool)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isBuiltinFun"><span class="hs-identifier hs-var">isBuiltinFun</span></a></span><span>
</span><span id="line-1674"></span><span>  </span><span class="annot"><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-type">caseMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverNatural"><span class="hs-identifier hs-type">recoverNatural</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008272"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008270"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008271"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Lit"><span class="hs-identifier hs-type">C.Lit</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-type">noRange</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>
</span><span id="line-1675"></span><span>
</span><span id="line-1676"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverNatural"><span class="hs-identifier hs-type">recoverNatural</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#BuiltinId"><span class="hs-identifier hs-type">BuiltinId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1677"></span><span id="recoverNatural"><span class="annot"><span class="annottext">recoverNatural :: (QName -&gt; BuiltinId -&gt; Bool) -&gt; Expr -&gt; Maybe Integer
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverNatural"><span class="hs-identifier hs-var hs-var">recoverNatural</span></a></span></span><span> </span><span id="local-6989586621682008275"><span class="annot"><span class="annottext">QName -&gt; BuiltinId -&gt; Bool
</span><a href="#local-6989586621682008275"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682008276"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008276"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Bool)
-&gt; (QName -&gt; Bool) -&gt; Integer -&gt; Expr -&gt; Maybe Integer
</span><a href="#local-6989586621682008277"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; BuiltinId -&gt; Bool
</span><a href="#local-6989586621682008275"><span class="hs-operator hs-var">`is`</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinZero"><span class="hs-identifier hs-var">builtinZero</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; BuiltinId -&gt; Bool
</span><a href="#local-6989586621682008275"><span class="hs-operator hs-var">`is`</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinSuc"><span class="hs-identifier hs-var">builtinSuc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008276"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1678"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1679"></span><span>    </span><span class="annot"><a href="#local-6989586621682008277"><span class="hs-identifier hs-type">explore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1680"></span><span>    </span><span id="local-6989586621682008277"><span class="annot"><span class="annottext">explore :: (QName -&gt; Bool)
-&gt; (QName -&gt; Bool) -&gt; Integer -&gt; Expr -&gt; Maybe Integer
</span><a href="#local-6989586621682008277"><span class="hs-identifier hs-var hs-var">explore</span></a></span></span><span> </span><span id="local-6989586621682008278"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008278"><span class="hs-identifier hs-var">isZero</span></a></span></span><span> </span><span id="local-6989586621682008279"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008279"><span class="hs-identifier hs-var">isSuc</span></a></span></span><span> </span><span id="local-6989586621682008280"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008280"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#App"><span class="hs-identifier hs-type">A.App</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Con"><span class="hs-identifier hs-type">A.Con</span></a></span><span> </span><span id="local-6989586621682008281"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008281"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682008282"><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682008282"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682008283"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008283"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; Maybe QName
</span><a href="Agda.Syntax.Abstract.Name.html#getUnambiguous"><span class="hs-identifier hs-var">getUnambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008281"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008279"><span class="hs-identifier hs-var">isSuc</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008283"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1681"></span><span>                                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName -&gt; Bool)
-&gt; (QName -&gt; Bool) -&gt; Integer -&gt; Expr -&gt; Maybe Integer
</span><a href="#local-6989586621682008277"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008278"><span class="hs-identifier hs-var">isZero</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008279"><span class="hs-identifier hs-var">isSuc</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Expr -&gt; Maybe Integer)
-&gt; Integer -&gt; Expr -&gt; Maybe Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008280"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Expr
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><a href="#local-6989586621682008282"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1682"></span><span>    </span><span class="annot"><a href="#local-6989586621682008277"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span id="local-6989586621682008286"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008286"><span class="hs-identifier hs-var">isZero</span></a></span></span><span> </span><span id="local-6989586621682008287"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008287"><span class="hs-identifier hs-var">isSuc</span></a></span></span><span> </span><span id="local-6989586621682008288"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008288"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Con"><span class="hs-identifier hs-type">A.Con</span></a></span><span> </span><span id="local-6989586621682008289"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008289"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682008290"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008290"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; Maybe QName
</span><a href="Agda.Syntax.Abstract.Name.html#getUnambiguous"><span class="hs-identifier hs-var">getUnambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008289"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008286"><span class="hs-identifier hs-var">isZero</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008290"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008288"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1683"></span><span>    </span><span class="annot"><a href="#local-6989586621682008277"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span id="local-6989586621682008291"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008291"><span class="hs-identifier hs-var">isZero</span></a></span></span><span> </span><span id="local-6989586621682008292"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621682008292"><span class="hs-identifier hs-var">isSuc</span></a></span></span><span> </span><span id="local-6989586621682008293"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008293"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">ExprInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span> </span><span id="local-6989586621682008294"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008294"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008293"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682008294"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1684"></span><span>    </span><span class="annot"><a href="#local-6989586621682008277"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1685"></span><span>
</span><span id="line-1686"></span><span class="hs-comment">-- Helpers for recovering C.OpApp ------------------------------------------</span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="hs-keyword">data</span><span> </span><span id="Hd"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Hd"><span class="hs-identifier hs-var">Hd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HdVar"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdVar"><span class="hs-identifier hs-var">HdVar</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HdCon"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdCon"><span class="hs-identifier hs-var">HdCon</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HdDef"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-var">HdDef</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HdSyn"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdSyn"><span class="hs-identifier hs-var">HdSyn</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span>
</span><span id="line-1689"></span><span>
</span><span id="line-1690"></span><span class="hs-keyword">data</span><span> </span><span id="MaybeSection"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-var">MaybeSection</span></a></span></span><span> </span><span id="local-6989586621682003403"><span class="annot"><a href="#local-6989586621682003403"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1691"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="YesSection"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span></span><span>
</span><span id="line-1692"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoSection"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682003403"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1693"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008302"><span id="local-6989586621682008308"><span class="annot"><span class="annottext">MaybeSection a -&gt; MaybeSection a -&gt; Bool
(MaybeSection a -&gt; MaybeSection a -&gt; Bool)
-&gt; (MaybeSection a -&gt; MaybeSection a -&gt; Bool)
-&gt; Eq (MaybeSection a)
forall a. Eq a =&gt; MaybeSection a -&gt; MaybeSection a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; MaybeSection a -&gt; MaybeSection a -&gt; Bool
== :: MaybeSection a -&gt; MaybeSection a -&gt; Bool
$c/= :: forall a. Eq a =&gt; MaybeSection a -&gt; MaybeSection a -&gt; Bool
/= :: MaybeSection a -&gt; MaybeSection a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008314"><span id="local-6989586621682008319"><span id="local-6989586621682008323"><span class="annot"><span class="annottext">VerboseLevel -&gt; MaybeSection a -&gt; ArgName -&gt; ArgName
[MaybeSection a] -&gt; ArgName -&gt; ArgName
MaybeSection a -&gt; ArgName
(VerboseLevel -&gt; MaybeSection a -&gt; ArgName -&gt; ArgName)
-&gt; (MaybeSection a -&gt; ArgName)
-&gt; ([MaybeSection a] -&gt; ArgName -&gt; ArgName)
-&gt; Show (MaybeSection a)
forall a.
Show a =&gt;
VerboseLevel -&gt; MaybeSection a -&gt; ArgName -&gt; ArgName
forall a. Show a =&gt; [MaybeSection a] -&gt; ArgName -&gt; ArgName
forall a. Show a =&gt; MaybeSection a -&gt; ArgName
forall a.
(VerboseLevel -&gt; a -&gt; ArgName -&gt; ArgName)
-&gt; (a -&gt; ArgName) -&gt; ([a] -&gt; ArgName -&gt; ArgName) -&gt; Show a
$cshowsPrec :: forall a.
Show a =&gt;
VerboseLevel -&gt; MaybeSection a -&gt; ArgName -&gt; ArgName
showsPrec :: VerboseLevel -&gt; MaybeSection a -&gt; ArgName -&gt; ArgName
$cshow :: forall a. Show a =&gt; MaybeSection a -&gt; ArgName
show :: MaybeSection a -&gt; ArgName
$cshowList :: forall a. Show a =&gt; [MaybeSection a] -&gt; ArgName -&gt; ArgName
showList :: [MaybeSection a] -&gt; ArgName -&gt; ArgName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008328"><span id="local-6989586621682008330"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; MaybeSection a -&gt; MaybeSection b)
-&gt; (forall a b. a -&gt; MaybeSection b -&gt; MaybeSection a)
-&gt; Functor MaybeSection
forall a b. a -&gt; MaybeSection b -&gt; MaybeSection a
forall a b. (a -&gt; b) -&gt; MaybeSection a -&gt; MaybeSection b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; MaybeSection a -&gt; MaybeSection b
fmap :: forall a b. (a -&gt; b) -&gt; MaybeSection a -&gt; MaybeSection b
$c&lt;$ :: forall a b. a -&gt; MaybeSection b -&gt; MaybeSection a
&lt;$ :: forall a b. a -&gt; MaybeSection b -&gt; MaybeSection a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008333"><span id="local-6989586621682008339"><span id="local-6989586621682008343"><span id="local-6989586621682008348"><span id="local-6989586621682008350"><span id="local-6989586621682008353"><span id="local-6989586621682008356"><span id="local-6989586621682008359"><span id="local-6989586621682008362"><span id="local-6989586621682008365"><span id="local-6989586621682008368"><span id="local-6989586621682008370"><span id="local-6989586621682008373"><span id="local-6989586621682008378"><span id="local-6989586621682008383"><span id="local-6989586621682008388"><span id="local-6989586621682008393"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; MaybeSection m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a)
-&gt; (forall a. MaybeSection a -&gt; [a])
-&gt; (forall a. MaybeSection a -&gt; Bool)
-&gt; (forall a. MaybeSection a -&gt; VerboseLevel)
-&gt; (forall a. Eq a =&gt; a -&gt; MaybeSection a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; MaybeSection a -&gt; a)
-&gt; (forall a. Ord a =&gt; MaybeSection a -&gt; a)
-&gt; (forall a. Num a =&gt; MaybeSection a -&gt; a)
-&gt; (forall a. Num a =&gt; MaybeSection a -&gt; a)
-&gt; Foldable MaybeSection
forall a. Eq a =&gt; a -&gt; MaybeSection a -&gt; Bool
forall a. Num a =&gt; MaybeSection a -&gt; a
forall a. Ord a =&gt; MaybeSection a -&gt; a
forall m. Monoid m =&gt; MaybeSection m -&gt; m
forall a. MaybeSection a -&gt; Bool
forall a. MaybeSection a -&gt; VerboseLevel
forall a. MaybeSection a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; VerboseLevel)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; MaybeSection m -&gt; m
fold :: forall m. Monoid m =&gt; MaybeSection m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MaybeSection a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MaybeSection a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; MaybeSection a -&gt; a
$ctoList :: forall a. MaybeSection a -&gt; [a]
toList :: forall a. MaybeSection a -&gt; [a]
$cnull :: forall a. MaybeSection a -&gt; Bool
null :: forall a. MaybeSection a -&gt; Bool
$clength :: forall a. MaybeSection a -&gt; VerboseLevel
length :: forall a. MaybeSection a -&gt; VerboseLevel
$celem :: forall a. Eq a =&gt; a -&gt; MaybeSection a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; MaybeSection a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; MaybeSection a -&gt; a
maximum :: forall a. Ord a =&gt; MaybeSection a -&gt; a
$cminimum :: forall a. Ord a =&gt; MaybeSection a -&gt; a
minimum :: forall a. Ord a =&gt; MaybeSection a -&gt; a
$csum :: forall a. Num a =&gt; MaybeSection a -&gt; a
sum :: forall a. Num a =&gt; MaybeSection a -&gt; a
$cproduct :: forall a. Num a =&gt; MaybeSection a -&gt; a
product :: forall a. Num a =&gt; MaybeSection a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008405"><span id="local-6989586621682008411"><span id="local-6989586621682008417"><span id="local-6989586621682008422"><span class="annot"><span class="annottext">Functor MaybeSection
Foldable MaybeSection
(Functor MaybeSection, Foldable MaybeSection) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    MaybeSection (f a) -&gt; f (MaybeSection a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; MaybeSection a -&gt; m (MaybeSection b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    MaybeSection (m a) -&gt; m (MaybeSection a))
-&gt; Traversable MaybeSection
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
MaybeSection (m a) -&gt; m (MaybeSection a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
MaybeSection (f a) -&gt; f (MaybeSection a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MaybeSection a -&gt; m (MaybeSection b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
MaybeSection (f a) -&gt; f (MaybeSection a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
MaybeSection (f a) -&gt; f (MaybeSection a)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MaybeSection a -&gt; m (MaybeSection b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MaybeSection a -&gt; m (MaybeSection b)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
MaybeSection (m a) -&gt; m (MaybeSection a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
MaybeSection (m a) -&gt; m (MaybeSection a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>
</span><span id="line-1695"></span><span id="local-6989586621682003373"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#fromNoSection"><span class="hs-identifier hs-type">fromNoSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682003373"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003373"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003373"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1696"></span><span id="fromNoSection"><span class="annot"><span class="annottext">fromNoSection :: forall a. a -&gt; MaybeSection a -&gt; a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#fromNoSection"><span class="hs-identifier hs-var hs-var">fromNoSection</span></a></span></span><span> </span><span id="local-6989586621682008428"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008428"><span class="hs-identifier hs-var">fallback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1697"></span><span>  </span><span class="annot"><span class="annottext">MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008428"><span class="hs-identifier hs-var">fallback</span></a></span><span>
</span><span id="line-1698"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-type">NoSection</span></a></span><span> </span><span id="local-6989586621682008429"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008429"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008429"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1699"></span><span>
</span><span id="line-1700"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682003376"><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003376"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1701"></span><span>  </span><span id="local-6989586621682008435"><span class="annot"><span class="annottext">getRange :: MaybeSection a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1702"></span><span>    </span><span class="annot"><span class="annottext">MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-1703"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-type">NoSection</span></a></span><span> </span><span id="local-6989586621682008436"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008436"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008436"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1704"></span><span>
</span><span id="line-1705"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-type">getHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Hd"><span class="hs-identifier hs-type">Hd</span></a></span><span>
</span><span id="line-1706"></span><span id="getHead"><span class="annot"><span class="annottext">getHead :: Expr -&gt; Maybe Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var hs-var">getHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682008437"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008437"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hd -&gt; Maybe Hd
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdVar"><span class="hs-identifier hs-var">HdVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008437"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1707"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621682008439"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008439"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hd -&gt; Maybe Hd
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-var">HdDef</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008439"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1708"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span id="local-6989586621682008440"><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621682008440"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621682008441"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008441"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hd -&gt; Maybe Hd
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-var">HdDef</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Hd) -&gt; QName -&gt; Hd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008441"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1709"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621682008442"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008442"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hd -&gt; Maybe Hd
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdCon"><span class="hs-identifier hs-var">HdCon</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Hd) -&gt; QName -&gt; Hd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008442"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1710"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSyn"><span class="hs-identifier hs-type">A.PatternSyn</span></a></span><span> </span><span id="local-6989586621682008443"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008443"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hd -&gt; Maybe Hd
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdSyn"><span class="hs-identifier hs-var">HdSyn</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Hd) -&gt; QName -&gt; Hd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008443"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1711"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Hd
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1712"></span><span>
</span><span id="line-1713"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#cOpApp"><span class="hs-identifier hs-type">cOpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Aspects"><span class="hs-identifier hs-type">Asp.Aspects</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span>
</span><span id="line-1714"></span><span id="cOpApp"><span class="annot"><span class="annottext">cOpApp :: Aspects
-&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Expr) -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#cOpApp"><span class="hs-identifier hs-var hs-var">cOpApp</span></a></span></span><span> </span><span id="local-6989586621682008445"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008445"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682008446"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008446"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682008447"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008447"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008448"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008448"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008449"><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1715"></span><span>  </span><span class="annot"><span class="annottext">Aspects -&gt; Range -&gt; QName -&gt; Set1 Name -&gt; OpAppArgs -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#KnownOpApp"><span class="hs-identifier hs-var">C.KnownOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008445"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008446"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008447"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Set1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008448"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OpAppArgs -&gt; Expr) -&gt; OpAppArgs -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1716"></span><span>  </span><span class="annot"><span class="annottext">((MaybeSection Expr, PositionInName)
 -&gt; NamedArg (MaybePlaceholder (OpApp Expr)))
-&gt; NonEmpty (MaybeSection Expr, PositionInName) -&gt; OpAppArgs
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybePlaceholder (OpApp Expr)
-&gt; NamedArg (MaybePlaceholder (OpApp Expr))
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybePlaceholder (OpApp Expr)
 -&gt; NamedArg (MaybePlaceholder (OpApp Expr)))
-&gt; ((MaybeSection Expr, PositionInName)
    -&gt; MaybePlaceholder (OpApp Expr))
-&gt; (MaybeSection Expr, PositionInName)
-&gt; NamedArg (MaybePlaceholder (OpApp Expr))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(MaybeSection Expr, PositionInName)
-&gt; MaybePlaceholder (OpApp Expr)
forall {e}.
(MaybeSection e, PositionInName) -&gt; MaybePlaceholder (OpApp e)
</span><a href="#local-6989586621682008451"><span class="hs-identifier hs-var">placeholder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (MaybeSection Expr, PositionInName) -&gt; OpAppArgs)
-&gt; NonEmpty (MaybeSection Expr, PositionInName) -&gt; OpAppArgs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1717"></span><span>  </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
-&gt; NonEmpty PositionInName
-&gt; NonEmpty (MaybeSection Expr, PositionInName)
forall a b. NonEmpty a -&gt; NonEmpty b -&gt; NonEmpty (a, b)
</span><span class="hs-identifier hs-var">List1.zip</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty PositionInName
</span><a href="#local-6989586621682008453"><span class="hs-identifier hs-var">positions</span></a></span><span>
</span><span id="line-1718"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1719"></span><span>    </span><span id="local-6989586621682008454"><span class="annot"><span class="annottext">x0 :: Name
</span><a href="#local-6989586621682008454"><span class="hs-identifier hs-var hs-var">x0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">C.unqualify</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008447"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1720"></span><span>    </span><span id="local-6989586621682008453"><span class="annot"><span class="annottext">positions :: NonEmpty PositionInName
</span><a href="#local-6989586621682008453"><span class="hs-identifier hs-var hs-var">positions</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isPrefix"><span class="hs-identifier hs-var">isPrefix</span></a></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008454"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PositionInName -&gt; MaybeSection Expr -&gt; PositionInName
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeSection Expr -&gt; PositionInName)
-&gt; [MaybeSection Expr] -&gt; [PositionInName]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; List1 (MaybeSection Expr) -&gt; [MaybeSection Expr]
forall a. VerboseLevel -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PositionInName] -&gt; PositionInName -&gt; NonEmpty PositionInName
forall a. [a] -&gt; a -&gt; List1 a
</span><a href="Agda.Utils.List1.html#snoc"><span class="hs-operator hs-var">`List1.snoc`</span></a></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#End"><span class="hs-identifier hs-var">End</span></a></span><span>
</span><span id="line-1721"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isPostfix"><span class="hs-identifier hs-var">isPostfix</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008454"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Beginning"><span class="hs-identifier hs-var">Beginning</span></a></span><span> </span><span class="annot"><span class="annottext">PositionInName -&gt; [PositionInName] -&gt; NonEmpty PositionInName
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PositionInName -&gt; MaybeSection Expr -&gt; PositionInName
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeSection Expr -&gt; PositionInName)
-&gt; [MaybeSection Expr] -&gt; [PositionInName]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; List1 (MaybeSection Expr) -&gt; [MaybeSection Expr]
forall a. VerboseLevel -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1722"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isInfix"><span class="hs-identifier hs-var">isInfix</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008454"><span class="hs-identifier hs-var">x0</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Beginning"><span class="hs-identifier hs-var">Beginning</span></a></span><span> </span><span class="annot"><span class="annottext">PositionInName -&gt; [PositionInName] -&gt; NonEmpty PositionInName
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PositionInName -&gt; MaybeSection Expr -&gt; PositionInName
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeSection Expr -&gt; PositionInName)
-&gt; [MaybeSection Expr] -&gt; [PositionInName]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; List1 (MaybeSection Expr) -&gt; [MaybeSection Expr]
forall a. VerboseLevel -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PositionInName] -&gt; [PositionInName] -&gt; [PositionInName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#End"><span class="hs-identifier hs-var">End</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1723"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span>               </span><span class="annot"><span class="annottext">PositionInName -&gt; MaybeSection Expr -&gt; PositionInName
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="Agda.Syntax.Common.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeSection Expr -&gt; PositionInName)
-&gt; List1 (MaybeSection Expr) -&gt; NonEmpty PositionInName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection Expr)
</span><a href="#local-6989586621682008449"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1724"></span><span>    </span><span id="local-6989586621682008451"><span class="annot"><span class="annottext">placeholder :: (MaybeSection e, PositionInName) -&gt; MaybePlaceholder (OpApp e)
</span><a href="#local-6989586621682008451"><span class="hs-identifier hs-var hs-var">placeholder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeSection e
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008462"><span class="annot"><span class="annottext">PositionInName
</span><a href="#local-6989586621682008462"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PositionInName -&gt; MaybePlaceholder (OpApp e)
forall e. PositionInName -&gt; MaybePlaceholder e
</span><a href="Agda.Syntax.Common.html#Placeholder"><span class="hs-identifier hs-var">Placeholder</span></a></span><span> </span><span class="annot"><span class="annottext">PositionInName
</span><a href="#local-6989586621682008462"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-1725"></span><span>    </span><span class="annot"><a href="#local-6989586621682008451"><span class="hs-identifier hs-var">placeholder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-type">NoSection</span></a></span><span> </span><span id="local-6989586621682008464"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682008464"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008465"><span class="annot"><span class="annottext">PositionInName
</span><a href="#local-6989586621682008465"><span class="hs-identifier hs-var">_pos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpApp e -&gt; MaybePlaceholder (OpApp e)
forall e. e -&gt; MaybePlaceholder e
</span><a href="Agda.Syntax.Common.html#noPlaceholder"><span class="hs-identifier hs-var">noPlaceholder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; OpApp e
forall e. e -&gt; OpApp e
</span><a href="Agda.Syntax.Concrete.html#Ordinary"><span class="hs-identifier hs-var">Ordinary</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682008464"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>
</span><span id="line-1727"></span><span id="local-6989586621682008468"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpApp"><span class="hs-identifier hs-type">tryToRecoverOpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682008468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682008468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span></span><span>
</span><span id="line-1728"></span><span id="tryToRecoverOpApp"><span class="annot"><span class="annottext">tryToRecoverOpApp :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpApp"><span class="hs-identifier hs-var hs-var">tryToRecoverOpApp</span></a></span></span><span> </span><span id="local-6989586621682008504"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008504"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682008505"><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008505"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Expr -&gt; m (Maybe Expr) -&gt; m Expr
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; m (Maybe a) -&gt; m a
</span><a href="Agda.Utils.Maybe.html#fromMaybeM"><span class="hs-identifier hs-var">fromMaybeM</span></a></span><span> </span><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008505"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Maybe Expr) -&gt; m Expr) -&gt; m (Maybe Expr) -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1729"></span><span>  </span><span class="annot"><span class="annottext">((PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr)
-&gt; (Expr -&gt; Bool)
-&gt; (Aspects
    -&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Expr) -&gt; Expr)
-&gt; (Expr -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Expr))]))
-&gt; Expr
-&gt; m (Maybe Expr)
forall a c (m :: * -&gt; *).
(ToConcrete a, c ~ ConOfAbs a, HasRange c, MonadToConcrete m) =&gt;
((PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c)
-&gt; (a -&gt; Bool)
-&gt; (Aspects
    -&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection c) -&gt; c)
-&gt; (a -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))]))
-&gt; a
-&gt; m (Maybe c)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverOpApp"><span class="hs-identifier hs-var">recoverOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Expr -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg Expr -&gt; Bool) -&gt; (Expr -&gt; NamedArg Expr) -&gt; Expr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; NamedArg Expr
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Aspects
-&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Expr) -&gt; Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#cOpApp"><span class="hs-identifier hs-var">cOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Expr))])
</span><a href="#local-6989586621682008508"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008504"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1731"></span><span>    </span><span class="annot"><a href="#local-6989586621682008508"><span class="hs-identifier hs-type">view</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Hd"><span class="hs-identifier hs-type">Hd</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span>    </span><span id="local-6989586621682008508"><span class="annot"><span class="annottext">view :: Expr -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Expr))])
</span><a href="#local-6989586621682008508"><span class="hs-identifier hs-var hs-var">view</span></a></span></span><span> </span><span id="local-6989586621682008509"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008509"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-1733"></span><span>        </span><span class="hs-comment">-- Do we have a series of inserted lambdas?</span><span>
</span><span id="line-1734"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682008510"><span class="annot"><span class="annottext">xs :: [Binder]
</span><a href="#local-6989586621682008510"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Binder]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LamBinding -&gt; Maybe Binder) -&gt; [LamBinding] -&gt; Maybe [Binder]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; Maybe Binder
</span><a href="#local-6989586621682008511"><span class="hs-identifier hs-var">insertedName</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682008512"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1735"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Hd
 -&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
 -&gt; (Hd, [NamedArg (MaybeSection (AppInfo, Expr))]))
-&gt; Maybe Hd
-&gt; Maybe
     ([NamedArg (MaybeSection (AppInfo, Expr))]
      -&gt; (Hd, [NamedArg (MaybeSection (AppInfo, Expr))]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008513"><span class="hs-identifier hs-var">hd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  ([NamedArg (MaybeSection (AppInfo, Expr))]
   -&gt; (Hd, [NamedArg (MaybeSection (AppInfo, Expr))]))
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Expr))])
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008514"><span class="hs-identifier hs-var">sectionArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binder -&gt; Name) -&gt; [Binder] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindName -&gt; Name
</span><a href="Agda.Syntax.Abstract.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">(BindName -&gt; Name) -&gt; (Binder -&gt; BindName) -&gt; Binder -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; BindName
forall a. Binder' a -&gt; a
</span><a href="Agda.Syntax.Abstract.html#binderName"><span class="hs-identifier hs-var">A.binderName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621682008510"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008515"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1736"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1737"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#LamView"><span class="hs-identifier hs-type">LamView</span></a></span><span>     </span><span id="local-6989586621682008512"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621682008512"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621682008517"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008517"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; LamView
</span><a href="Agda.Syntax.Abstract.Views.html#lamView"><span class="hs-identifier hs-var">A.lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008509"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1738"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621682008513"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008513"><span class="hs-identifier hs-var">hd</span></a></span></span><span> </span><span id="local-6989586621682008515"><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008515"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; AppView' (AppInfo, Expr)
</span><a href="Agda.Syntax.Abstract.Views.html#appView%27"><span class="hs-identifier hs-var">A.appView'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008517"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1739"></span><span>
</span><span id="line-1740"></span><span>        </span><span class="hs-comment">-- Only inserted domain-free visible lambdas come from sections.</span><span>
</span><span id="line-1741"></span><span>        </span><span id="local-6989586621682008511"><span class="annot"><span class="annottext">insertedName :: LamBinding -&gt; Maybe Binder
</span><a href="#local-6989586621682008511"><span class="hs-identifier hs-var hs-var">insertedName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DomainFree"><span class="hs-identifier hs-type">A.DomainFree</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008524"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682008524"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682008524"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Origin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682008524"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Maybe Binder
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; Maybe Binder) -&gt; Binder -&gt; Maybe Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Binder
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621682008524"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1743"></span><span>        </span><span class="annot"><a href="#local-6989586621682008511"><span class="hs-identifier hs-var">insertedName</span></a></span><span> </span><span class="annot"><span class="annottext">LamBinding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Binder
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1744"></span><span>
</span><span id="line-1745"></span><span>        </span><span class="hs-comment">-- Build section arguments. Need to check that:</span><span>
</span><span id="line-1746"></span><span>        </span><span class="hs-comment">-- lambda bound variables appear in the right order and only as</span><span>
</span><span id="line-1747"></span><span>        </span><span class="hs-comment">-- top-level arguments.</span><span>
</span><span id="line-1748"></span><span>        </span><span class="annot"><a href="#local-6989586621682008514"><span class="hs-identifier hs-type">sectionArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1749"></span><span>        </span><span id="local-6989586621682008514"><span class="annot"><span class="annottext">sectionArgs :: [Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008514"><span class="hs-identifier hs-var hs-var">sectionArgs</span></a></span></span><span> </span><span id="local-6989586621682008525"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008525"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008525"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1750"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1751"></span><span>            </span><span id="local-6989586621682008527"><span class="annot"><span class="annottext">noXs :: Arg (Named_ (AppInfo, Expr)) -&gt; Bool
</span><a href="#local-6989586621682008527"><span class="hs-identifier hs-var hs-var">noXs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool)
-&gt; (Arg (Named_ (AppInfo, Expr)) -&gt; All)
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; All) -&gt; Expr -&gt; All
forall m. FoldExprFn m Expr
forall a m. ExprLike a =&gt; FoldExprFn m a
</span><a href="Agda.Syntax.Abstract.Views.html#foldExpr"><span class="hs-identifier hs-var">foldExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">A.Var</span></a></span><span> </span><span id="local-6989586621682008530"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008530"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008530"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008525"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>                                             </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; All)
-&gt; (Arg (Named_ (AppInfo, Expr)) -&gt; Expr)
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; All
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AppInfo, Expr) -&gt; Expr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Expr) -&gt; Expr)
-&gt; (Arg (Named_ (AppInfo, Expr)) -&gt; (AppInfo, Expr))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr)) -&gt; (AppInfo, Expr)
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span>
</span><span id="line-1753"></span><span>            </span><span id="local-6989586621682008526"><span class="annot"><span class="annottext">go :: [Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008526"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1754"></span><span>            </span><span class="annot"><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008533"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008533"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682008534"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008534"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008535"><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008535"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682008536"><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008536"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1755"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr)) -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008535"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1756"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Var"><span class="hs-identifier hs-type">A.Var</span></a></span><span> </span><span id="local-6989586621682008537"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008537"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AppInfo, Expr) -&gt; Expr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Expr) -&gt; Expr) -&gt; (AppInfo, Expr) -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr)) -&gt; (AppInfo, Expr)
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008535"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1757"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008533"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008537"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named_ (AppInfo, Expr)
 -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; NamedArg (MaybeSection (AppInfo, Expr))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeSection (AppInfo, Expr)
forall a. MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, Expr)
-&gt; Named_ (AppInfo, Expr)
-&gt; Named NamedName (MaybeSection (AppInfo, Expr))
forall a b. a -&gt; Named NamedName b -&gt; Named NamedName a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008535"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg (MaybeSection (AppInfo, Expr))
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([NamedArg (MaybeSection (AppInfo, Expr))]
 -&gt; [NamedArg (MaybeSection (AppInfo, Expr))])
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008534"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008536"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1758"></span><span>            </span><span class="annot"><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682008538"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008538"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008539"><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008539"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682008540"><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008540"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1759"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr)) -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008539"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr)) -&gt; Bool
</span><a href="#local-6989586621682008527"><span class="hs-identifier hs-var">noXs</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008539"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named_ (AppInfo, Expr)
 -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; NamedArg (MaybeSection (AppInfo, Expr))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named_ (AppInfo, Expr)
  -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
 -&gt; Arg (Named_ (AppInfo, Expr))
 -&gt; NamedArg (MaybeSection (AppInfo, Expr)))
-&gt; (((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
    -&gt; Named_ (AppInfo, Expr)
    -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
-&gt; ((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; NamedArg (MaybeSection (AppInfo, Expr))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
-&gt; Named_ (AppInfo, Expr)
-&gt; Named NamedName (MaybeSection (AppInfo, Expr))
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr)
forall a. a -&gt; MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span><span> </span><span class="annot"><span class="annottext">Arg (Named_ (AppInfo, Expr))
</span><a href="#local-6989586621682008539"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg (MaybeSection (AppInfo, Expr))
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([NamedArg (MaybeSection (AppInfo, Expr))]
 -&gt; [NamedArg (MaybeSection (AppInfo, Expr))])
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
</span><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682008538"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008540"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1760"></span><span>            </span><span class="annot"><a href="#local-6989586621682008526"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [NamedArg (MaybeSection (AppInfo, Expr))]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1761"></span><span>
</span><span id="line-1762"></span><span>    </span><span class="annot"><a href="#local-6989586621682008508"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span id="local-6989586621682008541"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008541"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Arg (Named_ (AppInfo, Expr))
 -&gt; NamedArg (MaybeSection (AppInfo, Expr)))
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((Arg (Named_ (AppInfo, Expr))
  -&gt; NamedArg (MaybeSection (AppInfo, Expr)))
 -&gt; [Arg (Named_ (AppInfo, Expr))]
 -&gt; [NamedArg (MaybeSection (AppInfo, Expr))])
-&gt; (((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
    -&gt; Arg (Named_ (AppInfo, Expr))
    -&gt; NamedArg (MaybeSection (AppInfo, Expr)))
-&gt; ((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
-&gt; [Arg (Named_ (AppInfo, Expr))]
-&gt; [NamedArg (MaybeSection (AppInfo, Expr))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Named_ (AppInfo, Expr)
 -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; NamedArg (MaybeSection (AppInfo, Expr))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named_ (AppInfo, Expr)
  -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
 -&gt; Arg (Named_ (AppInfo, Expr))
 -&gt; NamedArg (MaybeSection (AppInfo, Expr)))
-&gt; (((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
    -&gt; Named_ (AppInfo, Expr)
    -&gt; Named NamedName (MaybeSection (AppInfo, Expr)))
-&gt; ((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
-&gt; Arg (Named_ (AppInfo, Expr))
-&gt; NamedArg (MaybeSection (AppInfo, Expr))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr))
-&gt; Named_ (AppInfo, Expr)
-&gt; Named NamedName (MaybeSection (AppInfo, Expr))
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AppInfo, Expr) -&gt; MaybeSection (AppInfo, Expr)
forall a. a -&gt; MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008542"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Hd -&gt; (Hd, [NamedArg (MaybeSection (AppInfo, Expr))]))
-&gt; Maybe Hd
-&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Expr))])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#getHead"><span class="hs-identifier hs-var">getHead</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008543"><span class="hs-identifier hs-var">hd</span></a></span><span>
</span><span id="line-1763"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621682008543"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008543"><span class="hs-identifier hs-var">hd</span></a></span></span><span> </span><span id="local-6989586621682008542"><span class="annot"><span class="annottext">[Arg (Named_ (AppInfo, Expr))]
</span><a href="#local-6989586621682008542"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; AppView' (AppInfo, Expr)
</span><a href="Agda.Syntax.Abstract.Views.html#appView%27"><span class="hs-identifier hs-var">A.appView'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008541"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1764"></span><span>
</span><span id="line-1765"></span><span id="local-6989586621682003326"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpAppP"><span class="hs-identifier hs-type">tryToRecoverOpAppP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003326"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003326"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1766"></span><span id="tryToRecoverOpAppP"><span class="annot"><span class="annottext">tryToRecoverOpAppP :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m (Maybe Pattern)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverOpAppP"><span class="hs-identifier hs-var hs-var">tryToRecoverOpAppP</span></a></span></span><span> </span><span id="local-6989586621682008577"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008577"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1767"></span><span>  </span><span id="local-6989586621682008578"><span class="annot"><a href="#local-6989586621682008578"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern)
-&gt; (Pattern -&gt; Bool)
-&gt; (Aspects
    -&gt; Range
    -&gt; QName
    -&gt; Name
    -&gt; List1 (MaybeSection Pattern)
    -&gt; Pattern)
-&gt; (Pattern
    -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))]))
-&gt; Pattern
-&gt; m (Maybe Pattern)
forall a c (m :: * -&gt; *).
(ToConcrete a, c ~ ConOfAbs a, HasRange c, MonadToConcrete m) =&gt;
((PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c)
-&gt; (a -&gt; Bool)
-&gt; (Aspects
    -&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection c) -&gt; c)
-&gt; (a -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))]))
-&gt; a
-&gt; m (Maybe c)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverOpApp"><span class="hs-identifier hs-var">recoverOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
(PrecedenceStack -&gt; Bool) -&gt; m Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#bracketP_"><span class="hs-identifier hs-var">bracketP_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Pattern) -&gt; Pattern)
-&gt; Aspects
-&gt; Range
-&gt; QName
-&gt; Name
-&gt; List1 (MaybeSection Pattern)
-&gt; Pattern
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Pattern) -&gt; Pattern
</span><a href="#local-6989586621682008579"><span class="hs-identifier hs-var">opApp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
</span><a href="#local-6989586621682008580"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621682008577"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1768"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportS"><span class="hs-identifier hs-type">reportS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;print.op&quot;</span></span><span> </span><span class="annot"><span class="hs-number">90</span></span><span>
</span><span id="line-1769"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;tryToRecoverOpApp&quot;</span></span><span>
</span><span id="line-1770"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;in:  &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682008577"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-1771"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;out: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682008578"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-1772"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1773"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682008578"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-1774"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1775"></span><span>    </span><span id="local-6989586621682008579"><span class="annot"><span class="annottext">opApp :: Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection Pattern) -&gt; Pattern
</span><a href="#local-6989586621682008579"><span class="hs-identifier hs-var hs-var">opApp</span></a></span></span><span> </span><span id="local-6989586621682008586"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008586"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682008587"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008588"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008588"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008589"><span class="annot"><span class="annottext">List1 (MaybeSection Pattern)
</span><a href="#local-6989586621682008589"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; QName -&gt; Set1 Name -&gt; List1 (Arg (Named_ Pattern)) -&gt; Pattern
</span><a href="Agda.Syntax.Concrete.html#OpAppP"><span class="hs-identifier hs-var">C.OpAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621682008586"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008587"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Set1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008588"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 (Arg (Named_ Pattern)) -&gt; Pattern)
-&gt; List1 (Arg (Named_ Pattern)) -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1776"></span><span>      </span><span class="annot"><span class="annottext">(MaybeSection Pattern -&gt; Arg (Named_ Pattern))
-&gt; List1 (MaybeSection Pattern) -&gt; List1 (Arg (Named_ Pattern))
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Arg (Named_ Pattern)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Arg (Named_ Pattern))
-&gt; (MaybeSection Pattern -&gt; Pattern)
-&gt; MaybeSection Pattern
-&gt; Arg (Named_ Pattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; MaybeSection Pattern -&gt; Pattern
forall a. a -&gt; MaybeSection a -&gt; a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#fromNoSection"><span class="hs-identifier hs-var">fromNoSection</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 (MaybeSection Pattern) -&gt; List1 (Arg (Named_ Pattern)))
-&gt; List1 (MaybeSection Pattern) -&gt; List1 (Arg (Named_ Pattern))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1777"></span><span>      </span><span class="hs-comment">-- `view` does not generate any `Nothing`s</span><span>
</span><span id="line-1778"></span><span>      </span><span class="annot"><span class="annottext">List1 (MaybeSection Pattern)
</span><a href="#local-6989586621682008589"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1779"></span><span>
</span><span id="line-1780"></span><span>    </span><span id="local-6989586621682008591"><span class="annot"><span class="annottext">appInfo :: AppInfo
</span><a href="#local-6989586621682008591"><span class="hs-identifier hs-var hs-var">appInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="Agda.Syntax.Info.html#defaultAppInfo_"><span class="hs-identifier hs-var">defaultAppInfo_</span></a></span><span>
</span><span id="line-1781"></span><span>
</span><span id="line-1782"></span><span>    </span><span class="annot"><a href="#local-6989586621682008580"><span class="hs-identifier hs-type">view</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Hd"><span class="hs-identifier hs-type">Hd</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1783"></span><span>    </span><span id="local-6989586621682008580"><span class="annot"><span class="annottext">view :: Pattern -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
</span><a href="#local-6989586621682008580"><span class="hs-identifier hs-var hs-var">view</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1784"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatInfo
</span><span class="hs-identifier">_</span></span><span>        </span><span id="local-6989586621682008593"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008593"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682008594"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008594"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdCon"><span class="hs-identifier hs-var">HdCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008593"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
 -&gt; [NamedArg Pattern]
 -&gt; [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Pattern
 -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named NamedName Pattern
  -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
 -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; Named NamedName Pattern
    -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; NamedArg Pattern
-&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; Named NamedName Pattern
-&gt; Named_ (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern)
forall a. a -&gt; MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern))
-&gt; (Pattern -&gt; (AppInfo, Pattern))
-&gt; Pattern
-&gt; MaybeSection (AppInfo, Pattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008591"><span class="hs-identifier hs-var">appInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008594"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1785"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefP"><span class="hs-identifier hs-type">DefP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><span class="hs-identifier">_</span></span><span>        </span><span id="local-6989586621682008595"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008595"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682008596"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008596"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-var">HdDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008595"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
 -&gt; [NamedArg Pattern]
 -&gt; [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Pattern
 -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named NamedName Pattern
  -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
 -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; Named NamedName Pattern
    -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; NamedArg Pattern
-&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; Named NamedName Pattern
-&gt; Named_ (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern)
forall a. a -&gt; MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern))
-&gt; (Pattern -&gt; (AppInfo, Pattern))
-&gt; Pattern
-&gt; MaybeSection (AppInfo, Pattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008591"><span class="hs-identifier hs-var">appInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008596"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1786"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-type">PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008597"><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008597"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621682008598"><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008598"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Hd
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdSyn"><span class="hs-identifier hs-var">HdSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#headAmbQ"><span class="hs-identifier hs-var">headAmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousQName
</span><a href="#local-6989586621682008597"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
 -&gt; [NamedArg Pattern]
 -&gt; [NamedArg (MaybeSection (AppInfo, Pattern))])
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; [NamedArg Pattern]
-&gt; [NamedArg (MaybeSection (AppInfo, Pattern))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Pattern
 -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Arg a -&gt; Arg b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Named NamedName Pattern
  -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
 -&gt; NamedArg Pattern -&gt; NamedArg (MaybeSection (AppInfo, Pattern)))
-&gt; ((Pattern -&gt; MaybeSection (AppInfo, Pattern))
    -&gt; Named NamedName Pattern
    -&gt; Named_ (MaybeSection (AppInfo, Pattern)))
-&gt; (Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; NamedArg Pattern
-&gt; NamedArg (MaybeSection (AppInfo, Pattern))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; MaybeSection (AppInfo, Pattern))
-&gt; Named NamedName Pattern
-&gt; Named_ (MaybeSection (AppInfo, Pattern))
forall a b. (a -&gt; b) -&gt; Named NamedName a -&gt; Named NamedName b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern)
forall a. a -&gt; MaybeSection a
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-var">NoSection</span></a></span><span> </span><span class="annot"><span class="annottext">((AppInfo, Pattern) -&gt; MaybeSection (AppInfo, Pattern))
-&gt; (Pattern -&gt; (AppInfo, Pattern))
-&gt; Pattern
-&gt; MaybeSection (AppInfo, Pattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008591"><span class="hs-identifier hs-var">appInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Pattern]
</span><a href="#local-6989586621682008598"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1787"></span><span>      </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Hd, [NamedArg (MaybeSection (AppInfo, Pattern))])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1788"></span><span>      </span><span class="hs-comment">-- ProjP _ _ d   -&gt; Just (HdDef (headAmbQ d), [])   -- ? Andreas, 2016-04-21</span><span>
</span><span id="line-1789"></span><span>
</span><span id="line-1790"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverOpApp"><span class="hs-identifier hs-type">recoverOpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682003393"><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682003394"><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621682003395"><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1791"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#PrecedenceStack"><span class="hs-identifier hs-type">PrecedenceStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1792"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Check for lambdas</span></span><span>
</span><span id="line-1793"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Aspects"><span class="hs-identifier hs-type">Asp.Aspects</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ @opApp@</span></span><span>
</span><span id="line-1794"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#Hd"><span class="hs-identifier hs-type">Hd</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1795"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1796"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1797"></span><span id="recoverOpApp"><span class="annot"><span class="annottext">recoverOpApp :: forall a c (m :: * -&gt; *).
(ToConcrete a, c ~ ConOfAbs a, HasRange c, MonadToConcrete m) =&gt;
((PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c)
-&gt; (a -&gt; Bool)
-&gt; (Aspects
    -&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection c) -&gt; c)
-&gt; (a -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))]))
-&gt; a
-&gt; m (Maybe c)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverOpApp"><span class="hs-identifier hs-var hs-var">recoverOpApp</span></a></span></span><span> </span><span id="local-6989586621682008697"><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c
</span><a href="#local-6989586621682008697"><span class="hs-identifier hs-var">bracket</span></a></span></span><span> </span><span id="local-6989586621682008698"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682008698"><span class="hs-identifier hs-var">isLam</span></a></span></span><span> </span><span id="local-6989586621682008699"><span class="annot"><span class="annottext">Aspects -&gt; Range -&gt; QName -&gt; Name -&gt; List1 (MaybeSection c) -&gt; c
</span><a href="#local-6989586621682008699"><span class="hs-identifier hs-var">opApp</span></a></span></span><span> </span><span id="local-6989586621682008700"><span class="annot"><span class="annottext">a -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))])
</span><a href="#local-6989586621682008700"><span class="hs-identifier hs-var">view</span></a></span></span><span> </span><span id="local-6989586621682008701"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008701"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))])
</span><a href="#local-6989586621682008700"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008701"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1798"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Hd, [NamedArg (MaybeSection (AppInfo, a))])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Maybe c)
forall {a}. m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var">mDefault</span></a></span><span>
</span><span id="line-1799"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008703"><span class="annot"><span class="annottext">Hd
</span><a href="#local-6989586621682008703"><span class="hs-identifier hs-var">hd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008704"><span class="annot"><span class="annottext">[NamedArg (MaybeSection (AppInfo, a))]
</span><a href="#local-6989586621682008704"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1800"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(NamedArg (MaybeSection (AppInfo, a)) -&gt; Bool)
-&gt; [NamedArg (MaybeSection (AppInfo, a))] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">NamedArg (MaybeSection (AppInfo, a)) -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg (MaybeSection (AppInfo, a))]
</span><a href="#local-6989586621682008704"><span class="hs-identifier hs-var">args</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1801"></span><span>      </span><span class="hs-keyword">let</span><span>  </span><span id="local-6989586621682008705"><span class="annot"><span class="annottext">args' :: [MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008705"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedArg (MaybeSection (AppInfo, a)) -&gt; MaybeSection (AppInfo, a))
-&gt; [NamedArg (MaybeSection (AppInfo, a))]
-&gt; [MaybeSection (AppInfo, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedArg (MaybeSection (AppInfo, a)) -&gt; MaybeSection (AppInfo, a)
forall a. NamedArg a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedArg"><span class="hs-identifier hs-var">namedArg</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg (MaybeSection (AppInfo, a))]
</span><a href="#local-6989586621682008704"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1802"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hd
</span><a href="#local-6989586621682008703"><span class="hs-identifier hs-var">hd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1803"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdVar"><span class="hs-identifier hs-type">HdVar</span></a></span><span>  </span><span id="local-6989586621682008706"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008706"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1804"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008706"><span class="hs-identifier hs-var">n</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Maybe c)
forall {a}. m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var">mDefault</span></a></span><span>
</span><span id="line-1805"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Name QName -&gt; [MaybeSection (AppInfo, a)] -&gt; m (Maybe c)
</span><a href="#local-6989586621682008707"><span class="hs-identifier hs-var">doQNameHelper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Either Name QName
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008706"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008705"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1806"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdDef"><span class="hs-identifier hs-type">HdDef</span></a></span><span> </span><span id="local-6989586621682008708"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008708"><span class="hs-identifier hs-var">qn</span></a></span></span><span>
</span><span id="line-1807"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#isExtendedLambdaName"><span class="hs-identifier hs-var">isExtendedLambdaName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008708"><span class="hs-identifier hs-var">qn</span></a></span><span>
</span><span id="line-1808"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Maybe c)
forall {a}. m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var">mDefault</span></a></span><span>
</span><span id="line-1809"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Name QName -&gt; [MaybeSection (AppInfo, a)] -&gt; m (Maybe c)
</span><a href="#local-6989586621682008707"><span class="hs-identifier hs-var">doQNameHelper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Either Name QName
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008708"><span class="hs-identifier hs-var">qn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008705"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1810"></span><span>        </span><span class="hs-comment">-- HdDef qn          -&gt; doQNameHelper (Right qn) args'</span><span>
</span><span id="line-1811"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdCon"><span class="hs-identifier hs-type">HdCon</span></a></span><span> </span><span id="local-6989586621682008710"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008710"><span class="hs-identifier hs-var">qn</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Name QName -&gt; [MaybeSection (AppInfo, a)] -&gt; m (Maybe c)
</span><a href="#local-6989586621682008707"><span class="hs-identifier hs-var">doQNameHelper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Either Name QName
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008710"><span class="hs-identifier hs-var">qn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008705"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1812"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#HdSyn"><span class="hs-identifier hs-type">HdSyn</span></a></span><span> </span><span id="local-6989586621682008711"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008711"><span class="hs-identifier hs-var">qn</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Name QName -&gt; [MaybeSection (AppInfo, a)] -&gt; m (Maybe c)
</span><a href="#local-6989586621682008707"><span class="hs-identifier hs-var">doQNameHelper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Either Name QName
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008711"><span class="hs-identifier hs-var">qn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008705"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1813"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Maybe c)
forall {a}. m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var">mDefault</span></a></span><span>
</span><span id="line-1814"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1815"></span><span>  </span><span id="local-6989586621682008702"><span class="annot"><span class="annottext">mDefault :: m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var hs-var">mDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1816"></span><span>
</span><span id="line-1817"></span><span>  </span><span class="annot"><a href="#local-6989586621682008715"><span class="hs-identifier hs-type">skipParens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1818"></span><span>  </span><span id="local-6989586621682008715"><span class="annot"><span class="annottext">skipParens :: MaybeSection (AppInfo, a) -&gt; Bool
</span><a href="#local-6989586621682008715"><span class="hs-identifier hs-var hs-var">skipParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1819"></span><span>     </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#YesSection"><span class="hs-identifier hs-var">YesSection</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1820"></span><span>     </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#NoSection"><span class="hs-identifier hs-type">NoSection</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008716"><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008716"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008717"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008717"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682008698"><span class="hs-identifier hs-var">isLam</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008717"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ParenPreference -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#preferParenless"><span class="hs-identifier hs-var">preferParenless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppInfo -&gt; ParenPreference
</span><a href="Agda.Syntax.Info.html#appParens"><span class="hs-identifier hs-var">appParens</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008716"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1821"></span><span>
</span><span id="line-1822"></span><span>  </span><span class="annot"><a href="#local-6989586621682008707"><span class="hs-identifier hs-type">doQNameHelper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1823"></span><span>  </span><span id="local-6989586621682008707"><span class="annot"><span class="annottext">doQNameHelper :: Either Name QName -&gt; [MaybeSection (AppInfo, a)] -&gt; m (Maybe c)
</span><a href="#local-6989586621682008707"><span class="hs-identifier hs-var hs-var">doQNameHelper</span></a></span></span><span> </span><span id="local-6989586621682008718"><span class="annot"><span class="annottext">Either Name QName
</span><a href="#local-6989586621682008718"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008719"><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008719"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1824"></span><span>    </span><span id="local-6989586621682008720"><span class="annot"><a href="#local-6989586621682008720"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m QName)
-&gt; (QName -&gt; m QName) -&gt; Either Name QName -&gt; m QName
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">C.QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; (Name -&gt; m Name) -&gt; Name -&gt; m QName
forall (m :: * -&gt; *) b c a.
Functor m =&gt;
(b -&gt; c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="Agda.Utils.Functor.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
Name -&gt; m (ConOfAbs Name)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Name -&gt; m (ConOfAbs Name)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m QName
QName -&gt; m (ConOfAbs QName)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
QName -&gt; m (ConOfAbs QName)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Either Name QName
</span><a href="#local-6989586621682008718"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1825"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008722"><span class="annot"><a href="#local-6989586621682008722"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; (QName -&gt; Name) -&gt; Either Name QName -&gt; Name
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">A.qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">Either Name QName
</span><a href="#local-6989586621682008718"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1826"></span><span>    </span><span class="hs-comment">-- #1346: The fixity of the abstract name is not necessarily correct, it depends on which</span><span>
</span><span id="line-1827"></span><span>    </span><span class="hs-comment">-- concrete name we choose! Make sure to resolve ambiguities with n'.</span><span>
</span><span id="line-1828"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682008723"><span class="annot"><a href="#local-6989586621682008723"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008724"><span class="annot"><a href="#local-6989586621682008724"><span class="hs-identifier hs-var">nk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#resolveName_"><span class="hs-identifier hs-type">resolveName_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008720"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008722"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-1829"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span id="local-6989586621682008725"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008725"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">BindingSource
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008725"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Lens' Name Fixity -&gt; Fixity
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity -&gt; f Fixity) -&gt; Name -&gt; f Name
forall a. LensFixity a =&gt; Lens' a Fixity
Lens' Name Fixity
</span><a href="Agda.Syntax.Common.html#lensFixity"><span class="hs-identifier hs-var">lensFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Bound"><span class="hs-identifier hs-var">Asp.Bound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1830"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#DefinedName"><span class="hs-identifier hs-type">DefinedName</span></a></span><span> </span><span class="annot"><span class="annottext">Access
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008731"><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008731"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="annottext">Suffix
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008731"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; Lens' AbstractName Fixity -&gt; Fixity
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity -&gt; f Fixity) -&gt; AbstractName -&gt; f AbstractName
forall a. LensFixity a =&gt; Lens' a Fixity
Lens' AbstractName Fixity
</span><a href="Agda.Syntax.Common.html#lensFixity"><span class="hs-identifier hs-var">lensFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Function"><span class="hs-identifier hs-var">Asp.Function</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1831"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008736"><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008736"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[AbstractName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008736"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; Lens' AbstractName Fixity -&gt; Fixity
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity -&gt; f Fixity) -&gt; AbstractName -&gt; f AbstractName
forall a. LensFixity a =&gt; Lens' a Fixity
Lens' AbstractName Fixity
</span><a href="Agda.Syntax.Common.html#lensFixity"><span class="hs-identifier hs-var">lensFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Field"><span class="hs-identifier hs-var">Asp.Field</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1832"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ConstructorName"><span class="hs-identifier hs-type">ConstructorName</span></a></span><span> </span><span class="annot"><span class="annottext">Set1 Induction
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008740"><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008740"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[AbstractName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008740"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; Lens' AbstractName Fixity -&gt; Fixity
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity -&gt; f Fixity) -&gt; AbstractName -&gt; f AbstractName
forall a. LensFixity a =&gt; Lens' a Fixity
Lens' AbstractName Fixity
</span><a href="Agda.Syntax.Common.html#lensFixity"><span class="hs-identifier hs-var">lensFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Constructor"><span class="hs-identifier hs-var">Asp.Constructor</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Asp.Inductive</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1833"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#PatternSynResName"><span class="hs-identifier hs-type">PatternSynResName</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008744"><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008744"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[AbstractName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbstractName
</span><a href="#local-6989586621682008744"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; Lens' AbstractName Fixity -&gt; Fixity
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity -&gt; f Fixity) -&gt; AbstractName -&gt; f AbstractName
forall a. LensFixity a =&gt; Lens' a Fixity
Lens' AbstractName Fixity
</span><a href="Agda.Syntax.Common.html#lensFixity"><span class="hs-identifier hs-var">lensFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Constructor"><span class="hs-identifier hs-var">Asp.Constructor</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Asp.Inductive</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1834"></span><span>      </span><span class="annot"><span class="annottext">ResolvedName
</span><a href="Agda.Syntax.Scope.Base.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity
</span><a href="Agda.Syntax.Common.html#noFixity"><span class="hs-identifier hs-var">noFixity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Syntax.Common.Aspect.html#Bound"><span class="hs-identifier hs-var">Asp.Bound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1835"></span><span>    </span><span class="annot"><a href="Agda.Utils.List1.html#ifNull"><span class="hs-identifier hs-type">List1.ifNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008719"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-comment">{-then-}</span><span> </span><span class="annot"><a href="#local-6989586621682008702"><span class="hs-identifier hs-type">mDefault</span></a></span><span> </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682008748"><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008748"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1836"></span><span>      </span><span class="annot"><span class="annottext">Aspects
-&gt; Fixity
-&gt; QName
-&gt; Name
-&gt; List1 (MaybeSection (AppInfo, a))
-&gt; NameParts
-&gt; m (Maybe c)
</span><a href="#local-6989586621682008749"><span class="hs-identifier hs-var">doQName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; NameKind -&gt; Name -&gt; Aspects
forall a. NameAspects a =&gt; Bool -&gt; NameKind -&gt; a -&gt; Aspects
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#nameAspects"><span class="hs-identifier hs-var">nameAspects</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682008724"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008722"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008723"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008720"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008722"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008748"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">C.nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameParts) -&gt; Name -&gt; NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var">C.unqualify</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008720"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1837"></span><span>
</span><span id="line-1838"></span><span>  </span><span class="annot"><a href="#local-6989586621682008749"><span class="hs-identifier hs-type">doQName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Aspect.html#Aspects"><span class="hs-identifier hs-type">Asp.Aspects</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">A.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MaybeSection"><span class="hs-identifier hs-type">MaybeSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Info.html#AppInfo"><span class="hs-identifier hs-type">AppInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682003393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682003394"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1839"></span><span>
</span><span id="line-1840"></span><span>  </span><span class="hs-comment">-- fall-back (wrong number of arguments or no holes)</span><span>
</span><span id="line-1841"></span><span>  </span><span id="local-6989586621682008749"><span class="annot"><span class="annottext">doQName :: Aspects
-&gt; Fixity
-&gt; QName
-&gt; Name
-&gt; List1 (MaybeSection (AppInfo, a))
-&gt; NameParts
-&gt; m (Maybe c)
</span><a href="#local-6989586621682008749"><span class="hs-identifier hs-var hs-var">doQName</span></a></span></span><span> </span><span id="local-6989586621682008751"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008751"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008752"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008752"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008753"><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008753"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682008754"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008754"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-1842"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a)) -&gt; VerboseLevel
forall a. NonEmpty a -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008753"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; VerboseLevel
forall a. NumHoles a =&gt; a -&gt; VerboseLevel
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008752"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe c)
forall {a}. m (Maybe a)
</span><a href="#local-6989586621682008702"><span class="hs-identifier hs-var">mDefault</span></a></span><span>
</span><span id="line-1843"></span><span>
</span><span id="line-1844"></span><span>  </span><span class="hs-comment">-- binary case</span><span>
</span><span id="line-1845"></span><span>  </span><span class="annot"><a href="#local-6989586621682008749"><span class="hs-identifier hs-var">doQName</span></a></span><span> </span><span id="local-6989586621682008756"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008756"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682008757"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008757"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621682008758"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008758"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008759"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008759"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008760"><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008760"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621682008761"><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008761"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682008762"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008762"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-1846"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008762"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1847"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008762"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1848"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008765"><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008765"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008766"><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008766"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
-&gt; ([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a))
-&gt; (List1 (MaybeSection (AppInfo, a))
    -&gt; ([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a)))
-&gt; ([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a))
forall a b. [a] -&gt; b -&gt; (List1 a -&gt; b) -&gt; b
</span><a href="Agda.Utils.List1.html#ifNull"><span class="hs-identifier hs-var">List1.ifNull</span></a></span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008761"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-comment">{-then-}</span><span> </span><span class="annot"><span class="annottext">([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a))
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
-&gt; ([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a))
forall a. List1 a -&gt; ([a], a)
</span><a href="Agda.Utils.List1.html#initLast"><span class="hs-identifier hs-var">List1.initLast</span></a></span><span>
</span><span id="line-1849"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; Maybe c
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe c) -&gt; m c -&gt; m (Maybe c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1850"></span><span>          </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c
</span><a href="#local-6989586621682008697"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Fixity -&gt; PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#opBrackets%27"><span class="hs-identifier hs-var">opBrackets'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a) -&gt; Bool
</span><a href="#local-6989586621682008715"><span class="hs-identifier hs-var">skipParens</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008766"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008757"><span class="hs-identifier hs-var">fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m c -&gt; m c) -&gt; m c -&gt; m c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1851"></span><span>            </span><span id="local-6989586621682008769"><span class="annot"><a href="#local-6989586621682008769"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((AppInfo, a) -&gt; m c)
-&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; Precedence
</span><a href="Agda.Syntax.Fixity.html#LeftOperandCtx"><span class="hs-identifier hs-var">LeftOperandCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008757"><span class="hs-identifier hs-var">fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m c) -&gt; ((AppInfo, a) -&gt; a) -&gt; (AppInfo, a) -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AppInfo, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008760"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-1852"></span><span>            </span><span id="local-6989586621682008771"><span class="annot"><a href="#local-6989586621682008771"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#InsideOperandCtx"><span class="hs-identifier hs-type">InsideOperandCtx</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008765"><span class="hs-identifier hs-type">as'</span></a></span><span>
</span><span id="line-1853"></span><span>            </span><span id="local-6989586621682008773"><span class="annot"><a href="#local-6989586621682008773"><span class="hs-identifier hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">uncurry</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#RightOperandCtx"><span class="hs-identifier hs-type">RightOperandCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008757"><span class="hs-identifier hs-type">fixity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#appParens"><span class="hs-identifier hs-var">appParens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008766"><span class="hs-identifier hs-type">an</span></a></span><span>
</span><span id="line-1854"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682008699"><span class="hs-identifier hs-type">opApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008756"><span class="hs-identifier hs-type">nk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682008769"><span class="hs-identifier hs-type">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682008773"><span class="hs-identifier hs-type">en</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008758"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008759"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682008769"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621682008771"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682008773"><span class="hs-identifier hs-type">en</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1855"></span><span>
</span><span id="line-1856"></span><span>  </span><span class="hs-comment">-- prefix</span><span>
</span><span id="line-1857"></span><span>  </span><span class="annot"><a href="#local-6989586621682008749"><span class="hs-identifier hs-var">doQName</span></a></span><span> </span><span id="local-6989586621682008775"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008775"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682008776"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008776"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621682008777"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008777"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008778"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008778"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008779"><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008779"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682008780"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008780"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-1858"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008780"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1859"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008781"><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008781"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008782"><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008782"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
-&gt; ([MaybeSection (AppInfo, a)], MaybeSection (AppInfo, a))
forall a. List1 a -&gt; ([a], a)
</span><a href="Agda.Utils.List1.html#initLast"><span class="hs-identifier hs-var">List1.initLast</span></a></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008779"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1860"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; Maybe c
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe c) -&gt; m c -&gt; m (Maybe c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1861"></span><span>          </span><span class="annot"><span class="annottext">(PrecedenceStack -&gt; Bool) -&gt; m c -&gt; m c
</span><a href="#local-6989586621682008697"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Fixity -&gt; PrecedenceStack -&gt; Bool
</span><a href="Agda.Syntax.Fixity.html#opBrackets%27"><span class="hs-identifier hs-var">opBrackets'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a) -&gt; Bool
</span><a href="#local-6989586621682008715"><span class="hs-identifier hs-var">skipParens</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008782"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008776"><span class="hs-identifier hs-var">fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m c -&gt; m c) -&gt; m c -&gt; m c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1862"></span><span>            </span><span id="local-6989586621682008783"><span class="annot"><a href="#local-6989586621682008783"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
-&gt; [MaybeSection (AppInfo, a)] -&gt; m [MaybeSection c]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">((MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
 -&gt; [MaybeSection (AppInfo, a)] -&gt; m [MaybeSection c])
-&gt; (((AppInfo, a) -&gt; m c)
    -&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
-&gt; ((AppInfo, a) -&gt; m c)
-&gt; [MaybeSection (AppInfo, a)]
-&gt; m [MaybeSection c]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, a) -&gt; m c)
-&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#InsideOperandCtx"><span class="hs-identifier hs-var">InsideOperandCtx</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m c) -&gt; ((AppInfo, a) -&gt; a) -&gt; (AppInfo, a) -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AppInfo, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008781"><span class="hs-identifier hs-var">as'</span></a></span><span>
</span><span id="line-1863"></span><span>            </span><span id="local-6989586621682008784"><span class="annot"><a href="#local-6989586621682008784"><span class="hs-identifier hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008785"><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008785"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008786"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008786"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; ParenPreference -&gt; Precedence
</span><a href="Agda.Syntax.Fixity.html#RightOperandCtx"><span class="hs-identifier hs-var">RightOperandCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008776"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">(ParenPreference -&gt; Precedence) -&gt; ParenPreference -&gt; Precedence
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AppInfo -&gt; ParenPreference
</span><a href="Agda.Syntax.Info.html#appParens"><span class="hs-identifier hs-var">appParens</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008785"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008786"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008782"><span class="hs-identifier hs-type">an</span></a></span><span>
</span><span id="line-1864"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682008699"><span class="hs-identifier hs-type">opApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008775"><span class="hs-identifier hs-type">nk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682008778"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682008784"><span class="hs-identifier hs-type">en</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008777"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008778"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#snoc"><span class="hs-identifier hs-type">List1.snoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008783"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008784"><span class="hs-identifier hs-type">en</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1865"></span><span>
</span><span id="line-1866"></span><span>  </span><span class="hs-comment">-- postfix</span><span>
</span><span id="line-1867"></span><span>  </span><span class="annot"><a href="#local-6989586621682008749"><span class="hs-identifier hs-var">doQName</span></a></span><span> </span><span id="local-6989586621682008787"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008787"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621682008788"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008788"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621682008789"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008789"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008790"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008790"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008791"><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008791"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682008792"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008792"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-1868"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621682008792"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1869"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008793"><span class="annot"><span class="annottext">a1 :: MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008793"><span class="hs-identifier hs-var hs-var hs-var">a1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a)) -&gt; MaybeSection (AppInfo, a)
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008791"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1870"></span><span>            </span><span id="local-6989586621682008794"><span class="annot"><span class="annottext">as' :: [MaybeSection (AppInfo, a)]
</span><a href="#local-6989586621682008794"><span class="hs-identifier hs-var hs-var hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a)) -&gt; [MaybeSection (AppInfo, a)]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.tail</span></span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008791"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1871"></span><span>        </span><span id="local-6989586621682008796"><span class="annot"><a href="#local-6989586621682008796"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((AppInfo, a) -&gt; m c)
-&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; Precedence
</span><a href="Agda.Syntax.Fixity.html#LeftOperandCtx"><span class="hs-identifier hs-var">LeftOperandCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621682008788"><span class="hs-identifier hs-var">fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m c) -&gt; ((AppInfo, a) -&gt; a) -&gt; (AppInfo, a) -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AppInfo, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeSection (AppInfo, a)
</span><a href="#local-6989586621682008793"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-1872"></span><span>        </span><span id="local-6989586621682008797"><span class="annot"><a href="#local-6989586621682008797"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-type">toConcreteCtx</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#InsideOperandCtx"><span class="hs-identifier hs-type">InsideOperandCtx</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008794"><span class="hs-identifier hs-type">as'</span></a></span><span>
</span><span id="line-1873"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1874"></span><span>          </span><span class="annot"><a href="#local-6989586621682008697"><span class="hs-identifier hs-type">bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Fixity.html#opBrackets"><span class="hs-identifier hs-type">opBrackets</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008788"><span class="hs-identifier hs-type">fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1875"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682008699"><span class="hs-identifier hs-type">opApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008787"><span class="hs-identifier hs-type">nk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682008796"><span class="hs-identifier hs-type">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682008790"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008789"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008790"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682008796"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621682008797"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1876"></span><span>
</span><span id="line-1877"></span><span>  </span><span class="hs-comment">-- roundfix</span><span>
</span><span id="line-1878"></span><span>  </span><span class="annot"><a href="#local-6989586621682008749"><span class="hs-identifier hs-var">doQName</span></a></span><span> </span><span id="local-6989586621682008799"><span class="annot"><span class="annottext">Aspects
</span><a href="#local-6989586621682008799"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008800"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008800"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682008801"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682008801"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682008802"><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008802"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1879"></span><span>    </span><span id="local-6989586621682008803"><span class="annot"><a href="#local-6989586621682008803"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
-&gt; List1 (MaybeSection (AppInfo, a)) -&gt; m (List1 (MaybeSection c))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">((MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
 -&gt; List1 (MaybeSection (AppInfo, a)) -&gt; m (List1 (MaybeSection c)))
-&gt; (((AppInfo, a) -&gt; m c)
    -&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c))
-&gt; ((AppInfo, a) -&gt; m c)
-&gt; List1 (MaybeSection (AppInfo, a))
-&gt; m (List1 (MaybeSection c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AppInfo, a) -&gt; m c)
-&gt; MaybeSection (AppInfo, a) -&gt; m (MaybeSection c)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MaybeSection a -&gt; f (MaybeSection b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precedence -&gt; a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *) a.
(MonadToConcrete m, ToConcrete a) =&gt;
Precedence -&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcreteCtx"><span class="hs-identifier hs-var">toConcreteCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Precedence
</span><a href="Agda.Syntax.Fixity.html#InsideOperandCtx"><span class="hs-identifier hs-var">InsideOperandCtx</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m c) -&gt; ((AppInfo, a) -&gt; a) -&gt; (AppInfo, a) -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AppInfo, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List1 (MaybeSection (AppInfo, a))
</span><a href="#local-6989586621682008802"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1880"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1881"></span><span>      </span><span class="annot"><a href="#local-6989586621682008697"><span class="hs-identifier hs-type">bracket</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Fixity.html#roundFixBrackets"><span class="hs-identifier hs-type">roundFixBrackets</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1882"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682008699"><span class="hs-identifier hs-type">opApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008799"><span class="hs-identifier hs-type">nk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008800"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008800"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008801"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008803"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-1883"></span><span>
</span><span id="line-1884"></span><span class="hs-comment">-- Recovering pattern synonyms --------------------------------------------</span><span>
</span><span id="line-1885"></span><span>
</span><span id="line-1886"></span><span class="annot"><span class="hs-comment">-- | Recover pattern synonyms for expressions.</span></span><span>
</span><span id="line-1887"></span><span id="local-6989586621682003059"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-type">tryToRecoverPatternSyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span></span><span>
</span><span id="line-1888"></span><span id="tryToRecoverPatternSyn"><span class="annot"><span class="annottext">tryToRecoverPatternSyn :: forall (m :: * -&gt; *). MonadToConcrete m =&gt; Expr -&gt; m Expr -&gt; m Expr
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSyn"><span class="hs-identifier hs-var hs-var">tryToRecoverPatternSyn</span></a></span></span><span> </span><span id="local-6989586621682008808"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008808"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682008809"><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008809"><span class="hs-identifier hs-var">fallback</span></a></span></span><span>
</span><span id="line-1889"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621682008810"><span class="hs-identifier hs-var">userWritten</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008808"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008809"><span class="hs-identifier hs-var">fallback</span></a></span><span>
</span><span id="line-1890"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621682008811"><span class="hs-identifier hs-var">litOrCon</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008808"><span class="hs-identifier hs-var">e</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; [NamedArg Expr] -&gt; Expr)
-&gt; (PatternSynDefn -&gt; Expr -&gt; Maybe [WithHiding Expr])
-&gt; Expr
-&gt; m (ConOfAbs Expr)
-&gt; m (ConOfAbs Expr)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
(QName -&gt; [NamedArg a] -&gt; a)
-&gt; (PatternSynDefn -&gt; a -&gt; Maybe [WithHiding a])
-&gt; a
-&gt; m (ConOfAbs a)
-&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverPatternSyn"><span class="hs-identifier hs-var">recoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [NamedArg Expr] -&gt; Expr
</span><a href="#local-6989586621682008813"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn -&gt; Expr -&gt; Maybe [WithHiding Expr]
</span><a href="Agda.Syntax.Abstract.PatternSynonyms.html#matchPatternSyn"><span class="hs-identifier hs-var">matchPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008808"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">m Expr
m (ConOfAbs Expr)
</span><a href="#local-6989586621682008809"><span class="hs-identifier hs-var">fallback</span></a></span><span>
</span><span id="line-1891"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Expr
</span><a href="#local-6989586621682008809"><span class="hs-identifier hs-var">fallback</span></a></span><span>
</span><span id="line-1892"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1893"></span><span>    </span><span id="local-6989586621682008810"><span class="annot"><span class="annottext">userWritten :: Expr -&gt; Bool
</span><a href="#local-6989586621682008810"><span class="hs-identifier hs-var hs-var">userWritten</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#App"><span class="hs-identifier hs-type">A.App</span></a></span><span> </span><span id="local-6989586621682008817"><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008817"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppInfo -&gt; Origin
forall a. LensOrigin a =&gt; a -&gt; Origin
</span><a href="Agda.Syntax.Common.html#getOrigin"><span class="hs-identifier hs-var">getOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">AppInfo
</span><a href="#local-6989586621682008817"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Origin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span>
</span><span id="line-1894"></span><span>    </span><span class="annot"><a href="#local-6989586621682008810"><span class="hs-identifier hs-var">userWritten</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- this means we always use pattern synonyms for nullary constructors</span><span>
</span><span id="line-1895"></span><span>
</span><span id="line-1896"></span><span>    </span><span class="hs-comment">-- Only literals or constructors can head pattern synonym definitions</span><span>
</span><span id="line-1897"></span><span>    </span><span id="local-6989586621682008811"><span class="annot"><span class="annottext">litOrCon :: Expr -&gt; Bool
</span><a href="#local-6989586621682008811"><span class="hs-identifier hs-var hs-var">litOrCon</span></a></span></span><span> </span><span id="local-6989586621682008818"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008818"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1898"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; AppView
</span><a href="Agda.Syntax.Abstract.Views.html#appView"><span class="hs-identifier hs-var">A.appView</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621682008818"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1899"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="annot"><span class="annottext">[NamedArg Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1900"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Lit"><span class="hs-identifier hs-type">A.Lit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">[NamedArg Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1901"></span><span>        </span><span class="annot"><span class="annottext">AppView
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1902"></span><span>
</span><span id="line-1903"></span><span>    </span><span id="local-6989586621682008813"><span class="annot"><span class="annottext">apply :: QName -&gt; [NamedArg Expr] -&gt; Expr
</span><a href="#local-6989586621682008813"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621682008820"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008820"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682008821"><span class="annot"><span class="annottext">[NamedArg Expr]
</span><a href="#local-6989586621682008821"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppView -&gt; Expr
</span><a href="Agda.Syntax.Abstract.Views.html#unAppView"><span class="hs-identifier hs-var">A.unAppView</span></a></span><span> </span><span class="annot"><span class="annottext">(AppView -&gt; Expr) -&gt; AppView -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [NamedArg Expr] -&gt; AppView
forall arg. Expr -&gt; [NamedArg arg] -&gt; AppView' arg
</span><a href="Agda.Syntax.Abstract.Views.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbiguousQName -&gt; Expr
</span><a href="Agda.Syntax.Abstract.html#PatternSyn"><span class="hs-identifier hs-var">A.PatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">(AmbiguousQName -&gt; Expr) -&gt; AmbiguousQName -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; AmbiguousQName
</span><a href="Agda.Syntax.Abstract.Name.html#unambiguous"><span class="hs-identifier hs-var">unambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008820"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedArg Expr]
</span><a href="#local-6989586621682008821"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="annot"><span class="hs-comment">-- | Recover pattern synonyms in patterns.</span></span><span>
</span><span id="line-1906"></span><span id="local-6989586621682003325"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSynP"><span class="hs-identifier hs-type">tryToRecoverPatternSynP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern"><span class="hs-identifier hs-type">A.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">C.Pattern</span></a></span></span><span>
</span><span id="line-1907"></span><span id="tryToRecoverPatternSynP"><span class="annot"><span class="annottext">tryToRecoverPatternSynP :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
Pattern -&gt; m Pattern -&gt; m Pattern
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#tryToRecoverPatternSynP"><span class="hs-identifier hs-var hs-var">tryToRecoverPatternSynP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; [NamedArg Pattern] -&gt; Pattern)
-&gt; (PatternSynDefn -&gt; Pattern -&gt; Maybe [WithHiding Pattern])
-&gt; Pattern
-&gt; m (ConOfAbs Pattern)
-&gt; m (ConOfAbs Pattern)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
(QName -&gt; [NamedArg a] -&gt; a)
-&gt; (PatternSynDefn -&gt; a -&gt; Maybe [WithHiding a])
-&gt; a
-&gt; m (ConOfAbs a)
-&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverPatternSyn"><span class="hs-identifier hs-var">recoverPatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [NamedArg Pattern] -&gt; Pattern
forall {e}. QName -&gt; NAPs e -&gt; Pattern' e
</span><a href="#local-6989586621682008826"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn -&gt; Pattern -&gt; Maybe [WithHiding Pattern]
forall e.
PatternSynDefn -&gt; Pattern' e -&gt; Maybe [WithHiding (Pattern' e)]
</span><a href="Agda.Syntax.Abstract.PatternSynonyms.html#matchPatternSynP"><span class="hs-identifier hs-var">matchPatternSynP</span></a></span><span>
</span><span id="line-1908"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682008826"><span class="annot"><span class="annottext">apply :: QName -&gt; NAPs e -&gt; Pattern' e
</span><a href="#local-6989586621682008826"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621682008828"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008828"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682008829"><span class="annot"><span class="annottext">NAPs e
</span><a href="#local-6989586621682008829"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
forall e. PatInfo -&gt; AmbiguousQName -&gt; NAPs e -&gt; Pattern' e
</span><a href="Agda.Syntax.Abstract.html#PatternSynP"><span class="hs-identifier hs-var">PatternSynP</span></a></span><span> </span><span class="annot"><span class="annottext">PatInfo
</span><a href="Agda.Syntax.Info.html#patNoRange"><span class="hs-identifier hs-var">patNoRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; AmbiguousQName
</span><a href="Agda.Syntax.Abstract.Name.html#unambiguous"><span class="hs-identifier hs-var">unambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008828"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NAPs e
</span><a href="#local-6989586621682008829"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1909"></span><span>
</span><span id="line-1910"></span><span class="annot"><span class="hs-comment">-- | General pattern synonym recovery parameterised over expression type.</span></span><span>
</span><span id="line-1911"></span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverPatternSyn"><span class="hs-identifier hs-type">recoverPatternSyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682003429"><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682003430"><span class="annot"><a href="#local-6989586621682003430"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#MonadToConcrete"><span class="hs-identifier hs-type">MonadToConcrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003430"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1912"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">A.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>                 </span><span class="hs-comment">-- applySyn</span><span>
</span><span id="line-1913"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefn"><span class="hs-identifier hs-type">PatternSynDefn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- match</span><span>
</span><span id="line-1914"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span>                                              </span><span class="hs-comment">-- expressions</span><span>
</span><span id="line-1915"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003430"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- fallback</span><span>
</span><span id="line-1916"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682003430"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-type">ConOfAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682003429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1917"></span><span id="recoverPatternSyn"><span class="annot"><span class="annottext">recoverPatternSyn :: forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
(QName -&gt; [NamedArg a] -&gt; a)
-&gt; (PatternSynDefn -&gt; a -&gt; Maybe [WithHiding a])
-&gt; a
-&gt; m (ConOfAbs a)
-&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#recoverPatternSyn"><span class="hs-identifier hs-var hs-var">recoverPatternSyn</span></a></span></span><span> </span><span id="local-6989586621682008873"><span class="annot"><span class="annottext">QName -&gt; [NamedArg a] -&gt; a
</span><a href="#local-6989586621682008873"><span class="hs-identifier hs-var">applySyn</span></a></span></span><span> </span><span id="local-6989586621682008874"><span class="annot"><span class="annottext">PatternSynDefn -&gt; a -&gt; Maybe [WithHiding a]
</span><a href="#local-6989586621682008874"><span class="hs-identifier hs-var">match</span></a></span></span><span> </span><span id="local-6989586621682008875"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008875"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682008876"><span class="annot"><span class="annottext">m (ConOfAbs a)
</span><a href="#local-6989586621682008876"><span class="hs-identifier hs-var">fallback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1918"></span><span>  </span><span id="local-6989586621682008877"><span class="annot"><a href="#local-6989586621682008877"><span class="hs-identifier hs-var">doFold</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Bool) -&gt; m Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Bool
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#foldPatternSynonyms"><span class="hs-identifier hs-var">foldPatternSynonyms</span></a></span><span>
</span><span id="line-1919"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682008877"><span class="hs-identifier hs-type">doFold</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682008876"><span class="hs-identifier hs-type">fallback</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1920"></span><span>    </span><span id="local-6989586621682008878"><span class="annot"><a href="#local-6989586621682008878"><span class="hs-identifier hs-var">psyns</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getAllPatternSyns"><span class="hs-identifier hs-type">getAllPatternSyns</span></a></span><span>
</span><span id="line-1921"></span><span>    </span><span id="local-6989586621682008879"><span class="annot"><a href="#local-6989586621682008879"><span class="hs-identifier hs-var">scope</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-type">getScope</span></a></span><span>
</span><span id="line-1922"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete.patsyn&quot;</span></span><span> </span><span class="annot"><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-type">hsep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1923"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Scope when attempting to recover pattern synonyms:&quot;</span></span><span>
</span><span id="line-1924"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008879"><span class="hs-identifier hs-type">scope</span></a></span><span>
</span><span id="line-1925"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1926"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682008881"><span class="annot"><a href="#local-6989586621682008881"><span class="hs-identifier hs-var hs-var">isConP</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>    </span><span class="hs-comment">-- #2828: only fold pattern synonyms with</span><span>
</span><span id="line-1927"></span><span>        </span><span class="annot"><a href="#local-6989586621682008881"><span class="hs-identifier hs-var">isConP</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' e
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">--        constructor rhs</span><span>
</span><span id="line-1928"></span><span>        </span><span id="local-6989586621682008882"><span class="annot"><a href="#local-6989586621682008882"><span class="hs-identifier hs-var hs-var">cands</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008883"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[WithHiding a]
</span><a href="#local-6989586621682008884"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pattern' Void -&gt; VerboseLevel
</span><a href="#local-6989586621682008885"><span class="hs-identifier hs-var">score</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' Void
</span><a href="#local-6989586621682008886"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1929"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008883"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008883"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008887"><span class="annot"><span class="annottext">psyndef :: PatternSynDefn
</span><a href="#local-6989586621682008887"><span class="hs-identifier hs-var">psyndef</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefn"><span class="hs-identifier hs-type">PatternSynDefn</span></a></span><span> </span><span class="annot"><span class="annottext">[WithHiding Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682008886"><span class="annot"><span class="annottext">Pattern' Void
</span><a href="#local-6989586621682008886"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(QName, PatternSynDefn)] -&gt; [(QName, PatternSynDefn)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([(QName, PatternSynDefn)] -&gt; [(QName, PatternSynDefn)])
-&gt; [(QName, PatternSynDefn)] -&gt; [(QName, PatternSynDefn)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns -&gt; [(QName, PatternSynDefn)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621682008878"><span class="hs-identifier hs-var">psyns</span></a></span><span>
</span><span id="line-1930"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pattern' Void -&gt; Bool
forall {e}. Pattern' e -&gt; Bool
</span><a href="#local-6989586621682008881"><span class="hs-identifier hs-var">isConP</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' Void
</span><a href="#local-6989586621682008886"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1931"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682008884"><span class="annot"><span class="annottext">[WithHiding a]
</span><a href="#local-6989586621682008884"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PatternSynDefn -&gt; a -&gt; Maybe [WithHiding a]
</span><a href="#local-6989586621682008874"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621682008887"><span class="hs-identifier hs-var">psyndef</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008875"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1932"></span><span>                </span><span class="hs-comment">-- #3879: only fold pattern synonyms with an unqualified concrete name in scope</span><span>
</span><span id="line-1933"></span><span>                </span><span class="hs-comment">-- Note that we only need to consider the head of the inverse lookup result: they</span><span>
</span><span id="line-1934"></span><span>                </span><span class="hs-comment">-- are already sorted from shortest to longest!</span><span>
</span><span id="line-1935"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; [QName]
forall a. Maybe a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">Fold.toList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe QName -&gt; [QName]) -&gt; Maybe QName -&gt; [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; Maybe QName
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; Maybe QName) -&gt; [QName] -&gt; Maybe QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ScopeInfo -&gt; [QName]
</span><a href="Agda.Syntax.Scope.Base.html#inverseScopeLookupName"><span class="hs-identifier hs-var">inverseScopeLookupName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008883"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621682008879"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-1936"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-1937"></span><span>        </span><span id="local-6989586621682008897"><span class="annot"><a href="#local-6989586621682008897"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008898"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008898"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008899"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008899"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008899"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008898"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1938"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;toConcrete.patsyn&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-type">hsep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1939"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Found pattern synonym candidates:&quot;</span></span><span>
</span><span id="line-1940"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyList_"><span class="hs-identifier hs-type">prettyList_</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682008901"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008901"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[WithHiding a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008901"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682008882"><span class="hs-identifier hs-type">cands</span></a></span><span>
</span><span id="line-1941"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1942"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">sortBy</span></span><span> </span><span class="annot"><a href="#local-6989586621682008897"><span class="hs-identifier hs-type">cmp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682008882"><span class="hs-identifier hs-type">cands</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1943"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682008902"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008902"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682008903"><span class="annot"><span class="annottext">[WithHiding a]
</span><a href="#local-6989586621682008903"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(QName, [WithHiding a], VerboseLevel)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m (ConOfAbs a)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadToConcrete m) =&gt;
a -&gt; m (ConOfAbs a)
forall (m :: * -&gt; *). MonadToConcrete m =&gt; a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var">toConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (ConOfAbs a)) -&gt; a -&gt; m (ConOfAbs a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [NamedArg a] -&gt; a
</span><a href="#local-6989586621682008873"><span class="hs-identifier hs-var">applySyn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682008902"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">([NamedArg a] -&gt; a) -&gt; [NamedArg a] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1944"></span><span>        </span><span class="annot"><span class="annottext">[WithHiding a] -&gt; (WithHiding a -&gt; NamedArg a) -&gt; [NamedArg a]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="Agda.Utils.Functor.html#for"><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[WithHiding a]
</span><a href="#local-6989586621682008903"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">((WithHiding a -&gt; NamedArg a) -&gt; [NamedArg a])
-&gt; (WithHiding a -&gt; NamedArg a) -&gt; [NamedArg a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span id="local-6989586621682008905"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682008905"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682008906"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008906"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; NamedArg a -&gt; NamedArg a
forall a. LensHiding a =&gt; Hiding -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier hs-var">setHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621682008905"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg a -&gt; NamedArg a) -&gt; NamedArg a -&gt; NamedArg a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; NamedArg a
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682008906"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1945"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ConOfAbs a)
</span><a href="#local-6989586621682008876"><span class="hs-identifier hs-var">fallback</span></a></span><span>
</span><span id="line-1946"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1947"></span><span>    </span><span class="hs-comment">-- Heuristic to pick the best pattern synonym: the one that folds the most</span><span>
</span><span id="line-1948"></span><span>    </span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-1949"></span><span>    </span><span class="annot"><a href="#local-6989586621682008885"><span class="hs-identifier hs-type">score</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Pattern%27"><span class="hs-identifier hs-type">Pattern'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1950"></span><span>    </span><span id="local-6989586621682008885"><span class="annot"><span class="annottext">score :: Pattern' Void -&gt; VerboseLevel
</span><a href="#local-6989586621682008885"><span class="hs-identifier hs-var hs-var">score</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sum VerboseLevel -&gt; VerboseLevel
forall a. Sum a -&gt; a
</span><span class="hs-identifier hs-var">getSum</span></span><span> </span><span class="annot"><span class="annottext">(Sum VerboseLevel -&gt; VerboseLevel)
-&gt; (Pattern' Void -&gt; Sum VerboseLevel)
-&gt; Pattern' Void
-&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' (ADotT (Pattern' Void)) -&gt; Sum VerboseLevel)
-&gt; Pattern' Void -&gt; Sum VerboseLevel
forall p m.
(APatternLike p, Monoid m) =&gt;
(Pattern' (ADotT p) -&gt; m) -&gt; p -&gt; m
</span><a href="Agda.Syntax.Abstract.Pattern.html#foldAPattern"><span class="hs-identifier hs-var">foldAPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' Void -&gt; Sum VerboseLevel
Pattern' (ADotT (Pattern' Void)) -&gt; Sum VerboseLevel
forall {a} {e}. Num a =&gt; Pattern' e -&gt; a
</span><a href="#local-6989586621682008910"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1951"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682008910"><span class="annot"><span class="annottext">con :: Pattern' e -&gt; a
</span><a href="#local-6989586621682008910"><span class="hs-identifier hs-var hs-var">con</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1952"></span><span>            </span><span class="annot"><a href="#local-6989586621682008910"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' e
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1953"></span><span>
</span><span id="line-1954"></span><span class="hs-comment">-- Some instances that are related to interaction with users -----------</span><span>
</span><span id="line-1955"></span><span>
</span><span id="line-1956"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682008916"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1957"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span>
</span><span id="line-1958"></span><span>    </span><span id="local-6989586621682008925"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
InteractionId -&gt; m (ConOfAbs InteractionId)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span id="local-6989586621682008927"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621682008927"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; m Expr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; m Expr) -&gt; Expr -&gt; m Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe VerboseLevel -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#QuestionMark"><span class="hs-identifier hs-var">C.QuestionMark</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Maybe VerboseLevel
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621682008927"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1959"></span><span>
</span><span id="line-1960"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682008930"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ToConcrete"><span class="hs-identifier hs-type">ToConcrete</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#NamedMeta"><span class="hs-identifier hs-type">NamedMeta</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1961"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ConOfAbs"><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#ConOfAbs"><span class="hs-identifier hs-var">ConOfAbs</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#NamedMeta"><span class="hs-identifier hs-type">NamedMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">C.Expr</span></a></span><span>
</span><span id="line-1962"></span><span>    </span><span id="local-6989586621682008942"><span class="annot"><span class="annottext">toConcrete :: forall (m :: * -&gt; *).
MonadToConcrete m =&gt;
NamedMeta -&gt; m (ConOfAbs NamedMeta)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#toConcrete"><span class="hs-identifier hs-var hs-var hs-var">toConcrete</span></a></span></span><span> </span><span id="local-6989586621682008943"><span class="annot"><span class="annottext">NamedMeta
</span><a href="#local-6989586621682008943"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1963"></span><span>      </span><span class="annot"><span class="annottext">Range -&gt; Maybe ArgName -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-var">C.Underscore</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ArgName -&gt; Expr) -&gt; (Doc -&gt; Maybe ArgName) -&gt; Doc -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Maybe ArgName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; Maybe ArgName)
-&gt; (Doc -&gt; ArgName) -&gt; Doc -&gt; Maybe ArgName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; ArgName
forall a. Doc a -&gt; ArgName
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Expr) -&gt; m Doc -&gt; m Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamedMeta -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; NamedMeta -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">NamedMeta
</span><a href="#local-6989586621682008943"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1964"></span></pre></body></html>