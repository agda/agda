<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | Type-check all files of a library (option @--build-library@).</span></span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html"><span class="hs-identifier">Agda.Interaction.BuildLibrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#buildLibrary"><span class="hs-identifier">buildLibrary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#printAccumulatedWarnings"><span class="hs-identifier">printAccumulatedWarnings</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getCurrentDirectory</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath.Find</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Find</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Interaction.FindFile.html"><span class="hs-identifier">Agda.Interaction.FindFile</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.FindFile.html#hasAgdaExtension"><span class="hs-identifier">hasAgdaExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.FindFile.html#checkModuleName"><span class="hs-identifier">checkModuleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Imports.html#TCWorkers"><span class="hs-identifier">TCWorkers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#Source"><span class="hs-identifier">Source</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#MainInterface"><span class="hs-identifier">MainInterface</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Imp</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Interaction.Library.html"><span class="hs-identifier">Agda.Interaction.Library</span></a></span><span>         </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.Base.html#AgdaLibFile"><span class="hs-identifier">AgdaLibFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.Base.html#_libIncludes"><span class="hs-identifier">_libIncludes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.Base.html#_libPragmas"><span class="hs-identifier">_libPragmas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.html#getAgdaLibFile"><span class="hs-identifier">getAgdaLibFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Types.html#optOnlyScopeChecking"><span class="hs-identifier">optOnlyScopeChecking</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html"><span class="hs-identifier">Agda.Syntax.Abstract.Name</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#noModuleName"><span class="hs-identifier">noModuleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#beginningOfFile"><span class="hs-identifier">beginningOfFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier">prettyTCM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier">text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vsep"><span class="hs-identifier">vsep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.TypeChecking.Pretty.Warning.html"><span class="hs-identifier">Agda.TypeChecking.Pretty.Warning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarnings"><span class="hs-identifier">getAllWarnings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.Warning.html#tcWarningsToError"><span class="hs-identifier">tcWarningsToError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>       </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#AllWarnings"><span class="hs-identifier">AllWarnings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#classifyWarnings"><span class="hs-identifier">classifyWarnings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier">absolute</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>               </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.IO.Directory.html"><span class="hs-identifier">Agda.Utils.IO.Directory</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.IO.Directory.html#findWithInfo"><span class="hs-identifier">findWithInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#bracket_"><span class="hs-identifier">bracket_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Null.html#unlessNullM"><span class="hs-identifier">unlessNullM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.String.html"><span class="hs-identifier">Agda.Utils.String</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.String.html#delimiter"><span class="hs-identifier">delimiter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Find @.agda-lib@ file from current directory</span><span>
</span><span id="line-40"></span><span class="hs-comment">--   and build all modules located in the @include@ paths</span><span>
</span><span id="line-41"></span><span class="hs-comment">--   and their subdirectories of the library.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#buildLibrary"><span class="hs-identifier hs-type">buildLibrary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span id="buildLibrary"><span class="annot"><span class="annottext">buildLibrary :: TCM ()
</span><a href="Agda.Interaction.BuildLibrary.html#buildLibrary"><span class="hs-identifier hs-var hs-var">buildLibrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621682243650"><span class="annot"><a href="#local-6989586621682243650"><span class="hs-identifier hs-var">cwd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; TCMT IO FilePath
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-comment">-- Read the library file.</span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621682243651"><span class="annot"><a href="#local-6989586621682243651"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#libToTCM"><span class="hs-identifier hs-type">libToTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Library.html#getAgdaLibFile"><span class="hs-identifier hs-type">getAgdaLibFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243650"><span class="hs-identifier hs-type">cwd</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621682243653"><span class="annot"><a href="#local-6989586621682243653"><span class="hs-identifier hs-var">libFile</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Interaction.Library.Base.html#AgdaLibFile"><span class="hs-identifier hs-type">AgdaLibFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.Base.html#_libIncludes"><span class="hs-identifier hs-var">_libIncludes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682243654"><span class="annot"><a href="#local-6989586621682243654"><span class="hs-identifier hs-var">paths</span></a></span></span><span>
</span><span id="line-50"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.Base.html#_libPragmas"><span class="hs-identifier hs-var">_libPragmas</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682243655"><span class="annot"><a href="#local-6989586621682243655"><span class="hs-identifier hs-var">libOpts</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682243651"><span class="hs-identifier hs-type">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682243656"><span class="annot"><span class="annottext">AgdaLibFile
</span><a href="#local-6989586621682243656"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AgdaLibFile -&gt; TCMT IO AgdaLibFile
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AgdaLibFile
</span><a href="#local-6989586621682243656"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; TCMT IO AgdaLibFile
forall a. TCErr -&gt; TCMT IO a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(TCErr -&gt; TCMT IO AgdaLibFile) -&gt; TCErr -&gt; TCMT IO AgdaLibFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCErr
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericException"><span class="hs-identifier hs-var">GenericException</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No library found to build&quot;</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">[AgdaLibFile]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCMT IO AgdaLibFile
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#checkAndSetOptionsFromPragma"><span class="hs-identifier hs-type">checkAndSetOptionsFromPragma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243655"><span class="hs-identifier hs-type">libOpts</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">-- Import the primitive modules</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Agda.Interaction.Imports.html#importPrimitiveModules"><span class="hs-identifier hs-type">Imp.importPrimitiveModules</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">-- Find all modules in the include paths of the library.</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621682243660"><span class="annot"><a href="#local-6989586621682243660"><span class="hs-identifier hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">sort</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-var">Find.infoPath</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="annot"><a href="#local-6989586621682243654"><span class="hs-identifier hs-type">paths</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682243665"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682243665"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">IO [FileInfo] -&gt; TCMT IO [FileInfo]
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [FileInfo] -&gt; TCMT IO [FileInfo])
-&gt; IO [FileInfo] -&gt; TCMT IO [FileInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RecursionPredicate
-&gt; RecursionPredicate -&gt; FilePath -&gt; IO [FileInfo]
</span><a href="Agda.Utils.IO.Directory.html#findWithInfo"><span class="hs-identifier hs-var">findWithInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; RecursionPredicate
forall a. a -&gt; FindClause a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="Agda.Interaction.FindFile.html#hasAgdaExtension"><span class="hs-identifier hs-var">hasAgdaExtension</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; FindClause FilePath -&gt; RecursionPredicate
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FindClause FilePath
</span><span class="hs-identifier hs-var">Find.filePath</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682243665"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">-- Call the type-checker on all these modules.</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- (Code copied from Agda.Main.)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621682243667"><span class="annot"><a href="#local-6989586621682243667"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#commandLineOptions"><span class="hs-identifier hs-type">commandLineOptions</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621682243669"><span class="annot"><a href="#local-6989586621682243669"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#wantsParallelChecking"><span class="hs-identifier hs-type">Imp.wantsParallelChecking</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621682243671"><span class="annot"><a href="#local-6989586621682243671"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="annot"><a href="#local-6989586621682243660"><span class="hs-identifier hs-type">files</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682243672"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682243672"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621682243673"><span class="annot"><a href="#local-6989586621682243673"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">AbsolutePath</span></span><span>
</span><span id="line-72"></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AbsolutePath -&gt; TCMT IO AbsolutePath
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO AbsolutePath
</span><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier hs-var">absolute</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682243672"><span class="hs-identifier hs-var">inputFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621682243674"><span class="annot"><a href="#local-6989586621682243674"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">SourceFile</span></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#srcFromPath"><span class="hs-identifier hs-type">srcFromPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243673"><span class="hs-identifier hs-type">path</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621682243676"><span class="annot"><a href="#local-6989586621682243676"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Source</span></span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#parseSource"><span class="hs-identifier hs-type">Imp.parseSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243674"><span class="hs-identifier hs-type">sf</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><a href="#local-6989586621682243678"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621682243678"><span class="annot"><a href="#local-6989586621682243678"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Source -&gt; TopLevelModuleName
</span><a href="Agda.Interaction.Imports.html#srcModuleName"><span class="hs-identifier hs-var">Imp.srcModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243676"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-type">setCurrentRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#beginningOfFile"><span class="hs-identifier hs-type">beginningOfFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243673"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><a href="Agda.Interaction.FindFile.html#checkModuleName"><span class="hs-identifier hs-type">checkModuleName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243678"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Imports.html#srcOrigin"><span class="hs-identifier hs-var">Imp.srcOrigin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243676"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-82"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Env.html#withCurrentModule"><span class="hs-identifier hs-type">withCurrentModule</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#noModuleName"><span class="hs-identifier hs-type">noModuleName</span></a></span><span>
</span><span id="line-83"></span><span>           </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withTopLevelModule"><span class="hs-identifier hs-type">withTopLevelModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243678"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-84"></span><span>           </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#checkModule"><span class="hs-identifier hs-type">checkModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243669"><span class="hs-identifier hs-type">par</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243678"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243676"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span> </span><span class="annot"><a href="#local-6989586621682243671"><span class="hs-identifier hs-type">checks</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#printAccumulatedWarnings"><span class="hs-identifier hs-type">printAccumulatedWarnings</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#printAccumulatedWarnings"><span class="hs-identifier hs-type">printAccumulatedWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span id="printAccumulatedWarnings"><span class="annot"><span class="annottext">printAccumulatedWarnings :: TCM ()
</span><a href="Agda.Interaction.BuildLibrary.html#printAccumulatedWarnings"><span class="hs-identifier hs-var hs-var">printAccumulatedWarnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">TCMT IO (Set TCWarning) -&gt; (Set TCWarning -&gt; TCM ()) -&gt; TCM ()
forall (m :: * -&gt; *) a.
(Monad m, Null a) =&gt;
m a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Null.html#unlessNullM"><span class="hs-identifier hs-var">unlessNullM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningsAndNonFatalErrors -&gt; Set TCWarning
</span><a href="Agda.TypeChecking.Monad.Base.html#tcWarnings"><span class="hs-identifier hs-var">tcWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">(WarningsAndNonFatalErrors -&gt; Set TCWarning)
-&gt; (Set TCWarning -&gt; WarningsAndNonFatalErrors)
-&gt; Set TCWarning
-&gt; Set TCWarning
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TCWarning] -&gt; WarningsAndNonFatalErrors
</span><a href="Agda.TypeChecking.Warnings.html#classifyWarnings"><span class="hs-identifier hs-var">classifyWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; WarningsAndNonFatalErrors)
-&gt; (Set TCWarning -&gt; [TCWarning])
-&gt; Set TCWarning
-&gt; WarningsAndNonFatalErrors
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning -&gt; [TCWarning]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span> </span><span class="annot"><span class="annottext">(Set TCWarning -&gt; Set TCWarning)
-&gt; TCMT IO (Set TCWarning) -&gt; TCMT IO (Set TCWarning)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WhichWarnings -&gt; TCMT IO (Set TCWarning)
forall (m :: * -&gt; *).
(MonadWarning m, MonadTCM m) =&gt;
WhichWarnings -&gt; m (Set TCWarning)
</span><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarnings"><span class="hs-identifier hs-var">getAllWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">WhichWarnings
</span><a href="Agda.TypeChecking.Warnings.html#AllWarnings"><span class="hs-identifier hs-var">AllWarnings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Set TCWarning -&gt; TCM ()) -&gt; TCM ())
-&gt; (Set TCWarning -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682243688"><span class="annot"><span class="annottext">Set TCWarning
</span><a href="#local-6989586621682243688"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682243691"><span class="annot"><span class="annottext">banner :: TCMT IO Doc
</span><a href="#local-6989586621682243691"><span class="hs-identifier hs-var hs-var">banner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; FilePath -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; TCMT IO Doc) -&gt; FilePath -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="Agda.Utils.String.html#delimiter"><span class="hs-identifier hs-var">delimiter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;All done; warnings encountered&quot;</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#alwaysReportSDoc"><span class="hs-identifier hs-var">alwaysReportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;warning&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-94"></span><span>      </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vsep"><span class="hs-identifier hs-var">vsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; TCMT IO Doc) -&gt; [TCMT IO Doc] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc
</span><a href="#local-6989586621682243691"><span class="hs-identifier hs-var">banner</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; [TCMT IO Doc]) -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TCWarning -&gt; TCMT IO Doc) -&gt; [TCWarning] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TCWarning -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; TCWarning -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; [TCMT IO Doc]) -&gt; [TCWarning] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning -&gt; [TCWarning]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning
</span><a href="#local-6989586621682243688"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#postCheckModule"><span class="hs-identifier hs-type">postCheckModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#Source"><span class="hs-identifier hs-type">Source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ModuleInfo"><span class="hs-identifier hs-type">ModuleInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span id="postCheckModule"><span class="annot"><span class="annottext">postCheckModule :: TopLevelModuleName -&gt; Source -&gt; ModuleInfo -&gt; TCM ()
</span><a href="Agda.Interaction.BuildLibrary.html#postCheckModule"><span class="hs-identifier hs-var hs-var">postCheckModule</span></a></span></span><span> </span><span id="local-6989586621682243694"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243694"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682243695"><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243695"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682243696"><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682243696"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- Here we ignore InfectiveImport warnings since we don't have an actual parent module that can</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- be infected.</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621682243697"><span class="annot"><span class="annottext">isInfectiveWarning :: Warning -&gt; Bool
</span><a href="#local-6989586621682243697"><span class="hs-identifier hs-var hs-var">isInfectiveWarning</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InfectiveImport"><span class="hs-identifier hs-type">InfectiveImport</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621682243697"><span class="hs-identifier hs-var">isInfectiveWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Warning
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621682243699"><span class="annot"><span class="annottext">warns :: [TCWarning]
</span><a href="#local-6989586621682243699"><span class="hs-identifier hs-var hs-var">warns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCWarning -&gt; Bool) -&gt; [TCWarning] -&gt; [TCWarning]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TCWarning -&gt; Bool) -&gt; TCWarning -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; Bool
</span><a href="#local-6989586621682243697"><span class="hs-identifier hs-var">isInfectiveWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; Bool) -&gt; (TCWarning -&gt; Warning) -&gt; TCWarning -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TCWarning -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#tcWarning"><span class="hs-identifier hs-var">tcWarning</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; [TCWarning]) -&gt; [TCWarning] -&gt; [TCWarning]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning -&gt; [TCWarning]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span> </span><span class="annot"><span class="annottext">(Set TCWarning -&gt; [TCWarning]) -&gt; Set TCWarning -&gt; [TCWarning]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleInfo -&gt; Set TCWarning
</span><a href="Agda.TypeChecking.Monad.Base.html#miWarnings"><span class="hs-identifier hs-var">miWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleInfo
</span><a href="#local-6989586621682243696"><span class="hs-identifier hs-var">mi</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">TopLevelModuleNameWithSourceFile -&gt; [TCWarning] -&gt; TCM ()
</span><a href="Agda.TypeChecking.Pretty.Warning.html#tcWarningsToError"><span class="hs-identifier hs-var">tcWarningsToError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelModuleName
-&gt; SourceFile -&gt; TopLevelModuleNameWithSourceFile
</span><a href="Agda.TypeChecking.Monad.Base.Types.html#TopLevelModuleNameWithSourceFile"><span class="hs-identifier hs-var">TopLevelModuleNameWithSourceFile</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243694"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Source -&gt; SourceFile
</span><a href="Agda.Interaction.Imports.html#srcOrigin"><span class="hs-identifier hs-var">Imp.srcOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243695"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TCWarning]
</span><a href="#local-6989586621682243699"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#checkModule"><span class="hs-identifier hs-type">checkModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#TCWorkers"><span class="hs-identifier hs-type">TCWorkers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#Source"><span class="hs-identifier hs-type">Source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span id="checkModule"><span class="annot"><span class="annottext">checkModule :: Maybe TCWorkers -&gt; TopLevelModuleName -&gt; Source -&gt; TCMT IO (TCM ())
</span><a href="Agda.Interaction.BuildLibrary.html#checkModule"><span class="hs-identifier hs-var hs-var">checkModule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682243704"><span class="annot"><span class="annottext">TCWorkers
</span><a href="#local-6989586621682243704"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682243705"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243705"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682243706"><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243706"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
-&gt; (PragmaOptions -&gt; TCM ())
-&gt; TCMT IO (TCM ())
-&gt; TCMT IO (TCM ())
forall (m :: * -&gt; *) a b.
Monad m =&gt;
m a -&gt; (a -&gt; m ()) -&gt; m b -&gt; m b
</span><a href="Agda.Utils.Monad.html#bracket_"><span class="hs-identifier hs-var">bracket_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' TCState PragmaOptions -&gt; TCMT IO PragmaOptions
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; f PragmaOptions) -&gt; TCState -&gt; f TCState
Lens' TCState PragmaOptions
</span><a href="Agda.TypeChecking.Monad.Base.html#stPragmaOptions"><span class="hs-identifier hs-var">stPragmaOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PragmaOptions -&gt; f PragmaOptions) -&gt; TCState -&gt; f TCState
Lens' TCState PragmaOptions
</span><a href="Agda.TypeChecking.Monad.Base.html#stPragmaOptions"><span class="hs-identifier hs-var">stPragmaOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState PragmaOptions -&gt; PragmaOptions -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-operator hs-var">`setTCLens`</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Source -&gt; TCM ()
</span><a href="Agda.Interaction.Imports.html#setOptionsFromSourcePragmas"><span class="hs-identifier hs-var">Imp.setOptionsFromSourcePragmas</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243706"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621682243715"><span class="annot"><a href="#local-6989586621682243715"><span class="hs-identifier hs-var">mip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCWorkers
-&gt; TopLevelModuleName
-&gt; MainInterface
-&gt; Maybe Source
-&gt; TCM (TCM ModuleInfo)
</span><a href="Agda.Interaction.Imports.html#chaseModule"><span class="hs-identifier hs-var">Imp.chaseModule</span></a></span><span> </span><span class="annot"><span class="annottext">TCWorkers
</span><a href="#local-6989586621682243704"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243705"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">MainInterface
</span><a href="Agda.Interaction.Imports.html#NotMainInterface"><span class="hs-identifier hs-var">NotMainInterface</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Source -&gt; Maybe Source
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243706"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682243715"><span class="hs-identifier hs-type">mip</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#postCheckModule"><span class="hs-identifier hs-type">postCheckModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243705"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243706"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#checkModule"><span class="hs-identifier hs-var">checkModule</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TCWorkers
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621682243718"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243718"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682243719"><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243719"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621682243720"><span class="annot"><a href="#local-6989586621682243720"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; Maybe Source -&gt; TCM ModuleInfo
</span><a href="Agda.Interaction.Imports.html#getNonMainModuleInfo"><span class="hs-identifier hs-var">Imp.getNonMainModuleInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621682243718"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Source -&gt; Maybe Source
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Source
</span><a href="#local-6989586621682243719"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Agda.Interaction.BuildLibrary.html#postCheckModule"><span class="hs-identifier hs-type">postCheckModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243718"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243719"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682243720"><span class="hs-identifier hs-type">mi</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span></pre></body></html>