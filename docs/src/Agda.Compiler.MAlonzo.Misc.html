<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Misc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IdentityT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runStateT</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html"><span class="hs-identifier">Agda.Utils.Haskell.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html"><span class="hs-identifier">Agda.Compiler.Common</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CC</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html"><span class="hs-identifier">Agda.Syntax.TopLevelModuleName</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.CallStack.html"><span class="hs-identifier">Agda.Utils.CallStack</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Setting up Interface before compile</span><span>
</span><span id="line-37"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="HsModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-var">HsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HsModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-var">HsModuleEnv</span></a></span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mazModuleName"><span class="annot"><span class="annottext">HsModuleEnv -&gt; TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazModuleName"><span class="hs-identifier hs-var hs-var">mazModuleName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The name of the Agda module</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mazIsMainModule"><span class="annot"><span class="annottext">HsModuleEnv -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazIsMainModule"><span class="hs-identifier hs-var hs-var">mazIsMainModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-comment">-- ^ Whether this is the compilation root and therefore should have the `main` function.</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">--   This corresponds to the @IsMain@ flag provided to the backend,</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">--   not necessarily whether the GHC module has a `main` function defined.</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | The options derived from</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- 'Agda.Compiler.MAlonzo.Compiler.GHCFlags' and other shared options.</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="GHCOptions"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-var">GHCOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCOptions"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-var">GHCOptions</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="optGhcCallGhc"><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCallGhc"><span class="hs-identifier hs-var hs-var">optGhcCallGhc</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcBin"><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcBin"><span class="hs-identifier hs-var hs-var">optGhcBin</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Use the compiler at PATH instead of &quot;ghc&quot;</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcFlags"><span class="annot"><span class="annottext">GHCOptions -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcFlags"><span class="hs-identifier hs-var hs-var">optGhcFlags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcCompileDir"><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var hs-var">optGhcCompileDir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcStrictData"><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var hs-var">optGhcStrictData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Make inductive constructors strict?</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcStrict"><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var hs-var">optGhcStrict</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Make functions strict?</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcTrace"><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcTrace"><span class="hs-identifier hs-var hs-var">optGhcTrace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Print function name upon entry using 'Debug.Trace.trace'?</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | A static part of the GHC backend's environment that does not</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- change from module to module.</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="GHCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-var">GHCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-var">GHCEnv</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcEnvOpts"><span class="annot"><span class="annottext">GHCEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var hs-var">ghcEnvOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvBool"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvBool"><span class="hs-identifier hs-var hs-var">ghcEnvBool</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvTrue"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvTrue"><span class="hs-identifier hs-var hs-var">ghcEnvTrue</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvFalse"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFalse"><span class="hs-identifier hs-var hs-var">ghcEnvFalse</span></a></span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvMaybe"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybe"><span class="hs-identifier hs-var hs-var">ghcEnvMaybe</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvNothing"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNothing"><span class="hs-identifier hs-var hs-var">ghcEnvNothing</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvJust"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvJust"><span class="hs-identifier hs-var hs-var">ghcEnvJust</span></a></span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvList"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvList"><span class="hs-identifier hs-var hs-var">ghcEnvList</span></a></span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvNil"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNil"><span class="hs-identifier hs-var hs-var">ghcEnvNil</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvCons"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvCons"><span class="hs-identifier hs-var hs-var">ghcEnvCons</span></a></span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvNat"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNat"><span class="hs-identifier hs-var hs-var">ghcEnvNat</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvInteger"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInteger"><span class="hs-identifier hs-var hs-var">ghcEnvInteger</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvWord64"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvWord64"><span class="hs-identifier hs-var hs-var">ghcEnvWord64</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvInf"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInf"><span class="hs-identifier hs-var hs-var">ghcEnvInf</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvSharp"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSharp"><span class="hs-identifier hs-var hs-var">ghcEnvSharp</span></a></span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvFlat"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFlat"><span class="hs-identifier hs-var hs-var">ghcEnvFlat</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvInterval"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInterval"><span class="hs-identifier hs-var hs-var">ghcEnvInterval</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIZero"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIZero"><span class="hs-identifier hs-var hs-var">ghcEnvIZero</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIOne"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIOne"><span class="hs-identifier hs-var hs-var">ghcEnvIOne</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIsOne"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne"><span class="hs-identifier hs-var hs-var">ghcEnvIsOne</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvItIsOne"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvItIsOne"><span class="hs-identifier hs-var hs-var">ghcEnvItIsOne</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIsOne1"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne1"><span class="hs-identifier hs-var hs-var">ghcEnvIsOne1</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIsOne2"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne2"><span class="hs-identifier hs-var hs-var">ghcEnvIsOne2</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIsOneEmpty"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOneEmpty"><span class="hs-identifier hs-var hs-var">ghcEnvIsOneEmpty</span></a></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvPathP"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvPathP"><span class="hs-identifier hs-var hs-var">ghcEnvPathP</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvSub"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSub"><span class="hs-identifier hs-var hs-var">ghcEnvSub</span></a></span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvSubIn"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSubIn"><span class="hs-identifier hs-var hs-var">ghcEnvSubIn</span></a></span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- Various (possibly) builtin names.</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvIsTCBuiltin"><span class="annot"><span class="annottext">GHCEnv -&gt; QName -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsTCBuiltin"><span class="hs-identifier hs-var hs-var">ghcEnvIsTCBuiltin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvListArity"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe Nat
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvListArity"><span class="hs-identifier hs-var hs-var">ghcEnvListArity</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcEnvMaybeArity"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe Nat
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybeArity"><span class="hs-identifier hs-var hs-var">ghcEnvMaybeArity</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Module compilation environment, bundling the overall</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   backend session options along with the module's basic</span><span>
</span><span id="line-105"></span><span class="hs-comment">--   readable properties.</span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="GHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcModEnv"><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModEnv"><span class="hs-identifier hs-var hs-var">ghcModEnv</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcModHsModuleEnv"><span class="annot"><span class="annottext">GHCModuleEnv -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModHsModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModHsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-type">HsModuleEnv</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- | Monads that can produce a 'GHCModuleEnv'.</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ReadGHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-var">ReadGHCModuleEnv</span></a></span></span><span> </span><span id="local-6989586621682244410"><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="askGHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-type">askGHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="askGHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-type">askGHCModuleEnv</span></a></span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682244411"><span id="local-6989586621682244413"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621682244411"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682244411"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244413"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244413"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span></span></span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621682244714"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var hs-var">askGHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n GHCModuleEnv -&gt; t n GHCModuleEnv
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">n GHCModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var">askGHCModuleEnv</span></a></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>  </span><span id="askHsModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-type">askHsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-type">HsModuleEnv</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621682244724"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var hs-var">askHsModuleEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModHsModuleEnv"><span class="hs-identifier hs-var">ghcModHsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; HsModuleEnv) -&gt; m GHCModuleEnv -&gt; m HsModuleEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var">askGHCModuleEnv</span></a></span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>  </span><span id="askGHCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-type">askGHCEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682244410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621682244734"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var hs-var">askGHCEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModEnv"><span class="hs-identifier hs-var">ghcModEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; GHCEnv) -&gt; m GHCModuleEnv -&gt; m GHCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var">askGHCModuleEnv</span></a></span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682244405"><span id="local-6989586621682244745"><span id="local-6989586621682244748"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682244405"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244405"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621682244753"><span class="annot"><span class="annottext">askGHCModuleEnv :: ReaderT GHCModuleEnv m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var hs-var hs-var">askGHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCModuleEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682244436"><span id="local-6989586621682244437"><span id="local-6989586621682244760"><span id="local-6989586621682244768"><span id="local-6989586621682244771"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244436"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621682244437"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244436"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682244441"><span id="local-6989586621682244779"><span id="local-6989586621682244787"><span id="local-6989586621682244790"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244441"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621682244441"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682244445"><span id="local-6989586621682244798"><span id="local-6989586621682244806"><span id="local-6989586621682244809"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244445"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><a href="#local-6989586621682244445"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682244449"><span id="local-6989586621682244450"><span id="local-6989586621682244816"><span id="local-6989586621682244824"><span id="local-6989586621682244827"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244449"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621682244450"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244449"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">newtype</span><span> </span><span id="HsCompileState"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-var">HsCompileState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HsCompileState"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-var">HsCompileState</span></a></span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mazAccumlatedImports"><span class="annot"><span class="annottext">HsCompileState -&gt; Set TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAccumlatedImports"><span class="hs-identifier hs-var hs-var">mazAccumlatedImports</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682244832"><span id="local-6989586621682244837"><span class="annot"><span class="annottext">HsCompileState -&gt; HsCompileState -&gt; Bool
(HsCompileState -&gt; HsCompileState -&gt; Bool)
-&gt; (HsCompileState -&gt; HsCompileState -&gt; Bool) -&gt; Eq HsCompileState
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: HsCompileState -&gt; HsCompileState -&gt; Bool
== :: HsCompileState -&gt; HsCompileState -&gt; Bool
$c/= :: HsCompileState -&gt; HsCompileState -&gt; Bool
/= :: HsCompileState -&gt; HsCompileState -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682244844"><span id="local-6989586621682244849"><span id="local-6989586621682244853"><span class="annot"><span class="annottext">NonEmpty HsCompileState -&gt; HsCompileState
HsCompileState -&gt; HsCompileState -&gt; HsCompileState
(HsCompileState -&gt; HsCompileState -&gt; HsCompileState)
-&gt; (NonEmpty HsCompileState -&gt; HsCompileState)
-&gt; (forall b. Integral b =&gt; b -&gt; HsCompileState -&gt; HsCompileState)
-&gt; Semigroup HsCompileState
forall b. Integral b =&gt; b -&gt; HsCompileState -&gt; HsCompileState
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: HsCompileState -&gt; HsCompileState -&gt; HsCompileState
&lt;&gt; :: HsCompileState -&gt; HsCompileState -&gt; HsCompileState
$csconcat :: NonEmpty HsCompileState -&gt; HsCompileState
sconcat :: NonEmpty HsCompileState -&gt; HsCompileState
$cstimes :: forall b. Integral b =&gt; b -&gt; HsCompileState -&gt; HsCompileState
stimes :: forall b. Integral b =&gt; b -&gt; HsCompileState -&gt; HsCompileState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682244865"><span id="local-6989586621682244870"><span id="local-6989586621682244874"><span class="annot"><span class="annottext">Semigroup HsCompileState
HsCompileState
Semigroup HsCompileState =&gt;
HsCompileState
-&gt; (HsCompileState -&gt; HsCompileState -&gt; HsCompileState)
-&gt; ([HsCompileState] -&gt; HsCompileState)
-&gt; Monoid HsCompileState
[HsCompileState] -&gt; HsCompileState
HsCompileState -&gt; HsCompileState -&gt; HsCompileState
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
$cmempty :: HsCompileState
mempty :: HsCompileState
$cmappend :: HsCompileState -&gt; HsCompileState -&gt; HsCompileState
mappend :: HsCompileState -&gt; HsCompileState -&gt; HsCompileState
$cmconcat :: [HsCompileState] -&gt; HsCompileState
mconcat :: [HsCompileState] -&gt; HsCompileState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">-- | Transformer adding read-only module info and a writable set of imported modules</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span id="HsCompileT"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-var">HsCompileT</span></a></span></span><span> </span><span id="local-6989586621682244879"><span class="annot"><a href="#local-6989586621682244879"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244879"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | The default compilation monad is the entire TCM (&#9785;&#65039;) enriched with our state and module info</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span id="HsCompileM"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-var">HsCompileM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621682244460"><span id="local-6989586621682244461"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT%27"><span class="hs-identifier hs-type">runHsCompileT'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244460"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244460"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682244461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-145"></span><span id="runHsCompileT%27"><span class="annot"><span class="annottext">runHsCompileT' :: forall (m :: * -&gt; *) a.
HsCompileT m a
-&gt; GHCModuleEnv -&gt; HsCompileState -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT%27"><span class="hs-identifier hs-var hs-var">runHsCompileT'</span></a></span></span><span> </span><span id="local-6989586621682244881"><span class="annot"><span class="annottext">HsCompileT m a
</span><a href="#local-6989586621682244881"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682244882"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682244882"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682244883"><span class="annot"><span class="annottext">HsCompileState
</span><a href="#local-6989586621682244883"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StateT HsCompileState m a
 -&gt; HsCompileState -&gt; m (a, HsCompileState))
-&gt; HsCompileState
-&gt; StateT HsCompileState m a
-&gt; m (a, HsCompileState)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT HsCompileState m a
-&gt; HsCompileState -&gt; m (a, HsCompileState)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">HsCompileState
</span><a href="#local-6989586621682244883"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT HsCompileState m a -&gt; m (a, HsCompileState))
-&gt; (HsCompileT m a -&gt; StateT HsCompileState m a)
-&gt; HsCompileT m a
-&gt; m (a, HsCompileState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HsCompileT m a -&gt; GHCModuleEnv -&gt; StateT HsCompileState m a)
-&gt; GHCModuleEnv -&gt; HsCompileT m a -&gt; StateT HsCompileState m a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a -&gt; GHCModuleEnv -&gt; StateT HsCompileState m a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682244882"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HsCompileT m a -&gt; m (a, HsCompileState))
-&gt; HsCompileT m a -&gt; m (a, HsCompileState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a
</span><a href="#local-6989586621682244881"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621682244482"><span id="local-6989586621682244483"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT"><span class="hs-identifier hs-type">runHsCompileT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244482"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244482"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682244483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-148"></span><span id="runHsCompileT"><span class="annot"><span class="annottext">runHsCompileT :: forall (m :: * -&gt; *) a.
HsCompileT m a -&gt; GHCModuleEnv -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT"><span class="hs-identifier hs-var hs-var">runHsCompileT</span></a></span></span><span> </span><span id="local-6989586621682244888"><span class="annot"><span class="annottext">HsCompileT m a
</span><a href="#local-6989586621682244888"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682244889"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682244889"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsCompileT m a
-&gt; GHCModuleEnv -&gt; HsCompileState -&gt; m (a, HsCompileState)
forall (m :: * -&gt; *) a.
HsCompileT m a
-&gt; GHCModuleEnv -&gt; HsCompileState -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT%27"><span class="hs-identifier hs-var">runHsCompileT'</span></a></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a
</span><a href="#local-6989586621682244888"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621682244889"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">HsCompileState
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621682244486"><span id="local-6989586621682244488"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ghcBackendError"><span class="hs-identifier hs-type">ghcBackendError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCError"><span class="hs-identifier hs-type">MonadTCError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244486"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GHCBackendError"><span class="hs-identifier hs-type">GHCBackendError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244488"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-151"></span><span id="ghcBackendError"><span class="annot"><span class="annottext">ghcBackendError :: forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
GHCBackendError -&gt; m a
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcBackendError"><span class="hs-identifier hs-var hs-var">ghcBackendError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCBackendError -&gt; TypeError)
-&gt; HasCallStack =&gt; GHCBackendError -&gt; m a
forall (m :: * -&gt; *) a b.
MonadTCError m =&gt;
(a -&gt; TypeError) -&gt; HasCallStack =&gt; a -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Base.html#locatedTypeError"><span class="hs-identifier hs-var">locatedTypeError</span></a></span><span> </span><span class="annot"><span class="annottext">GHCBackendError -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GHCBackendError"><span class="hs-identifier hs-var">GHCBackendError</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- utilities for haskell names</span><span>
</span><span id="line-155"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Whether the current module is expected to have the `main` function.</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   This corresponds to the @IsMain@ flag provided to the backend,</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   not necessarily whether the GHC module actually has a `main` function defined.</span><span>
</span><span id="line-160"></span><span id="local-6989586621682244495"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-type">curIsMainModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-161"></span><span id="curIsMainModule"><span class="annot"><span class="annottext">curIsMainModule :: forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-var hs-var">curIsMainModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsModuleEnv -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazIsMainModule"><span class="hs-identifier hs-var">mazIsMainModule</span></a></span><span> </span><span class="annot"><span class="annottext">(HsModuleEnv -&gt; Bool) -&gt; m HsModuleEnv -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m HsModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var">askHsModuleEnv</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | This is the same value as @curMName@, but does not rely on the TCM's state.</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   (@curMName@ and co. should be removed, but the current @Backend@ interface</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   is not sufficient yet to allow that)</span><span>
</span><span id="line-166"></span><span id="local-6989586621682244497"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-type">curAgdaMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span></span><span>
</span><span id="line-167"></span><span id="curAgdaMod"><span class="annot"><span class="annottext">curAgdaMod :: forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-var hs-var">curAgdaMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsModuleEnv -&gt; TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazModuleName"><span class="hs-identifier hs-var">mazModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">(HsModuleEnv -&gt; TopLevelModuleName)
-&gt; m HsModuleEnv -&gt; m TopLevelModuleName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m HsModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var">askHsModuleEnv</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | Get the Haskell module name of the currently-focused Agda module</span></span><span>
</span><span id="line-170"></span><span id="local-6989586621682244499"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-type">curHsMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244499"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244499"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span></span><span>
</span><span id="line-171"></span><span id="curHsMod"><span class="annot"><span class="annottext">curHsMod :: forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var hs-var">curHsMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-var">mazMod</span></a></span><span> </span><span class="annot"><span class="annottext">(TopLevelModuleName -&gt; ModuleName)
-&gt; m TopLevelModuleName -&gt; m ModuleName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m TopLevelModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-var">curAgdaMod</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | There are two kinds of functions: those definitely without unused</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- arguments, and those that might have unused arguments.</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="FunctionKind"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunctionKind"><span class="hs-identifier hs-var">FunctionKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoUnused"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NoUnused"><span class="hs-identifier hs-var">NoUnused</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="PossiblyUnused"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#PossiblyUnused"><span class="hs-identifier hs-var">PossiblyUnused</span></a></span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Different kinds of variables: those starting with @a@, those</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- starting with @v@, and those starting with @x@.</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">data</span><span> </span><span id="VariableKind"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VariableKind"><span class="hs-identifier hs-var">VariableKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="A"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="V"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#V"><span class="hs-identifier hs-var">V</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="X"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#X"><span class="hs-identifier hs-var">X</span></a></span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | Different kinds of names.</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="NameKind"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NameKind"><span class="hs-identifier hs-var">NameKind</span></a></span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TypeK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Types.</span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ConK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-var">ConK</span></a></span></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Constructors.</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VarK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VarK"><span class="hs-identifier hs-var">VarK</span></a></span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VariableKind"><span class="hs-identifier hs-type">VariableKind</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Variables.</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CoverK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-var">CoverK</span></a></span></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Used for coverage checking.</span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CheckK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-var">CheckK</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Used for constructor type checking.</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FunK"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-var">FunK</span></a></span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Other functions.</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Turns strings into valid Haskell identifiers.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- In order to avoid clashes with names of regular Haskell definitions</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- (those not generated from Agda definitions), make sure that the</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- Haskell names are always used qualified, with the exception of</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- names from the prelude.</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#encodeString"><span class="hs-identifier hs-type">encodeString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NameKind"><span class="hs-identifier hs-type">NameKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-207"></span><span id="encodeString"><span class="annot"><span class="annottext">encodeString :: NameKind -&gt; String -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#encodeString"><span class="hs-identifier hs-var hs-var">encodeString</span></a></span></span><span> </span><span id="local-6989586621682244932"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244932"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682244933"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682244933"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682244934"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; String -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
</span><a href="#local-6989586621682244936"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682244933"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621682244936"><span class="annot"><span class="annottext">encode :: Char -&gt; String
</span><a href="#local-6989586621682244936"><span class="hs-identifier hs-var hs-var">encode</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;''&quot;</span></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="#local-6989586621682244936"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span id="local-6989586621682244947"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isUpper</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">Char -&gt; GeneralCategory
</span><span class="hs-identifier hs-var">generalCategory</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralCategory -&gt; GeneralCategory -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GeneralCategory
</span><span class="hs-identifier hs-var">DecimalNumber</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Nat
forall a. Enum a =&gt; a -&gt; Nat
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682244947"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621682244934"><span class="annot"><span class="annottext">prefix :: String
</span><a href="#local-6989586621682244934"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244932"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-var">ConK</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;C&quot;</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VarK"><span class="hs-identifier hs-type">VarK</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VarK"><span class="hs-identifier hs-type">VarK</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#V"><span class="hs-identifier hs-var">V</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;v&quot;</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VarK"><span class="hs-identifier hs-type">VarK</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#X"><span class="hs-identifier hs-var">X</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-var">CoverK</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cover&quot;</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-var">CheckK</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check&quot;</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-type">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#NoUnused"><span class="hs-identifier hs-var">NoUnused</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;du&quot;</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-type">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#PossiblyUnused"><span class="hs-identifier hs-var">PossiblyUnused</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-type">ihname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#VariableKind"><span class="hs-identifier hs-type">VariableKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-229"></span><span id="ihname"><span class="annot"><span class="annottext">ihname :: VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var hs-var">ihname</span></a></span></span><span> </span><span id="local-6989586621682244956"><span class="annot"><span class="annottext">VariableKind
</span><a href="#local-6989586621682244956"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682244957"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682244957"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Name) -&gt; String -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; String -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#encodeString"><span class="hs-identifier hs-var">encodeString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#VarK"><span class="hs-identifier hs-var">VarK</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="#local-6989586621682244956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682244957"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-type">unqhname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NameKind"><span class="hs-identifier hs-type">NameKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-232"></span><span id="unqhname"><span class="annot"><span class="annottext">unqhname :: NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var hs-var">unqhname</span></a></span></span><span> </span><span id="local-6989586621682244960"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244960"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682244961"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244961"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Name) -&gt; String -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; String -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#encodeString"><span class="hs-identifier hs-var">encodeString</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244960"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameCanonical"><span class="hs-identifier hs-var">nameCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682244964"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NameId -&gt; String
</span><a href="#local-6989586621682244965"><span class="hs-identifier hs-var">idnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NameId
forall a. HasNameId a =&gt; a -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682244964"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621682244964"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621682244964"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244961"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621682244965"><span class="annot"><span class="annottext">idnum :: NameId -&gt; String
</span><a href="#local-6989586621682244965"><span class="hs-identifier hs-var hs-var">idnum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621682244975"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682244975"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682244975"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- the toplevel module containing the given one</span><span>
</span><span id="line-241"></span><span id="local-6989586621682244520"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#tlmodOf"><span class="hs-identifier hs-type">tlmodOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244520"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244520"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span></span><span>
</span><span id="line-242"></span><span id="tlmodOf"><span class="annot"><span class="annottext">tlmodOf :: forall (m :: * -&gt; *). ReadTCState m =&gt; ModuleName -&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#tlmodOf"><span class="hs-identifier hs-var hs-var">tlmodOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TopLevelModuleName -&gt; ModuleName)
-&gt; m TopLevelModuleName -&gt; m ModuleName
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-var">mazMod</span></a></span><span> </span><span class="annot"><span class="annottext">(m TopLevelModuleName -&gt; m ModuleName)
-&gt; (ModuleName -&gt; m TopLevelModuleName)
-&gt; ModuleName
-&gt; m ModuleName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m TopLevelModuleName
forall (m :: * -&gt; *).
ReadTCState m =&gt;
ModuleName -&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.Common.html#topLevelModuleName"><span class="hs-identifier hs-var">CC.topLevelModuleName</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- qualify HS.Name n by the module of QName q, if necessary;</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- accumulates the used module in stImportedModules at the same time.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-identifier hs-type">xqual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-248"></span><span id="xqual"><span class="annot"><span class="annottext">xqual :: QName -&gt; Name -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-identifier hs-var hs-var">xqual</span></a></span></span><span> </span><span id="local-6989586621682244986"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244986"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621682244987"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682244987"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621682244988"><span class="annot"><a href="#local-6989586621682244988"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) TopLevelModuleName
forall (m :: * -&gt; *).
ReadTCState m =&gt;
ModuleName -&gt; m TopLevelModuleName
</span><a href="Agda.Compiler.Common.html#topLevelModuleName"><span class="hs-identifier hs-var">CC.topLevelModuleName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; ModuleName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameModule"><span class="hs-identifier hs-var">qnameModule</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244986"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621682244990"><span class="annot"><a href="#local-6989586621682244990"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-type">curAgdaMod</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682244988"><span class="hs-identifier hs-type">m1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682244990"><span class="hs-identifier hs-type">m2</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-type">HS.UnQual</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244987"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621682244988"><span class="hs-identifier hs-type">m1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazAccumlatedImports"><span class="hs-identifier hs-var">mazAccumlatedImports</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-type">HS.Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-type">mazMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682244988"><span class="hs-identifier hs-type">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682244987"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-type">xhqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#NameKind"><span class="hs-identifier hs-type">NameKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-258"></span><span id="xhqn"><span class="annot"><span class="annottext">xhqn :: NameKind -&gt; QName -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var hs-var">xhqn</span></a></span></span><span> </span><span id="local-6989586621682244995"><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244995"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682244996"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244996"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-identifier hs-var">xqual</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244996"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="#local-6989586621682244995"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682244996"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-type">hsName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-261"></span><span id="hsName"><span class="annot"><span class="annottext">hsName :: String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var hs-var">hsName</span></a></span></span><span> </span><span id="local-6989586621682244998"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682244998"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682244998"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- always use the original name for a constructor even when it's redefined.</span><span>
</span><span id="line-264"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-type">conhqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-265"></span><span id="conhqn"><span class="annot"><span class="annottext">conhqn :: QName -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-var hs-var">conhqn</span></a></span></span><span> </span><span id="local-6989586621682245000"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245000"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-var">ConK</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; HsCompileM QName)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; HsCompileM QName
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m QName
</span><a href="Agda.TypeChecking.Monad.Signature.html#canonicalName"><span class="hs-identifier hs-var">canonicalName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245000"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- qualify name s by the module of builtin b</span><span>
</span><span id="line-268"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#bltQual"><span class="hs-identifier hs-type">bltQual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#BuiltinId"><span class="hs-identifier hs-type">BuiltinId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-269"></span><span id="bltQual"><span class="annot"><span class="annottext">bltQual :: BuiltinId -&gt; String -&gt; HsCompileM QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#bltQual"><span class="hs-identifier hs-var hs-var">bltQual</span></a></span></span><span> </span><span id="local-6989586621682245004"><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682245004"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682245005"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245005"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621682245007"><span class="annot"><a href="#local-6989586621682245007"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadTCError m) =&gt;
BuiltinId -&gt; m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getBuiltin"><span class="hs-identifier hs-var">getBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="#local-6989586621682245004"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-identifier hs-type">xqual</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682245007"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-type">HS.Ident</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682245005"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-type">dname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-274"></span><span id="dname"><span class="annot"><span class="annottext">dname :: QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var hs-var">dname</span></a></span></span><span> </span><span id="local-6989586621682245010"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245010"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionKind -&gt; NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-var">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#PossiblyUnused"><span class="hs-identifier hs-var">PossiblyUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245010"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Name for definition stripped of unused arguments</span></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-type">duname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-278"></span><span id="duname"><span class="annot"><span class="annottext">duname :: QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var hs-var">duname</span></a></span></span><span> </span><span id="local-6989586621682245012"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245012"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionKind -&gt; NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-var">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#NoUnused"><span class="hs-identifier hs-var">NoUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245012"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsPrimOp"><span class="hs-identifier hs-type">hsPrimOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QOp"><span class="hs-identifier hs-type">HS.QOp</span></a></span><span>
</span><span id="line-281"></span><span id="hsPrimOp"><span class="annot"><span class="annottext">hsPrimOp :: String -&gt; QOp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsPrimOp"><span class="hs-identifier hs-var hs-var">hsPrimOp</span></a></span></span><span> </span><span id="local-6989586621682245014"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245014"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; QOp
</span><a href="Agda.Utils.Haskell.Syntax.html#QVarOp"><span class="hs-identifier hs-var">HS.QVarOp</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; QOp) -&gt; QName -&gt; QOp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Symbol"><span class="hs-identifier hs-var">HS.Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245014"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsPrimOpApp"><span class="hs-identifier hs-type">hsPrimOpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-284"></span><span id="hsPrimOpApp"><span class="annot"><span class="annottext">hsPrimOpApp :: String -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsPrimOpApp"><span class="hs-identifier hs-var hs-var">hsPrimOpApp</span></a></span></span><span> </span><span id="local-6989586621682245018"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245018"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682245019"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245019"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682245020"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245020"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; QOp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#InfixApp"><span class="hs-identifier hs-var">HS.InfixApp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245019"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QOp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsPrimOp"><span class="hs-identifier hs-var">hsPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245018"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245020"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsInt"><span class="hs-identifier hs-type">hsInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-287"></span><span id="hsInt"><span class="annot"><span class="annottext">hsInt :: Integer -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsInt"><span class="hs-identifier hs-var hs-var">hsInt</span></a></span></span><span> </span><span id="local-6989586621682245023"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682245023"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682245023"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621682244545"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-type">hsTypedInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682244545"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244545"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span></span><span>
</span><span id="line-290"></span><span id="hsTypedInt"><span class="annot"><span class="annottext">hsTypedInt :: forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var hs-var">hsTypedInt</span></a></span></span><span> </span><span id="local-6989586621682245030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682245030"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#ExpTypeSig"><span class="hs-identifier hs-var">HS.ExpTypeSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682245030"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span id="local-6989586621682244548"><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedDouble"><span class="hs-identifier hs-type">hsTypedDouble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621682244548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682244548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span></span><span>
</span><span id="line-293"></span><span id="hsTypedDouble"><span class="annot"><span class="annottext">hsTypedDouble :: forall a. Real a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedDouble"><span class="hs-identifier hs-var hs-var">hsTypedDouble</span></a></span></span><span> </span><span id="local-6989586621682245036"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682245036"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#ExpTypeSig"><span class="hs-identifier hs-var">HS.ExpTypeSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Frac"><span class="hs-identifier hs-var">HS.Frac</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Literal) -&gt; Rational -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682245036"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Double&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsLet"><span class="hs-identifier hs-type">hsLet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-296"></span><span id="hsLet"><span class="annot"><span class="annottext">hsLet :: Name -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLet"><span class="hs-identifier hs-var hs-var">hsLet</span></a></span></span><span> </span><span id="local-6989586621682245039"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682245039"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682245040"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245040"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682245041"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245041"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">Binds -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Let"><span class="hs-identifier hs-var">HS.Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; Binds
</span><a href="Agda.Utils.Haskell.Syntax.html#BDecls"><span class="hs-identifier hs-var">HS.BDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Strictness -&gt; Name -&gt; Rhs -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#LocalBind"><span class="hs-identifier hs-var">HS.LocalBind</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Lazy"><span class="hs-identifier hs-var">HS.Lazy</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682245039"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245040"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245041"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-type">hsVarUQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-300"></span><span id="hsVarUQ"><span class="annot"><span class="annottext">hsVarUQ :: Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var hs-var">hsVarUQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; (Name -&gt; QName) -&gt; Name -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsAppView"><span class="hs-identifier hs-type">hsAppView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span id="hsAppView"><span class="annot"><span class="annottext">hsAppView :: Exp -&gt; [Exp]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsAppView"><span class="hs-identifier hs-var hs-var">hsAppView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; [Exp]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([Exp] -&gt; [Exp]) -&gt; (Exp -&gt; [Exp]) -&gt; Exp -&gt; [Exp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp]
</span><a href="#local-6989586621682245051"><span class="hs-identifier hs-var">view</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621682245051"><span class="annot"><span class="annottext">view :: Exp -&gt; [Exp]
</span><a href="#local-6989586621682245051"><span class="hs-identifier hs-var hs-var">view</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-type">HS.App</span></a></span><span> </span><span id="local-6989586621682245053"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245053"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682245054"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245054"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245054"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; [Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp]
</span><a href="#local-6989586621682245051"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245053"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621682245051"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#InfixApp"><span class="hs-identifier hs-type">HS.InfixApp</span></a></span><span> </span><span id="local-6989586621682245055"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245055"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621682245056"><span class="annot"><span class="annottext">QOp
</span><a href="#local-6989586621682245056"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682245057"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245057"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245057"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245055"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QOp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsOpToExp"><span class="hs-identifier hs-var">hsOpToExp</span></a></span><span> </span><span class="annot"><span class="annottext">QOp
</span><a href="#local-6989586621682245056"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="#local-6989586621682245051"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span id="local-6989586621682245059"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245059"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245059"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsOpToExp"><span class="hs-identifier hs-type">hsOpToExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QOp"><span class="hs-identifier hs-type">HS.QOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-310"></span><span id="hsOpToExp"><span class="annot"><span class="annottext">hsOpToExp :: QOp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsOpToExp"><span class="hs-identifier hs-var hs-var">hsOpToExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QVarOp"><span class="hs-identifier hs-type">HS.QVarOp</span></a></span><span> </span><span id="local-6989586621682245060"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245060"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621682245060"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-type">hsLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-313"></span><span id="hsLambda"><span class="annot"><span class="annottext">hsLambda :: [Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-var hs-var">hsLambda</span></a></span></span><span> </span><span id="local-6989586621682245062"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245062"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-type">HS.Lambda</span></a></span><span> </span><span id="local-6989586621682245064"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245064"><span class="hs-identifier hs-var">ps1</span></a></span></span><span> </span><span id="local-6989586621682245065"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245065"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-var">HS.Lambda</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245062"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; [Pat] -&gt; [Pat]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245064"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245065"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-var">hsLambda</span></a></span><span> </span><span id="local-6989586621682245066"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245066"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682245067"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245067"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-var">HS.Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621682245066"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245067"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapAlt"><span class="hs-identifier hs-type">hsMapAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-317"></span><span id="hsMapAlt"><span class="annot"><span class="annottext">hsMapAlt :: (Exp -&gt; Exp) -&gt; Alt -&gt; Alt
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapAlt"><span class="hs-identifier hs-var hs-var">hsMapAlt</span></a></span></span><span> </span><span id="local-6989586621682245069"><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245069"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span> </span><span id="local-6989586621682245071"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682245071"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682245072"><span class="annot"><span class="annottext">Rhs
</span><a href="#local-6989586621682245072"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682245073"><span class="annot"><span class="annottext">Maybe Binds
</span><a href="#local-6989586621682245073"><span class="hs-identifier hs-var">wh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621682245071"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; Rhs -&gt; Rhs
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapRHS"><span class="hs-identifier hs-var">hsMapRHS</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245069"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rhs
</span><a href="#local-6989586621682245072"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="#local-6989586621682245073"><span class="hs-identifier hs-var">wh</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapRHS"><span class="hs-identifier hs-type">hsMapRHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Rhs"><span class="hs-identifier hs-type">HS.Rhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Rhs"><span class="hs-identifier hs-type">HS.Rhs</span></a></span><span>
</span><span id="line-320"></span><span id="hsMapRHS"><span class="annot"><span class="annottext">hsMapRHS :: (Exp -&gt; Exp) -&gt; Rhs -&gt; Rhs
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapRHS"><span class="hs-identifier hs-var hs-var">hsMapRHS</span></a></span></span><span> </span><span id="local-6989586621682245075"><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245075"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-type">HS.UnGuardedRhs</span></a></span><span> </span><span id="local-6989586621682245076"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245076"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245075"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245076"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#hsMapRHS"><span class="hs-identifier hs-var">hsMapRHS</span></a></span><span> </span><span id="local-6989586621682245077"><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245077"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-type">HS.GuardedRhss</span></a></span><span> </span><span id="local-6989586621682245079"><span class="annot"><span class="annottext">[GuardedRhs]
</span><a href="#local-6989586621682245079"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GuardedRhs] -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-var">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; Exp -&gt; GuardedRhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-var">HS.GuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621682245081"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621682245077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245082"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-type">HS.GuardedRhs</span></a></span><span> </span><span id="local-6989586621682245081"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621682245081"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682245082"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621682245082"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GuardedRhs]
</span><a href="#local-6989586621682245079"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- Hard coded module names</span><span>
</span><span id="line-325"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazstr"><span class="hs-identifier hs-type">mazstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-328"></span><span id="mazstr"><span class="annot"><span class="annottext">mazstr :: String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazstr"><span class="hs-identifier hs-var hs-var">mazstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo.Code&quot;</span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazName"><span class="hs-identifier hs-type">mazName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-331"></span><span id="mazName"><span class="annot"><span class="annottext">mazName :: Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazName"><span class="hs-identifier hs-var hs-var">mazName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameId -&gt; String -&gt; Name
forall a. MkName a =&gt; NameId -&gt; a -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#mkName_"><span class="hs-identifier hs-var">mkName_</span></a></span><span> </span><span class="annot"><span class="annottext">NameId
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazstr"><span class="hs-identifier hs-var">mazstr</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod%27"><span class="hs-identifier hs-type">mazMod'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span>
</span><span id="line-334"></span><span id="mazMod%27"><span class="annot"><span class="annottext">mazMod' :: String -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod%27"><span class="hs-identifier hs-var hs-var">mazMod'</span></a></span></span><span> </span><span id="local-6989586621682245088"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245088"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ModuleName) -&gt; String -&gt; ModuleName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazstr"><span class="hs-identifier hs-var">mazstr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245088"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-type">mazMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span>
</span><span id="line-337"></span><span id="mazMod"><span class="annot"><span class="annottext">mazMod :: TopLevelModuleName -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-var hs-var">mazMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod%27"><span class="hs-identifier hs-var">mazMod'</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ModuleName)
-&gt; (TopLevelModuleName -&gt; String)
-&gt; TopLevelModuleName
-&gt; ModuleName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-type">mazCoerceName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-340"></span><span id="mazCoerceName"><span class="annot"><span class="annottext">mazCoerceName :: String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-var hs-var">mazCoerceName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coe&quot;</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-type">mazErasedName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-343"></span><span id="mazErasedName"><span class="annot"><span class="annottext">mazErasedName :: String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var hs-var">mazErasedName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;erased&quot;</span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-type">mazAnyTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-346"></span><span id="mazAnyTypeName"><span class="annot"><span class="annottext">mazAnyTypeName :: String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-var hs-var">mazAnyTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AgdaAny&quot;</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerce"><span class="hs-identifier hs-type">mazCoerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- mazCoerce = HS.Var $ HS.Qual unsafeCoerceMod (HS.Ident &quot;unsafeCoerce&quot;)</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- mazCoerce = HS.Var $ HS.Qual mazRTE $ HS.Ident mazCoerceName</span><span>
</span><span id="line-351"></span><span id="mazCoerce"><span class="annot"><span class="annottext">mazCoerce :: Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerce"><span class="hs-identifier hs-var hs-var">mazCoerce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-var">mazCoerceName</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazUnreachableError"><span class="hs-identifier hs-type">mazUnreachableError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-354"></span><span id="mazUnreachableError"><span class="annot"><span class="annottext">mazUnreachableError :: Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazUnreachableError"><span class="hs-identifier hs-var hs-var">mazUnreachableError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mazUnreachableError&quot;</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#rtmUnreachableError"><span class="hs-identifier hs-type">rtmUnreachableError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-357"></span><span id="rtmUnreachableError"><span class="annot"><span class="annottext">rtmUnreachableError :: Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmUnreachableError"><span class="hs-identifier hs-var hs-var">rtmUnreachableError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazUnreachableError"><span class="hs-identifier hs-var">mazUnreachableError</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazHole"><span class="hs-identifier hs-type">mazHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-360"></span><span id="mazHole"><span class="annot"><span class="annottext">mazHole :: Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazHole"><span class="hs-identifier hs-var hs-var">mazHole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mazHole&quot;</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#rtmHole"><span class="hs-identifier hs-type">rtmHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-363"></span><span id="rtmHole"><span class="annot"><span class="annottext">rtmHole :: String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmHole"><span class="hs-identifier hs-var hs-var">rtmHole</span></a></span></span><span> </span><span id="local-6989586621682245099"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245099"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazHole"><span class="hs-identifier hs-var">mazHole</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Literal) -&gt; Text -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245099"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-type">mazAnyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Type"><span class="hs-identifier hs-type">HS.Type</span></a></span><span>
</span><span id="line-366"></span><span id="mazAnyType"><span class="annot"><span class="annottext">mazAnyType :: Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var hs-var">mazAnyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-var">mazAnyTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-type">mazRTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span>
</span><span id="line-369"></span><span id="mazRTE"><span class="annot"><span class="annottext">mazRTE :: ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var hs-var">mazRTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo.RTE&quot;</span></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-type">mazRTEFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span>
</span><span id="line-372"></span><span id="mazRTEFloat"><span class="annot"><span class="annottext">mazRTEFloat :: ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var hs-var">mazRTEFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo.RTE.Float&quot;</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-type">rtmQual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#QName"><span class="hs-identifier hs-type">HS.QName</span></a></span><span>
</span><span id="line-375"></span><span id="rtmQual"><span class="annot"><span class="annottext">rtmQual :: String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-var hs-var">rtmQual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; (String -&gt; Name) -&gt; String -&gt; QName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#rtmVar"><span class="hs-identifier hs-type">rtmVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-378"></span><span id="rtmVar"><span class="annot"><span class="annottext">rtmVar :: String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmVar"><span class="hs-identifier hs-var hs-var">rtmVar</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; (String -&gt; QName) -&gt; String -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-var">rtmQual</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#rtmError"><span class="hs-identifier hs-type">rtmError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-381"></span><span id="rtmError"><span class="annot"><span class="annottext">rtmError :: Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmError"><span class="hs-identifier hs-var hs-var">rtmError</span></a></span></span><span> </span><span id="local-6989586621682245107"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682245107"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmVar"><span class="hs-identifier hs-var">rtmVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-382"></span><span>             </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Literal) -&gt; Text -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;MAlonzo Runtime Error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682245107"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#unsafeCoerceMod"><span class="hs-identifier hs-type">unsafeCoerceMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span>
</span><span id="line-385"></span><span id="unsafeCoerceMod"><span class="annot"><span class="annottext">unsafeCoerceMod :: ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unsafeCoerceMod"><span class="hs-identifier hs-var hs-var">unsafeCoerceMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsafe.Coerce&quot;</span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- Sloppy ways to declare &lt;name&gt; = &lt;string&gt;</span><span>
</span><span id="line-389"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeD"><span class="hs-identifier hs-type">fakeD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-392"></span><span id="fakeD"><span class="annot"><span class="annottext">fakeD :: Name -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeD"><span class="hs-identifier hs-var hs-var">fakeD</span></a></span></span><span> </span><span id="local-6989586621682245111"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682245111"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682245112"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245112"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682245111"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var">fakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682245112"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDS"><span class="hs-identifier hs-type">fakeDS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-395"></span><span id="fakeDS"><span class="annot"><span class="annottext">fakeDS :: String -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDS"><span class="hs-identifier hs-var hs-var">fakeDS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeD"><span class="hs-identifier hs-var">fakeD</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String -&gt; Decl)
-&gt; (String -&gt; Name) -&gt; String -&gt; String -&gt; Decl
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDQ"><span class="hs-identifier hs-type">fakeDQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-398"></span><span id="fakeDQ"><span class="annot"><span class="annottext">fakeDQ :: QName -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDQ"><span class="hs-identifier hs-var hs-var">fakeDQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeD"><span class="hs-identifier hs-var">fakeD</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String -&gt; Decl)
-&gt; (QName -&gt; Name) -&gt; QName -&gt; String -&gt; Decl
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeType"><span class="hs-identifier hs-type">fakeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Type"><span class="hs-identifier hs-type">HS.Type</span></a></span><span>
</span><span id="line-401"></span><span id="fakeType"><span class="annot"><span class="annottext">fakeType :: String -&gt; Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeType"><span class="hs-identifier hs-var hs-var">fakeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-type">fakeExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-404"></span><span id="fakeExp"><span class="annot"><span class="annottext">fakeExp :: String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var hs-var">fakeExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDecl"><span class="hs-identifier hs-type">fakeDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-407"></span><span id="fakeDecl"><span class="annot"><span class="annottext">fakeDecl :: String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDecl"><span class="hs-identifier hs-var hs-var">fakeDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeDecl"><span class="hs-identifier hs-var">HS.FakeDecl</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- Auxiliary definitions</span><span>
</span><span id="line-411"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-type">emptyBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Binds"><span class="hs-identifier hs-type">HS.Binds</span></a></span><span>
</span><span id="line-414"></span><span id="emptyBinds"><span class="annot"><span class="annottext">emptyBinds :: Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var hs-var">emptyBinds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- Utilities for Haskell modules names</span><span>
</span><span id="line-418"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Can the character be used in a Haskell module name part</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- (@conid@)? This function is more restrictive than what the Haskell</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- report allows.</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#isModChar"><span class="hs-identifier hs-type">isModChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-425"></span><span id="isModChar"><span class="annot"><span class="annottext">isModChar :: Char -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#isModChar"><span class="hs-identifier hs-var hs-var">isModChar</span></a></span></span><span> </span><span id="local-6989586621682245125"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isUpper</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682245125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span>
</span><span id="line-427"></span></pre></body></html>